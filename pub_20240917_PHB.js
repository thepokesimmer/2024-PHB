var iFileName = "pub_20240917_PHB.js";
RequiredSheetVersion("13.2.3", 15);
SourceList.P24 = {
    name: "2024 Player's Handbook",
    abbreviation: "P24",
    abbreviationSpellsheet: "P4",
    group: "Core Sources",
    url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
    date: "2024/09/17",
};
SourceList.LEGACYSPELLS = {
    name: "Spells Deprecated by 2024 Player's Handbook",
    abbreviation: "LEGACY",
    abbreviationSpellsheet: "L",
    group: "Core Sources",
    url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
    date: "2014/01/01",
    defaultExcluded: true,
};
SourceList.LEGACYCLASS = {
    name: "Subclasses Deprecated by 2024 Player's Handbook",
    abbreviation: "LEGACY",
    abbreviationSpellsheet: "L",
    group: "Core Sources",
    url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
    date: "2014/01/01",
    defaultExcluded: true,
};
SourceList.LEGACYRACE = {
    name: "Races Deprecated by 2024 Player's Handbook",
    abbreviation: "LEGACY",
    abbreviationSpellsheet: "L",
    group: "Core Sources",
    url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
    date: "2014/01/01",
    defaultExcluded: true,
};
SourceList.LEGACYBG = {
    name: "Backgrounds Deprecated by 2024 Player's Handbook",
    abbreviation: "LEGACY",
    abbreviationSpellsheet: "L",
    group: "Core Sources",
    url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
    date: "2014/01/01",
    defaultExcluded: true,
};
// Coded By: ThePok√©simmer with contributions from morepurplemorebetter (Joost), MasterJedi2014, Shroo, Reading Toskr, TrackAtNite, evanelric, TappyTap, Mente, Rocky, ShadowzAll, and Jeremy
//Functions
function escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"); // $& means the whole matched string
}

function legacySpellRefactor(spellKey, newSpell) {
    if (newSpell.replaces && newSpell.replaces in SpellsList) {
        SpellsList[spellKey] = SpellsList[newSpell.replaces];
        delete SpellsList[newSpell.replaces];
    }
    if (!(spellKey in SpellsList)) {
        SpellsList[spellKey] = newSpell;
    } else {
        var oldspell = SpellsList[spellKey];
        SpellsList[spellKey] = newSpell;
        var test = newSpell.replaces || spellKey;
        for (var i in ClassSubList) {
            var subclass = ClassSubList[i];
            if ("spellcastingExtra" in subclass) {
                var index = subclass.spellcastingExtra.indexOf(test);
                if (index !== -1) {
                    if (test !== spellKey) {
                        subclass.spellcastingExtra[index] = spellKey;
                    }
                    if (!('subclassfeature24' in subclass.features)) {
                        subclass.features['subclassfeature24'] = {
                            name: "Legacy spells",
                            source: [
                                ["LEGACYSPELLS", 1]
                            ],
                            minlevel: 1,
                            description: "\n I can choose to access to the legacy version of spells",
                            choices: ["Show Legacy", "Hide Legacy"],
                            "show legacy": {
                                name: "Show legacy spells",
                                description: "\n   I have access to the legacy version of spells",
                                spellcastingExtra: []
                            },
                            "hide legacy": {
                                name: "Hide legacy spells",
                                description: "\n   I have hidden the legacy version of spells",
                                spellcastingExtra: []
                            },
                            legacySpells: [],
                        };
                    }
                    subclass.features['subclassfeature24'].legacySpells.push(test + " legacy");
                    subclass.features['subclassfeature24']["show legacy"].spellcastingExtra = subclass.spellcastingExtra.concat(subclass.features['subclassfeature24'].legacySpells);
                    subclass.features['subclassfeature24']["hide legacy"].spellcastingExtra = subclass.spellcastingExtra;
                }
            }
        }
        oldspell.source = [
            ["LEGACYSPELLS", 1]
        ];
        oldspell.name = oldspell.name + " (L)";
        if ('nameShort' in oldspell) {
            oldspell.nameShort = oldspell.nameShort + " (L)";
        }
        SpellsList[test + " legacy"] = oldspell;
    }
}

function legacyClassRefactor(classKey, newClass) {
    if (!(classKey in ClassList)) {
        ClassList[classKey] = newClass;
    } else {
        newClass.subclasses = ClassList[classKey].subclasses;
        ClassList[classKey] = newClass;
    }
}

function archiveSubClass(classKey, subClass, newClassName) {
    subClass.subname = subClass.subname + " - 2014";
    if ('fullname' in subClass) {
        subClass.fullname = subClass.fullname + " - 2014";
    }
    subClass.source = [
        ["LEGACYCLASS", 1]
    ];
    for (var i of ClassList[classKey].subclasses[1]) {
        if (ClassSubList[i].regExpSearch.test(newClassName)) {
            var regex = "(?=^.*" + subClass.regExpSearch.source + ".*$)(?!^" + escapeRegExp(newClassName) + "$)";
            ClassSubList[i].regExpSearch = new RegExp(regex, 'i');
        }
    }
}

function legacySubClassRefactor(classKey, subClassKey, nSC) {
    var newSubClassName = classKey + "-" + subClassKey;
    var prv = null;
    if (newSubClassName in ClassSubList) {
        prv = ClassSubList[newSubClassName];
        AddSubClass(classKey, subClassKey + "_2014", prv);
        ClassSubList[newSubClassName] = nSC;
    } else {
        if ('replaces' in nSC && classKey + '-' + nSC.replaces in ClassSubList) {
            prv = ClassSubList[classKey + '-' + nSC.replaces];
        }
        AddSubClass(classKey, subClassKey, nSC);
    }
    if (prv != null) {
        var newRegex = nSC.regExpSearch;
        var bc = ClassList[classKey];
        var newClassName = nSC.fullname ? nSC.fullname : bc.name + " (" + nSC.subname + ")";
        archiveSubClass(classKey, prv, newClassName);
        nSC.regExpSearch = newRegex;
    }
    return nSC;
}

function legacyRaceRefactor(raceKey, newRace) {
    if (newRace.replaces) {
        for (var replaced of newRace.replaces) {
            if (replaced in RaceList) {
                var oldRace = RaceList[replaced];
                RaceList[replaced + " (L)"] = oldRace;
                delete RaceList[replaced];
                oldRace.source = [
                    ["LEGACYRACE", 1]
                ];
                oldRace.name = oldRace.name + " (L)";
                oldRace.shortname = oldRace.shortname + " (L)";
            }
        }
    }
    RaceList[raceKey] = newRace;
}

function legacyBackgroundRefactor(bgKey, newBg) {
    if (bgKey in BackgroundList) {
        var oldBg = BackgroundList[bgKey];
        BackgroundList[bgKey + " (L)"] = oldBg;
        oldBg.source = [
            ["LEGACYBG", 1]
        ];
        oldBg.name = oldBg.name + " (L)";
        for (var i in BackgroundList) {
            var bg_i = BackgroundList[i];
            if (bg_i.regExpSearch.test(newBg.name)) {
                var regex = "(?=^.*" + bg_i.regExpSearch.source + ".*$)(?!^" + escapeRegExp(newBg.name) + "$)";
                bg_i.regExpSearch = new RegExp(regex, 'i');
            }
        }
    }
    BackgroundList[bgKey] = newBg;
}
//Classes
legacyClassRefactor("barbarian", {
    regExpSearch: /barbarian/i,
    name: "Barbarian",
    source: [
        ["P24", 51]
    ],
    primaryAbility: ["Strength"],
    abilitySave: 1,
    prereqs: "Strength 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 12,
    saves: ["Str", "Con"],
    skillstxt: {
        primary: "Choose 2: Animal Handling, Athletics, Intimidation, Nature, Perception, or Survival",
    },
    armorProfs: {
        primary: [true, true, false, true],
        secondary: [false, false, false, true],
    },
    weaponProfs: {
        primary: [true, true],
        secondary: [false, true],
    },
    equipment: "Barbarian starting equipment:" +
        "\n \u2022 A Greataxe;" +
        "\n \u2022 4 Handaxes;" +
        "\n \u2022 An Explorer's Pack, and 15 gp." +
        "\n\nAlternatively, choose 75 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Barbarian Subclass", []],
    attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    features: {
        "rage": {
            name: "Rage",
            source: [
                ["P24", 51]
            ],
            minlevel: 1,
            action: ["bonus action", "Enter Rage"],
            limfeaname: "Rage (Regain 1 SR)",
            usages: [2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6],
            recovery: "long rest",
            additional: ["+2 Damage", "+2 Damage", "+2 Damage", "+2 Damage", "+2 Damage", "+2 Damage", "+2 Damage", "+2 Damage", "+3 Damage", "+3 Damage", "+3 Damage", "+3 Damage", "+3 Damage", "+3 Damage", "+3 Damage", "+4 Damage", "+4 Damage", "+4 Damage", "+4 Damage", "+4 Damage"],
            dmgres: [
                ["Bludgeoning", "Bludgeon. (in rage)"],
                ["Piercing", "Piercing (in rage)"],
                ["Slashing", "Slashing (in rage)"]
            ],
            savetxt: {
                text: ["Adv. on Str checks and saves in rage"],
            },
            calcChanges: {
                atkCalc: [
                    function(fields, v, output) {
                        if (v.isMeleeWeapon && fields.Mod === 1 && classes.known.barbarian && classes.known.barbarian.level && /\brage\b/i.test(v.WeaponTextName)) {
                            output.extraDmg += classes.known.barbarian.level < 9 ? 2 : classes.known.barbarian.level < 16 ? 3 : 4;
                        }
                    },
                    "If I include the word 'Rage' in a melee weapon's name that uses Strength, the calculation will add my Rage's bonus damage to it. Be aware that if the weapon is used to make a ranged attack, the rage bonus damage shouldn't be added (e.g. when using a thrown weapon)."
                ]
            },
            description: desc([
                "Bonus damage to melee weapon attacks using Str. Adv. on Strength checks/saves (not attacks); resistance to bludgeoning/piercing/slashing",
                "Rage lasts until the end of my next turn. Extend by attacking, forcing a save, or using a Bonus Action. Max duration: 10 minutes. Recover 1 use during a Short Rest."
            ]),
        },
        "unarmored defense": {
            name: "Unarmored Defense",
            source: [
                ["P24", 51]
            ],
            minlevel: 1,
            description: desc([
                "While not wearing armor, my base Armor Class equals 10 + Dex + Con, I can use Shields and still benefit.",
            ]),
            armorOptions: [{
                regExpSearch: /justToAddToDropDownAndEffectWildShape/,
                name: "Unarmored Defense (Con)",
                source: [
                    ["P24", 51]
                ],
                ac: "10+Con",
                affectsWildShape: true,
                selectNow: true
            }],
        },
        "weapon mastery": {
            name: "Weapon Mastery",
            source: [
                ["P24", 52]
            ],
            minlevel: 1,
            description: desc([
                "I gain mastery with a number of Simple/Martial Melee weapons. Can change 1 every long rest",
            ]),
            additional: ["2 Weapon Masteries", "2 Weapon Masteries", "2 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries"],
            extraname: "Weapon Mastery",
            extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip"],
            extraTimes: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
            "club": {
                name: "Club",
                description: desc([
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "dagger": {
                name: "Dagger",
                description: desc([
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "greatclub": {
                name: "Greatclub",
                description: desc([
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "handaxe": {
                name: "Handaxe",
                description: desc([
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "javelin": {
                name: "Javelin",
                description: desc([
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "light hammer": {
                name: "Light Hammer",
                description: desc([
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "mace": {
                name: "Mace",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "quarterstaff": {
                name: "Quarterstaff",
                description: desc([
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "sickle": {
                name: "Sickle",
                description: desc([
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "spear": {
                name: "Spear",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "battleaxe": {
                name: "Battleaxe",
                description: desc([
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "flail": {
                name: "Flail",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "glaive": {
                name: "Glaive",
                description: desc([
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "greataxe": {
                name: "Greataxe",
                description: desc([
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "greatsword": {
                name: "Greatsword",
                description: desc([
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "halberd": {
                name: "Halberd",
                description: desc([
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "lance": {
                name: "Lance",
                description: desc([
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "longsword": {
                name: "Longsword",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "maul": {
                name: "Maul",
                description: desc([
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "morningstar": {
                name: "Morningstar",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "pike": {
                name: "Pike",
                description: desc([
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "rapier": {
                name: "Rapier",
                description: desc([
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "scimitar": {
                name: "Scimitar",
                description: desc([
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "shortsword": {
                name: "Shortsword",
                description: desc([
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "trident": {
                name: "Trident",
                description: desc([
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "warhammer": {
                name: "Warhammer",
                description: desc([
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "war pick": {
                name: "War Pick",
                description: desc([
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "whip": {
                name: "Whip",
                description: desc([
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
        },
        "danger sense": {
            name: "Danger Sense",
            source: [
                ["P24", 52]
            ],
            minlevel: 2,
            savetxt: "Adv. on Dex saves when not Incapacitated",
            description: desc([
                "I have Advantage on Dexterity saving throws unless I have the Incapacitated condition.",
            ]),
        },
        "reckless attack": {
            name: "Reckless Attack",
            source: [
                ["P24", 52]
            ],
            minlevel: 2,
            description: desc([
                "When I make my first attack roll on my turn, I can attack recklessly. Until the start of my next turn, I have Advantage on Strength-based attack rolls but attack rolls against me also have Advantage",
            ]),
        },
        "subclassfeature3": {
            name: "Barbarian Subclass",
            source: [
                ["P24", 52]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Barbarian subclass and put it in the 'Class' field.",
            ]),
        },
        "primal knowledge": {
            name: "Primal Knowledge",
            source: [
                ["P24", 52]
            ],
            minlevel: 3,
            description: desc([
                "Gain proficiency in one additional skill from the Barbarian level 1 skill list.",
                "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival."
            ]),
            choices: ["Primal Knowledge : Animal Handling", "Primal Knowledge : Athletics", "Primal Knowledge : Intimidation", "Primal Knowledge : Nature", "Primal Knowledge : Perception", "Primal Knowledge : Survival"],
            "primal knowledge : animal handling": {
                name: "Primal Knowledge : Animal Handling",
                skills: ["Animal Handling"],
                description: desc([
                    "I gain proficiency in Animal Handling",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
            "primal knowledge : athletics": {
                name: "Primal Knowledge : Athletics",
                skills: ["Athletics"],
                description: desc([
                    "I gain proficiency in Athletics",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
            "primal knowledge : intimidation": {
                name: "Primal Knowledge : Intimidation",
                skills: ["Intimidation"],
                description: desc([
                    "I gain proficiency in Intimidation",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
            "primal knowledge : nature": {
                name: "Primal Knowledge : Nature",
                skills: ["Nature"],
                description: desc([
                    "I gain proficiency in Nature",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
            "primal knowledge : perception": {
                name: "Primal Knowledge : Perception",
                skills: ["Perception"],
                description: desc([
                    "I gain proficiency in Perception",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
            "primal knowledge : survival": {
                name: "Primal Knowledge : Survival",
                skills: ["Survival"],
                description: desc([
                    "I gain proficiency in Survival",
                    "While Raging, I can use Strength for ability checks with Acrobatics, Intimidation, Perception, Stealth, or Survival"
                ]),
            },
        },
        "fast movement": {
            name: "Fast Movement",
            source: [
                ["P24", 53]
            ],
            minlevel: 5,
            speed: {
                allModes: "+10"
            },
            description: desc([
                "My speed increases by 10 feet while I am not wearing Heavy armor.",
            ]),
        },
        "feral instinct": {
            name: "Feral Instinct",
            source: [
                ["P24", 53]
            ],
            minlevel: 7,
            description: desc([
                "My instincts are so honed that I have Advantage on Initiative rolls.",
            ]),
            advantages: [
                ["Initiative", true]
            ],
        },
        "instinctive pounce": {
            name: "Instinctive Pounce",
            source: [
                ["P24", 53]
            ],
            minlevel: 7,
            description: desc([
                "As part of the Bonus Action I take to enter my Rage, I can move up to half my Speed.",
            ]),
        },
        "brutal strike": {
            name: "Brutal Strike",
            source: [
                ["P24", 53]
            ],
            minlevel: 9,
            additional: ["", "", "", "", "", "", "", "", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "1 Brutal Strike Option, 1d10", "2 Brutal Strike Option, 2d10", "2 Brutal Strike Option, 2d10", "2 Brutal Strike Option, 2d10", "2 Brutal Strike Option, 2d10"],
            description: desc([
                "When using Reckless Attack, I can skip Advantage on a Strength-based attack without Disadvantage. If it hits, extra 1d10 damage and a Brutal Strike effect. (See Third Page).",
            ]),
            "forceful blow": {
                name: "Forceful Blow",
                extraname: "Brutal Strike Option",
                description: desc([
                    "Push target 15 feet away; move half my speed towards them without provoking Opportunity Attacks.",
                ]),
            },
            "hamstring blow": {
                name: "Hamstring Blow",
                extraname: "Brutal Strike Option",
                description: desc([
                    "Reduce target's Speed by 15 feet until my next turn; only one effect at a time per target.",
                ]),
            },
            autoSelectExtrachoices: [{
                extrachoice: "forceful blow"
            }, {
                extrachoice: "hamstring blow"
            }],
        },
        "relentless rage": {
            name: "Relentless Rage",
            source: [
                ["P24", 53]
            ],
            minlevel: 11,
            description: desc([
                "While Raging, if I drop to 0 HP but not killed outright, make a DC 10 Constitution save. On success, set HP to half my Barbarian level.",
                "Each subsequent use raises the DC by 5. DC resets to 10 after a Short or Long Rest."
            ]),
        },
        "improved brutal strike": {
            name: "Improved Brutal Strike",
            source: [
                ["P24", 53]
            ],
            minlevel: 13,
            description: desc([
                "Gain 2 new Brutal Strike options. (See Third Page).",
            ]),
            "staggering blow": {
                name: "Staggering Blow",
                extraname: "Brutal Strike Option",
                description: desc([
                    "Target has Disadvantage on its next save and can't make Opportunity Attacks until my next turn.",
                ]),
            },
            "sundering blow": {
                name: "Sundering Blow",
                extraname: "Brutal Strike Option",
                description: desc([
                    "Next attack roll against the target gets a +5 bonus before my next turn. 1 effect per attack roll.",
                ]),
            },
            autoSelectExtrachoices: [{
                extrachoice: "staggering blow"
            }, {
                extrachoice: "sundering blow"
            }],
        },
        "persistent rage": {
            name: "Persistent Rage",
            source: [
                ["P24", 53]
            ],
            minlevel: 15,
            description: desc([
                "Regain all Rage uses when I roll Initiative, once per Long Rest.",
                "Rage lasts 10 minutes without extension actions; ends early if Unconscious or wearing Heavy armor."
            ]),
        },
        "indomitable might": {
            name: "Indomitable Might",
            source: [
                ["P24", 53]
            ],
            minlevel: 18,
            description: desc([
                "If my total for a Strength check or Strength saving throw is less than my Strength score, I can use that score in place of the total.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 53]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "primal champion": {
            name: "Primal Champion",
            source: [
                ["P24", 53]
            ],
            minlevel: 20,
            scores: [4, 0, 4, 0, 0, 0],
            scoresMaximum: [25, 0, 25, 0, 0, 0],
            description: desc([
                "I embody primal power. My Strength and Constitution scores increase by 4, to a maximum of 25.",
            ]),
        },
    },
});
legacySubClassRefactor("barbarian", "berserker", {
    regExpSearch: /^(?=.*(barbarian))(?=.*(berserker)).*$/i,
    subname: "Path of the Berserker",
    source: [
        ["P24", 54]
    ],
    features: {
        "subclassfeature3": {
            name: "Frenzy",
            source: [
                ["P24", 54]
            ],
            minlevel: 3,
            additional: ["2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "4d6", "4d6", "4d6", "4d6", "4d6"],
            description: desc([
                "While Raging and using Reckless Attack, deal a number of d6 extra damage to the first target hit on my turn."
            ]),
        },
        "subclassfeature6": {
            name: "Mindless Rage",
            source: [
                ["P24", 54]
            ],
            minlevel: 6,
            savetxt: {
                immune: ["Charmed while Raging; ", "Frightened while Raging; "]
            },
            description: desc([
                "While Raging, I am immune to Charmed and Frightened conditions. These conditions end when I enter Rage."
            ]),
        },
        "subclassfeature10": {
            name: "Retaliation",
            source: [
                ["P24", 54]
            ],
            minlevel: 10,
            action: ["reaction", "Retaliation"],
            description: desc([
                "As a Reaction, make a melee attack against a creature within 5 feet when it damages me."
            ]),
        },
        "subclassfeature14": {
            name: "Intimidating Presence",
            source: [
                ["P24", 54]
            ],
            minlevel: 14,
            action: "action",
            usages: 1,
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, cause creatures in a 30-foot radius to make a Wisdom save (DC 8 + Strength mod + Proficiency). On failure, they are Frightened for 1 minute, repeating the save at each turn's end. Regain use after a Long Rest or by expending a Rage use."
            ]),
        },
    },
});
legacySubClassRefactor("barbarian", "wild heart", {
    regExpSearch: /^(?=.*(barbarian))(?=.*(wild))(?=.*(heart)).*$/i,
    subname: "Path of the Wild Heart",
    replaces: "totem warrior",
    source: [
        ["P24", 55]
    ],
    features: {
        "subclassfeature3": {
            name: "Animal Speaker",
            source: [
                ["P24", 55]
            ],
            minlevel: 3,
            spellcastingAbility: 5,
            spellcastingBonus: [{
                name: "Animal Speaker",
                spells: ["beast sense", "speak with animals"],
                selection: ["beast sense", "speak with animals"],
                times: 2,
                firstCol: "R",
            }],
            description: desc([
                "Cast *Beast Sense* and *Speak with Animals* as Rituals using Wisdom."
            ]),
        },
        "subclassfeature3.1": {
            name: "Rage of the Wilds",
            source: [
                ["P24", 55]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Rage of the Wilds animal aspect when I enter a Rage (See Third Page).",
            ]),
            "bear": {
                name: "Bear",
                extraname: "Rage of the Wild Option",
                description: desc([
                    "Resistance to all but Force, Necrotic, Psychic, and Radiant damage.",
                ]),
            },
            "eagle": {
                name: "Eagle",
                extraname: "Rage of the Wild Option",
                description: desc([
                    "Disengage and Dash as a Bonus Action.",
                ]),
            },
            "wolf": {
                name: "Wolf",
                extraname: "Rage of the Wild Option",
                description: desc([
                    "Allies have Advantage on attacks against enemies within 5 feet of me.",
                ]),
            },
            autoSelectExtrachoices: [{
                extrachoice: "bear"
            }, {
                extrachoice: "eagle"
            }, {
                extrachoice: "wolf"
            }],
        },
        "subclassfeature6": {
            name: "Aspect of the Wilds",
            source: [
                ["P24", 55]
            ],
            minlevel: 6,
            choices: ["Owl", "Panther", "Salmon"],
            "owl": {
                name: "Owl",
                vision: [
                    ["Darkvision", "fixed 60"],
                    ["Darkvision", "+60"]
                ],
                description: desc([
                    "I have Darkvision with a range of 60 feet. If I already have Darkvision, its range increases by 60 feet.",
                ]),
            },
            "panther": {
                name: "Panther",
                speed: {
                    climb: {
                        spd: "walk",
                        enc: "walk"
                    }
                },
                description: desc([
                    "I have a Climb Speed equal to my Speed",
                ]),
            },
            "salmon": {
                name: "Salmon",
                speed: {
                    swim: {
                        spd: "walk",
                        enc: "walk"
                    }
                },
                description: desc([
                    "I have a Swim Speed equal to my Speed",
                ])
            },
            description: desc([
                "Use 'Choose Feature' button to choose an Aspect of the Wilds. Whenever I finish a Long Rest, I can change my choice.",
            ]),
        },
        "subclassfeature10": {
            name: "Nature Speaker",
            source: [
                ["P24", 55]
            ],
            minlevel: 10,
            spellcastingBonus: [{
                name: "Nature Speaker",
                spells: ["commune with nature"],
                selection: ["commune with nature"],
                times: 1,
                firstCol: "R",
            }],
            description: desc([
                "I can cast the Commune with Nature spell but only as a Ritual. Wisdom is my spellcasting ability for it.",
            ]),
        },
        "subclassfeature14": {
            name: "Power of the Wilds",
            source: [
                ["P24", 55]
            ],
            minlevel: 14,
            description: desc([
                "When I enter a Rage, I gain the Benefits of an animal aspect from the Rage of the Wilds Feature and one animal aspect from this Feature (See Third Page).",
            ]),
            "falcon": {
                name: "Falcon",
                extraname: "Power of the Wild Option",
                description: desc([
                    "Fly Speed equals my Speed without armor.",
                ]),
            },
            "lion": {
                name: "Lion",
                extraname: "Power of the Wild Option",
                description: desc([
                    "Enemies with in 5 ft of me have Disadvantage on attacks against targets other than me or another Barbarian w/ this feature.",
                ]),
            },
            "ram": {
                name: "Ram",
                extraname: "Power of the Wild Option",
                description: desc([
                    "Knock Large or smaller creatures Prone when hit with melee attack.",
                ]),
            },
            autoSelectExtrachoices: [{
                extrachoice: "falcon"
            }, {
                extrachoice: "lion"
            }, {
                extrachoice: "ram"
            }],
        },
    },
});
AddSubClass("barbarian", "world tree", {
    regExpSearch: /^(?=.*(barbarian))(?=.*(world))(?=.*(tree)).*$/i,
    subname: "Path of the World Tree",
    source: [
        ["P24", 56]
    ],
    features: {
        "subclassfeature3": {
            name: "Vitality of the Tree",
            source: [
                ["P24", 56]
            ],
            minlevel: 3,
            additional: ["2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "4d6", "4d6", "4d6", "4d6", "4d6"],
            description: desc([
                "Vitality Surge : Gain Temporary Hit Points equal to my Barbarian level when I Rage.",
                "Life-Giving Force : Each turn, give a nearby creature Temporary Hit Points by rolling d6s equal to my Rage Damage bonus. All vanish when rage ends."
            ]),
        },
        "subclassfeature6": {
            name: "Branches of the Tree",
            source: [
                ["P24", 54]
            ],
            minlevel: 6,
            action: "reaction",
            description: desc([
                "As a Reaction, force a creature within 30 feet to make a Strength save (DC 8 + Strength mod + Proficiency), or be teleported to an unoccupied space within 5 feet of me and reduce its Speed to 0 until the end of the turn."
            ]),
        },
        "subclassfeature10": {
            name: "Battering Roots",
            source: [
                ["P24", 56]
            ],
            minlevel: 10,
            description: desc([
                "Extend reach by 10 feet with Heavy or Versatile weapons. Use Push or Topple mastery properties when hitting with such weapons in addition to a different property."
            ]),
        },
        "subclassfeature14": {
            name: "Travel Along the Tree",
            source: [
                ["P24", 56]
            ],
            minlevel: 14,
            action: "bonus action",
            description: desc([
                "Teleport up to 60 feet as a Bonus Action while Raging. Once per Rage, extend range to 150 feet and bring up to six creatures within 10 feet."
            ]),
        },
    },
});
legacySubClassRefactor("barbarian", "zealot", {
    regExpSearch: /^(?=.*(barbarian))(?=.*(zealot)).*$/i,
    subname: "Path of the Zealot",
    replaces: "path of the zealot",
    source: [
        ["P24", 57]
    ],
    features: {
        "subclassfeature3": {
            name: "Divine Fury",
            source: [
                ["P24", 57]
            ],
            minlevel: 3,
            additional: ["", "", "1d6+1", "1d6+2", "1d6+2", "1d6+3", "1d6+3", "1d6+4", "1d6+4", "1d6+5", "1d6+5", "1d6+6", "1d6+6", "1d6+7", "1d6+7", "1d6+8", "1d6+8", "1d6+9", "1d6+9", "1d6+10"],
            description: desc([
                "While Raging, my first hit each turn deals extra damage. Choose Necrotic or Radiant damage each time.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Warrior of the Gods",
            source: [
                ["P24", 57]
            ],
            minlevel: 3,
            action: "Bonus Action",
            limfeaname: "Healing Pool: d12",
            usages: [0, 0, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7],
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, expend d12s from a healing pool to regain HP. Regain all dice after a Long Rest."
            ]),
        },
        "subclassfeature6": {
            name: "Fanatical Focus",
            source: [
                ["P24", 57]
            ],
            minlevel: 6,
            description: desc([
                "Once per Rage, reroll a failed save with a bonus equal to my Rage Damage bonus. I must use new roll"
            ]),
        },
        "subclassfeature10": {
            name: "Zealous Presence",
            source: [
                ["P24", 57]
            ],
            minlevel: 10,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, give up to ten creatures within 60 feet Advantage on attacks and saves until my next turn. Recharge after Long Rest or by expending Rage."
            ]),
        },
        "subclassfeature14": {
            name: "Rage of the Gods",
            source: [
                ["P24", 57]
            ],
            minlevel: 14,
            action: ["reaction", "Revivification"],
            usages: 1,
            recovery: "long rest",
            description: desc([
                "Assume divine form for 1 minute when Raging. Gain flight, resistance to Necrotic, Psychic, and Radiant damage. Use Reaction to prevent an ally from dropping to 0 HP and change their HP to 1/2 my Barbarian level by expending Rage."
            ]),
        },
    },
});
legacyClassRefactor("bard", {
    regExpSearch: /bard/i,
    name: "Bard",
    source: [
        ["P24", 59]
    ],
    primaryAbility: ["Charisma"],
    abilitySave: 6,
    prereqs: "Charisma 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 8,
    saves: ["Dex", "Cha"],
    skillstxt: {
        primary: "Choose any 3 skills",
        secondary: "Choose any 1 skill",
    },
    armorProfs: {
        primary: [true, false, false, false],
        secondary: [true, false, false, false],
    },
    weaponProfs: {
        primary: [true, false],
    },
    toolProfs: {
        primary: ["Musical Instrument", 3],
        secondary: ["Musical Instrument", 1],
    },
    equipment: "Bard starting equipment:" +
        "\n \u2022 Leather Armor;" +
        "\n \u2022 2 Daggers;" +
        "\n \u2022 A Musical Instrument;" +
        "\n \u2022 An Entertainer's Pack, and 19 gp." +
        "\n\nAlternatively, choose 90 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Bard Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 6,
    spellcastingFactor: 1,
    spellcastingKnown: {
        cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        spells: [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22],
        prepared: false,
    },
    features: {
        "bardic inspiration": {
            name: "Bardic Inspiration",
            source: [
                ["P24", 59]
            ],
            minlevel: 1,
            action: "bonus action",
            additional: ["d6", "d6", "d6", "d6", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12", "d12", "d12", "d12"],
            usages: "Charisma modifier per ",
            usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
            recovery: levels.map(function(n) {
                return n < 5 ? "long rest" : "short rest";
            }),
            description: desc([
                "I can supernaturally inspire others using my Bardic Inspiration (BI) dice.",
                "As a Bonus Action I can give a creature w/in 60ft who can see/hear me a BI die (max 1). For 1 hr when it fails a D20 Test it can roll the BI die and add it, spending the BI die.",
            ]),
        },
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 59]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
                var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast Cantrips & Prepared level 1+ Bard spells using Cha as my spellcasting ability.",
                "Prepared spells from other Bard features count as Bard spells & don't count against my prepared spells. When I gain a Bard level I can replace one cantrip/spell with another of the same type from the Bard spell list.",
                "I can use a Musical Instrument as a Spellcasting Focus for my Bard spells.",
            ]),
        },
        "expertise": function() {
            var a = {
                name: "Expertise",
                source: [
                    ["P24", 60]
                ],
                minlevel: 2,
                additional: levels.map(function(n) {
                    return n < 2 ? "" : "with " + (n < 9 ? 2 : 4) + " skills";
                }),
                description: desc("I gain Expertise in two of my skill proficiencies and two more at 9th level."),
                skillstxt: "Expertise with any two skill proficiencies, and two more at 9th level",
                extraname: "Bard Expertise",
                extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
                extraTimes: levels.map(function(n) {
                    return n < 2 ? 0 : n < 9 ? 2 : 4;
                })
            };
            for (var i = 0; i < a.extrachoices.length; i++) {
                var attr = a.extrachoices[i].toLowerCase();
                a[attr] = {
                    name: a.extrachoices[i] + " Expertise",
                    description: "",
                    source: a.source,
                    skills: [
                        [a.extrachoices[i], "only"]
                    ],
                    prereqeval: function(v) {
                        return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
                    }
                };
            }
            return a;
        }(),
        "jack of all trades": {
            name: "Jack of All Trades",
            source: [
                ["P24", 60]
            ],
            minlevel: 2,
            addMod: [{
                type: "skill",
                field: "Init",
                mod: "Math.ceil(-Prof/2)",
                text: "",
            }],
            eval: function() {
                Checkbox('Jack of All Trades', true);
            },
            removeeval: function() {
                Checkbox('Jack of All Trades', false);
            },
            description: desc([
                "I can add half my Prof Bonus to skill checks that don't use it otherwise.",
            ]),
        },
        "subclassfeature3": {
            name: "Bard Subclass",
            source: [
                ["P24", 60]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Bard subclass and put it in the 'Class' field.",
            ]),
        },
        "font of inspiration": {
            name: "Font of Inspiration",
            source: [
                ["P24", 61]
            ],
            minlevel: 5,
            description: desc([
                "I regain all uses of Bardic Inspiration (BI) when I finish a Short or Long Rest.",
                "In addition, I can spend a spell slot (no action) to regain one use of BI.",
            ]),
        },
        "countercharm": {
            name: "Countercharm",
            source: [
                ["P24", 61]
            ],
            minlevel: 7,
            action: "reaction",
            description: desc([
                "If I or a creature within 30 feet of me fails a saving throw against a Charmed or Frightened effect, I can use a Reaction to force a reroll with Adv.",
            ]),
        },
        "magical secrets": {
            name: "Magical Secrets",
            source: [
                ["P24", 61]
            ],
            minlevel: 10,
            calcChanges: {
                spellList: [
                    function(spList, spName, spType) {
                        if (spName !== "bard" || spType.indexOf("bonus") !== -1) return;
                        var MagicalSecrets = CreateSpellList({
                            "class": ["cleric", "druid", "wizard"],
                            level: [1, 9]
                        });
                        spList.extraspells = spList.extraspells.concat(MagicalSecrets);
                    },
                    'From 10th-level onwards, each Bard level where I gain more prepared spells I can choose from the Bard, Cleric, Druid, and Wizard spell lists. The chosen spells count as Bard spells. When I replace a Prepared Bard spell I can replace it with a spell from those lists."'
                ]
            },
            description: desc([
                "Each Bard level where I gain more prepared spells I can choose from the Bard, Cleric, Druid, and Wizard spell lists. The chosen spells count as Bard spells. When I replace a Prepared Bard spell I can replace it with a spell from those lists.",
            ]),
        },
        "superior inspiration": {
            name: "Superior Inspiration",
            source: [
                ["P24", 61]
            ],
            minlevel: 18,
            description: desc([
                "When I roll Initiative I regain expended uses of BI until I have two if I have fewer.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 61]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "words of creation": {
            name: "Words of Creation",
            source: [
                ["P24", 61]
            ],
            minlevel: 20,
            spellcastingBonus: [{
                name: "Words of Creation",
                spells: ["power word heal", "power word kill"],
                selection: ["power word heal", "power word kill"],
                times: 2,
            }],
            description: desc([
                "I always have Power Word Heal and Power Word Kill prepared.",
                "I can target a second creature if it's within 10 feet of the first target.",
            ]),
        },
    },
});
AddSubClass("bard", "dance", {
    regExpSearch: /^(?=.*(bard))(?=.*(dance)).*$/i,
    subname: "College of Dance",
    source: [
        ["P24", 64]
    ],
    replaces: "college of dance",
    features: {
        "subclassfeature3": {
            name: "Dazzling Footwork",
            source: [
                ["P24", 64]
            ],
            minlevel: 3,
            armorOptions: [{
                regExpSearch: /justToAddToDropDownAndEffectWildShape/,
                name: "Unarmored Defense (Cha)",
                source: [
                    ["P24", 64]
                ],
                ac: "10+Cha",
                affectsWildShape: true,
                selectNow: true
            }],
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (classes.known.bard && classes.known.bard.level && (v.baseWeaponName == "unarmed strike")) {
                            v.theWea.monkweapon = true;
                            var aBardDie = function(n) {
                                return n < 5 ? 6 : n < 10 ? 8 : n < 15 ? 10 : 12;
                            }(classes.known.bard.level);
                            try {
                                var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
                            } catch (e) {
                                var curDie = 'x';
                            }
                            if (isNaN(curDie) || curDie < aBardDie) {
                                fields.Damage_Die = '1d' + aBardDie;
                            }
                            if (fields.Mod === 1 || fields.Mod === 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
                                fields.Mod = v.StrDex;
                            }
                        }
                    },
                    "I can use either Strength or Dexterity and my Bardic Inspiration damage die in place of the normal damage die for any unarmed strike.",
                    5
                ]
            },
            description: desc([
                "While I'm not wearing armor or wielding a Shield, I gain the following benefits:",
                "Dance Virtuoso: I have Adv on Cha (Performance) checks I make that involve me dancing.",
                "Unarmored Defense: My base Armor Class is 10 + Dex mod + Cha mod.",
                "Agile Strikes: When I spend a BI as part of an action/Bonus Action/Reaction I can make an Unarmed Strike as part of it.",
                "Bardic Damage: My Unarmed Strikes can use Dex instead of Str. Unarmed Strike can deal Blud damage (BI die + Dex mod) instead of normal. This doesn't spend the die.",
            ]),
        },
        "subclassfeature6": {
            name: "Inspiring Movement",
            source: [
                ["P24", 64]
            ],
            minlevel: 6,
            action: "reaction",
            description: desc([
                "Spend one BI as a Reaction when an enemy I can see ends its turn within 5 ft of me to move up to half my Speed. An ally of my choice within 30 feet can also gain this benefit.",
                "None of this feature's movement provokes Opportunity Attacks.",
            ]),
        },
        "subclassfeature6.1": {
            name: "Tandem Footwork",
            source: [
                ["P24", 64]
            ],
            minlevel: 6,
            description: desc([
                "If I'm not Incapacitated when I roll Initiative I can roll one BI die. Each ally within 30 ft who can see or hear me adds the BI roll as a bonus to their Initative.",
            ]),
        },
        "subclassfeature14": {
            name: "Leading Evasion",
            source: [
                ["P24", 65]
            ],
            minlevel: 14,
            description: desc([
                "Unless Incapacitated, when making a Dex save to take only half damage, myself and allies within 5 ft take no damage on a success & half on a fail.",
            ]),
        },
    },
});
legacySubClassRefactor("bard", "glamour", {
    regExpSearch: /^(?=.*(bard))(?=.*(glamour)).*$/i,
    subname: "College of Glamour",
    source: [
        ["P24", 65]
    ],
    replaces: "college of glamour",
    features: {
        "subclassfeature3": {
            name: "Beguiling Magic",
            source: [
                ["P24", 65]
            ],
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            spellcastingBonus: [{
                name: "Beguiling Magic",
                spells: ["charm person", "mirror image"],
                selection: ["charm person", "mirror image"],
                times: 2,
                prepared: true,
            }],
            description: desc([
                "I always have Charm Person and Mirror Image prepared.",
                "After I cast an Ench or Illus spell with a spell slot, I can force a Wis save on a creature I can see within 60 ft On a fail the target is Charmed OR Frightened for 1 min. It repeats the save at the end of each of its turns, ending the effect on a success.",
                "I can spend one Bardic Inspiration (no action) or Long Rest to restore this feature.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Mantle of Inspiration",
            source: [
                ["P24", 65]
            ],
            minlevel: 3,
            action: "bonus action",
            description: desc([
                "As a Bonus Action up to my Cha mod (min 1) creatures within 60 feet gain [2 x one BI die roll] Temp HP and can move up to its Speed as a Reaction w/out Opportunity Attacks.",
            ]),
        },
        "subclassfeature6": {
            name: "Mantle of Majesty",
            source: [
                ["P24", 65]
            ],
            minlevel: 6,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            spellcastingBonus: [{
                name: "Mantle of Majesty",
                spells: ["command"],
                selection: ["command"],
                times: 1,
                firstCol: "oncelr",
            }],
            description: desc([
                "I always have Command prepared.",
                "As a bonus action, I can appear unearthly up to 1 min; At the same time & during this I can cast Command without spell slots; Creatures charmed by me automatically fail.",
                "I can restore it by spending a level 3+ spell slot (no action) or finish a Long Rest.",
            ]),
        },
        "subclassfeature14": {
            name: "Unbreakable Majesty",
            source: [
                ["P24", 66]
            ],
            minlevel: 14,
            action: "bonus action",
            usages: 1,
            recovery: "short rest",
            description: desc([
                "Once per rest as a Bonus Action for 1 min or until Incapacitated, when a creature attacks & hits me for the first time on a turn it must succeed a Cha save or miss.",
            ]),
        },
    },
});
legacySubClassRefactor("bard", "lore", {
    regExpSearch: /^(?=.*(bard))(?=.*(lore)).*$/i,
    subname: "College of Lore",
    source: [
        ["P24", 66]
    ],
    replaces: "college of lore",
    features: {
        "subclassfeature3": {
            name: "Bonus Proficiencies",
            source: [
                ["P24", 66]
            ],
            minlevel: 3,
            skillstxt: "Choose any 3 skills",
            description: desc([
                "I gain proficiency with three skills.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Cutting Words",
            source: [
                ["P24", 66]
            ],
            minlevel: 3,
            action: "reaction",
            description: desc([
                "When a creature I can see within 60 ft rolls for damage, passes a check, or attacks, I can take a Reaction to spend BI die; Subtract the number rolled from the creature's roll.",
            ]),
        },
        "subclassfeature6": {
            name: "Magical Discoveries",
            source: [
                ["P24", 66]
            ],
            minlevel: 6,
            spellcastingBonus: [{
                name: "Magical Discoveries",
                "class": ["cleric", "druid", "wizard"],
                times: 2,
            }],
            description: desc([
                "Learn two spells from the Cleric, Druid, or Wizard spell lists. They're always prepared.",
                "When I gain a Bard level I can replace one spell with another that I have slots for.",
            ]),
        },
        "subclassfeature14": {
            name: "Peerless Skill",
            source: [
                ["P24", 67]
            ],
            minlevel: 14,
            description: desc([
                "When I fail a check/attack I can roll one BI die & add it. The BI isn't spent on a fail.",
            ]),
        },
    },
});
legacySubClassRefactor("bard", "valor", {
    regExpSearch: /^(?=.*(bard))(?=.*(valor)).*$/i,
    subname: "College of Valor",
    source: [
        ["P24", 67]
    ],
    replaces: "college of valor",
    attacks: [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    features: {
        "subclassfeature3": {
            name: "Combat Inspiration",
            source: [
                ["P24", 67]
            ],
            minlevel: 3,
            description: desc([
                "A creature with a BI die from me can use it for one of the following:",
                "Defense: When hit by an attack it can roll the BI die as a Reaction & add it to its AC.",
                "Offense: When it hits with an attack it can roll the BI die & add it to the damage.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Martial Training",
            source: [
                ["P24", 67]
            ],
            minlevel: 3,
            armorProfs: [false, true, false, true],
            weaponProfs: [false, true],
            description: desc([
                "I gain proficiency with Martial weapons & training with Medium armor & Shields.",
                "I can use a Simple/Martial weapon as a Spellcasting Focus to cast my Bard Spells.",
            ]),
        },
        "subclassfeature6": {
            name: "Extra Attack",
            source: [
                ["P24", 67]
            ],
            minlevel: 6,
            description: desc([
                "I can attack twice instead of once when I Attack on my turn.",
                "I can cast a cantrip that has a casting time of an action in place of one of those attacks.",
            ]),
        },
        "subclassfeature14": {
            name: "Battle Magic",
            source: [
                ["P24", 67]
            ],
            minlevel: 14,
            action: ["bonus action", "Weapon Attack (After Casing Spell)"],
            description: desc([
                "After I cast a spell that takes an action, I can make a weapon attack as a Bonus Action.",
            ]),
        },
    },
});
legacyClassRefactor("cleric", {
    regExpSearch: /cleric/i,
    name: "Cleric",
    source: [
        ["P24", 59]
    ],
    primaryAbility: ["Wisdom"],
    abilitySave: 5,
    prereqs: "Wisdom 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 8,
    saves: ["Wis", "Cha"],
    skillstxt: {
        primary: "Choose 2: History, Insight, Medicine, Persuasion, or Religion",
    },
    armorProfs: {
        primary: [true, true, false, true],
        secondary: [true, true, false, true],
    },
    weaponProfs: {
        primary: [true, false],
    },
    equipment: "Cleric starting equipment:" +
        "\n \u2022 Chain Shirt;" +
        "\n \u2022 A Shield;" +
        "\n \u2022 A Mace;" +
        "\n \u2022 A Holy Symbol;" +
        "\n \u2022 A Priest's Pack, and 7 gp." +
        "\n\nAlternatively, choose 110 gp worth of starting equipment instead of the class' starting equipment.",
    subclasses: ["Cleric Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 5,
    spellcastingFactor: 1,
    spellcastingKnown: {
        cantrips: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        spells: "list",
        prepared: [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22],
    },
    features: {
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 69]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx];
                var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast Cantrips & Prepared level 1+ Cleric spells using Wis as my spellcasting ability & a Holy Symbol as a Spellcasting Focus.",
                "I can replace one cantrip with another when I gain a Cleric level; I can change my Prepared spells at the end of a Long Rest.",
            ]),
        },
        "divine order": {
            name: "Divine Order",
            source: [
                ["P24", 70]
            ],
            minlevel: 1,
            choices: ["Protector", "Thaumaturge"],
            "protector": {
                name: "Protector",
                armorProfs: [false, false, true, false],
                weaponProfs: [false, true],
                description: desc([
                    "I gain proficiency with Martial weapons & Heavy armor training.",
                ]),
            },
            "thaumaturge": {
                name: "Thaumaturge",
                spellcastingBonus: [{
                    name: "Thaumaturge",
                    "class": ["cleric"],
                    level: [0, 0],
                    times: 1,
                }],
                addMod: [{
                        type: "skill",
                        field: "Arcana",
                        mod: "Wis",
                        text: "I can add my Wisdom modifier to Arcana rolls."
                    },
                    {
                        type: "skill",
                        field: "Religion",
                        mod: "Wis",
                        text: "I can add my Wisdom modifier to Religion rolls."
                    },
                ],
                description: desc([
                    "I know one extra cantrip from the Cleric spell list and can add my Wis mod (min 1) to my Int (Arcana and Religion) checks.",
                ]),
            },
            description: desc([
                "I have dedicated myself to a sacred role. Use 'Choose Feature' above to select one.",
            ]),
        },
        "channel divinity": {
            name: "Channel Divinity",
            source: [
                ["P24", 70]
            ],
            minlevel: 2,
            limfeaname: "Channel Divinity (Regain 1 SR)",
            usages: [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4],
            recovery: "long rest",
            description: desc([
                "I regain one use on a Short Rest; All return on a Long Rest. If a Channel Divinity effect has a saving throw the DC is my Wis spell save DC.",
                "Channel Divinity: Divine Spark: As a Magic action I choose a creature I can see w/in 30 ft and roll 1d8 + my Wis mod. I either heal the creature for that amount or force it make a Con save; On a fail it takes that amount of Necrotic or Radiant dmg; half on a save. (2d8 at 7th level, 3d8 at 13th level, 4d8 at 18th level)",
                "Channel Divinity: Turn Undead: As a Magic action each Undead I choose w/in 30 ft must make a Wis save; On a fail it is Frightened & Incapacitated for 1 min; It also tries to move as far from me as it can on its turns. This ends early if it takes any damage, I'm Incapacitated, or I die.",
            ]),
        },
        "subclassfeature3": {
            name: "Cleric Subclass",
            source: [
                ["P24", 71]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Cleric subclass and put it in the 'Class' field.",
            ]),
        },
        "sear undead": {
            name: "Sear Undead",
            source: [
                ["P24", 71]
            ],
            minlevel: 5,
            description: desc([
                "When I use my Channel Divinity: Turn Undead, each Undead that fails its save against that use takes my Wis mod d8s Radiant damage (min 1) without ending the Turn effect.",
            ]),
        },
        "blessed strikes": {
            name: "Blessed Strikes",
            source: [
                ["P24", 71]
            ],
            minlevel: 7,
            choices: ["Divine Strike", "Potent Spellcasting"],
            "divine strike": {
                name: "Divine Strike",
                description: desc([
                    "I can cause the target to take an extra 1d8 Necro or Radiant damage (my choice) once when I hit with a weapon on my turn.",
                ]),
            },
            "potent spellcasting": {
                name: "Potent Spellcasting",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.thisWeapon[3] && /\bcleric\b/.test(v.thisWeapon[4]) && SpellsList[v.thisWeapon[3]].level === 0 && /\d/.test(fields.Damage_Die)) {
                                output.extraDmg += What('Wis Mod');
                            }
                        },
                        "My cleric cantrips get my Wisdom modifier added to their damage."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellObj.psionic || spellObj.level !== 0 || spName.indexOf("cleric") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0) return;
                            return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
                        },
                        "My cleric cantrips get my Wisdom modifier added to their damage."
                    ]
                },
                description: desc([
                    "Add my Wis mod to the damage I deal with any Cleric cantrip.",
                ]),
            },
            description: desc([
                "Use 'Choose Feature' above to select a Blessed Strike option (if I get either from a Cleric subclass in an older book, use only the option you choose for this Feature).",
            ]),
        },
        "divine intervention": {
            name: "Divine Intervention",
            source: [
                ["P24", 71]
            ],
            minlevel: 10,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "As a Magic action, once per Long Rest, I can cast one Cleric spell of level 5 or lower that doesn't require a Reaction to cast without a spell slot or Material components.",
            ]),
        },
        "improved blessed strikes": {
            name: "Improved Blessed Strikes",
            source: [
                ["P24", 71]
            ],
            minlevel: 14,
            choices: ["Divine Strike", "Potent Spellcasting"],
            "divine strike": {
                name: "Divine Strike",
                description: desc([
                    "The extra damage of my Divine Strikes increases to 2d8",
                ]),
            },
            "potent spellcasting": {
                name: "Potent Spellcasting",
                description: desc([
                    "When I deal damage to a creature with a Cleric cantrip I can give 2 times my Wis mod HP to a creature w/in 60 ft or myself.",
                ]),
            },
            description: desc([
                "Use 'Choose Feature' above to select an improved Blessed Strike feature.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 71]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "greater divine intervention": {
            name: "Greater Divine Intervention",
            source: [
                ["P24", 71]
            ],
            minlevel: 20,
            description: desc([
                "When I use Divine Intervention I can choose Wish when I select a spell, but can't use Divine Intervention again until I finish 2d4 Long Rests.",
            ]),
        },
    },
});
legacySubClassRefactor("cleric", "life", {
    regExpSearch: /^(?=.*(cleric))(?=.*(life)).*$/i,
    subname: "Life Domain",
    source: [
        ["P24", 73]
    ],
    replaces: "life domain",
    spellcastingExtra: ["aid", "bless", "cure wounds", "lesser restoration", "mass healing word", "revivify", "aura of life", "death ward", "greater restoration", "mass cure wounds"],
    features: {
        "subclassfeature3": {
            name: "Disciple of Life",
            source: [
                ["P24", 73]
            ],
            minlevel: 3,
            description: desc([
                "When I cast a spell with a spell slot that gives HP it gives addtl 2 + slot level HP.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Channel Divinity: Preserve Life",
            source: [
                ["P24", 73]
            ],
            minlevel: 3,
            action: "action",
            description: desc([
                "As a Magic action I restore 5 x my Cleric level HP, divided among Bloodied creatures I choose within 30 ft, up to half their max HP.",
            ]),
        },
        "subclassfeature6": {
            name: "Blessed Healer",
            source: [
                ["P24", 74]
            ],
            minlevel: 6,
            description: desc([
                "When I restore HP with a spell slot to another creature(s), I regain 2 + slot level HP.",
            ]),
        },
        "subclassfeature17": {
            name: "Supreme Healing",
            source: [
                ["P24", 74]
            ],
            minlevel: 17,
            description: desc([
                "I can heal max HP when I would roll to restore HP with a spell or Channel Divinity.",
            ]),
        },
    },
});
legacySubClassRefactor("cleric", "light", {
    regExpSearch: /^(?=.*(cleric))(?=.*(light)).*$/i,
    subname: "Light Domain",
    source: [
        ["P24", 74]
    ],
    replaces: "light domain",
    spellcastingExtra: ["burning hands", "faerie fire", "scorching ray", "see invisibility", "daylight", "fireball", "arcane eye", "wall of fire", "flame strike", "scrying"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Radiance of Dawn",
            source: [
                ["P24", 74]
            ],
            minlevel: 3,
            additional: ["", "", "2d10 + 3", "2d10 + 4", "2d10 + 5", "2d10 + 6", "2d10 + 7", "2d10 + 8", "2d10 + 9", "2d10 + 10", "2d10 + 11", "2d10 + 12", "2d10 + 13", "2d10 + 14", "2d10 + 15", "2d10 + 16", "2d10 + 17", "2d10 + 18", "2d10 + 19", "2d10 + 20"],
            description: desc([
                "As a Magic action I dispel magical Darkness w/in 30 ft Each creature of my choice in that area must pass a Con save for half damage or take Radiant damage.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Warding Flare",
            source: [
                ["P24", 74]
            ],
            minlevel: 3,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: levels.map(function(n) {
                return n < 6 ? "long rest" : "short rest";
            }),
            description: desc([
                "When a creature I can see w/in 30 feet makes an attack roll I can impose Disadv as a reaction.",
            ]),
        },
        "subclassfeature6": {
            name: "Improved Warding Flare",
            source: [
                ["P24", 75]
            ],
            minlevel: 6,
            description: desc([
                "I regain all uses of Warding Flare when I finish a rest. When I use it I can give the target of the attack 2d6 + my Wis mod Temp HP.",
            ]),
        },
        "subclassfeature17": {
            name: "Corona of Light",
            source: [
                ["P24", 75]
            ],
            minlevel: 17,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "As a Magic action, I can emit Bright Light in a 60-ft radius and Dim Light for an addtl 30 ft (sunlight) for 1 min or until dismissed (no action). Foes in the Bright Light have Disadv on saves against my Radiance of the Dawn & Fire or Radiant spell damage.",
            ]),
        },
    },
});
legacySubClassRefactor("cleric", "trickery", {
    regExpSearch: /^(?=.*(cleric))(?=.*(trickery)).*$/i,
    subname: "Trickery Domain",
    source: [
        ["P24", 75]
    ],
    replaces: "trickery domain",
    spellcastingExtra: ["charm person", "disguise self", "invisibility", "pass without trace", "hypnotic pattern", "nondetection", "confusion", "dimension door", "dominate person", "modify memory"],
    features: {
        "subclassfeature3": {
            name: "Blessing of the Trickster",
            source: [
                ["P24", 75]
            ],
            minlevel: 3,
            action: "action",
            description: desc([
                "As a Magic action I can give a willing creature w/in 30 ft or myself Adv on Dex (Stealth) checks until I finish a Long Rest or use this again.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Channel Divinity: Invoke Duplicity",
            source: [
                ["P24", 75]
            ],
            minlevel: 3,
            action: ["bonus action", "Invoke/Move"],
            description: desc([
                "As a Bonus Action I can create an animated intangible illusory double of myself in an empty space w/in 30 ft for 1 min, until dismissed (no action), or I'm Incapacitated; it doesn't occupy its space. While active I have these benefits:",
                "Cast Spells: I can cast spells through my double but must use my own senses.",
                "Distract: I have Adv on Attack rolls against creatures w/in 5 ft of my double & I.",
                "Move: As a Bonus Action I can move my double up to 30 ft to an empty space w/in 120 ft of me.",
            ]),
        },
        "subclassfeature6": {
            name: "Trickster's Transposition",
            source: [
                ["P24", 76]
            ],
            minlevel: 6,
            description: desc([
                "When I use a Bonus Action to create or move my double I can swap places with it.",
            ]),
        },
        "subclassfeature17": {
            name: "Improved Duplicity",
            source: [
                ["P24", 76]
            ],
            minlevel: 17,
            description: desc([
                "My Invoke Duplicity illusion has grown more powerful:",
                "Shared Distraction: Allies & I have Adv on attacks vs creatures w/in 5 ft of the double.",
                "Healing Illusion: When the illusion ends I choose a creature w/in 5 feet of it or myself to regain my Cleric level HP.",
            ]),
        },
    },
});
legacySubClassRefactor("cleric", "war", {
    regExpSearch: /^(?=.*(cleric))(?=.*(war)).*$/i,
    subname: "War Domain",
    source: [
        ["P24", 76]
    ],
    replaces: "war domain",
    spellcastingExtra: ["guiding bolt", "magic weapon", "shield of faith", "spiritual weapon", "crusader's mantle", "spirit guardians", "fire shield", "freedom of movement", "hold monster", "steel wind strike"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Guided Strikes",
            source: [
                ["P24", 77]
            ],
            minlevel: 3,
            action: "reaction",
            description: desc([
                "I can give a +10 bonus when a creature within 300 ft (Reaction) or I (no action) miss an attack roll.",
            ]),
        },
        "subclassfeature3.1": {
            name: "War Priest",
            source: [
                ["P24", 77]
            ],
            minlevel: 3,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "short rest",
            action: ["bonus action", "Weapon/Unarmed Strike"],
            description: desc([
                "As a Bonus Action, I can make one attack with a weapon or an Unarmed Strike.",
            ]),
        },
        "subclassfeature6": {
            name: "Channel Divinity: War God's Blessing",
            source: [
                ["P24", 77]
            ],
            minlevel: 6,
            description: desc([
                "I can cast Shield of Faith or Spiritual Weapon without a spell slot or Conc; it lasts 1 min, until I cast it again, become Incapacitated, or die.",
            ]),
        },
        "subclassfeature14": {
            name: "Avatar of Battle",
            source: [
                ["P24", 77]
            ],
            minlevel: 14,
            dmgres: ["Bludgeoning", "Piercing", "Slashing"],
            description: desc([
                "I gain Resistance to Bludgeoning, Piercing, and Slashing damage.",
            ]),
        },
    },
});
legacyClassRefactor("druid", {
    regExpSearch: /druid/i,
    name: "Druid",
    source: [
        ["P24", 79]
    ],
    primaryAbility: ["Wisdom"],
    abilitySave: 5,
    prereqs: "Wisdom 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 8,
    saves: ["Int", "Wis"],
    skillstxt: {
        primary: "Choose 2: Arcana, Animal Handling, Insight, Medicine, Nature, Perception, Religion, or Survival",
    },
    armorProfs: {
        primary: [true, false, false, true],
        secondary: [true, false, false, true],
    },
    toolProfs: {
        primary: [
            ["Herbalism Kit"]
        ],
        secondary: [
            [""]
        ],
    },
    weaponProfs: {
        primary: [true, false],
        secondary: [false, false],
    },
    equipment: "Druid starting equipment:" +
        "\n \u2022 Leather Armor;" +
        "\n \u2022 A Shield;" +
        "\n \u2022 A Sickle;" +
        "\n \u2022 A Druidic Focus(Quarterstaff);" +
        "\n \u2022 An Herbalism Kit;" +
        "\n \u2022 An Explorer's Pack, and 9 gp." +
        "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class' starting equipment.",
    subclasses: ["Druid Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 5,
    spellcastingFactor: 1,
    spellcastingKnown: {
        cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        spells: "list",
        prepared: [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22],
    },
    features: {
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 79]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
                var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast druid spells using Wisdom as my spellcasting ability.",
                "I know druid cantrips and can prepare a number of spells from the druid list. I regain spell slots after a long rest."
            ]),
        },
        "druidic": {
            name: "Druidic",
            source: [
                ["P24", 80]
            ],
            minlevel: 1,
            languageProfs: ["Druidic"],
            calcChanges: {
                spellAdd: [
                    function(spellKey, spellObj, spName) {
                        // only change the spell if it's from druid CurrentSpells object.
                        if (spellKey === "speak with animals" && spName === "druid") {
                            spellObj.firstCol = "markedbox"; // Always prepared

                        }
                    }
                ]
            },
            description: desc([
                "I know Druidic, the secret language of druids. I can leave hidden messages in it. I always have Speak with Animals prepared.",
            ]),
        },
        "primal order": {
            name: "Primal Order",
            source: [
                ["P24", 80]
            ],
            minlevel: 1,
            choices: ["Magician", "Warden"],
            "magician": {
                name: "Magician",
                spellcastingBonus: [{
                    name: "Magician",
                    "class": ["druid"],
                    level: [0, 0],
                    times: 1,
                }],
                addMod: [{
                        type: "skill",
                        field: "Arcana",
                        mod: "Wis",
                        text: "I can add my Wisdom modifier to Arcana rolls."
                    },
                    {
                        type: "skill",
                        field: "Nature",
                        mod: "Wis",
                        text: "I can add my Wisdom modifier to Nature rolls."
                    },
                ],
                description: "I know one extra cantrip from the Druid spell list. I add my wisdom modifier to my Intelligence (Arcana and Nature) checks.",
            },
            "warden": {
                name: "Warden",
                armorProfs: [false, true, false, false],
                weaponProfs: [false, true],
                description: "Trained for battle, I gain proficiency with Martial weapons and training with Medium armor."
            },
            description: desc([
                "Use the 'Choose Feature' button to select a Primal Order option.",
            ]),
        },
        "wild shape": {
            name: "Wild Shape",
            source: [
                ["P24", 80]
            ],
            minlevel: 2,
            action: ["bonus action", "Wild Shape (Shift/Revert)"],
            limfeaname: "Wild Shape (Regain 1 SR)",
            usages: [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4],
            recovery: "long rest",
            additional: levels.map(function(n) {
                if (n < 2) return "";
                var cr = n < 4 ? "1/4; 4 Known Forms" : n < 8 ? "1/2; 6 Known Forms" : "1; 8 Known Forms";
                var hr = Math.floor(n / 2);
                var restr = n < 8 ? ", no fly" : "";
                return "CR " + cr + restr + "; " + hr + (restr.length ? " h" : " hours");
            }),
            description: desc([
                "Wild Shape allows me to transform into known beast forms as a bonus action, lasting for hours equal to half my druid level.",
                "Regain 1 on a short rest or all on a long rest. Initially, I know 4 forms (CR 1/4 or lower, no flying). While transformed, I gain temp HP equal to my druid level, use the beast's physical stats and proficiencies, but retain my mental stats, class features, and languages.",
                "I can't cast spells but maintain concentration. Equipment falls, merges, or is worn. The form ends if I'm incapacitated or die."
            ])
        },
        "wild companion": {
            name: "Wild Companion",
            source: [
                ["P24", 81]
            ],
            minlevel: 2,
            spellcastingBonus: [{
                name: "Wild Companion",
                spells: ["find familiar"],
                selection: ["find familiar"],
            }],
            spellChanges: {
                "find familiar": {
                    name: "Find Familiar",
                    description: "Gain the services of a fey familiar; bns see thru its eyes; it can deliver touch spells; disappears after a LR",
                    descriptionFull: "You gain the service of a familiar, a spirit that takes an animal form you choose: Bat, Cat, Frog, Hawk, Lizard, Octopus, Owl, Rat, Raven, Spider, Weasel, or another Beast that has a Challenge Rating of 0. Appearing in an unoccupied space within range, the familiar has the statistics of the chosen form (see appendix B), though it is a Fey instead of a Beast. Your familiar acts independently of you, but it obeys your commands." + "\n   " + "Telepathic Connection. While your familiar is within 100 feet of you, you can communicate with it telepathically. Additionally, as a Bonus Action, you can see through the familiar's eyes and hear what it hears until the start of your next turn, gaining the benefits of any special senses it has." + "\n   " + "Finally, when you cast a spell with a range of touch, your familiar can deliver the touch. Your familiar must be within 100 feet of you, and it must take a Reaction to deliver the touch when you cast the spell." + "\n   " + "Combat. The familiar is an ally to you and your allies. It rolls its own Initiative and acts on its own turn. A familiar can't attack, but it can take other actions as normal." + "\n   " + "Disappearance of the Familiar. When you complete a Long Rest or when the familiar drops to 0 Hit Points, it disappears. It reappears after you cast this spell again. As a Magic action, you can temporarily dismiss the familiar to a pocket dimension. Alternatively, you can dismiss it forever. As a Magic action while it is temporarily dismissed, you can cause it to reappear in an unoccupied space within 30 feet of you. Whenever the familiar drops to 0 Hit Points or disappears into the pocket dimension, it leaves behind in its space anything it was wearing or carrying." + "\n   " + "One Familiar Only. You can't have more than one familiar at a time. If you cast this spell while you have a familiar, you instead cause it to adopt a new eligible form.",
                    time: "1 a",
                    components: "V,S", // Does not require materials anymore
                    compMaterial: "",
                    changes: "removes material components, changes casting time to 1 action, updates description to more closely match the class feature."
                }
            },
            calcChanges: {
                spellAdd: [
                    function(spellKey, spellObj, spName) {
                        // only change the spell if it's from druid CurrentSpells object.
                        if (spellKey === "find familiar" && spName === "druid") {
                            spellObj.firstCol = "markedbox"; // Always prepared
                        }
                    }
                ]
            },
            description: desc([
                "As a Magic action, I can expend a spell slot or a use of Wild Shape to cast the Find Familiar spell without Material components.",
                "When I cast the spell in this way, the familiar is Fey and disappears when I finish a Long Rest.",
            ]),
        },
        "subclassfeature3": {
            name: "Druid Subclass",
            source: [
                ["P24", 81]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Druid subclass and put it in the 'Class' field.",
            ]),
        },
        "wild resurgence": {
            name: "Wild Resurgence",
            source: [
                ["P24", 81]
            ],
            minlevel: 5,
            description: desc([
                "Once per turn, I can regain a Wild Shape use by expending a spell slot. I can also exchange a Wild Shape use for a level 1 spell slot once per long rest.",
            ]),
        },
        "elemental fury": {
            name: "Elemental Fury",
            source: [
                ["P24", 81]
            ],
            minlevel: 7,
            choices: ["Primal Strike", "Potent Spellcasting"],
            "primal strike": {
                name: "Primal Strike",
                description: desc([
                    "Once on each of my turns when I hit a creature with an attack roll using a weapon, I can cause the target to take an extra 1d8 Cold, Fire, Lightning, or Thunder damage (choose on hit).",
                ]),
            },
            "potent spellcasting": {
                name: "Potent Spellcasting",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.thisWeapon[3] && /\bdruid\b/.test(v.thisWeapon[4]) && SpellsList[v.thisWeapon[3]].level === 0 && /\d/.test(fields.Damage_Die)) {
                                output.extraDmg += What('Wis Mod');
                            }
                        },
                        "My druid cantrips get my Wisdom modifier added to their damage."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellObj.psionic || spellObj.level !== 0 || spName.indexOf("druid") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0) return;
                            return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
                        },
                        "My druid cantrips get my Wisdom modifier added to their damage."
                    ]
                },
                description: desc([
                    "I add my Wisdom modifier to the damage I deal with any Druid cantrip.",
                ]),
            },
            description: desc([
                "The might of the elements flows through me. Use the 'Choose Feature' button to select an Elemental Fury option.",
            ]),
        },
        "improved elemental fury": {
            name: "Improved Elemental Fury",
            source: [
                ["P24", 81]
            ],
            minlevel: 15,
            choices: ["Primal Strike", "Potent Spellcasting"],
            "primal strike": {
                name: "Primal Strike",
                description: desc([
                    "The extra damage of my Primal Strikes increases to 2d8",
                ]),
            },
            "potent spellcasting": {
                name: "Potent Spellcasting",
                description: desc([
                    "When I cast a Druid cantrip with a range of 10 feet or greater, the spell's range increases by 300 feet.",
                ]),
            },
            description: desc([
                "The option I chose for Elemental Fury grow more powerful. Use the 'Choose Feature' button to select the option that matches the option I choose at 7th level.",
            ]),
        },
        "beast spells": {
            name: "Beast Spells",
            source: [
                ["P24", 81]
            ],
            minlevel: 18,
            description: desc([
                "I can cast spells while in Wild Shape, except those with costly/consumed material components",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 81]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "archdruid": {
            name: "Archdruid",
            source: [
                ["P24", 82]
            ],
            minlevel: 20,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I regain a Wild Shape use when rolling initiative if I have none left Once per long rest I can convert Wild Shape uses into a spell slot. 2 spell slot level/wild shape. I age more slowly."
            ]),
        },
    },
});
legacySubClassRefactor("druid", "land", {
    regExpSearch: /^(?=.*(druid))(?=.*(land)).*$/i,
    subname: "Circle of the Land",
    source: [
        ["P24", 84]
    ],
    replaces: "circle of the land",
    features: {
        "subclassfeature3": {
            name: "Circle of the Land Spells",
            source: [
                ["P24", 84]
            ],
            minlevel: 3,
            choices: ["Arid Land", "Polar Land", "Temperate Land", "Tropical Land"],
            "arid land": {
                name: "Arid Land",
                spellcastingExtra: ["blur", "burning hands", "fire bolt", "fireball", "blight", "wall of stone"],
                description: desc([
                    "Whenever I finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. I have certain spells prepared based on the land chosen.",
                ]),
            },
            "polar land": {
                name: "Polar Land",
                spellcastingExtra: ["fog cloud", "hold person", "ray of frost", "sleet storm", "ice storm", "cone of cold"],
                description: desc([
                    "Whenever I finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. I have certain spells prepared based on the land chosen.",
                ]),
            },
            "temperate land": {
                name: "Temperate Land",
                spellcastingExtra: ["misty step", "shocking grasp", "sleep", "lightning bolt", "freedom of movement", "tree stride"],
                description: desc([
                    "Whenever I finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. I have certain spells prepared based on the land chosen.",
                ]),
            },
            "tropical land": {
                name: "Tropical Land",
                spellcastingExtra: ["acid splash", "ray of sickness", "web", "stinking cloud", "polymorph", "insect plague"],
                description: desc([
                    "Whenever I finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. I have certain spells prepared based on the land chosen.",
                ]),
            },
            description: desc([
                "Whenever I finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. I have certain spells prepared based on the land chosen.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Land's Aid",
            source: [
                ["P24", 85]
            ],
            minlevel: 3,
            action: "action",
            additional: ["", "", "", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "3d6", "3d6", "3d6", "3d6", "4d6", "4d6", "4d6", "4d6", "4d6", "4d6", "4d6"],
            description: desc([
                "As a Magic action, expend a Wild Shape use to create a 10-foot sphere within 60 feet. Chosen creatures in the sphere make a Constitution save against my spell DC, taking a number of d6s Necrotic damage (half on success). One creature in the area regains the same number of d6s HP.",
            ]),
        },
        "subclassfeature6": {
            name: "Natural Recovery",
            source: [
                ["P24", 85]
            ],
            minlevel: 6,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "Once per long rest, cast a prepared circle spell (level 1+) without using a spell slot. After a short rest, recover expended spell slots totaling up to half my druid level (rounded up, max 5th level)."
            ]),
        },
        "subclassfeature10": {
            name: "Nature's Ward",
            source: [
                ["P24", 85]
            ],
            minlevel: 10,
            savetxt: {
                immune: ["Poisoned condition"],
            },
            choices: ["Arid Land", "Polar Land", "Temperate Land", "Tropical Land"],
            "arid land": {
                name: "Arid Land",
                dmgres: "Fire",
                description: desc([
                    "I am immune to the Poisoned condition, and have damage resistance associated with my current land choice.[Fire]",
                ]),
            },
            "polar land": {
                name: "Polar Land",
                dmgres: "Cold",
                description: desc([
                    "I am immune to the Poisoned condition, and have damage resistance associated with my current land choice.[Cold]",
                ]),
            },
            "temperate land": {
                name: "Temperate Land",
                dmgres: "Lightning",
                description: desc([
                    "I am immune to the Poisoned condition, and have damage resistance associated with my current land choice.[Lightning]",
                ]),
            },
            "tropical land": {
                name: "Tropical Land",
                dmgres: "Poison",
                description: desc([
                    "I am immune to the Poisoned condition, and have damage resistance associated with my current land choice.[Poison]",
                ]),
            },
            description: desc([
                "I am immune to the Poisoned condition, and have damage resistance associated with my current land choice.",
            ]),
        },
        "subclassfeature14": {
            name: "Nature's Sanctuary",
            source: [
                ["P24", 86]
            ],
            minlevel: 14,
            action: [
                ["action", "Summon Sanctuary"],
                ["bonus action", "Move Sanctuary"]
            ],
            description: desc([
                "As a Magic action, I can use my Wild Shape to create a 15-foot cube within 120 feet. It lasts for 1 minute or until I'm incapacitated or die. In this area, my allies and I have Half Cover, and my allies gain the current Resistance from my Nature's Ward. As a Bonus Action, move the cube up to 60 feet within 120 feet",
            ]),
        },
    },
});
legacySubClassRefactor("druid", "moon", {
    regExpSearch: /^(?=.*(druid))(?=.*(moon)).*$/i,
    subname: "Circle of the Moon",
    source: [
        ["P24", 86]
    ],
    replaces: "circle of the moon",
    spellcastingExtra: ["cure wounds", "moonbeam", "starry wisp", "conjure animals", "fount of moonlight", "mass cure wounds"],
    features: {
        "subclassfeature3": {
            name: "Circle Forms",
            source: [
                ["P24", 86]
            ],
            minlevel: 3,
            additional: ["", "", "CR 1, 9 Temp HP", "CR 1, 12 Temp HP", "CR 1, 15 Temp HP", "CR 2, 18 Temp HP", "CR 2, 21 Temp HP", "CR 2, 24 Temp HP", "CR 3, 27 Temp HP", "CR 3, 30 Temp HP", "CR 3, 33 Temp HP", "CR 4, 36 Temp HP", "CR 4, 39 Temp HP", "CR 4, 42 Temp HP", "CR 5, 45 Temp HP", "CR 5, 48 Temp HP", "CR 5, 51 Temp HP", "CR 6, 54 Temp HP", "CR 6, 57 Temp HP", "CR 6, 60 Temp HP"],
            description: desc([
                "In Wild Shape: My maximum form's Challenge Rating is my Druid level divided by 3. My AC becomes greatest of 13 plus my Wisdom modifier or the Beast's AC. I also gain Temporary Hit Points equal to three times my Druid level.",
            ]),
        },
        "wild shape": {
            name: "Wild Shape",
            source: [
                ["P24", 86]
            ],
            minlevel: 3,
            description: desc([
                "As a bonus action, I assume the shape of a beast I have seen before with these rules:",
                " \u2022 I gain all its game statistics except Intelligence, Wisdom, or Charisma",
                " \u2022 I get its skill/saving throw prof. while keeping my own, using whichever is higher",
                " \u2022 I gain three times my Druid level Temp HP",
                " \u2022 I can't cast spells in beast form, but transforming doesn't break concentration",
                " \u2022 I retain my HP, hit dice, class features, feats and creature type",
                " \u2022 I can choose whether equipment falls to the ground, merges, or stays worn",
                " \u2022 I revert if out of time or Incapacitated; I die, or I end it as a Bonus Action"
            ]),
            usages: [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4],
            recovery: "short rest",
            additional: levels.map(function(n) {
                if (n < 2) return "";
                var cr = Math.max(1, Math.floor(n / 3));
                var hr = Math.floor(n / 2);
                var restr = n < 8 ? ", no fly" : "";
                return "CR " + cr + restr + "; " + hr + (restr.length ? " h" : " hours");
            }),
            action: [
                ["bonus action", " (start/revert)"]
            ],
            eval: function() {
                processActions(false, "Druid: Wild Shape", ClassList.druid.features["wild shape"].action, "Wild Shape");
            }
        },
        "subclassfeature6": {
            name: "Improved Circle Forms",
            source: [
                ["P24", 87]
            ],
            minlevel: 6,
            description: desc([
                "In Wild Shape, I can choose to deal Radiant damage with my attacks. I also add my Wisdom modifier to Constitution saving throws.",
            ]),
        },
        "subclassfeature10": {
            name: "Moonlight Step",
            source: [
                ["P24", 87]
            ],
            minlevel: 10,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, I can teleport up to 30 feet and gain Advantage on my next attack roll this turn.",
                "I can do this a number of times per long rest equal to my Wisdom modifier or by expending a level 2+ spell slot.",
            ]),
        },
        "subclassfeature14": {
            name: "Lunar Form",
            source: [
                ["P24", 87]
            ],
            minlevel: 14,
            description: desc([
                "Once per turn, I can deal an extra 2d10 Radiant damage with a Wild Shape attack.",
                "When using Moonlight Step, I can also teleport one willing creature within 10 feet to a space within 10 feet of my destination.",
            ]),
        },
    },
});
AddSubClass("druid", "sea", {
    regExpSearch: /^(?=.*(druid))(?=.*(sea)).*$/i,
    subname: "Circle of the Sea",
    source: [
        ["P24", 87]
    ],
    spellcastingExtra: ["fog cloud", "gust of wind", "ray of frost", "shatter", "thunderwave", "lightning bolt", "water breathing", "control water", "ice storm", "conjure elemental", "hold monster"],
    features: {
        "subclassfeature3": {
            name: "Wrath of the Sea",
            source: [
                ["P24", 87]
            ],
            minlevel: 3,
            action: "bonus action",
            description: desc([
                "As a Bonus Action, I can use my Wild Shape to create a 5-foot ocean spray around me for 10 minutes.",
                "Each turn, I can target a creature in the spray, forcing a Constitution save or dealing WIS * d6 Cold damage and pushing it 15 feet away.",
            ]),
        },
        "subclassfeature6": {
            name: "Aquatic Affinity",
            source: [
                ["P24", 87]
            ],
            minlevel: 6,
            speed: {
                swim: {
                    spd: "walk",
                    enc: "walk"
                }
            },
            description: desc([
                "My ocean spray increases to a 10-foot radius, and I gain a Swim Speed equal to my walking Speed.",
            ]),
        },
        "subclassfeature10": {
            name: "Stormborn",
            source: [
                ["P24", 87]
            ],
            minlevel: 10,
            description: desc([
                "While my ocean spray is active, I gain a Fly Speed equal to my walking Speed and Resistance to Cold, Lightning, and Thunder damage",
            ]),
        },
        "subclassfeature14": {
            name: "Oceanic Gift",
            source: [
                ["P24", 88]
            ],
            minlevel: 14,
            description: desc([
                "I can manifest my ocean spray around another willing creature within 60 feet. By expending two uses of Wild Shape, I can cover both myself and the other creature with the spray.",
            ]),
        },
    },
});
legacySubClassRefactor("druid", "stars", {
    regExpSearch: /^(?=.*(druid))(?=.*(stars)).*$/i,
    subname: "Circle of Stars",
    source: [
        ["P24", 88]
    ],
    replaces: "circle of the stars",
    features: {
        "subclassfeature3": {
            name: "Star Map",
            source: [
                ["P24", 88]
            ],
            minlevel: 3,
            description: desc([
                "I've created a star map, a Tiny object which i can use as my spellcasting focus.",
                "If I lose it, I can recreate the map during a Short or Long Rest.",
                "While holding it, I know the Guidance cantrip and always have Guiding Bolt prepared.",
                "I can cast Guiding Bolt without expending a spell slot, up to my Wisdom modifier times per long rest. ",
            ]),
            spellcastingBonus: [{
                name: "Star Map",
                spells: ["guidance"],
                selection: ["guidance"],
            }, {
                name: "Star Map",
                spells: ["guiding bolt"],
                selection: ["guiding bolt"],
                firstCol: "markedbox"
            }],
            additional: "Guiding Bolt",
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest"
        },
        "subclassfeature3.1": {
            name: "Starry Form",
            source: [
                ["P24", 88]
            ],
            minlevel: 3,
            description: desc([
                "As a bonus action, I can expend a use of wild shape to take on a starry form for 10 min",
                "In that form I become luminous and shed bright light in a 10-ft radius and dim light for an extra 10-ft radius",
                "When I do so, I choose one constellation that glimmers on my body, granting me benefits",
                "See the 3rd page's \"Notes\" section for the benefits of the possible constellations"
            ]),
            weaponOptions: [{
                regExpSearch: /^(?=.*luminous)(?=.*arrow).*$/i,
                name: "Luminous Arrow",
                source: [
                    ["P24", 89]
                ],
                ability: 5,
                type: "Spell",
                damage: [1, 8, "radiant"],
                range: "60 ft",
                description: "Use as bonus action",
                abilitytodamage: true,
                useSpellMod: "druid",
                luminousarrow: true,
                selectNow: true
            }],
            extraname: "Starry Form",
            "archer constellation": {
                name: "Archer Constellation",
                source: [
                    ["P24", 89]
                ],
                description: desc([
                    "As a bonus action, I can make a ranged spell attack to hurl a luminous arrow 60 ft"
                ]),
                additional: levels.map(function(n) {
                    return n < 2 ? "" : (n < 10 ? 1 : 2) + "d8 + Wisdom modifier radiant damage";
                }),
                action: [
                    ["bonus action", " (Luminous Arrow)"]
                ]
            },
            "chalice constellation": {
                name: "Chalice Constellation",
                source: [
                    ["P24", 89]
                ],
                description: desc([
                    "When I cast a healing spell with a spell slot, I can heal myself or another within 30 ft of me"
                ]),
                additional: levels.map(function(n) {
                    return n < 2 ? "" : (n < 10 ? 1 : 2) + "d8 + Wisdom modifier hit points restored";
                })
            },
            "dragon constellation": {
                name: "Dragon Constellation",
                source: [
                    ["P24", 89]
                ],
                description: desc([
                    "I can treat a roll below 10 as a 10 for Int/Wis/Con checks and saves to maintain concentration",
                    "From 10th-level onwards, I also gain a flying speed of 20 ft and can hover"
                ])
            },
            autoSelectExtrachoices: [{
                extrachoice: "archer constellation"
            }, {
                extrachoice: "chalice constellation"
            }, {
                extrachoice: "dragon constellation"
            }]
        },
        "subclassfeature6": {
            name: "Cosmic Omen",
            source: [
                ["P24", 89]
            ],
            minlevel: 6,
            description: desc([
                "When I finish a long rest, I roll a die to gain an omen based on the result (odd/even)",
                "As a reaction when a creature I can see in 30 ft makes an D20 Test, I can:",
                " \u2022 Weal (even): add 1d6 to the number rolled to the total",
                " \u2022 Woe (odd): subtract 1d6 from the number rolled to the total"
            ]),
            action: [
                ["reaction", "Cosmic Omen"]
            ],
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest"
        },
        "subclassfeature10": {
            name: "Twinkling Constellations",
            source: [
                ["P24", 89]
            ],
            minlevel: 10,
            description: desc([
                "While in my starry form, I can change the constellation at the start of each of my turns",
                "The benefit of my constellations improve, see the 3rd page's \"Notes\" section"
            ]),
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (v.theWea.luminousarrow && fields.Damage_Die.indexOf('1d8') !== -1) {
                            fields.Damage_Die = fields.Damage_Die.replace('1d8', '2d8');
                        }
                    },
                    '',
                    1
                ]
            }
        },
        "subclassfeature14": {
            name: "Full of Stars",
            source: [
                ["P24", 89]
            ],
            minlevel: 14,
            description: desc([
                "while in starry form, I gain Resistance to Bludgeoning, Piercing, and Slashing damage.",
            ]),
            dmgres: [
                ["Bludgeoning", "Bludgeon. (in form)"],
                ["Piercing", "Piercing (in form)"],
                ["Slashing", "Slashing (in form)"]
            ]
        },
    },
});
legacyClassRefactor("fighter", {
    regExpSearch: /fighter/i,
    name: "Fighter",
    source: [
        ["P24", 91]
    ],
    primaryAbility: "Strength or Dexterity",
    prereqs: "Strength 13 or Dexterity 13",
    improvements: [0, 0, 0, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7],
    die: 10,
    saves: ["Str", "Con"],
    skillstxt: {
        primary: "Choose 2: Acrobatics, Animal Handling, Athletics, History, Insight, Intimidation, Persuasion, Perception, or Survival",
    },
    armorProfs: {
        primary: [true, true, true, true],
        secondary: [true, true, false, true],
    },
    weaponProfs: {
        primary: [true, true],
        secondary: [false, true],
    },
    equipment: "Fighter starting equipment:" +
        "\n \u2022 (a) Chain Mail -or- (b) Studded Leather Armor;" +
        "\n \u2022 (a) Greatsword -or- (b) Scimitar;" +
        "\n \u2022 (a) Flail -or- (b) Shortsword;" +
        "\n \u2022 (a) 8 Javelins -or- (b) Longbow and Quiver of 20 Arrows;" +
        "\n \u2022 (a) Dungeoneer's Pack, and 4 gp -or- (b) Dungeoneer's Pack, and 11 gp;" +
        "\n\nAlternatively, choose 155 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Fighter Subclass", []],
    attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4],
    features: {
        "fighting style": {
            name: "Fighting Style",
            source: [
                ["P24", 91]
            ],
            minlevel: 1,
            description: desc([
                "Choose a Fighting Style Feat using the 'Choose Feature' Button",
                "When I gain a Fighter Level, I can replace it with another",
            ]),
            choices: ["Fighting Style [Archery]", "Fighting Style [Blind Fighting]", "Fighting Style [Defense]", "Fighting Style [Dueling]", "Fighting Style [Great Weapon Fighting]", "Fighting Style [Interception]", "Fighting Style [Protection]", "Fighting Style [Thrown Weapon Fighting]", "Fighting Style [Two-Weapon Fighting]", "Fighting Style [Unarmed Fighting]"],
            "fighting style [archery]": {
                name: "Fighting Style [Archery]",
                description: " I gain a +2 bonus to attack rolls I make with Ranged weapons.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
                        },
                        "My ranged weapons get a +2 bonus on the To Hit."
                    ]
                }
            },
            "fighting style [blind fighting]": {
                name: "Fighting Style [Blind Fighting]",
                description: " I have Blindsight with a range of 10 feet.",
                vision: [
                    ["Blindsight", 10]
                ],
            },
            "fighting style [defense]": {
                name: "Fighting Style [Defense]",
                description: " While I'm wearing Light, Medium, or Heavy armor, I gain a +1 bonus to Armor Class.",
                extraAC: {
                    name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
                    mod: 1,
                    text: "I gain a +1 bonus to AC while wearing armor.",
                    stopeval: function(v) {
                        return !v.wearingArmor;
                    }
                },
            },
            "fighting style [dueling]": {
                name: "Fighting Style [Dueling]",
                description: " When I'm holding a Melee weapon in one hand and no other weapons, I gain a +2 bonus to damage rolls with that weapon.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            for (var i = 1; i <= FieldNumbers.actions; i++) {
                                if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
                            }
                            if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
                        },
                        "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
                    ]
                }
            },
            "fighting style [great weapon fighting]": {
                name: "Fighting Style [Great Weapon Fighting]",
                description: " When I roll damage for an attack I make with a Melee weapon that I am holding with two hands, I can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
                                fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
                            }
                        },
                        "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
                    ]
                },
            },
            "fighting style [interception]": {
                name: "Fighting Style [Interception]",
                description: " When a creature I can see hits another creature within 5 feet of me with an attack roll, I can take a Reaction to reduce the damage dealt to the target by 1d10 plus my Proficiency Bonus. I must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
                action: "reaction",
            },
            "fighting style [protection]": {
                name: "Fighting Style [Protection]",
                description: " When a creature I can see attacks a target other than me that is within 5 feet of me, I can take a Reaction to interpose my Shield if I'm holding one. I impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of my next turn if I remain within 5 feet of the target.",
                action: "reaction",
            },
            "fighting style [thrown weapon fighting]": {
                name: "Fighting Style [Thrown Weapon Fighting]",
                description: " When I hit with a ranged attack roll using a weapon that has the Thrown property, I gain a +2 bonus to the damage roll.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isThrownWeapon && v.isMeleeWeapon) {
                                fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
                            }
                        },
                        "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
                    ],
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isThrownWeapon && !v.isMeleeWeapon) {
                                output.extraDmg += 2;
                            }
                        },
                        ""
                    ],
                },
            },
            "fighting style [two-weapon fighting]": {
                name: "Fighting Style [Two-Weapon Fighting]",
                description: " When I make an extra attack as a result of using a weapon that has the Light property, I can add my ability modifier to the damage to that attack if I am not already adding it to the damage.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isOffHand) output.modToDmg = true;
                        },
                        "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
                    ]
                },
            },
            "fighting style [unarmed fighting]": {
                name: "Fighting Style [Unarmed Fighting]",
                description: " When I hit with my Unarmed Strike and deal damage, I can deal Bludgeoning damage equal to 1d6 plus my Strength modifier instead of the normal damage of an Unarmed Strike. If I am not holding any weapons or a Shield when I make the attack roll, the d6 becomes a d8.\n At the start of each of my turns, I can deal 1d4 Bludgeoning damage to one creature Grappled by me.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == "unarmed strike") {
                                if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
                                fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
                            }
                        },
                        "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
                        1
                    ]
                },
            },
        },
        "second wind": {
            name: "Second Wind",
            source: [
                ["P24", 91]
            ],
            minlevel: 1,
            action: [
                ["bonus action", "Second Wind"]
            ],
            limfeaname: "Second Wind (Regain 1 SR)",
            usages: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
            recovery: "long rest",
            additional: ["1d10+1", "1d10+2", "1d10+3", "1d10+4", "1d10+5", "1d10+6", "1d10+7", "1d10+8", "1d10+9", "1d10+10", "1d10+11", "1d10+12", "1d10+13", "1d10+14", "1d10+15", "1d10+16", "1d10+17", "1d10+18", "1d10+19", "1d10+20"],
            description: desc([
                "As a bonus action, I regain 1d10 + fighter level HP; I can use this feature a number of times before a Long Rest",
                "I regain 1 use after a Short Rest and all after a Long Rest",
            ]),
        },
        "weapon mastery": {
            name: "Weapon Mastery",
            source: [
                ["P24", 91]
            ],
            minlevel: 1,
            description: desc([
                "I gain mastery with a number of simple/martial weapons. Can change 1 every long rest",
            ]),
            additional: ["3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries"],
            extraname: "Weapon Mastery",
            extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
            extraTimes: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6],
            "club": {
                name: "Club",
                description: desc([
                    "I gain access to the Club's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "dagger": {
                name: "Dagger",
                description: desc([
                    "I gain access to the Dagger's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "greatclub": {
                name: "Greatclub",
                description: desc([
                    "I gain access to the Greatclub's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "handaxe": {
                name: "Handaxe",
                description: desc([
                    "I gain access to the Handaxe's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "javelin": {
                name: "Javelin",
                description: desc([
                    "I gain access to the Javelin's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "light hammer": {
                name: "Light Hammer",
                description: desc([
                    "I gain access to the Light Hammer's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "mace": {
                name: "Mace",
                description: desc([
                    "I gain access to the Mace's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "quarterstaff": {
                name: "Quarterstaff",
                description: desc([
                    "I gain access to the Quarterstaff's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "sickle": {
                name: "Sickle",
                description: desc([
                    "I gain access to the Sickle's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "spear": {
                name: "Spear",
                description: desc([
                    "I gain access to the Spear's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "dart": {
                name: "Dart",
                description: desc([
                    "I gain access to the Dart's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "light crossbow": {
                name: "Light Crossbow",
                description: desc([
                    "I gain access to the Light Crossbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "shortbow": {
                name: "Shortbow",
                description: desc([
                    "I gain access to the Shortbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "sling": {
                name: "Sling",
                description: desc([
                    "I gain access to the Sling's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "battleaxe": {
                name: "Battleaxe",
                description: desc([
                    "I gain access to the Battleaxe's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "flail": {
                name: "Flail",
                description: desc([
                    "I gain access to the Flail's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "glaive": {
                name: "Glaive",
                description: desc([
                    "I gain access to the Glaive's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "greataxe": {
                name: "Greataxe",
                description: desc([
                    "I gain access to the Greataxe's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "greatsword": {
                name: "Greatsword",
                description: desc([
                    "I gain access to the Greatsword's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "halberd": {
                name: "Halberd",
                description: desc([
                    "I gain access to the Halberd's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "lance": {
                name: "Lance",
                description: desc([
                    "I gain access to the Lance's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "longsword": {
                name: "Longsword",
                description: desc([
                    "I gain access to the Longsword's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "maul": {
                name: "Maul",
                description: desc([
                    "I gain access to the Maul's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "morningstar": {
                name: "Morningstar",
                description: desc([
                    "I gain access to the Morningstar's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "pike": {
                name: "Pike",
                description: desc([
                    "I gain access to the Pike's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "rapier": {
                name: "Rapier",
                description: desc([
                    "I gain access to the Rapier's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "scimitar": {
                name: "Scimitar",
                description: desc([
                    "I gain access to the Scimitar's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "shortsword": {
                name: "Shortsword",
                description: desc([
                    "I gain access to the Shortsword's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "trident": {
                name: "Trident",
                description: desc([
                    "I gain access to the Trident's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "warhammer": {
                name: "Warhammer",
                description: desc([
                    "I gain access to the Warhammer's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "war pick": {
                name: "War Pick",
                description: desc([
                    "I gain access to the War Pick's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "whip": {
                name: "Whip",
                description: desc([
                    "I gain access to the Whip's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "blowgun": {
                name: "Blowgun",
                description: desc([
                    "I gain access to the Blowgun's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "hand crossbow": {
                name: "Hand Crossbow",
                description: desc([
                    "I gain access to the Hand Crossbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "heavy crossbow": {
                name: "Heavy Crossbow",
                description: desc([
                    "I gain access to the Heavy Crossbow's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "longbow": {
                name: "Longbow",
                description: desc([
                    "I gain access to the Longbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "musket": {
                name: "Musket",
                description: desc([
                    "I gain access to the Musket's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "pistol": {
                name: "Pistol",
                description: desc([
                    "I gain access to the Pistol's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
        },
        "action surge": {
            name: "Action Surge",
            source: [
                ["P24", 91]
            ],
            minlevel: 2,
            usages: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2],
            recovery: "short rest",
            description: desc([
                "I can take one additional action on my turn (no Magic action)",
            ]),
        },
        "tactical mind": {
            name: "Tactical Mind",
            source: [
                ["P24", 91]
            ],
            minlevel: 2,
            description: desc([
                "When I fail an ability check, expend a Second Wind to add 1d10; on fail, not expended",
            ]),
        },
        "subclassfeature3": {
            name: "Fighter Subclass",
            source: [
                ["P24", 92]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Fighter subclass and put it in the 'Class' field.",
            ]),
        },
        "extra attack": {
            name: "Extra Attack",
            source: [
                ["P24", 92]
            ],
            minlevel: 5,
            description: desc([
                "I can attack twice instead of once whenever I take the Attack Action on my Turn",
            ]),
        },
        "tactical shift": {
            name: "Tactical Shift",
            source: [
                ["P24", 92]
            ],
            minlevel: 5,
            description: desc([
                "When using Second Wind, can move half my speed without provoking Opportunity Attacks",
            ]),
        },
        "indomitable": {
            name: "Indomitable",
            source: [
                ["P24", 92]
            ],
            minlevel: 9,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I can reroll a failed saving throw and add my Fighter level, but must keep new result",
            ]),
        },
        "tactical master": {
            name: "Tactical Master",
            source: [
                ["P24", 92]
            ],
            minlevel: 9,
            description: desc([
                "Can replace one weapon master property with Push/Sap/Slow for that attack",
            ]),
        },
        "two extra attack": {
            name: "Two Extra Attack",
            source: [
                ["P24", 92]
            ],
            minlevel: 11,
            description: desc([
                "Can attack three times instead of twice whenever I take the Attack action on my turn.",
            ]),
        },
        "studied attacks": {
            name: "Studied Attacks",
            source: [
                ["P24", 92]
            ],
            minlevel: 13,
            description: desc([
                "On attack roll miss, gain adv. on next attack against same creature till end my next turn",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 92]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "three extra attacks": {
            name: "Three Extra Attacks",
            source: [
                ["P24", 92]
            ],
            minlevel: 20,
            description: desc([
                "I can attack four times instead of three whenever I take the Attack action on my turn.",
            ]),
        },
    },
});
legacySubClassRefactor("fighter", "battle master", {
    regExpSearch: /^(?=.*(fighter))(?=.*(battle))(?=.*(master)).*$/i,
    subname: "Battle Master",
    source: [
        ["P24", 93]
    ],
    features: {
        "subclassfeature3": {
            name: "Combat Superiority",
            source: [
                ["P24", 93]
            ],
            minlevel: 3,
            additional: ["", "", "d8", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12"],
            usages: [0, 0, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6],
            recovery: "short rest",
            description: desc([
                "I gain superiority dice (SD) that I can use to fuel special Maneuvers",
                "One maneuver per attack. I regain all SD after a short rest",
            ]),
            extraname: "Maneuver Options",
            extrachoices: ["Ambush", "Bait and Switch", "Commander's Strike", "Commanding Presence", "Disarming Attack", "Distracting Strike", "Evasive Footwork", "Feinting Attack", "Goading Attack", "Lunging Attack", "Maneuvering Attack", "Menacing Attack", "Parry", "Precision Attack", "Pushing Attack", "Rally", "Riposte", "Sweeping Attack", "Tactical Assessment", "Trip Attack", ],
            extraTimes: [3, 3, 3, 3, 3, 3, 5, 5, 5, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9],
            "ambush": {
                name: "Ambush",
                description: desc([
                    "When I make a Dexterity (Stealth) check or an Initiative roll, I can expend one Superiority Die and add the die to the roll, unless I have the Incapacitated condition.",
                ]),
            },
            "bait and switch": {
                name: "Bait and Switch",
                description: desc([
                    "When I'm within 5 feet of a creature on my turn, I can expend one Superiority Die and switch places with that creature, provided I spend at least 5 feet of movement and the creature is willing and doesn't have the Incapacitated condition. This movement doesn't provoke Opportunity Attacks.",
                    "Roll the Superiority Die. Until the Start of my next turn, I or the other creature (my choice) gains a bonus to AC equal to the number rolled.",
                ]),
            },
            "commander's strike": {
                name: "Commander's Strike",
                description: desc([
                    "When I take the Attack action on my turn, I can replace one of my attacks to direct one of my companions to strike. When I do so, choose a willing creature who can see or hear I and expend one Superiority Die. That creature can immediately use its Reaction to make one attack with a weapon or an Unarmed Strike, adding the Superiority Die to the attack's damage roll on a hit.",
                ]),
            },
            "commanding presence": {
                name: "Commanding presence",
                description: desc([
                    "When I make a Charisma (Intimidation, Performance, or Persuasion) check, I can expend one Superiority Die and add that die to the roll.",
                ]),
            },
            "disarming attack": {
                name: "Disarming Attack",
                description: desc([
                    "When I hit a creature with an attack roll, I can expend one Superiority Die to attempt to disarm the target. Add the Superiority Die roll to the attack's damage roll. The target must succeed on a Strength saving throw or drop one object of my choice that it's holding with the object landing in its space.",
                ]),
            },
            "distracting strike": {
                name: "Distracting Strike",
                description: desc([
                    "When I hit a creature with an attack roll, I can expend one Superiority Die to distract the target. Add the Superiority Die roll to the attack's damage roll. The next attack roll against the target by an attacker other than myself has Advantage if the attack is made before the start of my next turn.",
                ]),
            },
            "evasive footwork": {
                name: "evasive footwork",
                description: desc([
                    "As a Bonus Action, I can expend one Superiority Die and take the Disengage action. I also roll the die and add the number rolled to my AC until the start of my next turn.",
                ]),
            },
            "feinting attack": {
                name: "Feinting Attack",
                description: desc([
                    "As a Bonus Action, I can expend one Superiority Die to feint, choosing one creature within 5 feet of me as my target. I have Advantage on my next attack roll against that target this turn. If that attack hits, add the Superiority Die to the attack's damage roll.",
                ]),
            },
            "goading attack": {
                name: "Goading Attack",
                description: desc([
                    "When I hit a creature with an attack roll, I can expend one Superiority Die to attempt to goad the target into attacking I. Add the Superiority Die to the attack's damage roll. The target must succeed on a Wisdom saving throw or have Disadvantage on attack rolls against the targets other than I until the end of my next turn.",
                ]),
            },
            "lunging attack": {
                name: "Lunging Attack",
                description: desc([
                    "As a Bonus Action, I can expend one Superiority Die and take the Dash action. If I move at least 5 feet in a straight line immediately before hitting with a melee attack as part of the Attack action on this turn, I can add the Superiority Die to the attack's damage roll.",
                ]),
            },
            "maneuvering attack": {
                name: "Maneuvering Attack",
                description: desc([
                    "When I hit a creature with an attack roll, I can expend one Superiority Die to maneuver one of my comrades into another position. Add the Superiority Die roll to the attack's damage roll, and choose a willing creature who can see or hear I. That creature can use its Reaction to move up to half its Speed without provoking an Opportunity Attack from the target of my attack.",
                ]),
            },
            "menacing attack": {
                name: "Menacing Attack",
                description: desc([
                    "When I hit a creature with an attack roll, I can expend one Superiority Die to attempt to frighten the target. Add the Superiority Due to the attack's damage roll. The target must succeed on a Wisdom saving throw or have the Frightened condition until the end of my next turn.",
                ]),
            },
            "parry": {
                name: "Parry",
                description: desc([
                    "When another creature damages I with a melee attack roll, I can take a Reaction and expend one Superiority Die to reduce the damage by the number I roll on my Superiority Die plus I Strength or Dexterity modifier (my choice).",
                ]),
            },
            "precision attack": {
                name: "Precision Attack",
                description: desc([
                    "When I miss with an attack roll, I can expend one Superiority Die, roll that die, and add it to the attack roll, potentially causing the attack to hit.",
                ]),
            },
            "pushing attack": {
                name: "Pushing Attack",
                description: desc([
                    "When I hit a creature with an attack roll using a weapon or an Unarmed Strike, I can expend one Superiority Die to attempt to drive the target back. Add the Superiority Die to the attack's damage roll. If the target is Large or smaller, it must succeed on a Strength saving throw or be pushed up to 15 feet directly away from I.",
                ]),
            },
            "rally": {
                name: "Rally",
                description: desc([
                    "As a Bonus Action, I can expend one Superiority Die to bolster the resolve of a companion. Choose an ally within 30 feet of who can see or hear me. That creature gains Temporary Hit Points equal to the Superiority Die roll plus half my Fighter level (round down).",
                ]),
            },
            "riposte": {
                name: "Riposte",
                description: desc([
                    "When a creature misses me with a melee attack roll, I can take a Reaction and expend one Superiority Die to make a melee attack roll with a weapon or an Unarmed Strike against the creature. If I hit, add the Superiority Die to the attack's damage.",
                ]),
            },
            "sweeping attack": {
                name: "Sweeping Attack",
                description: desc([
                    "When I hit a creature with a melee attack roll using a weapon or an Unarmed Strike, I can expend one Superiority Die to attempt to damage another creature. Choose another creature within 5 feet of the original target, within my reach. If the original attack roll would hit the second creature, it takes damage equal to the number I rolled on my Superiority Die. The damage is of the same type dealt by the original attack.",
                ]),
            },
            "tactical assessment": {
                name: "Tactical Assessment",
                description: desc([
                    "When I make an Intelligence (History or Investigation) check or a Wisdom (Insight) check, I can expend one Superiority Die and add that die to the ability check.",
                ]),
            },
            "trip attack": {
                name: "Trip Attack",
                description: desc([
                    "When I hit a creature with an attack roll using a weapon or an Unarmed Strike, I can expend one Superiority Die and add the die to the attack's damage roll. If the target is Large or smaller it must succeed on a Strength saving throw or have the Prone condition.",
                ]),
            },
        },
        "subclassfeature3.1": {
            name: "Student of War",
            source: [
                ["P24", 94]
            ],
            minlevel: 3,
            toolProfs: [
                ["Artisan's Tools", 1]
            ],
            skillstxt: [
                ["I gain 1 additional Fighter skill of choice."]
            ],
            description: desc([
                "Gain proficiency with one level 1 Fighter skill and one artisan's tool set ",
            ]),
        },
        "subclassfeature7": {
            name: "Know Your Enemy",
            source: [
                ["P24", 94]
            ],
            minlevel: 7,
            action: [
                ["bonus action", ""]
            ],
            usages: 1,
            recovery: "long rest",
            altResource: "SD",
            description: desc([
                "As a Bonus Action, observe any Immunities/Resistances/Vulnerabilities of a creature within 30 ft",
                "I have 1 use per long rest unless I spend a SD (no action) to restore this feature",
            ]),
        },
        "subclassfeature15": {
            name: "Relentless",
            source: [
                ["P24", 94]
            ],
            minlevel: 15,
            description: desc([
                "When I use a maneuver, I can roll 1d8 once per turn instead of spending a SD",
            ]),
        },
    },
});
legacySubClassRefactor("fighter", "champion", {
    regExpSearch: /^(?=.*(fighter))(?=.*(champion)).*$/i,
    subname: "Champion",
    source: [
        ["P24", 96]
    ],
    features: {
        "subclassfeature3": {
            name: "Improved Critical",
            source: [
                ["P24", 96]
            ],
            minlevel: 3,
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (!v.isSpell && !v.CritChance && classes.known.fighter && classes.known.fighter.level < 15) {
                            fields.Description += (fields.Description ? '; ' : '') + 'Crit on 19-20';
                            v.CritChance = 19;
                        }
                    },
                    "My weapon attacks score a critical on a to hit roll of both 19 and 20.",
                    19
                ]
            },
            description: desc([
                "I score a critical hit with my weapon attacks/Unarmed Strikes on a roll of 19 and 20",
            ]),
        },
        "subclassfeature3.1": {
            name: "Remarkable Athlete",
            source: [
                ["P24", 96]
            ],
            minlevel: 3,
            description: desc([
                "I have Advantage on Initiative and Strength(Athletics) checks",
                "On a critical hit, I can move half my Speed without provoking Opportunity Attacks",
            ]),
        },
        "subclassfeature7": {
            name: "Additional Fighting Style",
            source: [
                ["P24", 96]
            ],
            minlevel: 7,
            choices: ["Fighting Style [Archery]", "Fighting Style [Blind Fighting]", "Fighting Style [Defense]", "Fighting Style [Dueling]", "Fighting Style [Great Weapon Fighting]", "Fighting Style [Interception]", "Fighting Style [Protection]", "Fighting Style [Thrown Weapon Fighting]", "Fighting Style [Two-Weapon Fighting]", "Fighting Style [Unarmed Fighting]"],
            "fighting style [archery]": {
                name: "Fighting Style [Archery]",
                description: "I gain a +2 bonus to attack rolls I make with Ranged weapons.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
                        },
                        "My ranged weapons get a +2 bonus on the To Hit."
                    ]
                }
            },
            "fighting style [blind fighting]": {
                name: "Fighting Style [Blind Fighting]",
                description: "I have Blindsight with a range of 10 feet.",
                vision: [
                    ["Blindsight", 10]
                ],
            },
            "fighting style [defense]": {
                name: "Fighting Style [Defense]",
                description: "While I'm wearing Light, Medium, or Heavy armor, I gain a +1 bonus to Armor Class.",
                extraAC: {
                    name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
                    mod: 1,
                    text: "I gain a +1 bonus to AC while wearing armor.",
                    stopeval: function(v) {
                        return !v.wearingArmor;
                    }
                },
            },
            "fighting style [dueling]": {
                name: "Fighting Style [Dueling]",
                description: "When I'm holding a Melee weapon in one hand and no other weapons, I gain a +2 bonus to damage rolls with that weapon.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            for (var i = 1; i <= FieldNumbers.actions; i++) {
                                if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
                            }
                            if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
                        },
                        "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
                    ]
                }
            },
            "fighting style [great weapon fighting]": {
                name: "Fighting Style [Great Weapon Fighting]",
                description: "When I roll damage for an attack I make with a Melee weapon that I am holding with two hands, I can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
                                fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
                            }
                        },
                        "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
                    ]
                },
            },
            "fighting style [interception]": {
                name: "Fighting Style [Interception]",
                description: "When a creature I can see hits another creature within 5 feet of me with an attack roll, I can take a Reaction to reduce the damage dealt to the target by 1d10 plus my Proficiency Bonus. I must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
                action: "reaction",
            },
            "fighting style [protection]": {
                name: "Fighting Style [Protection]",
                description: "When a creature I can see attacks a target other than me that is within 5 feet of me, I can take a Reaction to interpose my Shield if I'm holding one. I impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of my next turn if I remain within 5 feet of the target.",
                action: "reaction",
            },
            "fighting style [thrown weapon fighting]": {
                name: "Fighting Style [Thrown Weapon Fighting]",
                description: "When I hit with a ranged attack roll using a weapon that has the Thrown property, I gain a +2 bonus to the damage roll.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isThrownWeapon && v.isMeleeWeapon) {
                                fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
                            }
                        },
                        "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
                    ],
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isThrownWeapon && !v.isMeleeWeapon) {
                                output.extraDmg += 2;
                            }
                        },
                        ""
                    ],
                },
            },
            "fighting style [two-weapon fighting]": {
                name: "Fighting Style [Two-Weapon Fighting]",
                description: "When I make an extra attack as a result of using a weapon that has the Light property, I can add my ability modifier to the damage to that attack if I am not already adding it to the damage.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isOffHand) output.modToDmg = true;
                        },
                        "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
                    ]
                },
            },
            "fighting style [unarmed fighting]": {
                name: "Fighting Style [Unarmed Fighting]",
                description: "When I hit with my Unarmed Strike and deal damage, I can deal Bludgeoning damage equal to 1d6 plus my Strength modifier instead of the normal damage of an Unarmed Strike. If I am not holding any weapons or a Shield when I make the attack roll, the d6 becomes a d8.\n At the start of each of my turns, I can deal 1d4 Bludgeoning damage to one creature Grappled by me.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == "unarmed strike") {
                                if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
                                fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
                            }
                        },
                        "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
                        1
                    ]
                },
            },
            description: desc([
                "I gain another different Fighting Style feat of my choice.",
            ]),
        },
        "subclassfeature10": {
            name: "Heroic Warrior",
            source: [
                ["P24", 96]
            ],
            minlevel: 10,
            description: desc([
                "I gain Heroic Inspiration in combat when I start a turn without it",
            ]),
        },
        "subclassfeature15": {
            name: "Superior Critical",
            source: [
                ["P24", 96]
            ],
            minlevel: 15,
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (v.isSpell) return;
                        if (v.CritChance && v.CritChance > 18) {
                            fields.Description = fields.Description.replace('Crit on ' + CritChance + '-20', 'Crit on 18-20');
                            v.CritChance = 18;
                        } else if (!v.CritChance) {
                            fields.Description += (fields.Description ? '; ' : '') + 'Crit on 18-20';
                            v.CritChance = 18;
                        }
                    },
                    "My weapon attacks also score a critical on a to hit roll of 18.",
                    18
                ]
            },
            description: desc([
                "I score a critical hit with my weapon attacks/Unarmed Strikes on a roll of 18, 19, and 20",
            ]),
        },
        "subclassfeature18": {
            name: "Survivor",
            source: [
                ["P24", 96]
            ],
            minlevel: 18,
            description: desc([
                "I roll with Advantage on Death Saves and 18-19 counts as a critical success",
                "At the start of my turn, if I'm not above half or at 0 HP, I regain 5 + Con mod HP",
            ]),
        },
    },
});
legacySubClassRefactor("fighter", "eldritch knight", {
    regExpSearch: /^(?=.*(fighter))(?=.*(eldritch))(?=.*(knight)).*$/i,
    subname: "Eldritch Knight",
    source: [
        ["P24", 96]
    ],
    spellcastingFactor: 3,
    spellcastingAbility: 4,
    spellcastingList: {
        "class": "wizard",
        level: [0, 4],
    },
    spellcastingKnown: {
        cantrips: [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        spells: [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13],
        prepared: false,
    },
    features: {
        "subclassfeature3": {
            name: "Spellcasting",
            source: [
                ["P24", 97]
            ],
            minlevel: 3,
            additional: levels.map(function(n, idx) {
                var cantr = [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3][idx];
                var splls = [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast known wizard cantrips/spells, using Intelligence as my spellcasting ability",
                "When I gain a Fighter level, I can replace one spell. I can use an Arcane Focus",
            ]),
        },
        "subclassfeature3.1": {
            name: "War Bond",
            source: [
                ["P24", 98]
            ],
            minlevel: 3,
            action: ["bonus action", "Summon Bonded Weapon"],
            description: desc([
                "During a 1 hour ritual or short rest, I can bind one weapon I touch",
                "I can‚Äôt be disarmed of it unless I'm Incapacitated. I can summon it as a Bonus Action",
            ]),
        },
        "subclassfeature7": {
            name: "War Magic",
            source: [
                ["P24", 98]
            ],
            minlevel: 7,
            description: desc([
                "When I use my Attack action, I can replace an attack with a Wizard cantrip of 1 action",
            ]),
        },
        "subclassfeature10": {
            name: "Eldritch Strike",
            source: [
                ["P24", 98]
            ],
            minlevel: 10,
            description: desc([
                "On a weapon hit, the creature has disadv. on my spell save until the end of my next turn",
            ]),
        },
        "subclassfeature15": {
            name: "Arcane Charge",
            source: [
                ["P24", 98]
            ],
            minlevel: 15,
            description: desc([
                "When I use Action Surge, I can also teleport up to 30ft to an unoccupied space I see",
                "I can do so before or after the extra action"
            ]),
        },
        "subclassfeature18": {
            name: "Improved War Magic",
            source: [
                ["P24", 98]
            ],
            minlevel: 18,
            description: desc([
                "When I use my Attack action on my turn, I can replace two of my attacks with a",
                "level 1 or 2 Wizard spell with the casting time of an action."
            ]),
        },
    },
});
legacySubClassRefactor("fighter", "psi warrior", {
    regExpSearch: /^(?=.*(fighter))(?=.*(psi))(?=.*(warrior)).*$/i,
    subname: "Psi Warrior",
    source: [
        ["P24", 98]
    ],
    features: {
        "subclassfeature3": {
            name: "Psionic Power",
            source: [
                ["P24", 98]
            ],
            minlevel: 3,
            action: [
                ["reaction", "Protective Field"],
                ["action", "Telekinetic Movement"]
            ],
            extraLimitedFeatures: [{
                name: "Telekinetic Movement",
                usages: 1,
                recovery: "short rest",
            }],
            limfeaname: "Psionic Energy Die",
            usages: ["", "", 4, 4, 6, 6, 6, 6, 8, 8, 8, 8, 10, 10, 10, 10, 12, 12, 12, 12],
            recovery: "long rest",
            additional: ["", "", "d6", "d6", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12", "d12"],
            description: desc([
                "I gain twice my proficiency bonus of psionic energy dice (PsiD) that fuel my psionics",
                "I regain one PsiD after a short rest and all after a long rest",
                "Protective Field: When I or a creature I see within 30ft is hit, as a Reaction I can",
                "reduce the damage by rolling one PsiD + Int mod (min 1)",
                "Psionic Strike: Once on my turn after I damage a target with a weapon",
                "I can spend a PsiD to deal the roll + Int mod extra force damage",
                "Telekinetic Movement: as a magic action, I can move a Large/smaller loose object or one",
                "willing creature to an unoccupied space I can see (range 30ft). If it's Tiny, I can move it to",
                "or from my hand. 1 free use per short/long rest unless I spend a PsiD to restore my use",
            ]),
        },
        "subclassfeature7": {
            name: "Telekinetic Adept",
            source: [
                ["P24", 99]
            ],
            minlevel: 7,
            limfeaname: "Psi-Powered Leap",
            usages: 1,
            recovery: "short rest",
            description: desc([
                "Psi-Powered Leap: As a Bonus Action, gain a flying speed equal to twice my speed until",
                "the turn ends. 1 free use per short/long rest unless I spend a PsiD to restore my use",
                "Telekinetic Thrust: If I deal damage with my Psionic Strike, I can force a Str save",
                "On a fail: target knocked prone or moved up to 10ft in any direction horizontally",
            ]),
        },
        "subclassfeature10": {
            name: "Guarded Mind",
            source: [
                ["P24", 99]
            ],
            minlevel: 10,
            dmgres: ["Psychic"],
            description: desc([
                "I am Resistant to Psychic damage. If I start my turn Charmed/Frightened, I can",
                "spend a PsiD (no action) to cure it/both conditions",
            ]),
        },
        "subclassfeature15": {
            name: "Bulwark of Force",
            source: [
                ["P24", 99]
            ],
            minlevel: 15,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, I can choose up to Int mod of creatures (min 1) I see in 30ft",
                "(can be me), each gains Half Cover (duration 1 min) or until I'm Incapapacitated",
                "1 free use per long rest unless I spend a PsiD to restore my use",
            ]),
        },
        "subclassfeature18": {
            name: "Telekinetic Master",
            source: [
                ["P24", 99]
            ],
            minlevel: 18,
            usages: 1,
            recovery: "long rest",
            spellcastingBonus: [{
                name: "Telekinetic Master",
                spells: ["telekinesis"],
                selection: ["telekinesis"],
                times: 1,
                prepared: true,
            }],
            description: desc([
                "I can cast Telekinesis, without spell slots/components, with Int spellcasting ability",
                "While concentrating on this spell, as a Bonus Action, I can make one weapon attack",
                "1 free use per long rest unless I spend a PsiD to restore my use",
            ]),
        },
    },
});
legacyClassRefactor("monk", {
    regExpSearch: /monk/i,
    name: "Monk",
    source: [
        ["P24", 101]
    ],
    primaryAbility: "Dexterity and Wisdom",
    prereqs: "Strength 13 or Dexterity 13",
    abilitySave: 5,
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 8,
    saves: ["Str", "Dex"],
    skillstxt: {
        primary: "Choose 2: Acrobatics, Athletics, History, Insight, Religion, or Stealth",
    },
    toolProfs: {
        primary: [
            ["Artisan's Tools or Musical Instrument", 1]
        ],
    },
    armorProfs: {
        primary: [false, false, false, false],
    },
    weaponProfs: {
        primary: [true, false, ["scimitar", "shortsword", "hand crossbow"]],
    },
    equipment: "Monk starting equipment:" +
        "\n \u2022 Spear;" +
        "\n \u2022 5 Daggers;" +
        "\n \u2022 Artisan's Tools or Musical Instrument;" +
        "\n \u2022 Explorer's Pack, and 11 gp;" +
        "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Monk Subclass", []],
    attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    features: {
        "martial arts": {
            name: "Martial Arts",
            source: [
                ["P24", 101]
            ],
            minlevel: 1,
            action: [
                ["bonus action", "Unarmed Strike"]
            ],
            additional: levels.map(function(n) {
                return "1d" + (n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12);
            }),
            eval: function() {
                AddString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Martial Arts, Unarmored Defense, Unarmored Movement, and \n   Acrobatic Movement');
                show3rdPageNotes();
            },
            removeeval: function() {
                RemoveString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Martial Arts, Unarmored Defense, Unarmored Movement, and Acrobatic Movement');
            },
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (classes.known.monk && classes.known.monk.level && (v.theWea.monkweapon || v.baseWeaponName == "unarmed strike" || v.baseWeaponName == "shortsword" || v.baseWeaponName == "scimitar" || (v.isMeleeWeapon && (/simple/i).test(v.theWea.type) && !(/heavy|((^|[^+-]\b)2|\btwo).?hand(ed)?s?/i).test(fields.Description)))) {
                            v.theWea.monkweapon = true;
                            var aMonkDie = function(n) {
                                return n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12;
                            }(classes.known.monk.level);
                            try {
                                var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
                            } catch (e) {
                                var curDie = 'x';
                            }
                            if (isNaN(curDie) || curDie < aMonkDie) {
                                fields.Damage_Die = '1d' + aMonkDie;
                            }
                            if (fields.Mod === 1 || fields.Mod === 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
                                fields.Mod = v.StrDex;
                            }
                        }
                    },
                    "I can use either Strength or Dexterity and my Martial Arts damage die in place of the normal damage die for any 'Monk Weapons', which include unarmed strike, shortsword, scimitar, and any simple melee weapon that is not two-handed or heavy.",
                    5
                ]
            },
            description: desc([
                "Monk weapons: Simple Melee weapons, Martial Melee weapons with the Light property, Unarmed Strike",
                "While wielding Monk weapons and unarmored I can make one unarmed strike as a bonus action",
                "With monk weapons, I can use Dex instead of Str and use the Martial Arts damage die",
            ]),
        },
        "unarmored defense": {
            name: "Unarmored Defense",
            source: [
                ["P24", 101]
            ],
            minlevel: 1,
            armorOptions: [{
                regExpSearch: /justToAddToDropDownAndEffectWildShape/,
                name: "Unarmored Defense (Wis)",
                source: [
                    ["P24", 101]
                ],
                ac: "10+Wis",
                affectsWildShape: true,
                selectNow: true
            }],
            description: desc([
                "My AC is 10 + Dex mod + Wis mod",
            ]),
        },
        "monk's focus": {
            name: "Monk's Focus",
            source: [
                ["P24", 101]
            ],
            minlevel: 2,
            limfeaname: "Focus Points",
            usages: levels.map(function(n) {
                return n < 2 ? "" : n;
            }),
            recovery: "short rest",
            description: desc([
                "I can spend Focus Points to fuel special actions (see third page).",
            ]),
            "flurry of blows": {
                name: "Flurry of Blows",
                extraname: "Focus Feature",
                action: ["bonus action", " (1 FP)"],
                description: levels.map(function(n) {
                    if (n < 2) return "";
                    var description = desc([
                        "I can expend 1 Focus Point to make two Unarmed Strikes as a Bonus Action.",
                    ]);
                    if (n >= 10) {
                        description += desc([
                            "At 10th level, I can expend 1 Focus Point to use Flurry of Blows and make three Unarmed",
                            "Strikes instead of two."
                        ]);
                    }
                    return description;
                }),
            },
            "patient defense": {
                name: "Patient Defense",
                extraname: "Focus Feature",
                action: [
                    ["bonus action", "Disengage"],
                    ["bonus action", " (1 FP)"]
                ],
                description: levels.map(function(n) {
                    if (n < 2) return "";
                    var description = desc([
                        "As a bonus action, I can disengage.",
                        "1 Focus Point, as a bonus action, I can Disengage and Dodge.",
                    ]);
                    if (n >= 10) {
                        description += desc([
                            "At 10th level, when I expend a Focus Point to use Patient Defense, I gain a number of",
                            "Temporary Hit Points equal to two rolls of my Martial Arts die."
                        ]);
                    }
                    return description;
                }),
            },
            "step of the wind": {
                name: "Step of the Wind",
                extraname: "Focus Feature",
                action: [
                    ["bonus action", " (1 FP)"],
                    ["bonus action", "Dash"]
                ],
                description: levels.map(function(n) {
                    if (n < 2) return "";
                    var description = desc([
                        "As a bonus action, I can take the Dash action.",
                        "1 Focus Point, as a bonus action I can Dash and Disengage, and my jump distance is doubled",
                        "for that turn.",
                    ]);
                    if (n >= 10) {
                        description += desc([
                            "At 10th level, when I expend a Focus Point to use Step of the Wind, I can choose a willing",
                            "creature within 5 feet of myself that is Large or smaller. I move the creature with me until the",
                            "end of my turn. The creature's movement doesn't provoke Opportunity Attacks."
                        ]);
                    }
                    return description;
                }),
            },
            autoSelectExtrachoices: [{
                extrachoice: "flurry of blows"
            }, {
                extrachoice: "patient defense"
            }, {
                extrachoice: "step of the wind"
            }],
        },
        "unarmored movement": {
            name: "Unarmored Movement",
            source: [
                ["P24", 102]
            ],
            minlevel: 2,
            additional: levels.map(function(n) {
                if (n < 2) return "";
                var spd = "+" + (n < 6 ? 10 : n < 10 ? 15 : n < 14 ? 20 : n < 18 ? 25 : 30) + " ft";
                var xtr = n < 9 ? "" : "; Vertical surfaces and liquids";
                return spd + xtr;
            }),
            changeeval: function(v) {
                var monkSpd = '+' + (v[1] < 2 ? 0 : v[1] < 6 ? 10 : v[1] < 10 ? 15 : v[1] < 14 ? 20 : v[1] < 18 ? 25 : 30);
                SetProf('speed', monkSpd !== '+0', {
                    allModes: monkSpd
                }, "Monk: Unarmored Movement");
            },
            description: desc([
                "Speed increases and eventually lets me traverse some surfaces without falling as I move",
            ]),
        },
        "uncanny metabolism": {
            name: "Uncanny Metabolism",
            source: [
                ["P24", 102]
            ],
            minlevel: 2,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I roll initiative, I can restore all Focus Points and heal 1 Martial die roll + Monk Level.",
            ]),
        },
        "deflect attacks": {
            name: "Deflect Attacks",
            source: [
                ["P24", 102]
            ],
            minlevel: 3,
            description: desc([
                "As a reaction, I can reduce Bludg., Pierc., or Slash. dmg done to me",
                "If the damage is negated, I can redirect the melee or ranged atk (60ft).",
                "Dex save or 2x Martial die roll + Dex mod dmg of the same type.",
            ]),
            action: "reaction",
            additional: levels.map(function(n) {
                return n < 3 ? "" : "1d10 + " + n + " + Dexterity modifier; 1 FP to redirect";
            }),
        },
        "subclassfeature3": {
            name: "Monk Subclass",
            source: [
                ["P24", 103]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Monk subclass and put it in the 'Class' field.",
            ]),
        },
        "slow fall": {
            name: "Slow Fall",
            source: [
                ["P24", 103]
            ],
            minlevel: 4,
            additional: levels.map(function(n) {
                return n < 4 ? "" : (n * 5) + " less falling damage";
            }),
            action: "reaction",
            description: desc([
                "As a Reaction, I can reduce fall damage by 5x my Monk level.",
            ]),
            "stunning strike": {
                name: "Stunning Strike",
                extraname: "Monk 5",
                source: [
                    ["P24", 103]
                ],
                description: " [1 focus point]" + desc([
                    "Once per turn, after I hit a creature, 1 Focus Point for a Stunning Strike.",
                    "Con save or it's Stunned until my next turn starts.",
                    "On a success, its Speed is halved and the next attack against it has Advantage.",
                ])
            },
            autoSelectExtrachoices: [{
                extrachoice: "stunning strike",
                minlevel: 5
            }]
        },
        "empowered strikes": {
            name: "Empowered Strikes",
            source: [
                ["P24", 103]
            ],
            minlevel: 6,
            description: desc([
                "My Unarmed Strikes can deal Force damage or their normal damage type.",
            ]),
        },
        "evasion": {
            name: "Evasion",
            source: [
                ["P24", 103]
            ],
            minlevel: 7,
            description: desc([
                "When not Incapacitated and must make a Dex save to take half damage on an effect I take no damage on a pass & half damage on a fail."
            ]),
            savetxt: {
                text: ["When not Incapacitated Dex saves: fail \u2015 half dmg, success \u2015 no dmg"]
            },
        },
        "acrobatic movement": {
            name: "Acrobatic Movement",
            source: [
                ["P24", 103]
            ],
            minlevel: 9,
            description: desc([
                "I can move on vertical surfaces and across liquids without falling during my turn",
            ]),
        },
        "heightened focus": {
            name: "Heightened Focus",
            source: [
                ["P24", 103]
            ],
            minlevel: 10,
            description: desc([
                "My Monk's Focus Features have Improved, (see third page).",
            ]),
        },
        "self-restoration": {
            name: "Self-Restoration",
            source: [
                ["P24", 103]
            ],
            minlevel: 10,
            description: desc([
                "At the end of each of my turns, I can remove the Charmed, Frightened, or Poisoned condition.",
                "I also don't gain Exhaustion from skipping food or drink.",
            ]),
        },
        "deflect energy": {
            name: "Deflect Energy",
            source: [
                ["P24", 103]
            ],
            minlevel: 13,
            description: desc([
                "Deflect Attacks works against any damage type.",
            ]),
        },
        "disciplined survivor": {
            name: "Disciplined Survivor",
            source: [
                ["P24", 103]
            ],
            minlevel: 14,
            description: desc("I am proficient with all saves; I can reroll a failed save once by spending 1 FP, must use new roll"),
            additional: "1 FP to reroll failed saving throw",
            saves: ["Str", "Dex", "Con", "Int", "Wis", "Cha"]
        },
        "perfect focus": {
            name: "Perfect Focus",
            source: [
                ["P24", 103]
            ],
            minlevel: 15,
            description: desc([
                "If I roll Initiative and I have less than 4 FP, I regain up to 4 FP.",
            ]),
        },
        "superior defense": {
            name: "Superior Defense",
            source: [
                ["P24", 103]
            ],
            minlevel: 18,
            description: desc([
                "At the start of my turn, 3 FP to resist non-Force damage for 1 minute, unless Incapacitated.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 103]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "body and mind": {
            name: "Body and Mind",
            source: [
                ["P24", 103]
            ],
            minlevel: 20,
            scores: [0, 4, 0, 0, 4, 0],
            scoresMaximum: [0, 25, 0, 0, 25, 0],
            description: desc([
                "My Dexterity and Wisdom scores increase by 4, to a maximum of 25.",
            ]),
        },
    },
});
legacySubClassRefactor("monk", "mercy", {
    regExpSearch: /^(?=.*(monk))(?=.*(mercy)).*$/i,
    subname: "Warrior of Mercy",
    source: [
        ["P24", 104]
    ],
    replaces: "way of mercy",
    features: {
        "subclassfeature3": {
            name: "Hand of Harm",
            source: [
                ["P24", 104]
            ],
            minlevel: 3,
            description: desc([
                "1/turn when I hit a crea. with an Unarmed Strike and deal dmg",
                "1 FP to add extra Necro. dmg equal to one roll of my Martial Arts die + Wis mod.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Hand of Healing",
            source: [
                ["P24", 104]
            ],
            minlevel: 3,
            action: "action",
            description: desc([
                "As a Magic action, 1 FP to touch a crea. and restore HP equal to a roll of my Martial Arts die + Wis mod.",
                "When I use Flurry of Blows, I can replace one of the Unarmed Strikes with a use of this feature without expending FP for the healing.",
            ]),
        },
        "subclassfeature3.2": {
            name: "Implements of Mercy",
            source: [
                ["P24", 104]
            ],
            minlevel: 3,
            skills: ["Insight", "Medicine"],
            toolProfs: [
                ["Herbalism Kit"]
            ],
            description: desc([
                "I gain Proficiency in the Insight and Medicine skills and proficiency with the Herbalism Kit.",
            ]),
        },
        "subclassfeature6": {
            name: "Physician's Touch",
            source: [
                ["P24", 104]
            ],
            minlevel: 6,
            description: desc([
                "Hand of Healing also ends 1 condition blinded, deafened, paralyzed, poisoned or stunned",
                "Hand of Harm also causes the target to be poisoned until the end of my next turn"
            ]),
        },
        "subclassfeature11": {
            name: "Flurry of Healing and Harm",
            source: [
                ["P24", 104]
            ],
            minlevel: 11,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "I can use Hand of Healing instead of each Flurry of Blows unarmed strike without ki cost",
                "I can use Hand of Harm on one Flurry of Blows unarmed strike without ki cost",
                "I can use this benefit a number of times equal to my Wis Mod, and can't do so again until a Long Rest.",
            ]),
            "hand of ultimate mercy": {
                name: "Hand of Ultimate Mercy",
                extraname: "Way of Mercy 17",
                source: [
                    ["P24", 104]
                ],
                description: desc([
                    "As an action, I can spend 5 FP and touch a creature that died in the last 24 hours",
                    "The creature returns to life and regains 4d10 + my Wisdom modifier in hit points",
                    "It is also cured of all these conditions: blinded, deafened, paralyzed, poisoned, and stunned"
                ]),
                action: "action",
                additional: "5 FP",
                usages: 1,
                recovery: "long rest"
            },
            autoSelectExtrachoices: [{
                extrachoice: "hand of ultimate mercy",
                minlevel: 17
            }]
        },
    },
});
legacySubClassRefactor("monk", "shadow", {
    regExpSearch: /^(?=.*(monk))(?=.*(shadow)).*$/i,
    subname: "Warrior of Shadow",
    source: [
        ["P24", 105]
    ],
    replaces: "way of shadow",
    spellcastingAbility: 5,
    features: {
        "subclassfeature3": {
            name: "Shadow Arts",
            source: [
                ["P24", 105]
            ],
            minlevel: 3,
            vision: [
                ["Darkvision", "+60"]
            ],
            "darkness": {
                name: "Darkness",
                extraname: "Shadow Arts",
                source: [
                    ["P24", 105]
                ],
                spellcastingBonus: [{
                    name: "Shadow Arts",
                    spells: ["darkness"],
                    selection: ["darkness"],
                    times: 1,
                    firstCol: 1,
                }],
                spellFirstColTitle: "FP",
                description: desc([
                    "Darkness : I can expend 1 Focus Point to cast the Darkness spell without expending components. I can see within the spell's area when I cast it with this feature. While the spell persists, I can move its area of Darkness to a space within 60 feet of myself at the start of each of my turns.",
                ])
            },
            autoSelectExtrachoices: [{
                extrachoice: "darkness"
            }],
            spellChanges: {
                "darkness": {
                    components: "",
                    compMaterial: "",
                    changes: "Spells cast with my Shadow Arts don't require spell components."
                },
            },
            spellcastingBonus: [{
                name: "Shadow Arts",
                spells: ["minor illusion"],
                selection: ["minor illusion"],
                times: 1,
            }],
            description: "\n   " + "I know the Minor Illusion cantrip and can cast certain spells by using FP (see page 3)",
        },
        "subclassfeature6": {
            name: "Shadow Step",
            source: [
                ["P24", 105]
            ],
            minlevel: 6,
            action: "bonus action",
            description: desc([
                "I can use a Bonus Action to teleport up to 60 feet while in Dim Light or Darkness. I gain Advantage on my next melee attack before the turn ends.",
            ]),
        },
        "subclassfeature11": {
            name: "Improved Shadow Step",
            source: [
                ["P24", 105]
            ],
            minlevel: 11,
            description: desc([
                "1 Focus Point, I can use Shadow Step to teleport without needing to start and end in Dim Light or Darkness. I can also make an Unarmed Strike immediately after teleporting.",
            ]),
        },
        "subclassfeature17": {
            name: "Cloak of Shadows",
            source: [
                ["P24", 105]
            ],
            minlevel: 17,
            action: "action",
            description: desc([
                "As a Magic action in Dim Light or Darkness, 3 FP to shroud myself in shadows for 1 min.",
                "I lose this if I end my turn in Bright Light or am Incapacitated. While shrouded, I gain:",
                "The Invisible Condition",
                "I can move through occupied spaces as Difficult Terrain",
                "and will be shunted to the last unoccupied space if I end my turn in an occupied space",
                "I can use Flurry of Blows without spending Focus Points.",
            ]),
        },
    },
});
legacySubClassRefactor("monk", "elements", {
    regExpSearch: /^(?=.*(monk))(?=.*(elements)).*$/i,
    subname: "Warrior of the Elements",
    source: [
        ["P24", 106]
    ],
    replaces: "way of the four elements",
    spellcastingAbility: 5,
    features: {
        "subclassfeature3": {
            name: "Elemental Attunement",
            source: [
                ["P24", 106]
            ],
            minlevel: 3,
            description: desc([
                "At the start of my turn, 1 FP for 10 mins of elemental energy. While active:",
                "My Unarmed Strikes have 10ft extra reach, and deal my choice: Acid, Cold, Fire, Lightning,",
                "or Thunder damage, and on hit Str save or I can move the target up to 10ft",
            ]),
            spellcastingBonus: [{
                name: "Manipulate Elements",
                spells: ["elementalism"],
                selection: ["elementalism"],
                times: 1,
            }],
        },
        "subclassfeature6": {
            name: "Elemental Burst",
            source: [
                ["P24", 106]
            ],
            minlevel: 6,
            action: "action",
            description: desc([
                "As a Magic action, 2 FP for a 20ft radius burst of Acid, Cold, Fire, Lightning, or Thunder damage within 120ft",
                "Affected Creatures make a Dex save, or 3x Martial dice roll damage, half on success.",
            ]),
        },
        "subclassfeature11": {
            name: "Stride of the Elements",
            source: [
                ["P24", 106]
            ],
            minlevel: 11,
            description: desc([
                "While my Elemental Attunement is active, I gain Fly and Swim Speed equal to my Speed.",
            ]),
        },
        "subclassfeature17": {
            name: "Elemental Epitome",
            source: [
                ["P24", 106]
            ],
            minlevel: 17,
            description: desc([
                "When Elemental Attunement is active:",
                "I gain Resistance to Acid, Cold, Fire, Lightning, or Thunder, and can change on my turn.",
                "Step of the Wind adds 20ft Speed, for the duration I can deal damage (Acid, Cold,",
                "Fire, Lightning or Thunder), to each creature within 5ft once per turn.",
                "Once per turn, extra damage with Unarmed Strikes of the same damage type.",
            ]),
        },
    },
});
legacySubClassRefactor("monk", "open hand", {
    regExpSearch: /^(?=.*(monk))(?=.*(open))(?=.*(hand)).*$/i,
    subname: "Warrior of the Open Hand",
    source: [
        ["P24", 107]
    ],
    replaces: "way of the open hand",
    features: {
        "subclassfeature3": {
            name: "Open Hand Technique",
            source: [
                ["P24", 107]
            ],
            minlevel: 3,
            description: desc([
                "When I hit a crea. with a Flurry of Blows attack, I can impose one of these effects:",
                "Crea. can't make Opportunity Attacks until its next turn.",
                "Crea. makes a Str save or is pushed 15ft",
                "Crea. makes a Dex save or is knocked Prone.",
            ]),
        },
        "subclassfeature6": {
            name: "Wholeness of Body",
            source: [
                ["P24", 107]
            ],
            minlevel: 6,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, I can heal myself for 1 Martial die roll + my Wis mod.",
            ]),
        },
        "subclassfeature11": {
            name: "Fleet Step",
            source: [
                ["P24", 107]
            ],
            minlevel: 11,
            description: desc([
                "When I use a Bonus Action other than Step of the Wind, I can also use Step of the Wind immediately after.",
            ]),
            "quivering palm": {
                name: "Quivering Palm",
                extraname: "Warrior of the Open Hand 17",
                source: [
                    ["P24", 107]
                ],
                description: " [4 focus points]" + desc([
                    "When I hit a creature with an unarmed strike, I can start imperceptible vibrations",
                    "Within my monk level in days, I can use an action to have the creature make a Con save",
                    "If it fails, it takes 10d12 necrotic damage, half on success."
                ])
            },
            autoSelectExtrachoices: [{
                extrachoice: "quivering palm",
                minlevel: 17,
            }]
        },
    },
});
legacyClassRefactor("paladin", {
    regExpSearch: /paladin/i,
    name: "Paladin",
    source: [
        ["P24", 109]
    ],
    primaryAbility: "Strength or Charisma",
    prereqs: "Strength 13 or Dexterity 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 10,
    saves: ["Wis", "Cha"],
    skillstxt: {
        primary: "Choose 2: Athletics, Insight, Intimidation, Medicine, Persuasion, or Religion.",
    },
    armorProfs: {
        primary: [true, true, true, true],
        secondary: [true, true, false, true],
    },
    weaponProfs: {
        primary: [true, true],
        secondary: [false, true],
    },
    equipment: "Paladin starting equipment:" +
        "\n \u2022 Chain Mail;" +
        "\n \u2022 Shield;" +
        "\n \u2022 Longsword;" +
        "\n \u2022 6 Javelins;" +
        "\n \u2022 Holy Symbol;" +
        "\n \u2022 Priest's Pack and 9 gp;" +
        "\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Paladin Subclass", []],
    attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    spellcastingFactor: 2,
    spellcastingAbility: 6,
    spellcastingKnown: {
        spells: "list",
        prepared: [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15],
    },
    spellcastingFactorRoundupMulti: true,
    spellcastingTable: [
        [0, 0, 0, 0, 0, 0, 0, 0, 0]
    ].concat(levels.map(function(n) {
        return defaultSpellTable[Math.ceil(n / 2)];
    })),
    features: {
        "lay on hands": {
            name: "Lay on Hands",
            source: [
                ["P24", 109]
            ],
            minlevel: 1,
            action: "bonus action",
            usages: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100],
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, I can draw from a pool of healing to restore HP to a creature I touch.",
                "I can instead spend 5 HP from the pool to remove Poisoned; Those don't also restore HP.",
            ]),
        },
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 109]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var splls = [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15][idx];
                return splls + " spells prepared";
            }),
            description: desc([
                "I can cast prepared level 1+ Paladin spells using Charisma as my spellcasting ability.",
                "I can use a Holy Symbol as a spellcasting focus for my paladin spells.",
                "I can change one prepared spell at the end of a long rest.",
            ]),
        },
        "weapon mastery": {
            name: "Weapon Mastery",
            source: [
                ["P24", 110]
            ],
            minlevel: 1,
            description: desc([
                "I choose two weapons I'm proficient with and gain their mastery features.",
                "I can change these on a long rest; use ‚ÄòChoose Feature‚Äô above to select two. (See page 3)",
            ]),
            additional: ["2 Weapon Masteries"],
            extraname: "Weapon Mastery",
            extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
            extraTimes: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
            "club": {
                name: "Club",
                description: desc([
                    "I gain access to the Club's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "dagger": {
                name: "Dagger",
                description: desc([
                    "I gain access to the Dagger's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "greatclub": {
                name: "Greatclub",
                description: desc([
                    "I gain access to the Greatclub's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "handaxe": {
                name: "Handaxe",
                description: desc([
                    "I gain access to the Handaxe's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "javelin": {
                name: "Javelin",
                description: desc([
                    "I gain access to the Javelin's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "light hammer": {
                name: "Light Hammer",
                description: desc([
                    "I gain access to the Light Hammer's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "mace": {
                name: "Mace",
                description: desc([
                    "I gain access to the Mace's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "quarterstaff": {
                name: "Quarterstaff",
                description: desc([
                    "I gain access to the Quarterstaff's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "sickle": {
                name: "Sickle",
                description: desc([
                    "I gain access to the Sickle's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "spear": {
                name: "Spear",
                description: desc([
                    "I gain access to the Spear's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "dart": {
                name: "Dart",
                description: desc([
                    "I gain access to the Dart's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "light crossbow": {
                name: "Light Crossbow",
                description: desc([
                    "I gain access to the Light Crossbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "shortbow": {
                name: "Shortbow",
                description: desc([
                    "I gain access to the Shortbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "sling": {
                name: "Sling",
                description: desc([
                    "I gain access to the Sling's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "battleaxe": {
                name: "Battleaxe",
                description: desc([
                    "I gain access to the Battleaxe's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "flail": {
                name: "Flail",
                description: desc([
                    "I gain access to the Flail's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "glaive": {
                name: "Glaive",
                description: desc([
                    "I gain access to the Glaive's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "greataxe": {
                name: "Greataxe",
                description: desc([
                    "I gain access to the Greataxe's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "greatsword": {
                name: "Greatsword",
                description: desc([
                    "I gain access to the Greatsword's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "halberd": {
                name: "Halberd",
                description: desc([
                    "I gain access to the Halberd's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "lance": {
                name: "Lance",
                description: desc([
                    "I gain access to the Lance's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "longsword": {
                name: "Longsword",
                description: desc([
                    "I gain access to the Longsword's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "maul": {
                name: "Maul",
                description: desc([
                    "I gain access to the Maul's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "morningstar": {
                name: "Morningstar",
                description: desc([
                    "I gain access to the Morningstar's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "pike": {
                name: "Pike",
                description: desc([
                    "I gain access to the Pike's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "rapier": {
                name: "Rapier",
                description: desc([
                    "I gain access to the Rapier's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "scimitar": {
                name: "Scimitar",
                description: desc([
                    "I gain access to the Scimitar's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "shortsword": {
                name: "Shortsword",
                description: desc([
                    "I gain access to the Shortsword's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "trident": {
                name: "Trident",
                description: desc([
                    "I gain access to the Trident's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "warhammer": {
                name: "Warhammer",
                description: desc([
                    "I gain access to the Warhammer's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "war pick": {
                name: "War Pick",
                description: desc([
                    "I gain access to the War Pick's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "whip": {
                name: "Whip",
                description: desc([
                    "I gain access to the Whip's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "blowgun": {
                name: "Blowgun",
                description: desc([
                    "I gain access to the Blowgun's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "hand crossbow": {
                name: "Hand Crossbow",
                description: desc([
                    "I gain access to the Hand Crossbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "heavy crossbow": {
                name: "Heavy Crossbow",
                description: desc([
                    "I gain access to the Heavy Crossbow's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "longbow": {
                name: "Longbow",
                description: desc([
                    "I gain access to the Longbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "musket": {
                name: "Musket",
                description: desc([
                    "I gain access to the Musket's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "pistol": {
                name: "Pistol",
                description: desc([
                    "I gain access to the Pistol's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
        },
        "fighting style": {
            name: "Fighting Style",
            source: [
                ["P24", 110]
            ],
            minlevel: 2,
            description: desc([
                "Pick a 'Fighting Style' feat or 'Blessed Warrior'; use Choose Feature above.",
            ]),
            choices: ["Fighting Style [Archery]", "Fighting Style [Blessed Warrior]", "Fighting Style [Blind Fighting]", "Fighting Style [Defense]", "Fighting Style [Dueling]", "Fighting Style [Great Weapon Fighting]", "Fighting Style [Interception]", "Fighting Style [Protection]", "Fighting Style [Thrown Weapon Fighting]", "Fighting Style [Two-Weapon Fighting]", "Fighting Style [Unarmed Fighting]"],
            "fighting style [archery]": {
                name: "Fighting Style [Archery]",
                description: " I gain a +2 bonus to attack rolls I make with Ranged weapons.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
                        },
                        "My ranged weapons get a +2 bonus on the To Hit."
                    ]
                }
            },
            "fighting style [blessed warrior]": {
                name: "Fighting Style [Blessed Warrior]",
                spellcastingBonus: [{
                    name: "Blessed Warrior",
                    "class": "cleric",
                    level: [0, 0],
                    times: 2,
                }],
                description: desc([
                    "I learn two Cleric cantrips that count as Paladin spells; I use Cha for spellcasting.",
                    "When I gain a Paladin level I can swap one of these for another Cleric cantrip.",
                ]),
            },
            "fighting style [blind fighting]": {
                name: "Fighting Style [Blind Fighting]",
                description: " I have Blindsight with a range of 10 feet.",
                vision: [
                    ["Blindsight", 10]
                ],
            },
            "fighting style [defense]": {
                name: "Fighting Style [Defense]",
                description: " While I'm wearing Light, Medium, or Heavy armor, I gain a +1 bonus to Armor Class.",
                extraAC: {
                    name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
                    mod: 1,
                    text: "I gain a +1 bonus to AC while wearing armor.",
                    stopeval: function(v) {
                        return !v.wearingArmor;
                    }
                },
            },
            "fighting style [dueling]": {
                name: "Fighting Style [Dueling]",
                description: " When I'm holding a Melee weapon in one hand and no other weapons, I gain a +2 bonus to damage rolls with that weapon.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            for (var i = 1; i <= FieldNumbers.actions; i++) {
                                if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
                            }
                            if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
                        },
                        "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
                    ]
                }
            },
            "fighting style [great weapon fighting]": {
                name: "Fighting Style [Great Weapon Fighting]",
                description: " When I roll damage for an attack I make with a Melee weapon that I am holding with two hands, I can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
                                fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
                            }
                        },
                        "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
                    ]
                },
            },
            "fighting style [interception]": {
                name: "Fighting Style [Interception]",
                description: " When a creature I can see hits another creature within 5 feet of me with an attack roll, I can take a Reaction to reduce the damage dealt to the target by 1d10 plus my Proficiency Bonus. I must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
                action: "reaction",
            },
            "fighting style [protection]": {
                name: "Fighting Style [Protection]",
                description: " When a creature I can see attacks a target other than me that is within 5 feet of me, I can take a Reaction to interpose my Shield if I'm holding one. I impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of my next turn if I remain within 5 feet of the target.",
                action: "reaction",
            },
            "fighting style [thrown weapon fighting]": {
                name: "Fighting Style [Thrown Weapon Fighting]",
                description: " When I hit with a ranged attack roll using a weapon that has the Thrown property, I gain a +2 bonus to the damage roll.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isThrownWeapon && v.isMeleeWeapon) {
                                fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
                            }
                        },
                        "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
                    ],
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isThrownWeapon && !v.isMeleeWeapon) {
                                output.extraDmg += 2;
                            }
                        },
                        ""
                    ],
                },
            },
            "fighting style [two-weapon fighting]": {
                name: "Fighting Style [Two-Weapon Fighting]",
                description: " When I make an extra attack as a result of using a weapon that has the Light property, I can add my ability modifier to the damage to that attack if I am not already adding it to the damage.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isOffHand) output.modToDmg = true;
                        },
                        "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
                    ]
                },
            },
            "fighting style [unarmed fighting]": {
                name: "Fighting Style [Unarmed Fighting]",
                description: " When I hit with my Unarmed Strike and deal damage, I can deal Bludgeoning damage equal to 1d6 plus my Strength modifier instead of the normal damage of an Unarmed Strike. If I am not holding any weapons or a Shield when I make the attack roll, the d6 becomes a d8.\n At the start of each of my turns, I can deal 1d4 Bludgeoning damage to one creature Grappled by me.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == "unarmed strike") {
                                if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
                                fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
                            }
                        },
                        "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
                        1
                    ]
                },
            },
        },
        "paladin's smite": {
            name: "Paladin's Smite",
            source: [
                ["P24", 110]
            ],
            minlevel: 2,
            limfeaname: "Divine Smite",
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I always have the Divine Smite spell prepared, once per Long Rest, I can cast this spell without expending a spell slot.",
            ]),
            calcChanges: {
                spellAdd: [
                    function(spellKey, spellObj, spName) {
                        // only change the spell if it's from paladin's CurrentSpells object.
                        if (spellKey === "divine smite" && spName === "paladin") {
                            spellObj.firstCol = "markedbox"; // Always prepared

                        }
                    }
                ]
            },
        },
        "channel divinity": {
            name: "Channel Divinity",
            source: [
                ["P24", 110]
            ],
            action: ["bonus action", " Divine Sense"],
            minlevel: 3,
            limfeaname: "Channel Divinity (Regain 1 SR)",
            usages: [0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
            recovery: "long rest",
            description: desc([
                "If a Channel Divinity effect has a saving throw the DC is my Cha spell save DC.",
                "I get two uses (three at level 11); one returns on a Short Rest; all return on a Long Rest.",
                "\u2022 Channel Divinity: Divine Sense As a Bonus Action I sense and locate Celestials, Fiends, Undead and consecrated/desecrated places/obj within 60 ft for 10 min or until Incapacitated",
            ]),
        },
        "subclassfeature3": {
            name: "Paladin Subclass",
            source: [
                ["P24", 111]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Paladin subclass and put it in the 'Class' field.",
            ]),
            spellcastingBonus: [{
                name: "Faithful Steed",
                spells: ["find steed"],
                selection: ["find steed"],
                times: 1,
                minlevel: 5,
                firstCol: "oncelr",
            }],
        },
        "faithful steed": {
            name: "Faithful Steed",
            source: [
                ["P24", 111]
            ],
            minlevel: 5,
            limfeaname: "Find Steed",
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I always have the Find Steed spell prepared, once per Long Rest, I can cast this spell without expending a spell slot.",
            ]),
            calcChanges: {
                spellAdd: [
                    function(spellKey, spellObj, spName) {
                        // only change the spell if it's from paladin's CurrentSpells object.
                        if (spellKey === "find steed" && spName === "paladin") {
                            spellObj.firstCol = "markedbox"; // Always prepared

                        }
                    }
                ]
            },
        },
        "aura of protection": {
            name: "Aura of Protection",
            source: [
                ["P24", 111]
            ],
            minlevel: 6,
            description: desc("While I'm conscious, allies within range and I can add my Cha mod (min 1) to saves"),
            additional: levels.map(function(n) {
                return n < 6 ? "" : (n < 18 ? 10 : 30) + "-foot aura";
            }),
            addMod: {
                type: "save",
                field: "all",
                mod: "max(Cha|1)",
                text: "While I'm conscious I can add my Charisma modifier (min 1) to all my saving throws."
            }
        },
        "abjure foes": {
            name: "Channel Divinity : Abjure Foes",
            source: [
                ["P24", 111]
            ],
            minlevel: 9,
            action: "action",
            description: desc([
                "As a Magic action I target my Cha mod (min 1) creatures I can see within 60 ft",
                "Each target must succeed a Wis saving throw or be Frightened for 1 min or until damaged.",
            ]),
        },
        "aura of courage": {
            name: "Aura of Courage",
            source: [
                ["P24", 111]
            ],
            minlevel: 10,
            description: desc("While I'm conscious, allies within range and I can't be frightened"),
            additional: levels.map(function(n) {
                return n < 10 ? "" : (n < 18 ? 10 : 30) + "-foot aura";
            }),
            savetxt: {
                immune: ["frightened"]
            }
        },
        "radiant strikes": {
            name: "Radiant Strikes",
            source: [
                ["P24", 111]
            ],
            minlevel: 11,
            description: desc("Whenever I hit a creature with a melee weapon or unarmed strike, I do an extra 1d8 radiant damage"),
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (v.isMeleeWeapon) fields.Description += (fields.Description ? '; ' : '') + '+1d8 Radiant damage' + (v.isThrownWeapon ? ' in melee' : '');
                    },
                    "With my melee weapon and unarmed strike attacks I deal an extra 1d8 radiant damage."
                ]
            }
        },
        "restoring touch": {
            name: "Restoring Touch",
            source: [
                ["P24", 111]
            ],
            minlevel: 14,
            description: desc([
                "I spend 5 Hit Points of Lay on Hands to remove one of the following:",
                "Blinded, Charmed, Deafened, Frightened, Paralyzed, Stunned.",
                "Those points don't also restore HP; I can spend more points for more conditions.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 111]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
    },
});
legacySubClassRefactor("paladin", "devotion", {
    regExpSearch: /^(?=.*(paladin))(?=.*(devotion)).*$/i,
    subname: "Oath of Devotion",
    source: [
        ["P24", 113]
    ],
    replaces: "oath of devotion",
    spellcastingExtra: ["divine smite", "protection from evil and good", "shield of faith", "aid", "zone of truth", "beacon of hope", "dispel magic", "freedom of movement", "guardian of faith", "commune", "flame strike"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Sacred Weapon",
            source: [
                ["P24", 113]
            ],
            minlevel: 3,
            description: desc([
                "As part of the attack action, I can imbue 1 held melee weapon for 10 minutes or until I use this feature again. While active, I add my Cha modifier to attacks and choose Radiant or normal damage on each hit. It also emits 20-ft radius bright light and 20-ft more dim light."
            ]),
            action: "action",
            calcChanges: {
                atkCalc: [
                    function(fields, v, output) {
                        if (classes.known.paladin && classes.known.paladin.level > 2 && !v.isSpell && (/^(?=.*sacred)(?=.*weapon).*$/i).test(v.WeaponTextName)) {
                            output.extraHit += What('Cha Mod');
                        }
                    },
                    "If I include the words 'Sacred Weapon' in the name of a weapon, it gets my Charisma modifier added to its To Hit."
                ]
            },
        },
        "subclassfeature7": {
            name: "Aura of Devotion",
            source: [
                ["P24", 114]
            ],
            minlevel: 7,
            description: desc("While I'm conscious, allies within range and I can't be charmed"),
            additional: levels.map(function(n) {
                return n < 7 ? "" : (n < 18 ? 10 : 30) + "-foot aura";
            }),
            savetxt: {
                immune: ["charmed"]
            }
        },
        "subclassfeature15": {
            name: "Smite of Protection",
            source: [
                ["P24", 114]
            ],
            minlevel: 15,
            description: desc([
                "When I cast Divine Smite my allies & I have Half Cover while in my aura of protection until the start of my next turn.",
            ]),
        },
        "subclassfeature20": {
            name: "Holy Nimbus",
            source: [
                ["P24", 114]
            ],
            minlevel: 20,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            altResource: "SS 5",
            description: desc([
                "As a Bonus Action, I can give my Aura of Protection the benefits below for 10 minutes:",
                "Holy Ward: I have Advantage on saving throws I'm forced to make by a Fiend or Undead.",
                "Radiant Damage: An enemy that starts its turn in range takes my Cha mod + Prof Bonus Radiant damage.",
                "Sunlight: The aura is filled with Bright Light that is sunlight.",
                "I can end it for free; I can spend a level 5 spell slot or Long Rest to restore it.",
            ]),
        },
    },
});
legacySubClassRefactor("paladin", "glory", {
    regExpSearch: /^(?=.*(paladin))(?=.*(glory)).*$/i,
    subname: "Oath of Glory",
    source: [
        ["P24", 114]
    ],
    replaces: "oath of glory",
    spellcastingExtra: ["divine smite", "guiding bolt", "heroism", "enhance ability", "magic weapon", "haste", "protection from energy", "compulsion", "freedom of movement", "legend lore", "yolande's regal presence"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Inspiring Smite",
            source: [
                ["P24", 114]
            ],
            minlevel: 3,
            description: desc([
                "Immediately after dealing damage with Divine Smite, I can grant temporary HP",
                "I distribute the temporary HP how I choose across creatures within 30 ft, including me"
            ]),
            additional: levels.map(function(n) {
                return n < 3 ? "" : "2d8 + " + n + " temporary HP";
            }),
        },
        "subclassfeature3.1": {
            name: "Channel Divinity: Peerless Athlete",
            source: [
                ["P24", 114]
            ],
            minlevel: 3,
            description: desc([
                "As a bonus action, I can get adv. on Str (Athletics) \u0026 Dex (Acrobatics) checks for 1 hour",
                "In that time, I also add +10 ft to long and high jumps"
            ]),
            action: "bonus action",
        },
        "subclassfeature7": {
            name: "Aura of Alacrity",
            source: [
                ["P24", 115]
            ],
            minlevel: 7,
            description: "\n   If I'm not incapacitated, allies starting their turn in range gain bonus speed for that turn",
            speed: {
                walk: {
                    spd: "+10",
                    enc: "+10"
                }
            },
            additional: levels.map(function(n) {
                return n < 7 ? "" : (n < 18 ? 10 : 30) + "-foot aura; +10 ft walking speed";
            })
        },
        "subclassfeature15": {
            name: "Glorious Defense",
            source: [
                ["P24", 115]
            ],
            minlevel: 15,
            description: desc([
                "As a reaction when I or another in 10 ft is hit with an attack roll, I can grant bonus AC",
                "I must be able to see the attacker; I add my Cha mod (min 1) to the AC for that attack",
                "If it misses, I can do a weapon attack vs. the attacker, if in reach, as part of this reaction"
            ]),
            usages: "Charisma modifier per ",
            usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
            recovery: "long rest",
            action: "reaction",
        },
        "subclassfeature20": {
            name: "Living Legend",
            source: [
                ["P24", 115]
            ],
            minlevel: 20,
            description: desc([
                "As a bonus action, I can empower myself with legends, gaining the following for 10 mins:",
                " \u2022 My otherworldly presence grants me advantage on Charisma checks",
                " \u2022 Once on each of my turns when I miss with a weapon attack, I can have it hit instead",
                " \u2022 As a reaction when I fail a saving throw, I can reroll it, but must use the new roll",
                "I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)"
            ]),
            recovery: "long rest",
            usages: 1,
            altResource: "SS 5+",
            action: [
                ["bonus action", ""]
            ]
        },
    },
});
legacySubClassRefactor("paladin", "ancients", {
    regExpSearch: /^(?=.*(paladin))(?=.*(ancients)).*$/i,
    subname: "Oath of the Ancients",
    source: [
        ["P24", 115]
    ],
    replaces: "oath of the ancients",
    spellcastingExtra: ["divine smite", "ensnaring strike", "speak with animals", "misty step", "moonbeam", "plant growth", "protection from energy", "ice storm", "stoneskin", "commune with nature", "tree stride"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Nature's Wrath",
            source: [
                ["P24", 115]
            ],
            minlevel: 3,
            description: "\n   " + "As a magic action, a creature I can see within 15 ft must make a Str save" + "\n   " + "If it fails this save, it is restrained until it succeeds on a save at the end of its turn",
            action: "action",
        },
        "subclassfeature7": {
            name: "Aura of Warding",
            source: [
                ["P24", 116]
            ],
            minlevel: 7,
            dmgres: ["Psychic", "Radiant", "Necrotic"],
            description: desc([
                "My allies & I have Resistance to Necrotic, Psychic, & Radiant damage while in range.",
            ]),
            additional: levels.map(function(n) {
                return n < 7 ? "" : (n < 18 ? 10 : 30) + "-foot aura";
            }),
        },
        "subclassfeature15": {
            name: "Undying Sentinel",
            source: [
                ["P24", 116]
            ],
            minlevel: 15,
            description: "\n   " + "If dropped to 0 hit points and not killed outright, I can choose to stay at 1 hit point" + "\n   " + "Additionally, I suffer no drawbacks of old age and can't be aged magically",
            recovery: "long rest",
            usages: 1
        },
        "subclassfeature20": {
            name: "Elder Champion",
            source: [
                ["P24", 115]
            ],
            minlevel: 20,
            description: desc([
                "As a Bonus Action, I can give my Aura of Protection the benefits below for 10 minutes:",
                " \u2022 At the start of each of my turns, I regain 10 hit points",
                " \u2022 I can cast paladin spells with a casting time of 1 action as a bonus action instead",
                " \u2022 Enemies within range have disadv. on saves vs. my paladin spells and channel divinity"
            ]),
        },
    },
});
legacySubClassRefactor("paladin", "Vengeance", {
    regExpSearch: /^(?=.*(paladin))(?=.*(vengeance)).*$/i,
    subname: "Oath of Vengeance",
    source: [
        ["P24", 116]
    ],
    replaces: "oath of vengeance",
    spellcastingExtra: ["divine smite", "bane", "hunter's mark", "hold person", "misty step", "haste", "protection from energy", "banishment", "dimension door", "hold monster", "scrying"],
    features: {
        "subclassfeature3": {
            name: "Channel Divinity: Vow of Enmity",
            source: [
                ["P24", 117]
            ],
            minlevel: 3,
            description: desc([
                "When I Attack I can make a Vow of Enmity against a creature I choose that I can see within 30 ft",
                "I have Adv on attack rolls against it for 1 min or until I use this feature again.",
                "If it drops to 0 HP before the Vow ends I can transfer the Vow to a different creature within 30 feet.",
            ]),
        },
        "subclassfeature7": {
            name: "Relentless Avenger",
            source: [
                ["P24", 117]
            ],
            minlevel: 7,
            description: desc([
                "When I hit with an Opp Attack, I reduce the target's Speed to 0 until the end of the current turn.",
                "I can move up to half my Speed as part of the same Reaction without provoking Opp Attacks.",
            ]),
        },
        "subclassfeature15": {
            name: "Soul of Vengeance",
            source: [
                ["P24", 117]
            ],
            minlevel: 15,
            description: "\n   " + "When an enemy I have an active Vow of Enmity against makes an attack, I can react" + "\n   " + "As a reaction, I can make a melee weapon attack against it if it is within range",
            action: [
                ["reaction", " (with Vow of Enmity)"]
            ]
        },
        "subclassfeature20": {
            name: "Avenging Angel",
            source: [
                ["P24", 117]
            ],
            minlevel: 20,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            altResource: "SS 5",
            description: desc([
                "As a Bonus Action, I can gain the benefits below for 10 min or until I end them.",
                "Flight: I sprout spectral wings on my back, I have a Fly speed of 60 ft and can hover.",
                "Frightful Aura: When an enemy starts its turn in my Aura it must pass a Wis saving throw.",
                "On a failed save it is Frightened for 1 min or until it takes damage. Attacks against it have Adv.",
                "I can also restore this feature by spending a level 5 spell slot.",
            ]),
            additional: levels.map(function(n) {
                return n < 20 ? "" : (n < 18 ? 10 : 30) + "-foot aura";
            }),
        },
    },
});
legacyClassRefactor("ranger", {
    regExpSearch: /ranger/i,
    name: "Ranger",
    source: [
        ["P24", 119]
    ],
    primaryAbility: "Dexterity and Wisdom",
    prereqs: "Dexterity 13 and Wisdom 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 10,
    saves: ["Str", "Dex"],
    skillstxt: {
        primary: "Choose 3: Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, or Survival.",
        secondary: "Choose 1: Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, or Survival.",
    },
    armorProfs: {
        primary: [true, true, false, true],
        secondary: [true, true, false, true],
    },
    weaponProfs: {
        primary: [true, true],
        secondary: [false, true],
    },
    equipment: "Ranger starting equipment:" +
        "\n \u2022 Studded Leather Armor;" +
        "\n \u2022 Scimitar;" +
        "\n \u2022 Shortsword;" +
        "\n \u2022 Longbow and Quiver of 20 Arrows;" +
        "\n \u2022 Druidic Focus (sprig of mistletoe);" +
        "\n \u2022 Explorer's Pack and 7 gp;" +
        "\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Ranger Subclass", []],
    attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    spellcastingFactor: 2,
    spellcastingAbility: 5,
    spellcastingKnown: {
        spells: "list",
        prepared: [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15],
    },
    spellcastingFactorRoundupMulti: true,
    spellcastingTable: [
        [0, 0, 0, 0, 0, 0, 0, 0, 0]
    ].concat(levels.map(function(n) {
        return defaultSpellTable[Math.ceil(n / 2)];
    })),
    features: {
        "favored enemy": {
            name: "Favored Enemy",
            source: [
                ["P24", 119]
            ],
            minlevel: 1,
            usages: [2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6],
            recovery: "LR",
            altResource: "SS",
            calcChanges: {
                spellAdd: [
                    function(spellKey, spellObj, spName) {
                        // only change the spell if it's from ranger's CurrentSpells object.
                        if (spellKey === "hunter's mark" && spName === "ranger") {
                            spellObj.firstCol = "markedbox"; // Always prepared

                        }
                    }
                ]
            },
            description: desc([
                "I always have the Hunter's Mark spell prepared and can cast it a number of times without expending a spell slot per long rest.",
            ]),
        },
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 119]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var splls = [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15][idx];
                return splls + " spells prepared";
            }),
            description: desc([
                "I can cast ranger spells using Wis as my casting ability.",
                "I can use a Druidic Focus as a spellcasting focus.",
                "I can change one prepared spell at the end of a long rest.",
            ]),
        },
        "weapon mastery": {
            name: "Weapon Mastery",
            source: [
                ["P24", 120]
            ],
            minlevel: 1,
            description: desc([
                "I can use the Mastery properties of two Weapon types.",
                "I can change these Weapon types after a Long Rest.",
            ]),
            additional: ["2 Weapon Masteries"],
            extraname: "Weapon Mastery",
            extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
            extraTimes: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
            "club": {
                name: "Club",
                description: desc([
                    "I gain access to the Club's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "dagger": {
                name: "Dagger",
                description: desc([
                    "I gain access to the Dagger's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "greatclub": {
                name: "Greatclub",
                description: desc([
                    "I gain access to the Greatclub's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "handaxe": {
                name: "Handaxe",
                description: desc([
                    "I gain access to the Handaxe's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "javelin": {
                name: "Javelin",
                description: desc([
                    "I gain access to the Javelin's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "light hammer": {
                name: "Light Hammer",
                description: desc([
                    "I gain access to the Light Hammer's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "mace": {
                name: "Mace",
                description: desc([
                    "I gain access to the Mace's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "quarterstaff": {
                name: "Quarterstaff",
                description: desc([
                    "I gain access to the Quarterstaff's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "sickle": {
                name: "Sickle",
                description: desc([
                    "I gain access to the Sickle's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "spear": {
                name: "Spear",
                description: desc([
                    "I gain access to the Spear's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "dart": {
                name: "Dart",
                description: desc([
                    "I gain access to the Dart's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "light crossbow": {
                name: "Light Crossbow",
                description: desc([
                    "I gain access to the Light Crossbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "shortbow": {
                name: "Shortbow",
                description: desc([
                    "I gain access to the Shortbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "sling": {
                name: "Sling",
                description: desc([
                    "I gain access to the Sling's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "battleaxe": {
                name: "Battleaxe",
                description: desc([
                    "I gain access to the Battleaxe's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "flail": {
                name: "Flail",
                description: desc([
                    "I gain access to the Flail's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "glaive": {
                name: "Glaive",
                description: desc([
                    "I gain access to the Glaive's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "greataxe": {
                name: "Greataxe",
                description: desc([
                    "I gain access to the Greataxe's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "greatsword": {
                name: "Greatsword",
                description: desc([
                    "I gain access to the Greatsword's 'Graze' Mastery feature",
                    "Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
                ]),
            },
            "halberd": {
                name: "Halberd",
                description: desc([
                    "I gain access to the Halberd's 'Cleave' Mastery feature",
                    "Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
                ]),
            },
            "lance": {
                name: "Lance",
                description: desc([
                    "I gain access to the Lance's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "longsword": {
                name: "Longsword",
                description: desc([
                    "I gain access to the Longsword's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "maul": {
                name: "Maul",
                description: desc([
                    "I gain access to the Maul's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "morningstar": {
                name: "Morningstar",
                description: desc([
                    "I gain access to the Morningstar's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "pike": {
                name: "Pike",
                description: desc([
                    "I gain access to the Pike's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "rapier": {
                name: "Rapier",
                description: desc([
                    "I gain access to the Rapier's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "scimitar": {
                name: "Scimitar",
                description: desc([
                    "I gain access to the Scimitar's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "shortsword": {
                name: "Shortsword",
                description: desc([
                    "I gain access to the Shortsword's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "trident": {
                name: "Trident",
                description: desc([
                    "I gain access to the Trident's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "warhammer": {
                name: "Warhammer",
                description: desc([
                    "I gain access to the Warhammer's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "war pick": {
                name: "War Pick",
                description: desc([
                    "I gain access to the War Pick's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "whip": {
                name: "Whip",
                description: desc([
                    "I gain access to the Whip's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "blowgun": {
                name: "Blowgun",
                description: desc([
                    "I gain access to the Blowgun's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "hand crossbow": {
                name: "Hand Crossbow",
                description: desc([
                    "I gain access to the Hand Crossbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "heavy crossbow": {
                name: "Heavy Crossbow",
                description: desc([
                    "I gain access to the Heavy Crossbow's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "longbow": {
                name: "Longbow",
                description: desc([
                    "I gain access to the Longbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "musket": {
                name: "Musket",
                description: desc([
                    "I gain access to the Musket's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "pistol": {
                name: "Pistol",
                description: desc([
                    "I gain access to the Pistol's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
        },
        "expertise": function() {
            var a = {
                name: "Deft Explorer",
                source: [
                    ["P24", 120]
                ],
                minlevel: 2,
                description: levels.map(function(n) {
                    if (n < 2) return "";
                    var description = desc([
                        "Choose 1 skill proficiency to gain Expertise in that skill.",
                    ]);
                    if (n >= 9) {
                        description += desc([
                            "At 9th level, I gain Expertise in two additional skills of choice."
                        ]);
                    }
                    return description;
                }),
                skillstxt: "Expertise with any one skill proficiency, additional 2 at 9th level.",
                languageProfs: 2,
                additional: levels.map(function(n) {
                    return n < 2 ? "" : "with " + (n < 9 ? 1 : 3) + " skills";
                }),
                extraname: "Ranger Expertise",
                extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
                extraTimes: levels.map(function(n) {
                    return n < 9 ? 1 : 3;
                })
            };
            for (var i = 0; i < a.extrachoices.length; i++) {
                var attr = a.extrachoices[i].toLowerCase();
                a[attr] = {
                    name: a.extrachoices[i] + " Expertise",
                    description: "",
                    source: a.source,
                    skills: [
                        [a.extrachoices[i], "only"]
                    ],
                    prereqeval: function(v) {
                        return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
                    }
                };
            }
            return a;
        }(),
        "fighting style": {
            name: "Fighting Style",
            source: [
                ["P24", 120]
            ],
            minlevel: 2,
            description: desc([
                "I gain either one 'Fighting Style' or 'Druidic Warrior'.",
            ]),
            choices: ["Fighting Style [Archery]", "Fighting Style [Druidic Warrior]", "Fighting Style [Blind Fighting]", "Fighting Style [Defense]", "Fighting Style [Dueling]", "Fighting Style [Great Weapon Fighting]", "Fighting Style [Interception]", "Fighting Style [Protection]", "Fighting Style [Thrown Weapon Fighting]", "Fighting Style [Two-Weapon Fighting]", "Fighting Style [Unarmed Fighting]"],
            "fighting style [archery]": {
                name: "Fighting Style [Archery]",
                description: " I gain a +2 bonus to attack rolls I make with Ranged weapons.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
                        },
                        "My ranged weapons get a +2 bonus on the To Hit."
                    ]
                }
            },
            "fighting style [druidic warrior]": {
                name: "Fighting Style [Druidic Warrior]",
                spellcastingBonus: [{
                    name: "Druidic Warrior",
                    "class": "druid",
                    level: [0, 0],
                    times: 2,
                }],
                description: desc([
                    "I learn two Druid cantrips that count as Ranger spells; I use Wis for spellcasting.",
                    "When I gain a Ranger level I can swap one of these for another Druid cantrip.",
                ]),
            },
            "fighting style [blind fighting]": {
                name: "Fighting Style [Blind Fighting]",
                description: " I have Blindsight with a range of 10 feet.",
                vision: [
                    ["Blindsight", 10]
                ],
            },
            "fighting style [defense]": {
                name: "Fighting Style [Defense]",
                description: " While I'm wearing Light, Medium, or Heavy armor, I gain a +1 bonus to Armor Class.",
                extraAC: {
                    name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
                    mod: 1,
                    text: "I gain a +1 bonus to AC while wearing armor.",
                    stopeval: function(v) {
                        return !v.wearingArmor;
                    }
                },
            },
            "fighting style [dueling]": {
                name: "Fighting Style [Dueling]",
                description: " When I'm holding a Melee weapon in one hand and no other weapons, I gain a +2 bonus to damage rolls with that weapon.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            for (var i = 1; i <= FieldNumbers.actions; i++) {
                                if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
                            }
                            if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
                        },
                        "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
                    ]
                }
            },
            "fighting style [great weapon fighting]": {
                name: "Fighting Style [Great Weapon Fighting]",
                description: " When I roll damage for an attack I make with a Melee weapon that I am holding with two hands, I can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
                                fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
                            }
                        },
                        "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
                    ]
                },
            },
            "fighting style [interception]": {
                name: "Fighting Style [Interception]",
                description: " When a creature I can see hits another creature within 5 feet of me with an attack roll, I can take a Reaction to reduce the damage dealt to the target by 1d10 plus my Proficiency Bonus. I must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
                action: "reaction",
            },
            "fighting style [protection]": {
                name: "Fighting Style [Protection]",
                description: " When a creature I can see attacks a target other than me that is within 5 feet of me, I can take a Reaction to interpose my Shield if I'm holding one. I impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of my next turn if I remain within 5 feet of the target.",
                action: "reaction",
            },
            "fighting style [thrown weapon fighting]": {
                name: "Fighting Style [Thrown Weapon Fighting]",
                description: " When I hit with a ranged attack roll using a weapon that has the Thrown property, I gain a +2 bonus to the damage roll.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.isThrownWeapon && v.isMeleeWeapon) {
                                fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
                            }
                        },
                        "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
                    ],
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isThrownWeapon && !v.isMeleeWeapon) {
                                output.extraDmg += 2;
                            }
                        },
                        ""
                    ],
                },
            },
            "fighting style [two-weapon fighting]": {
                name: "Fighting Style [Two-Weapon Fighting]",
                description: " When I make an extra attack as a result of using a weapon that has the Light property, I can add my ability modifier to the damage to that attack if I am not already adding it to the damage.",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.isOffHand) output.modToDmg = true;
                        },
                        "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
                    ]
                },
            },
            "fighting style [unarmed fighting]": {
                name: "Fighting Style [Unarmed Fighting]",
                description: " When I hit with my Unarmed Strike and deal damage, I can deal Bludgeoning damage equal to 1d6 plus my Strength modifier instead of the normal damage of an Unarmed Strike. If I am not holding any weapons or a Shield when I make the attack roll, the d6 becomes a d8.\n At the start of each of my turns, I can deal 1d4 Bludgeoning damage to one creature Grappled by me.",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == "unarmed strike") {
                                if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
                                fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
                            }
                        },
                        "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
                        1
                    ]
                },
            },
        },
        "subclassfeature3": {
            name: "Ranger Subclass",
            source: [
                ["P24", 120]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Ranger subclass and put it in the 'Class' field.",
            ]),
        },
        "roving": {
            name: "Roving",
            source: [
                ["P24", 121]
            ],
            minlevel: 6,
            speed: {
                walk: "+10",
                climb: {
                    spd: "walk",
                    enc: "walk"
                },
                swim: {
                    spd: "walk",
                    enc: "walk"
                },
            },
            description: desc([
                "My Speed increases +10 when not wearing Heavy armor.",
                "My Climb Speed and Swim Speed equals my Speed.",
            ]),
        },
        "tireless": {
            name: "Tireless",
            source: [
                ["P24", 121]
            ],
            minlevel: 10,
            action: ["action", " Temporary Hit Points"],
            usages: "Wis mod per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "Using an action I gain Temp HP equal to 1d8 + Wis mod.",
                "A Short Rest decreases my Exhaustion level by 1.",
            ]),
        },
        "relentless hunter": {
            name: "Relentless Hunter",
            source: [
                ["P24", 121]
            ],
            minlevel: 13,
            description: desc([
                "I maintain Hunter's Mark after taking damage.",
            ]),
        },
        "nature's veil": {
            name: "Nature's Veil",
            source: [
                ["P24", 121]
            ],
            minlevel: 14,
            action: "bonus action",
            usages: "Wis mod per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "As a Bonus Action, I turn Invisible until the end of my next turn.",
                "I can do this a number times equal to my Wis mod (min 1).",
            ]),
        },
        "precise hunter": {
            name: "Precise Hunter",
            source: [
                ["P24", 121]
            ],
            minlevel: 17,
            description: desc([
                "I have Adv on attack rolls on those marked by my Hunter's Mark.",
            ]),
        },
        "feral senses": {
            name: "Feral Senses",
            source: [
                ["P24", 121]
            ],
            minlevel: 18,
            vision: [
                ["Blindsight", 30]
            ],
            description: desc([
                "I gain 30 ft Blindsight.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 121]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "foe slayer": {
            name: "Foe Slayer",
            source: [
                ["P24", 121]
            ],
            minlevel: 20,
            description: desc([
                "The damage die of my Hunter's Mark changes to d10.",
            ]),
        },
    },
});
legacySubClassRefactor("ranger", "beast master", {
    regExpSearch: /^(?=.*(ranger))(?=.*(beast))(?=.*(master)).*$/i,
    subname: "Beast Master",
    source: [
        ["P24", 122]
    ],
    features: {
        "subclassfeature3": {
            name: "Primal Companion",
            source: [
                ["P24", 122]
            ],
            minlevel: 3,
            action: [
                ["action", "Revive Companion"]
            ],
            additional: "Companion Sheet",
            description: desc([
                "Choose a primal beast using the \"Companion Options\" button on the Companion Sheet.",
                "I have my choice of a \"Beast of the Land\", a \"Beast of the Sea\", or a \"Beast of the Sky\";",
                "After summoning, I can summon a different primal beast after a Long Rest.",
            ]),
        },
        "subclassfeature7": {
            name: "Exceptional Training",
            source: [
                ["P24", 123]
            ],
            minlevel: 7,
            description: desc([
                "When I command my beast to take an action, I can also have it Dash/Disengage/Dodge/Help as a bonus action.",
                "My Primal Companion's attacks count can deal Force damage or its normal damage type.",
            ]),
        },
        "subclassfeature11": {
            name: "Bestial Fury",
            source: [
                ["P24", 123]
            ],
            minlevel: 11,
            description: desc([
                "When I command my Primal Companion to use the Attack action, it can attack twice.",
                "My Primal Companion deals extra Force damage to my Hunter's Mark target.",
                "This occurs only the 1st time, each turn, the Primal Companion hits a creature.",
            ]),
        },
        "subclassfeature15": {
            name: "Share Spells",
            source: [
                ["P24", 123]
            ],
            minlevel: 15,
            description: desc([
                "When I cast a spell on myself, I can have it also affect my Primal Companion, if within 30 ft",
            ]),
        },
    },
});
legacySubClassRefactor("ranger", "fey wanderer", {
    regExpSearch: /^(?=.*(ranger))(?=.*(fey))(?=.*(wanderer)).*$/i,
    subname: "Fey Wanderer",
    source: [
        ["P24", 124]
    ],
    spellcastingExtra: ["charm person", "misty step", "summon fey", "dimension door", "mislead"],
    features: {
        "subclassfeature3": {
            name: "Dreadful Strikes",
            source: [
                ["P24", 124]
            ],
            minlevel: 3,
            description: desc([
                "My weapons deal extra psychic damage, but only once per turn per creature"
            ]),
            additional: levels.map(function(n) {
                return n < 3 ? "" : "+1d" + (n < 11 ? 4 : 6) + " psychic damage";
            }),
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (v.isWeapon && (classes.known.ranger || classes.known.rangerua)) {
                            var rngrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.rangerua.level;
                            fields.Description += (fields.Description ? '; ' : '') + 'Once per turn per target +1d' + (rngrLvl < 11 ? 4 : 6) + ' psychic damage';
                        }
                    },
                    "When I hit a creature with a weapon, I can deal an extra 1d4 psychic damage to the target, which can take this extra damage only once per turn. From 11th-level, this damage increases to 1d6.",
                ]
            }
        },
        "subclassfeature3.2": {
            name: "Otherworldly Glamour",
            source: [
                ["P24", 124]
            ],
            minlevel: 3,
            description: desc([
                "I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
                'I gain proficiency in Deception, Performance, or Persuasion; Use "Choose Feature" button'
            ]),
            addMod: ["Deception", "Intimidation", "Performance", "Persuasion"].map(function(skill) {
                return {
                    type: "skill",
                    field: skill,
                    mod: "max(Wis|1)",
                    text: "I can add my Wisdom modifier to any Charisma check I make (minimum of +1)."
                };
            }),
            choices: ["Deception proficiency", "Performance proficiency", "Persuasion proficiency"],
            "deception proficiency": {
                name: "Otherworldly Glamour",
                description: " [Deception proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
                skills: ["Deception"]
            },
            "performance proficiency": {
                name: "Otherworldly Glamour",
                description: " [Performance proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
                skills: ["Performance"]
            },
            "persuasion proficiency": {
                name: "Otherworldly Glamour",
                description: " [Persuasion proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
                skills: ["Persuasion"]
            }
        },
        "subclassfeature7": {
            name: "Beguiling Twist",
            source: [
                ["P24", 125]
            ],
            minlevel: 7,
            action: "reaction",
            savetxt: {
                adv_vs: ["Charmed", "Frightened"]
            },
            description: desc([
                "I have advantage on saves against being charmed or frightened.",
                "As a reaction when a creature I see in 120 ft succeeds its save vs. charmed or frightened,",
                "I can have another I see in 120 ft make a Wis save or be charmed/frightened (my choice).",
                "This lasts for 1 minute and the target can repeat the save at the end of each of its turns"
            ]),
        },
        "subclassfeature11": {
            name: "Fey Reinforcements",
            source: [
                ["P24", 125]
            ],
            minlevel: 11,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I learn Summon Fey; It needs no material component, nor counts against spells known.",
                "Once per long rest, I can cast it without expending a spell slot.",
                "When cast, I can have it not require concentration, its duration becomes 1 minute"
            ]),
        },
        "subclassfeature15": {
            name: "Misty Wanderer",
            source: [
                ["P24", 125]
            ],
            minlevel: 15,
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "I can cast Misty Step without expending a spell slot and can bring a willing creature within 5 ft",
                "That creature teleports to an unoccupied space of my choice within 5 ft of my destination.",
            ]),
        },
    },
});
legacySubClassRefactor("ranger", "gloom stalker", {
    regExpSearch: /^(?=.*(ranger))(?=.*(gloom))(?=.*(stalker)).*$/i,
    subname: "Gloom Stalker",
    source: [
        ["P24", 125]
    ],
    spellcastingExtra: ["disguise self", "rope trick", "fear", "greater invisibility", "seeming"],
    features: {
        "subclassfeature3": {
            name: "Dread Ambusher",
            source: [
                ["P24", 125]
            ],
            minlevel: 3,
            addMod: [{
                type: "skill",
                field: "Init",
                mod: "Wis",
                text: "I can add my Wisom modifier to initiative rolls."
            }, ],
            usages: "Wisdom modifier per ",
            usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
            recovery: "long rest",
            description: desc([
                "I can add my Wisdom modifier to my initiative rolls, and I get +10 ft speed",
                "in the first turn of combat.",
                "Additionally, once per turn when I hit with a weapon, I can deal +2d6 Psychic",
                "damage to my target. ",
                "I can do this a number equal to my Wis Mod per Long Rest.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Umbral Sight",
            source: [
                ["P24", 126]
            ],
            minlevel: 3,
            vision: [
                ["Darkvision", "fixed 60"],
                ["Darkvision", "+60"]
            ],
            description: desc([
                "I gain 60 ft Darkvision, or add 60 ft, if I already had it from any source.",
                "When I'm entirely in darkness, I have the Invisible condition to any creature",
                "that relies on Darkvision to see me in that darkness.",
            ]),
        },
        "subclassfeature7": {
            name: "Iron Mind",
            source: [
                ["P24", 126]
            ],
            minlevel: 7,
            saves: ["Wis"],
            description: desc([
                "I gain proficiency in Wis saves. If already proficient, choose either Int or Cha.",
            ]),
        },
        "subclassfeature11": {
            name: "Stalker's Flurry",
            source: [
                ["P24", 126]
            ],
            minlevel: 11,
            description: desc([
                "When I use the Frighten effect of Dread Ambusher, I can do one of the following:",
                " \u2022 Sudden Strike. I can attack another creature within 5 ft of the original target that is within",
                "  weapon range.",
                " \u2022 Mass Fear. Each creature within 10 ft of the target makes Wis save or be Frightened until start ",
                "  of my next turn.",
            ]),
        },
        "subclassfeature15": {
            name: "Shadowy Dodge",
            source: [
                ["P24", 126]
            ],
            minlevel: 15,
            action: ["reaction", " (when attacked)"],
            description: desc([
                "As a reaction when I'm attacked, I can impose Disadv. on the attack roll.",
                "If the attack then misses, I can teleport up to 30 ft",
            ]),
        },
    },
});
legacySubClassRefactor("ranger", "hunter", {
    regExpSearch: /^(?=.*(ranger))(?=.*(hunter)).*$/i,
    subname: "Hunter",
    source: [
        ["P24", 127]
    ],
    features: {
        "subclassfeature3": {
            name: "Hunter's Lore",
            source: [
                ["P24", 127]
            ],
            minlevel: 3,
            description: desc([
                "While a creature is marked by my Hunter's Mark, I know the following about it:",
                "Damage/condition immunities, damage resistances, and/or damage vulnerabilities.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Hunter's Prey",
            source: [
                ["P24", 127]
            ],
            minlevel: 3,
            choices: ["Colossus Slayer", "Horde Breaker"],
            "colossus slayer": {
                name: "Colossus Slayer",
                description: desc([
                    "Once per turn, when I hit a creature with a weapon, I deal an extra 1d8 damage to the target if it's missing any Hit Points. After a Short or Long Rest, I can replace this feature with the 'Horde Breaker' feature.",
                ]),
            },
            "horde breaker": {
                name: "Horde Breaker",
                description: desc([
                    "Once per turn, when I hit a creature, I can make an attack vs. another within 5 ft of it if I haven't hit it during this turn. After a Short or Long Rest, I can replace this feature with the 'Colossus Slayer' feature."
                ]),
            },
            description: desc([
                "Use the 'choose feature' button to select a Hunter's Prey option, after a Short or Long Rest, I can replace the chosen option with the other one.",
            ]),
        },
        "subclassfeature7": {
            name: "Defensive Tactics",
            source: [
                ["P24", 127]
            ],
            minlevel: 7,
            choices: ["Escape the Horde", "Multiattack Defense"],
            "escape the horde": {
                name: "Escape the Horde",
                description: desc([
                    "Opportunity Attacks have Disadvantage against me. After a Short or Long Rest, I can replace this feature with the 'Multiattack Defense' feature.",
                ]),
            },
            "multiattack defense": {
                name: "Multiattack Defense",
                description: desc([
                    "When a creature hits me with an attack roll, that creature has Disadvantage on all other attack rolls against me this turn. After a Short or Long Rest, I can replace this feature with the 'Escape the Horde' feature.",
                ]),
            },
            description: desc([
                "Use the 'choose feature' button to select a Defensive Tactics option, After a Short or Long Rest, I can replace the chosen option with the other one.",
            ]),
        },
        "subclassfeature11": {
            name: "Superior Hunter's Prey",
            source: [
                ["P24", 127]
            ],
            minlevel: 11,
            description: desc([
                "Once per turn when I deal damage to a creature marked by my Hunter's mark, I can also deal the extra damage to another creature I can see within 30 feet.",
            ]),
        },
        "subclassfeature15": {
            name: "Superior Hunter's Defense",
            source: [
                ["P24", 127]
            ],
            minlevel: 15,
            action: ["reaction", " (taking damage)"],
            description: desc([
                "When I take damage, I can take a Reaction to give myself Resistance to that damage and any other damage of the same type until the end of the current turn.",
            ]),
        },
    },
});
legacyClassRefactor("rogue", {
    regExpSearch: /rogue/i,
    name: "Rogue",
    source: [
        ["P24", 129]
    ],
    primaryAbility: "Dexterity",
    prereqs: "Dexterity 13",
    abilitySave: 2,
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 5, 5, 5, 6, 6],
    die: 8,
    saves: ["Dex", "Int"],
    skillstxt: {
        primary: "Choose 4: Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, or Stealth",
        secondary: "Choose 1: Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, or Stealth",
    },
    toolProfs: {
        primary: [
            ["Thieves' Tools"]
        ],
        secondary: [
            ["Thieves' Tools"]
        ],
    },
    armorProfs: {
        primary: [true, false, false, false],
        secondary: [true, false, false, false],
    },
    weaponProfs: {
        primary: [true, false, ["scimitar", "shortsword", "hand crossbow", "rapier", "whip"]],
    },
    equipment: "Rogue starting equipment:" +
        "\n \u2022 Leather Armor;" +
        "\n \u2022 2 Daggers;" +
        "\n \u2022 Shortsword;" +
        "\n \u2022 Shortbow and a Quiver of 20 Arrows;" +
        "\n \u2022 Thieves' Tools;" +
        "\n \u2022 Burglar's Pack, and 8 gp;" +
        "\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Rogue Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    features: {
        "expertise": function() {
            var a = {
                name: "Expertise",
                source: [
                    ["P24", 129]
                ],
                minlevel: 1,
                description: desc("I gain expertise with any two of my skill proficiencies and two more at 6th level."),
                skillstxt: "Expertise with any two skill proficiencies, and two more at 6th level",
                additional: levels.map(function(n) {
                    return n < 1 ? "" : "with " + (n < 6 ? 2 : 4) + " skills";
                }),
                extraname: "Rogue Expertise",
                extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
                extraTimes: levels.map(function(n) {
                    return n < 1 ? 0 : n < 6 ? 2 : 4;
                })
            };
            for (var i = 0; i < a.extrachoices.length; i++) {
                var attr = a.extrachoices[i].toLowerCase();
                a[attr] = {
                    name: a.extrachoices[i] + " Expertise",
                    description: "",
                    source: a.source,
                    skills: [
                        [a.extrachoices[i], "only"]
                    ],
                    prereqeval: function(v) {
                        return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
                    }
                };
            }
            return a;
        }(),
        "sneak attack": {
            name: "Sneak Attack",
            source: [
                ["P24", 129]
            ],
            minlevel: 1,
            additional: ["1d6", "1d6", "2d6", "2d6", "3d6", "3d6", "4d6", "4d6", "5d6", "5d6", "6d6", "6d6", "7d6", "7d6", "8d6", "8d6", "9d6", "9d6", "10d6", "10d6"],
            description: desc([
                "Once per turn, I can add damage to a finesse/ranged weapon attack if I have Adv or a conscious ally is within 5 ft of the target & I don't have Disadv.",
            ]),
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (classes.known.rogue && classes.known.rogue.level && !v.isSpell && !v.isDC && (v.isRangedWeapon || (/\bfinesse\b/i).test(fields.Description))) {
                            v.sneakAtk = Math.ceil(classes.known.rogue.level / 2);
                            fields.Description += (fields.Description ? '; ' : '') + 'Sneak attack ' + v.sneakAtk + 'd6';
                        }
                    },
                    "Once per turn, when I attack with a ranged or finesse weapon while I have advantage or an conscious ally is within 5 ft of the target, I can add my sneak attack damage to the attack.",
                    700
                ]
            }
        },
        "thieves' cant": {
            name: "Thieves' Cant",
            source: [
                ["P24", 129]
            ],
            minlevel: 1,
            languageProfs: [
                ["Thieves' Cant"],
                ["Additional Language", 1]
            ],
            description: desc([
                "I know Thieves' Cant and one other language of my choice.",
            ]),
        },
        "weapon mastery": {
            name: "Weapon Mastery",
            source: [
                ["P24", 129]
            ],
            minlevel: 1,
            description: desc([
                "I choose two weapons I'm proficient with & gain their mastery features.",
                "I can change these on a long rest; Use Choose Feature above to pick. (See page 3)",
            ]),
            additional: ["2 Weapon Masteries"],
            extraname: "Weapon Mastery",
            extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Rapier", "Scimitar", "Shortsword", "Whip", "Hand Crossbow"],
            extraTimes: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
            "club": {
                name: "Club",
                description: desc([
                    "I gain access to the Club's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "dagger": {
                name: "Dagger",
                description: desc([
                    "I gain access to the Dagger's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "greatclub": {
                name: "Greatclub",
                description: desc([
                    "I gain access to the Greatclub's 'Push' Mastery feature",
                    "Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
                ]),
            },
            "handaxe": {
                name: "Handaxe",
                description: desc([
                    "I gain access to the Handaxe's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "javelin": {
                name: "Javelin",
                description: desc([
                    "I gain access to the Javelin's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "light hammer": {
                name: "Light Hammer",
                description: desc([
                    "I gain access to the Light Hammer's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "mace": {
                name: "Mace",
                description: desc([
                    "I gain access to the Mace's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "quarterstaff": {
                name: "Quarterstaff",
                description: desc([
                    "I gain access to the Quarterstaff's 'Topple' Mastery feature",
                    "Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
                ]),
            },
            "sickle": {
                name: "Sickle",
                description: desc([
                    "I gain access to the Sickle's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "spear": {
                name: "Spear",
                description: desc([
                    "I gain access to the Spear's 'Sap' Mastery feature",
                    "Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
                ]),
            },
            "dart": {
                name: "Dart",
                description: desc([
                    "I gain access to the Dart's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "light crossbow": {
                name: "Light Crossbow",
                description: desc([
                    "I gain access to the Light Crossbow's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "shortbow": {
                name: "Shortbow",
                description: desc([
                    "I gain access to the Shortbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "sling": {
                name: "Sling",
                description: desc([
                    "I gain access to the Sling's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "rapier": {
                name: "Rapier",
                description: desc([
                    "I gain access to the Rapier's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "scimitar": {
                name: "Scimitar",
                description: desc([
                    "I gain access to the Scimitar's 'Nick' Mastery feature",
                    "Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
                ]),
            },
            "shortsword": {
                name: "Shortsword",
                description: desc([
                    "I gain access to the Shortsword's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
            "whip": {
                name: "Whip",
                description: desc([
                    "I gain access to the Whip's 'Slow' Mastery feature",
                    "Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
                ]),
            },
            "hand crossbow": {
                name: "Hand Crossbow",
                description: desc([
                    "I gain access to the Hand Crossbow's 'Vex' Mastery feature",
                    "Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
                ]),
            },
        },
        "cunning action": {
            name: "Cunning Action",
            source: [
                ["P24", 130]
            ],
            minlevel: 2,
            action: [
                ["bonus action", "Dash/Disengage/Hide"]
            ],
            description: desc([
                "On my turn, I can take one of these actions as a Bonus Action: Dash, Disengage, or Hide.",
            ]),
        },
        "subclassfeature3": {
            name: "Rogue Subclass",
            source: [
                ["P24", 130]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Rogue subclass and put it in the 'Class' field.",
            ]),
        },
        "steady aim": {
            name: "Steady Aim",
            source: [
                ["P24", 130]
            ],
            minlevel: 3,
            action: ["bonus action", ""],
            description: desc([
                "If I haven't moved on my turn I can use my Bonus Action and give up my Movement for Advantage on my next attack roll this turn.",
            ]),
        },
        "cunning strike": {
            name: "Cunning Strike",
            source: [
                ["P24", 130]
            ],
            minlevel: 5,
            description: desc([
                "When I deal Sneak Attack damage I can add one of the following Cunning Strike effects at the cost of Sneak Attack damage dice:",
                "Poison (Cost 1d6): If I possess a Poisoner's Kit, on a failed Con save the target is Poisoned for 1 min. It repeats the save at the end of each of its turns, ending it on a success.",
                "Trip (Cost 1d6): If the target is Large or smaller it must pass a Dex save or fall Prone.",
                "Withdraw (Cost 1d6): Right after I attack I move up to half my Speed without provoking Opp Attacks.",
                "If a Cunning Strike effect requires a saving throw the DC is 8 + Dex mod + Prof Bonus.",
            ]),
        },
        "uncanny dodge": {
            name: "Uncanny Dodge",
            source: [
                ["P24", 131]
            ],
            minlevel: 5,
            action: "reaction",
            description: desc([
                "As a reaction, I can halve the damage of an attack from an attacker I can see (round down).",
            ]),
        },
        "evasion": {
            name: "Evasion",
            source: [
                ["P24", 131]
            ],
            minlevel: 7,
            description: desc([
                "When not Incapacitated and must make a Dex save to take half damage on an effect I take no damage on a pass & half damage on a fail."
            ]),
            savetxt: {
                text: ["When not Incapacitated Dex saves: fail \u2015 half dmg, success \u2015 no dmg"]
            },
        },
        "reliable talent": {
            name: "Reliable Talent",
            source: [
                ["P24", 131]
            ],
            minlevel: 7,
            description: desc([
                "When I make an ability check that uses one of my skill or tool proficiencies, d20 rolls of 9 or lower are 10.",
            ]),
        },
        "improved cunning strike": {
            name: "Improved Cunning Strike",
            source: [
                ["P24", 131]
            ],
            minlevel: 11,
            description: desc([
                "Use up to two Cunning Strike effects when I deal Sneak Attack damage, paying the cost for each.",
            ]),
        },
        "devious strikes": {
            name: "Devious Strikes",
            source: [
                ["P24", 131]
            ],
            minlevel: 14,
            description: desc([
                "These effects are now among my Cunning Strike options:",
                "Dose (Cost 2d6) : Target must pass a Con save or on its next turn it can do only one: move/action/Bonus Action.",
                "Knock Out (Cost 6d6) : Target must pass a Con save or be Unconscious for 1 min or until damaged.",
                "It repeats the save at the end of each of its turns, ending the effect on a pass.",
                "Obscure (Cost 3d6) : Target must pass a Dex save or be Blinded until the end of its next turn.",
            ]),
        },
        "slippery mind": {
            name: "Slippery Mind",
            source: [
                ["P24", 131]
            ],
            minlevel: 15,
            saves: ["Wis", "Cha"],
            description: desc([
                "I gain proficiency in Wis and Cha saves.",
            ]),
        },
        "elusive": {
            name: "Elusive",
            source: [
                ["P24", 131]
            ],
            minlevel: 18,
            description: desc([
                "No attack roll can have Advantage against me while I'm conscious.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 131]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "stroke of luck": {
            name: "Stroke of Luck",
            source: [
                ["P24", 131]
            ],
            minlevel: 20,
            usages: 1,
            recovery: "short rest",
            description: desc([
                "Once per rest if I fail a D20 roll I can turn the roll into a 20.",
            ]),
        },
    },
});
legacySubClassRefactor("rogue", "arcane trickster", {
    regExpSearch: /^(?=.*(rogue))(?=.*(arcane))(?=.*(trickster)).*$/i,
    subname: "Arcane Trickster",
    source: [
        ["P24", 132]
    ],
    spellcastingFactor: 3,
    spellcastingAbility: 4,
    spellcastingList: {
        "class": "wizard",
        level: [0, 4],
    },
    spellcastingKnown: {
        cantrips: [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        spells: [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 11, 12, 13],
        prepared: false,
    },
    features: {
        "subclassfeature3": {
            name: "Spellcasting",
            source: [
                ["P24", 132]
            ],
            minlevel: 3,
            additional: levels.map(function(n, idx) {
                var cantr = [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3][idx];
                var splls = [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13][idx];
                return "Mage Hand \u0026 " + cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast prepared level 1+ Wizard spells using Int as my spellcasting ability.",
                "I can use an Arcane Focus as a spellcasting focus for my spells.",
                "I can change one prepared spell and one cantrip when I gain a Rogue level.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Mage Hand Legerdemain",
            source: [
                ["P24", 133]
            ],
            minlevel: 3,
            action: [
                ["bonus action", ""]
            ],
            spellcastingBonus: [{
                name: "Mage Hand",
                spells: ["mage hand"],
                selection: ["mage hand"],
                times: 1,
            }],
            spellChanges: {
                "mage hand": {
                    time: "1 bns",
                    description: "Invisible Spectral hand does simple task and can make Dex (Sleight of Hand) checks in 30ft; carries up to 10 lb; 1 bns to control again; only 1 instance ",
                    changes: "My Mage Hand Legerdemain class feature expands my use of the Mage Hand cantrip and makes the spectral hand invisible."
                },
            },
            description: desc([
                "I can cast Mage Hand as a Bonus Action, and make the spectral hand Invisible.",
                "I can control it as a Bonus Action, and through it can make Dex (Sleight of Hand) checks.",
            ]),
        },
        "subclassfeature9": {
            name: "Magical Ambush",
            source: [
                ["P24", 133]
            ],
            minlevel: 9,
            description: desc([
                "If I'm Invisible when I cast a spell on a creature it has Disadv on saving throws against the spell on the same turn.",
            ]),
        },
        "subclassfeature13": {
            name: "Versatile Trickster",
            source: [
                ["P24", 133]
            ],
            minlevel: 13,
            description: desc([
                "I can use Mage Hand to use the Trip option of my Cunning Strike on a creature within 5ft of the hand when I use it on another creature.",
            ]),
        },
        "subclassfeature17": {
            name: "Spell Thief",
            source: [
                ["P24", 133]
            ],
            minlevel: 17,
            description: desc([
                "Once per long rest as a reaction I can force a creature to make an Int save (my spell save DC) after it casts a spell that targets me.",
                "On a failed save the spell is negated and stolen if it's level 1+ and of a level I can cast.",
                "I have it prepared and the creature can't cast it for the next 8 hours.",
            ]),
        },
    },
});
legacySubClassRefactor("rogue", "assassin", {
    regExpSearch: /^(?=.*(rogue))(?=.*(assassin)).*$/i,
    subname: "Assassin",
    source: [
        ["P24", 133]
    ],
    features: {
        "subclassfeature3": {
            name: "Assassinate",
            source: [
                ["P24", 134]
            ],
            minlevel: 3,
            description: desc([
                "Initiative: I have Advantage on Initiative rolls.",
                "Surprising Strikes: During the first round of combat:",
                "I have Advantage on attack rolls against any creature that hasn't taken a turn yet.",
                "If my Sneak Attack hits it does extra damage (my Rogue level) of the weapon's type.",
            ]),
            advantages: [
                ["Initiative", true]
            ],
        },
        "subclassfeature3.1": {
            name: "Assassin's Tools",
            source: [
                ["P24", 134]
            ],
            minlevel: 3,
            toolProfs: [
                ["Disguise Kit"],
                ["Poisoner's Kit"]
            ],
            description: desc([
                "I gain a Disguise Kit and a Poisoner's Kit, and I have proficiency with them.",
            ]),
        },
        "subclassfeature9": {
            name: "Infiltration Expertise",
            source: [
                ["P24", 134]
            ],
            minlevel: 9,
            description: desc([
                "Masterful Mimicry: After 1 hour of study I can mimic another person's speech, handwriting, or both.",
                "Roving Aim: My Speed isn't reduced to 0 by using Steady Aim.",
            ]),
        },
        "subclassfeature13": {
            name: "Envenom Weapons",
            source: [
                ["P24", 134]
            ],
            minlevel: 13,
            description: desc([
                "Targets of the Poison option of my Cunning Strike also take 2d6 Poison damage on a failed save.",
            ]),
        },
        "subclassfeature17": {
            name: "Death Strike",
            source: [
                ["P24", 134]
            ],
            minlevel: 17,
            additional: "DC 8 + Dex + Prof",
            description: desc([
                "When I hit with my Sneak Attack on the first round of combat, the target must succeed on a Con save or take double damage.",
            ]),
        },
    },
});
legacySubClassRefactor("rogue", "soulknife", {
    regExpSearch: /^(?=.*(rogue))(?=.*(soulknife)).*$/i,
    subname: "Soulknife",
    source: [
        ["P24", 135]
    ],
    features: {
        "subclassfeature3": {
            name: "Psionic Power",
            source: [
                ["P24", 135]
            ],
            minlevel: 3,
            additional: ["", "", "Psionic Energy Die 4 d6", "Psionic Energy Die 4 d6", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d10", "Psionic Energy Die 8 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12"],
            description: desc([
                "I gain Psionic Energy Dice (PsiD), which fuel certain powers from this subclass.",
                "Features in this subclass that use a PsiD use only dice from this subclass. I can't use powers if all dice are expended.",
                "I regain one die when I finish a Short Rest and all when I finish a Long Rest.",
                "Psi-Bolstered Knack: If I fail an ability check using a skill or tool I'm proficient with, I can roll one PsiD and add the number rolled. The die is spent only if the roll succeeds.",
                "Psychic Whispers: As a Magic action, I can choose one or more creatures I can see up to my Prof Bonus, then roll one PsiD. For that number of hours, the chosen creatures can speak telepathically with me and vice versa when within 1 mile of each other (no action). A creature can end the telepathic connection at any time (no action).",
                "The first time I use this power after each Long Rest, I don't spend a PsiD.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Psychic Blades",
            source: [
                ["P24", 136]
            ],
            minlevel: 3,
            action: [
                ["bonus action", "Psychic Blade (after Attack action)"]
            ],
            description: desc([
                "As part of an Attack or Opportunity Attack, I can manifest a Psychic Blade in my free hand to attack. The magic blade has the following traits;",
                "Simple Melee, 1d6 Psychic + Ability mod damage, Finesse, Thrown (range 60/120 feet).",
                "Mastery: Vex: If I damage a creature with this I have Adv. on my next attack roll against it before the end of my next turn. (Doesn't count against class Weapon Masteries).",
                "The blade vanishes immediately after it hits or misses and leaves no mark.",
                "As a bonus action after this attack, I can manifest a second psychic blade on the same turn.",
                "My other hand must be free. The damage die of the bonus attack is 1d4.",
            ]),
            weaponOptions: [{
                regExpSearch: /^(?=.*psychic)(?=.*blade).*$/i,
                name: "Psychic Blade",
                source: [
                    ["P24", 136]
                ],
                ability: 2,
                type: "Simple",
                damage: [1, 6, "psychic"],
                range: "Melee, 60/120 ft",
                description: "Finesse, Thrown, Vex; Bonus action: 1d4 instead of 1d6",
                abilitytodamage: true,
                selectNow: true
            }]
        },
        "subclassfeature9": {
            name: "Soul Blades",
            source: [
                ["P24", 136]
            ],
            minlevel: 9,
            description: desc([
                "I can use more powers with my Psychic Blades.",
                "Homing Strikes: If I miss an attack roll with my Psychic Blade, I can roll one Psionic Energy Die (PsiD) and add it to the attack roll. If the attack hits the die is spent.",
                "Psychic Teleportation: As a Bonus Action, I manifest a Psychic Blade, spend one PsiD roll it, and throw the blade at an unoccupied space I can see up to 10 times the die roll feet away and teleport to that space. The blade vanishes.",
            ]),
        },
        "subclassfeature13": {
            name: "Psychic Veil",
            source: [
                ["P24", 136]
            ],
            minlevel: 13,
            usages: 1,
            recovery: "long rest",
            altResource: "1 PsiD",
            description: desc([
                "As a Magic action, I become Invisible for 1 hour or until I dismiss it (no action).",
                "It ends immediately after I deal damage to or force a creature to make a save.",
                "I can spend a Psionic Energy Die (no action) to restore it. It returns after a Long Rest.",
            ]),
        },
        "subclassfeature17": {
            name: "Rend Mind",
            source: [
                ["P24", 136]
            ],
            minlevel: 17,
            usages: 1,
            recovery: "long rest",
            altResource: "3 PsiD",
            description: desc([
                "When I deal Sneak Attack damage to a creature with my Psychic Blades I can force it to make a Wis save (DC 8 + Dex mod + Prof Bonus). On a fail, it's Stunned for 1 min. It repeats the save at the end of each of its turns, ending it on a pass.",
                "I can spend 3 Psionic Energy Die (no action) to restore it. It returns after a Long Rest.",
            ]),
        },
    },
});
legacySubClassRefactor("rogue", "thief", {
    regExpSearch: /^(?=.*(rogue))(?=.*(thief)).*$/i,
    subname: "Thief",
    source: [
        ["P24", 137]
    ],
    features: {
        "subclassfeature3": {
            name: "Fast Hands",
            source: [
                ["P24", 137]
            ],
            minlevel: 3,
            action: ["bonus action", "Pick Lock/Disarm Trap/Utilize Item/Activate Magic Item"],
            description: desc([
                "I can do these as a bonus action:",
                "Sleight of Hand: Make a Dex (Sleight of Hand) check to pick a lock/disarm a trap or pick a pocket.",
                "Use an Object: Take the Utilize action, or take the Magic action to use a magic item that requires one.",
            ]),
        },
        "subclassfeature6": {
            name: "Second-Story Work",
            source: [
                ["P24", 137]
            ],
            minlevel: 3,
            speed: {
                climb: {
                    spd: "walk",
                    enc: "walk"
                }
            },
            description: desc([
                "I gain a Climb Speed equal to my Speed and can determine my jump distance using Dex.",
            ]),
        },
        "subclassfeature9": {
            name: "Supreme Sneak",
            source: [
                ["P24", 137]
            ],
            minlevel: 9,
            description: desc([
                "I gain the following Cunning Strike option:",
                "Stealth Attack (Cost 1d6): This attack doesn't end Hiding if I end the turn behind Three-Quarters or Total Cover.",
            ]),
        },
        "subclassfeature13": {
            name: "Use Magic Device",
            source: [
                ["P24", 137]
            ],
            minlevel: 13,
            description: desc([
                "Attunement: I can attune to up to four magic items at once.",
                "Charges: When I use a magic item property with charges, a 6 on a 1d6 roll means no charges are used.",
                "Scrolls: I can use any Spell Scroll, using Int as my spellcasting ability. Level 2+ spells require an Int (Arcana) check (DC 10 + Spell Level) to cast or the scroll disintegrates.",
            ]),
        },
        "subclassfeature17": {
            name: "Thief's Reflexes",
            source: [
                ["P24", 137]
            ],
            minlevel: 17,
            description: desc([
                "I can take two turns during the first round of any combat at my normal Initiative and my second turn at my Initiative - 10.",
            ]),
        },
    },
});
legacyClassRefactor("sorcerer", {
    regExpSearch: /sorcerer/i,
    name: "Sorcerer",
    source: [
        ["P24", 139]
    ],
    primaryAbility: ["Charisma"],
    abilitySave: 6,
    prereqs: "Charisma 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 6,
    saves: ["Con", "Cha"],
    skillstxt: {
        primary: "Choose 2: Arcana, Deception, Insight, Intimidation, Persuasion, or Religion",
    },
    armorProfs: {
        primary: [false, false, false, false],
        secondary: [false, false, false, false],
    },
    weaponProfs: {
        primary: [true, false],
        secondary: [false, false],
    },
    equipment: "Sorcerer starting equipment:" +
        "\n \u2022 A Spear;" +
        "\n \u2022 2 Daggers;" +
        "\n \u2022 An Arcane Focus (crystal);" +
        "\n \u2022 A Dungeoneer's Pack, and 28 gp." +
        "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Sorcerer Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 6,
    spellcastingFactor: 1,
    spellcastingKnown: {
        cantrips: [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
        spells: [2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22],
        prepared: false,
    },
    features: {
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 139]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6][idx];
                var splls = [2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast Cantrips and Prepared level 1+ Sorcerer spells with Cha as my Spellcasting Ability and an Arcane Focus as my Spellcasting Focus.",
                "I can replace a cantrip and a Level 1+ spell each time I gain a Sorcerer level.",
                "Prepared spells for other Sorcerer features don't count against me & count as Sorcerer spells.",
            ]),
        },
        "innate sorcery": {
            name: "Innate Sorcery",
            source: [
                ["P24", 140]
            ],
            minlevel: 1,
            action: "bonus action",
            usages: 2,
            recovery: "long rest",
            description: desc([
                "As a Bonus Action twice per Long Rest I can gain the following benefits for 1 min:",
                "The Spell save DC of my Sorcerer spells goes up by 1.",
                "I have Adv on attack rolls of Sorcerer spells I cast.",
            ]),
        },
        "font of magic": {
            name: "Font of Magic",
            source: [
                ["P24", 140]
            ],
            minlevel: 2,
            description: desc([
                "As a bonus action, I can use sorcery points to create spell slots and vice versa",
                "I can convert spell slots to sorcery points at a rate of 1 point per spell slot level",
                "I can convert sorcery points to spell slots, which last until I finish a long rest, as follows:",
                "Level 1 for 2 sorcery points; level 2 for 3 sorcery points; level 3 for 5 sorcery points",
                "Level 4 for 6 sorcery points; level 5 for 7 sorcery points"
            ]),
            usages: [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
            recovery: "long rest",
            action: [
                ["bonus action", "Font of Magic"]
            ],
            additional: "Sorcery Points",
            limfeaname: "Sorcery Points"
        },
        "metamagic": {
            name: "Metamagic",
            source: [
                ["P24", 141]
            ],
            minlevel: 2,
            extraname: "Metamagic Options",
            extrachoices: ["Careful Spell", "Distant Spell", "Empowered Spell", "Extended Spell", "Heightened Spell", "Quickened Spell", "Seeking Spell", "Subtle Spell", "Transmuted Spell", "Twinned Spell"],
            extraTimes: [0, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6],
            description: desc([
                "Use 'Choose Feature' above to select Metamagic options. Only one can be used per spell cast unless noted. I can replace one Metamagic option when I gain a Sorcerer level.",
            ]),
            "careful spell": {
                name: "Careful Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell that forces other creatures to make a saving throw, I can protect some of those creatures from the spell's full force. To do so, spend 1 Sorcery Point and choose a number of those creatures up to my Charisma modifier (minimum of one creature). A chosen creature automatically succeeds on its saving throw against the spell, and it takes no damage if it would normally take half damage on a successful save.",
                ]),
            },
            "distant spell": {
                name: "Distant Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell that has a range of at least 5 feet, I can spend 1 Sorcery Point to double the spell's range. Or when I cast a spell that has a range of Touch, I can spend 1 Sorcery Point to make the spell's range 30 feet.",
                ]),
            },
            "empowered spell": {
                name: "Empowered Spell",
                description: desc([
                    "[1 Sorcery Point] When I roll damage for a spell, I can spend 1 Sorcery Point to reroll a number of the damage dice up to my Charisma modifier (minimum of one), and I must use the new rolls.",
                    "I can use Empowered Spell even if I've already used a different Metamagic option during the casting of the spell.",
                ])
            },
            "extended spell": {
                name: "Extended Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell that has a duration of 1 minute or longer, I can spend 1 Sorcery Point to double its duration to a maximum duration of 24 hours.",
                    "If the affected spell requires Concentration, I have Advantage on any saving throw I make to maintain Concentration.",
                ]),
            },
            "heightened spell": {
                name: "Heightened Spell",
                description: desc([
                    "[2 Sorcery Points] When I cast a spell that forces a creature to make a saving throw, I can spend 2 Sorcery Points to give one target of the spell Disadvantage on saves against the spell.",
                ]),
            },
            "quickened spell": {
                name: "Quickened Spell",
                description: desc([
                    "[2 Sorcery Points] When I cast a spell that has a casting time of an action, I can spend 2 Sorcery Points to change the casting time to a Bonus Action for this casting, I can't modify a spell in this way if I've already cast a level 1+ spell on the current turn, nor can I cast a level 1+ spell on this turn after modifying a spell in this way.",
                ]),
            },
            "seeking spell": {
                name: "Seeking Spell",
                description: desc([
                    "[1 Sorcery Point] If I make an attack roll for a spell and miss, I can spend 1 Sorcery Point to reroll the d20, and I must use the new roll.",
                    "I can use Seeking Spell even if I've already used a different Metamagic option during the casting of the spell.",
                ]),
            },
            "subtle spell": {
                name: "Subtle Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell, I can spend 1 Sorcery Point to cast it without any Verbal, Somatic, or Material components, except Material Components that are consumed by the spell or that have a cost specified in the spell.",
                ]),
            },
            "transmuted spell": {
                name: "Transmuted Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell that deals a type of damage from the following list, I can spend 1 Sorcery Point to change that damage type to one of the other listed types; Acid, Cold, Fire, Lightning, Poison, Thunder.",
                ]),
            },
            "twinned spell": {
                name: "Twinned Spell",
                description: desc([
                    "[1 Sorcery Point] When I cast a spell, such as Charm Person, that can be cast with a higher level spell slot to target an additional creature, I can spend 1 Sorcery Point to increase the spell's effective level by 1.",
                ]),
            }
        },
        "subclassfeature3": {
            name: "Sorcerer Subclass",
            source: [
                ["P24", 141]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Sorcerer subclass and put it in the 'Class' field.",
            ]),
        },
        "sorcerous restoration": {
            name: "Sorcerous Restoration",
            source: [
                ["P24", 141]
            ],
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "Once per Long Rest I can regain spent SP up to half my Sorcerer level at the end of a Short Rest.",
            ]),
        },
        "sorcery incarnate": {
            name: "Sorcery Incarnate",
            source: [
                ["P24", 141]
            ],
            minlevel: 7,
            description: desc([
                "I can spend 2 SP to use Innate Sorcery when I have no uses left While it's active I can use up to two Metamagic options on each spell I cast.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 141]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "arcane apotheosis": {
            name: "Arcane Apotheosis",
            source: [
                ["P24", 141]
            ],
            minlevel: 20,
            description: desc([
                "While Innate Sorcery is active I can use one Metamagic option on each of my turns without spending SP.",
            ]),
        },
    },
});
legacySubClassRefactor("sorcerer", "aberrant", {
    regExpSearch: /^(?=.*(sorcerer))(?=.*(aberrant)).*$/i,
    subname: "Aberrant Sorcery",
    source: [
        ["P24", 145]
    ],
    replaces: "aberrant mind",
    spellcastingExtra: ["arms of hadar", "calm emotions", "detect thoughts", "dissonant whispers", "mind sliver", "hunger of hadar", "sending", "evard's black tentacles", "summon aberration", "rary's telepathic bond", "telekinesis"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Telepathic Speech",
            source: [
                ["P24", 145]
            ],
            minlevel: 3,
            action: "bonus action",
            description: desc([
                "As a Bonus Action, one creature I can see within 30 ft of myself & I can speak telepathically with each other while within my Cha mod miles (min 1) for my Sorcerer level minutes as long as we share a language. It lasts until I use it with another creature.",
            ]),
        },
        "subclassfeature6": {
            name: "Psionic Sorcery",
            source: [
                ["P24", 146]
            ],
            minlevel: 6,
            description: desc([
                "When I cast a psionic spell of level 1+ I can cast it using a spell slot, or with SP equal to the spell's level. If I cast the spell with SPs It requires no components, unless they are consumed or have a specified cost.",
            ]),
        },
        "subclassfeature6.1": {
            name: "Psychic Defense",
            source: [
                ["P24", 146]
            ],
            minlevel: 6,
            dmgres: "Psychic",
            savetxt: {
                adv_vs: ["Charmed", "Frightened"]
            },
            description: desc([
                "I have Resistance to Psychic damage & Adv on saves to avoid/end Charmed or Frightened.",
            ]),
        },
        "subclassfeature14": {
            name: "Revelation in Flesh",
            source: [
                ["P24", 146]
            ],
            minlevel: 14,
            action: "bonus action",
            description: desc([
                "As a Bonus Action, I can spend 1+ SP to magically alter my body for 10 min, gaining one revelation for each SP spent (See Third Page).",
            ]),
            "aquatic adaptation": {
                name: "Aquatic Adaptation",
                extraname: "Revelation in Flesh Option",
                description: desc([
                    "I gain a Swim Speed of 2x my Speed & I can breathe underwater.",
                ]),
            },
            "glistening flight": {
                name: "Glistening Flight",
                extraname: "Revelation in Flesh Option",
                description: desc([
                    "I gain a Fly Speed of my Speed & can hover.",
                ]),
            },
            "see the invisible": {
                name: "See the Invisible",
                extraname: "Revelation in Flesh Option",
                description: desc([
                    "I can see any Invisible creature within 60 ft not behind Total Cover.",
                ]),
            },
            "wormlike movement": {
                name: "Wormlike Movement",
                extraname: "Revelation in Flesh Option",
                description: desc([
                    "I, with equipment, can move through a 1+ inch space or spend 5 ft of movement to escape a Grapple or nonmagical restraints.",
                ]),
            },
            autoSelectExtrachoices: [{
                extrachoice: "aquatic adaptation"
            }, {
                extrachoice: "glistening flight"
            }, {
                extrachoice: "see the invisible"
            }, {
                extrachoice: "wormlike movement"
            }],
        },
        "subclassfeature18": {
            name: "Warping Implosion",
            source: [
                ["P24", 146]
            ],
            minlevel: 18,
            action: "action",
            usages: 1,
            recovery: "long rest",
            altResource: "5 SP",
            description: desc([
                "As a Magic action, I teleport to a visible unoccupied space w/in 120 feet. Each creature w/in 30 feet of the space I left must make a Strength save or take 3d10 Force damage & be pulled toward the space I left, ending in the nearest unoccupied space. On a success, it takes half damage. I can restore this with a Long Rest or by spending 5 SP (no action).",
            ]),
        },
    },
});
legacySubClassRefactor("sorcerer", "clockwork", {
    regExpSearch: /^(?=.*(sorcerer))(?=.*(clockwork)).*$/i,
    subname: "Clockwork Sorcery",
    source: [
        ["P24", 146]
    ],
    replaces: "clockwork soul",
    spellcastingExtra: ["aid", "alarm", "lesser restoration", "protection from evil and good", "dispel magic", "protection from energy", "freedom of movement", "summon construct", "greater restoration", "wall of force"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Restore Balance",
            source: [
                ["P24", 146]
            ],
            minlevel: 3,
            usages: "Charisma modifier per ",
            usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
            recovery: "long rest",
            description: desc([
                "As a reaction, when a creature I can see w/in 60 ft is about to roll a d20 with Adv or Disadv, I can make it a straight roll.",
            ]),
        },
        "subclassfeature6": {
            name: "Bastion of Law",
            source: [
                ["P24", 147]
            ],
            minlevel: 6,
            action: ["action", "Bastion of Law 1-5 SP"],
            description: desc([
                "As a Magic action, I can spend 1 to 5 SP to create a magic ward around me or a creature I can see within 30 ft The ward has SP-spent d8s that can reduce the damage taken by the total rolled on those dice. The ward lasts until I finish a Long Rest or use it again.",
            ]),
        },
        "subclassfeature14": {
            name: "Trance of Order",
            source: [
                ["P24", 147]
            ],
            minlevel: 14,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            altResource: "5 SP",
            description: desc([
                "As a bonus action, I can enter a state of clockwork consciousness for 1 min during which attack rolls against me can't have Adv and when I make a D20 Test I can treat a roll below 9 as a 10. I can restore this with a Long Rest or by spending 5 SP (no action).",
            ]),
        },
        "subclassfeature18": {
            name: "Clockwork Cavalcade",
            source: [
                ["P24", 147]
            ],
            minlevel: 18,
            action: "action",
            usages: 1,
            recovery: "long rest",
            altResource: "7 SP",
            description: desc([
                "As an action, I can call spirits to bring balance in a 30-ft cube originating from me; The intangible spirits do all the following inside the cube before vanishing:",
                "Heal: Restore up to 100 HP, divided among the creatures as I choose.",
                "Repair: Repair all damaged objects entirely instantly.",
                "Dispel: End every spell of level 6 or lower on objects or creatures of my choice.",
                "I can restore this with a Long Rest or by spending 7 SP (no action).",
            ]),
        },
    },
});
legacySubClassRefactor("sorcerer", "draconic", {
    regExpSearch: /^(?=.*(sorcerer))(?=.*(draconic)).*$/i,
    subname: "Draconic Sorcery",
    source: [
        ["P24", 148]
    ],
    replaces: "draconic bloodline",
    spellcastingExtra: ["alter self", "chromatic orb", "command", "dragon's breath", "fear", "fly", "arcane eye", "charm monster", "legend lore", "summon dragon"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Draconic Resilience",
            source: [
                ["P24", 148]
            ],
            minlevel: 3,
            armorOptions: [{
                regExpSearch: /justToAddToDropDownAndEffectWildShape/,
                name: "Unarmored Defense (Cha)",
                source: [
                    ["P24", 148]
                ],
                ac: "10+Cha",
                affectsWildShape: true,
                selectNow: true
            }],
            calcChanges: {
                hp: function(totalHD, HDobj, prefix) {
                    if (classes.known.sorcerer) {
                        return [classes.known.sorcerer.level, "Draconic Resilience (Sorcerer)"];
                    }
                },
            },
            description: desc([
                "My hit point maximum increases by an amount equal to my sorcerer level.",
                "While not wearing armor my base AC is 10 + Dex mod + Cha mod.",
            ]),
        },
        "subclassfeature6": {
            name: "Elemental Affinity",
            source: [
                ["P24", 148]
            ],
            minlevel: 6,
            description: desc([
                "Use 'Choose Feature' above to choose an elemental affinity. I have Resistance to that damage type; When I do spell damage of that type I can add my Cha mod to 1 damage roll.",
            ]),
            choices: ["Acid Affinity", "Cold Affinity", "Fire Affinity", "Lightning Affinity", "Poison Affinity"],
            "acid affinity": {
                name: "Acid Affinity",
                dmgres: "Acid",
                description: "I am resistant to Acid damage & spells I cast that deal Acid damage can add my Cha mod to one damage roll.",
            },
            "cold affinity": {
                name: "Cold Affinity",
                dmgres: "Cold",
                description: "I am resistant to Cold damage & spells I cast that deal Cold damage can add my Cha mod to one damage roll.",
            },
            "fire affinity": {
                name: "Fire Affinity",
                dmgres: "Fire",
                description: "I am resistant to Fire damage & spells I cast that deal Fire damage can add my Cha mod to one damage roll.",
            },
            "lightning affinity": {
                name: "Lightning Affinity",
                dmgres: "Lightning",
                description: "I am resistant to Lightning damage & spells I cast that deal Lightning damage can add my Cha mod to one damage roll.",
            },
            "poison affinity": {
                name: "Poison Affinity",
                dmgres: "Poison",
                description: "I am resistant to Poison damage & spells I cast that deal Poison damage can add my Cha mod to one damage roll.",
            },
        },
        "subclassfeature14": {
            name: "Dragon Wings",
            source: [
                ["P24", 148]
            ],
            minlevel: 14,
            action: "bonus action",
            usages: 1,
            recovery: "long rest",
            altResource: "3 SP",
            description: desc([
                "As a Bonus Action, I can gain draconic wings and a Fly speed of 60ft for 1 hour or until dismissed (no action). I can restore it with a Long Rest or with 3 SP (no action).",
            ]),
        },
        "subclassfeature18": {
            name: "Dragon Companion",
            source: [
                ["P24", 149]
            ],
            minlevel: 18,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I can cast Summon Dragon w/out a Material component & once per Long Rest without a spell slot. I can also cast it without requiring Concentration, for 1 min.",
            ]),
        },
    },
});
legacySubClassRefactor("sorcerer", "wild magic", {
    regExpSearch: /^(?=.*(sorcerer))(?=.*(wild ))(?=.*(magic)).*$/i,
    subname: "Wild Magic Sorcery",
    source: [
        ["P24", 149]
    ],
    replaces: "wild magic",
    features: {
        "subclassfeature3": {
            name: "Wild Magic Surge",
            source: [
                ["P24", 149]
            ],
            minlevel: 3,
            description: desc([
                "Once per turn, I can roll 1d20 when I cast a Sorcerer spell with a spell slot. On a 20, I roll on the Wild Magic Surge (WMS) table (See page 3). Spells from the table are unaffected by my Metamagic.",
            ]),
            toNotesPage: [{
                name: "Wild Magic Surge",
                note: [
                    "1d100\tEffect\n01-04\tRoll on this table at the start of each of my turns for the next minute, \n\tignoring this result on subsequent rolls.\n05-08\tA creature that is Friendly toward me appears in a random unoccupied \n\tspace within 60 feet of me. The creature is under the DM's control and \n\tdisappears 1 minute later. Roll 1d4 to determine the creature, on a 1. \n\ta Modrone Duodrone appears, on a 2. a Flumph appears, on a 3. a \n\tModrone Monodrone appears, on a 4. a Unicorn appears. See the \n\tMonster Manual for the creature's stat block.\n09-12\tFor the next minute, I regain 5 Hit Points at the start of each of my \n\tturns.\n13-16\tCreatures have Disadvantage on saving throws against the next spell \n\tI cast in the next minute that involves a saving throw.\n17-20\tI am subjected to an effect that lasts for 1 minute unless its \n\tdescription says otherwise. Roll 1d8 to determine the effect, on a 1. \n\tI'm surrounded by faint, ethereal music only myself and creatures within 5 \n\tfeet of me can hear, on a 2. my size increases by one size category, on \n\ta 3. I grow a long beard made of feathers that remains until I sneeze \n\tat which point the feathers explode from my face and vanish, on a 4. I \n\tmust shout when I speak, on a 5. illusory butterflies flutter in the air \n\twithin 10 feet of me, on a 6. An eye appears on my forehead granting \n\tme advantage on Wisdom (Perception) checks, on a 7. Pink bubbles \n\tfloat out of my mouth whenever I speak, on an 8. my skin turns a \n\tvibrant shade of blue for 24 hours or until the effect is ended by a \n\tRemove Curse spell.\n21-24\tFor the next minute, all my spells with a casting time of an action have \n\ta casting time of a Bonus Action.\n25-28\tI am transported to the Astral Plane until the end of my next turn. I \n\tthen return to the space I previously occupied or the nearest \n\tunoccupied space if that space is occupied.\n29-32\tThe next time I cast a spell that deals damage within the next minute, \n\tdon't roll the spell's damage dice for the damage, instead use the \n\thighest number possible for each damage die.\n33-36\tI have Resistance to all damage for the next minute.\n37-40\tI turn into a potted plant until the start of my next turn. While I'm a \n\tplant, I have the Incapacitated condition and have Vulnerability to all \n\tdamage. If I drop to 0 Hit Points, my pot breaks and my form reverts.\n45-48\tMyself and up to three creatures I choose within 30 feet of I have the \n\tinvisible condition for 1 minute. This invisibility ends on a creature \n\timmediately after it makes an attack roll, deals damage, or casts a \n\tspell.\n49-52\tA spectral shield hovers near me for the next minute, granting me a \n\t+2 bonus to AC and immunity to Magic Missile.\n53-56\tI can take one extra action on this turn.\n57-60\tI cast a random spell, if the spell normally requires Concentration it \n\tdoesn't require Concentration in this case the spell lasts for its full \n\tduration. Roll 1d10 to determine the spell; on a 1. Confusion, on a 2. \n\tFireball, on a 3. Fog Cloud, on a 4. Fly (cast on a random creature \n\twithin 60 feet of me), on a 5 Grease, on a 6. Levitate (cast on myself), \n\ton a 7. Magic Missile (cast as a level 5 spell), on an 8. Mirror Image, on \n\ta 9. Polymorph (cast on myself), and if I fail the saving throw I turn \n\tinto a Goat (see appendix B), on a 10. See Invisibility.\n61-64\tFor the next minute, any flammable, non-magical object I touch that \n\tisn't being worn or carried by another creature bursts into flame, takes \n\t1d4 Fire damage, and is burning.\n65-68\tIf I die within the next hour, I immediately revive as if by the \n\tReincarnate spell.\n69-72\tI have the Frightened condition until the end of my next turn. The DM \n\tdetermines the source of my fear.\n73-76\tI teleport up to 60 feet to an unoccupied space I can see.\n77-80\tA random creature within 60 feet of me has the poisoned condition for \n\t1d4 hours.\n81-84\tI radiate Bright Light in a 30-foot radius for the next minute. Any \n\tcreature that ends its turn within 5 feet of me has the Blinded condition \n\tuntil the end of its next turn.\n85-88\tUp to three creatures of my choice that I can see within 30 feet of me \n\ttake 1d10 Necrotic damage, I regain Hit Points equal to the sum of \n\tthe Necrotic damage dealt.\n89-92\tUp to three creatures of my choice I can see within 30 feet of me take \n\t4d10 Lightning damage.\n93-96\tMe and all creatures within 30 feet of me have Vulnerability to Piercing \n\tdamage for the next minute.\n97-00\tRoll 1d6; On a 1. I regain 2d10 Hit Points, on a 2. One ally of my \n\tchoice within 300 feet of me regains 2d10 Hit Points, on a 3. I regain \n\tmy lowest-level expended spell slot, on a 4. One ally of my choice \n\twithin 300 feet of me regains their lowest-level expended \n\tspell slot, on a 5. I regain all my expended Sorcery Points, on a 6. All \n\tthe effects of row 17-20 affect I simultaneously.",
                ],
            }],
        },
        "subclassfeature3.1": {
            name: "Tides of Chaos",
            source: [
                ["P24", 149]
            ],
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I can gain Adv on one D20 Test before I roll. If I cast a Sorcerer spell with a spell slot before a Long Rest I must roll on the WMS table, but regain this feature.",
            ]),
        },
        "subclassfeature6": {
            name: "Bend Luck",
            source: [
                ["P24", 149]
            ],
            minlevel: 6,
            action: "reaction",
            description: desc([
                "As a reaction, I can add/subtract 1d4 from another's attack roll, ability check, or save for 1 SP.",
            ]),
        },
        "subclassfeature14": {
            name: "Controlled Chaos",
            source: [
                ["P24", 149]
            ],
            minlevel: 14,
            description: desc([
                "When I roll on the Wild Magic Surge table I can roll twice and use either number.",
            ]),
        },
        "subclassfeature18": {
            name: "Tamed Surge",
            source: [
                ["P24", 150]
            ],
            minlevel: 18,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "Once per Long Rest, after I cast a Sorcerer spell with a spell slot, I can choose an effect from the WMS table (except the final row). If it involves a roll I must make it.",
            ]),
        },
    },
});
legacyClassRefactor("warlock", {
    regExpSearch: /warlock/i,
    name: "Warlock",
    source: [
        ["P24", 153]
    ],
    primaryAbility: ["Charisma"],
    abilitySave: 6,
    prereqs: "Charisma 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 8,
    saves: ["Wis", "Cha"],
    skillstxt: {
        primary: "Choose 2: Arcana, Deception, History, Intimidation, Investigation, Nature, or Religion",
    },
    armorProfs: {
        primary: [true, false, false, false],
        secondary: [true, false, false, false],
    },
    weaponProfs: {
        primary: [true, false],
        secondary: [false, false],
    },
    equipment: "Warlock starting equipment:" +
        "\n \u2022 Leather Armor;" +
        "\n \u2022 Sickle;" +
        "\n \u2022 2 Daggers;" +
        "\n \u2022 An Arcane Focus (orb);" +
        "\n \u2022 A Book (Occult Lore);" +
        "\n \u2022 A Scholar's Pack, and 15 gp." +
        "\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Warlock Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 6,
    spellcastingFactor: "warlock1",
    spellcastingKnown: {
        cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        spells: [2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15],
        prepared: false,
    },
    features: {
        "eldritch invocations": {
            name: "Eldritch Invocations",
            source: [
                ["P24", 153]
            ],
            minlevel: 1,
            description: desc([
                "Use the 'Choose Feature' button above to add Eldritch Invocations (EI) to the third page. I must meet all prereqs. When I gain a Warlock level I can replace one EI with another unless it's a prereq for another EI I have.",
            ]),
            extraname: "Eldritch Invocation Options",
            extrachoices: ["Agonizing Blast [Chill Touch] (2+)", "Agonizing Blast [Eldritch Blast] (2+)", "Agonizing Blast [Mind Sliver] (2+)", "Agonizing Blast [Poison Spray] (2+)", "Agonizing Blast [True Strike] (2+)", "Armor of Shadows", "Ascendant Step (5+)", "Devil's Sight (2+)", "Devouring Blade (PoB, 12+)", "Eldritch Mind", "Eldritch Smite (PoB, 5+)", "Eldritch Spear [Eldritch Blast] (2+)", "Eldritch Spear [Mind Sliver] (2+)", "Eldritch Spear [Poison Spray] (2+)", "Fiendish Vigor (2+)", "Gaze of Two Minds (5+)", "Gift of the Depths (5+)", "Gift of the Protectors (PoT, 9+)", "Investment of the Chain Master (PoC, 5+)", "Lessons of the First Ones (2+)", "Lifedrinker (PoB, 9+)", "Mask of Many Faces (2+)", "Master of Myriad Forms (5+)", "Misty Visions (2+)", "One with Shadows (5+)", "Otherworldly Leap (2+)", "Pact of the Blade", "Pact of the Chain", "Pact of the Tome", "Repelling Blast [Chill Touch] (2+)", "Repelling Blast [Eldritch Blast] (2+)", "Repelling Blast [Poison Spray] (2+)", "Repelling Blast [True Strike] (2+)", "Thirsting Blade (PoB, 5+)", "Visions of Distant Realms (9+)", "Whispers of the Grave (7+)", "Witch Sight (15+)"],
            extraTimes: [1, 3, 3, 3, 5, 5, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10, 10, 10],

            "agonizing blast [chill touch] (2+)": {
                name: "Agonizing Blast [Chill Touch] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('chill touch', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.baseWeaponName == 'chill touch') output.extraDmg += What('Cha Mod');
                        },
                        "I add my Charisma modifier to the damage of my Chill Touch cantrip."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "chill touch") {
                                spellObj.description = spellObj.description.replace(" Necrotic", "+" + What("Cha Mod") + " Necrotic");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my Chill Touch cantrip."
                    ]
                },
                description: desc([
                    "I add my Charisma modifier to the damage of my Chill Touch Cantrip.",
                ]),
            },
            "agonizing blast [eldritch blast] (2+)": {
                name: "Agonizing Blast [Eldritch Blast] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.baseWeaponName == 'eldritch blast') output.extraDmg += What('Cha Mod');
                        },
                        "I add my Charisma modifier to the damage of each bolt of my Eldritch Blast cantrip."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "eldritch blast") {
                                spellObj.description = spellObj.description.replace("1d10 Force damage", "1d10+" + What("Cha Mod") + " Force dmg");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of each bolt of my Eldritch Blast cantrip."
                    ]
                },
                description: desc([
                    "I add my Charisma modifier to the damage of my Eldritch Blast Cantrip.",
                ]),
            },
            "agonizing blast [mind sliver] (2+)": {
                name: "Agonizing Blast [Mind Sliver] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('mind sliver', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.baseWeaponName == 'mind sliver') output.extraDmg += What('Cha Mod');
                        },
                        "I add my Charisma modifier to the damage of my Mind Sliver cantrip."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "mind sliver") {
                                spellObj.description = spellObj.description.replace(" Psychic", "+" + What("Cha Mod") + " Psychic");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my Mind Sliver cantrip."
                    ]
                },
                description: desc([
                    "I add my Charisma modifier to the damage of my Mind Sliver Cantrip.",
                ]),
            },
            "agonizing blast [poison spray] (2+)": {
                name: "Agonizing Blast [Poison Spray] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.baseWeaponName == 'poison spray') output.extraDmg += What('Cha Mod');
                        },
                        "I add my Charisma modifier to the damage of my Poison Spray cantrip."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "poison spray") {
                                spellObj.description = spellObj.description.replace(" Poison", "+" + What("Cha Mod") + " Poison");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my Poison Spray cantrip."
                    ]
                },
                description: desc([
                    "I add my Charisma modifier to the damage of my Poison Spray Cantrip.",
                ]),
            },
			"agonizing blast [true strike] (2+)": {
                name: "Agonizing Blast [True Strike] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('true strike', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.baseWeaponName == 'true strike') output.extraDmg += What('Cha Mod');
                        },
                        "I add my Charisma modifier to the damage of my True Strike cantrip."
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "true strike") {
                                spellObj.description = spellObj.description.replace(" Radiant.", "+" + What("Cha Mod") + " Radiant.");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my True Strike cantrip."
                    ]
                },
                description: desc([
                    "I add my Charisma modifier to the damage of my True Strike Cantrip.",
                ]),
            },
            "armor of shadows": {
                name: "Armor of Shadows",
                spellcastingBonus: [{
                    name: "Armor of Shadows",
                    spells: ["mage armor"],
                    selection: ["mage armor"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Mage Armor on myself without expending a spell slot.",
                ]),
            },
            "ascendant step (5+)": {
                name: "Ascendant Step (5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5;
                },
                submenu: "[Warlock Level 5+]",
                spellcastingBonus: [{
                    name: "Ascendant Step",
                    spells: ["levitate"],
                    selection: ["levitate"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Levitate on myself without expending a spell slot.",
                ]),
            },
            "devil's sight (2+)": {
                name: "Devil's Sight (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                vision: [
                    ["Devil's Sight", 120]
                ],
                description: desc([
                    "I can see normally in Dim Light and Darkness both magical and non-magical - within 120 feet of myself.",
                ]),
            },
            "devouring blade (pob, 12+)": {
                name: "Devouring Blade (PoB, 12+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 12 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("thirsting blade (pob, 5+)") !== -1;
                },
                submenu: "[Improves Pact of the Blade]",
                action: ["action", "Pact Weapon (3 attacks per action)"],
                description: desc([
                    "The Extra Attack of my Thirsting Blade invocation confers two extra attacks rather than one.",
                ]),
            },
            "eldritch mind": {
                name: "Eldritch Mind",
                savetxt: "Advantage on Constitution (Concentration) Checks",
                description: desc([
                    "I have Advantage on Constitution saving throws that I make to maintain Concentration",
                ]),
            },
            "eldritch smite (pob, 5+)": {
                name: "Eldritch Smite (PoB, 5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
                },
                submenu: "[Improves Pact of the Blade]",
                description: desc([
                    "Once per turn when I hit a creature with my pact weapon, I can expend a Pact Magic spell slot to deal an extra 1d8 Force damage to the target, plus another 1d8 per level of the spell slot, and I can give the target the Prone condition if it is Huge or smaller.",
                ]),
            },
            "eldritch spear [eldritch blast] (2+)": {
                name: "Eldritch Spear [Eldritch Blast] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'eldritch blast') fields.Range = 120 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft';
                        },
                        "My Eldritch Blast cantrip has an increased range of (30 times my Warlock level) ft.",
                        50
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == 'eldritch blast') {
                                spellObj.range = 120 + 30 * classes.known.warlock.level + ' ft';
                                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
                            }
                        },
                        "My Eldritch Blast cantrip has a range of (30 times my Warlock level) ft.",
                        50
                    ]
                },
                description: desc([
                    "my Eldritch Blast cantrip has a range of (30 times my Warlock level) ft.",
                ]),
            },
            "eldritch spear [mind sliver] (2+)": {
                name: "Eldritch Spear [Mind Sliver] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('mind sliver', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'mind sliver') fields.Range = 60 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft';
                        },
                        "My Mind Sliver cantrip has an increased range of (30 times my Warlock level) ft.",
                        50
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == 'mind sliver') {
                                spellObj.range = 30 * classes.known.warlock.level + ' ft';
                                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
                            }
                        },
                        "My Mind Sliver cantrip has a range of (30 times my Warlock level) ft.",
                        50
                    ]
                },
                description: desc([
                    "My Mind Sliver cantrip has a range of (30 times my Warlock level) ft.",
                ]),
            },
            "eldritch spear [poison spray] (2+)": {
                name: "Eldritch Spear [Poison Spray] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'poison spray') fields.Range = 30 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft';
                        },
                        "My Poison Spray cantrip has a range of (30 times my Warlock level) ft.",
                        50
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == 'poison spray') {
                                spellObj.range = 30 + 30 * classes.known.warlock.level + ' ft';
                                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
                            }
                        },
                        "My Poison Spray cantrip has an increased range of (30 times my Warlock level) ft.",
                        50
                    ]
                },
                description: desc([
                    "My Poison Spray cantrip has a range of (30 times my Warlock level) ft.",
                ]),
            },
            "fiendish vigor (2+)": {
                name: "Fiendish Vigor (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                spellcastingBonus: [{
                    name: "Fiendish Vigor",
                    spells: ["false life"],
                    selection: ["false life"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast False Life on myself without expending a spell slot. When I cast the spell with this feature, I don't roll the die for the Temporary Hit Points; I automatically get the highest number on the die.",
                ]),
				calcChanges: {
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == 'false life') {
                                spellObj.description = "I gain 8+4+5/SL temporary hit points.";
                            }
                        },
                        "I can cast False Life on myself I don't roll the die for the Temporary Hit Points; I automatically get the highest number on the die.",
                        51
                    ]
                },
            },
            "gaze of two minds (5+)": {
                name: "Gaze of Two Minds (5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5;
                },
                submenu: "[Warlock Level 5+]",
                action: ["bonus action", "Gaze of Two Minds (Create/Maintain)"],
                description: desc([
                    "I can use a Bonus Action to touch a willing creature and perceive through its senses until the end of my next turn. As long as the creature is on the same plane of existence as me, I can take a Bonus Action on subsequent turns to maintain this connection, extending the duration until the end of my next turn. The connection ends if I don't maintain it in this way.",
                    "While perceiving through the other creature's senses, I benefit from any special senses possessed by that creature, and I can cast spells as if I were in my space or the other creature's space if the two of I are within 60 feet of each other.",
                ]),
            },
            "gift of the depths (5+)": {
                name: "Gift of the Depths (5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5;
                },
                submenu: "[Warlock Level 5+]",
                speed: {
                    swim: {
                        spd: "walk",
                        enc: "walk"
                    }
                },
                description: desc([
                    "I can breathe underwater, and I gain a Swim Speed equal to my Speed.",
                    "I can also cast Water Breathing once without expending a spell slot. I regain the ability to cast it in this way again when I finish a Long Rest.",
                ]),
            },
            "gift of the protectors (pot, 9+)": {
                name: "Gift of the Protectors (PoT, 9+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 9 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the tome") !== -1;
                },
                submenu: "[Improves Pact of the Tome]",
                description: desc([
                    "A new page appears in my Book of Shadows when I conjure it. With my permission, a creature can take an action to write its name on that pace, which can contain a number of names equal to my Charisma modifier (minimum of one name).",
                    "When any creature whose name is on the page is reduced to 0 Hit Points but not killed outright, the creature magically drops to 1 Hit Point instead. Once this magic is triggered, no creature can benefit from it until I finish a Long Rest.",
                    "As a Magic action, I can erase a name on the page by touching it.",
                ]),
            },
            "investment of the chain master (poc, 5+)": {
                name: "Investment of the Chain Master (PoC, 5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the chain") !== -1;
                },
                submenu: "[Improves Pact of the Chain]",
                description: desc([
                    "When I cast Find Familiar, I infuse the summoned familiar with a measure of my eldritch power, granting the creature the following benefits.",
                    "Aerial or Aquatic : The familiar gains either a Fly or a Swim speed (my choice) of 40 feet.",
                    "Quick Attack : As a Bonus Action, I can command the familiar to take the Attack action.",
                    "Necrotic or Radiant Damage : Whenever the familiar deals Bludgeoning, Piercing, or Slashing damage, I can make it deal Necrotic or Radiant damage instead.",
                    "my Save DC : If the familiar forces a creature to make a saving throw, it uses my spell save DC.",
                    "Resistance : When the familiar takes damage, I can take a Reaction to grant it Resistance against that damage.",
                ]),
            },
            "lessons of the first ones (2+)": {
                name: "Lessons of the First Ones (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                eval: function() {
                    AddString('Feat Note 1', 'Lessons of the First Ones (Origin)');
                },
                removeeval: function() {
                    RemoveString('Feat Note 1', 'Lessons of the First Ones (Origin)');
                },
                description: desc([
                    "I have received knowledge from an elder entity of the multiverse, allowing me to gain one Origin feat of my choice (see Chapter 5).",
                    "Repeatable : I can gain this invocation more than once. Each time I do so, choose a different Origin feat.",
                ]),
            },
            "lifedrinker (pob, 9+)": {
                name: "Lifedrinker (PoB, 9+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 9 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
                },
                submenu: "[Improves Pact of the Blade]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.pactWeapon) fields.Description += (fields.Description ? '; ' : '') + '+1d6 necrotic, psychic, or radiant damage';
                        },
                        "I add 1d6 to the damage of my Pact Weapons. However, it won't say in the damage box that this added damage is of the necrotic, psychic, or radiant type, as it can only display a single damage type."
                    ],
                },
                description: desc([
                    "Once per turn when I hit a creature with my pact weapon, I can deal an extra 1d6 Necrotic, Psychic, or Radiant damage (my choice) to the creature, and I can expend one of my Hit Point Dice to roll it and regain a number of Hit Points equal to the roll plus my Constitution modifier (minimum of 1 Hit Point).",
                ]),
            },
            "mask of many faces (2+)": {
                name: "Mask of Many Faces (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                spellcastingBonus: [{
                    name: "Mask of Many Faces",
                    spells: ["disguise self"],
                    selection: ["disguise self"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Disguise Self on myself without expending a spell slot.",
                ]),
            },
            "master of myriad forms (5+)": {
                name: "Master of Myriad Forms (5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5;
                },
                submenu: "[Warlock Level 5+]",
                spellcastingBonus: [{
                    name: "Master of Myriad Forms",
                    spells: ["alter self"],
                    selection: ["alter self"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Alter Self on myself without expending a spell slot.",
                ]),
            },
            "misty visions (2+)": {
                name: "Misty Visions (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                spellcastingBonus: [{
                    name: "Misty Visions",
                    spells: ["silent image"],
                    selection: ["silent image"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Silent Image on myself without expending a spell slot.",
                ]),
            },
            "one with shadows (5+)": {
                name: "One with Shadows (5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5;
                },
                submenu: "[Warlock Level 5+]",
                spellcastingBonus: [{
                    name: "One with Shadows",
                    spells: ["invisibility"],
                    selection: ["invisibility"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "While I'm in an area of Dim Light or Darkness, I can cast Invisibility on myself without expending a spell slot.",
                ]),
            },
            "otherworldly leap (2+)": {
                name: "Otherworldly Leap (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2;
                },
                submenu: "[Warlock Level 2+]",
                spellcastingBonus: [{
                    name: "Otherworldly Leap",
                    spells: ["jump"],
                    selection: ["jump"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Jump on myself without expending a spell slot.",
                ]),
            },
            "pact of the blade": {
                name: "Pact of the Blade",
                submenu: "[Pact Boons]",
                action: ["bonus action", "Conjure Pact Weapon"],
                calcChanges: {
                    atkCalc: [
                        function(fields, v, output) {
                            if (v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) {
                                v.pactWeapon = true;
                            }
                        }, "",
                        90
                    ],
                    atkAdd: [
                        function(fields, v) {
                            // Resuse this statement
                            if (v.pactWeapon || v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) {
                                v.pactWeapon = true;
                                fields.Proficiency = true;
                                // Grab the current modifier and compare
                                var weaMod = What(AbilityScores.abbreviations[fields.Mod - 1] + ' Mod');
                                // Compare charisma and if it's higher use that instead.
                                fields.Mod = What('Cha Mod') > weaMod ? 6 : fields.Mod;
                                if (!v.theWea.isMagicWeapon && !v.thisWeapon[1] && !(/counts as( a)? magical/i).test(fields.Description)) fields.Description += (fields.Description ? '; ' : '') + 'Counts as magical';
                            }
                        },
                        "If I include the word 'Pact' in a melee or magic weapon's name, it gets treated as my Pact Weapon.",
                        290
                    ]
                },
                description: desc([
                    "As a Bonus Action, I can conjure a pact weapon in my hand - a Simple or Martial Melee weapon of my choice with which I bond - or create a bond with a magic weapon I touch, I can't bond with a magic weapon if someone else is attuned to it or another Warlock is bonded with it. Until the bond ends, I have proficiency with the weapon and I can use it as a Spellcasting Focus.",
                    "Whenever I attack with the bonded weapon, I can use my Charisma modifier for the attack and damage rolls instead of using Strength or Dexterity; and I can cause the weapon to deal Necrotic, Psychic, or Radiant damage or its normal damage type.",
                    "My bond with this weapon ends if I use this feature's Bonus Action again, if the weapon is more than 5 feet away from me for 1 minute or more, or If I die. A conjured weapon disappears when the bond ends.",
                ]),
            },
            "pact of the chain": {
                name: "Pact of the Chain",
                submenu: "[Pact Boons]",
                spellcastingBonus: [{
                    name: "Pact of the Chain",
                    spells: ["find familiar"],
                    selection: ["find familiar"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I learn the Find Familiar spell and can cast it as a Magic action without expending a spell slot.",
                    "When I cast the spell, I choose one of the normal forms for my familiar or one of the following special forms; Imp, Pseudodragon, Quasit, Skeleton, Slaad Tadpole, Sphinx of Wonder, Sprite, or Venomous Snake (see appendix B for the familiar's stat block).",
                    "Additionally, when I take the Attack action, I can forgo one of my own attacks to allow my familiar to make one attack of its own with its Reaction",
                ]),
            },
            "pact of the tome": {
                name: "Pact of the Tome",
                submenu: "[Pact Boons]",
                spellcastingBonus: [{
                    name: "Pact of the Tome",
                    "class": "any",
                    level: [0, 0],
                    times: 3,
                }, {
                    name: "Pact of the Tome",
                    "class": "any",
                    level: [1, 1],
                    times: 2,
                    ritual: true,
                }],
                description: desc([
                    "Stitching together strands of shadow, I conjure forth a book in my hand at the end of a Short or Long Rest. This Book of Shadows (I determine its appearance) contains eldritch magic that only I can access, granting me the benefits below. The book disappears if I conjure another book with this feature or if I die.",
                    "Cantrips and Rituals : When the book appears, choose three cantrips, and choose two level 1 spells that have the Ritual tag. The spells can be from any class's spell list, and they must be spells I don't already have prepared. While the book is on my person, I have the chosen spells prepared, and they function as Warlock spells for me.",
                    "Spellcasting Focus : I can use the book as a Spellcasting Focus.",
                ]),
            },
            "repelling blast [chill touch] (2+)": {
                name: "Repelling Blast [Chill Touch] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('chill touch', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'chill touch') fields.Description += '; Target pushed back 10 ft';
                        },
                        "When I hit a Large or smaller creature with Chill Touch, I can push the creature up to 10 feet straight away from me.",
                        51
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "chill touch") {
                                spellObj.description = spellObj.description.replace("Necrotic;", "Necrotic \u0026 push 10 ft;");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my Chill Touch cantrip."
                    ]
                },
                description: desc([
                    "When I hit a Large or smaller creature with Chill Touch, I can push the creature up to 10 feet straight away from me.",
                ]),
            },
            "repelling blast [eldritch blast] (2+)": {
                name: "Repelling Blast [Eldritch Blast] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'eldritch blast') fields.Description += '; Target pushed back 10 ft';
                        },
                        "When I hit a Large or smaller creature with Eldritch Blast, I can push the creature up to 10 feet straight away from me.",
                        51
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == 'eldritch blast') {
                                spellObj.description = "Spell attack beam 1d10 Force damage \u0026 push 10 ft; beams can be combined; +1 beam at CL5,11,17";
                                spellObj.descriptionShorter = "Spell atk beam 1d10 Force damage \u0026 push 10 ft; can combine beams; +1 beam at CL5,11,17";
                                spellObj.descriptionCantripDie = "Spell atk for `CD` beam(s), each 1d10 Force damage \u0026 push 10 ft; can combine/split beams";
                            }
                        },
                        "When I hit a Large or smaller creature with Eldritch Blast, I can push the creature up to 10 feet straight away from me.",
                        51
                    ]
                },
                description: desc([
                    "When I hit a Large or smaller creature with Eldritch Blast, I can push the creature up to 10 feet straight away from me.",
                ]),
            },
            "repelling blast [poison spray] (2+)": {
                name: "Repelling Blast [Poison Spray] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'poison spray') fields.Description += '; Target pushed back 10 ft';
                        },
                        "When I hit a Large or smaller creature with Poison Spray, I can push the creature up to 10 feet straight away from me.",
                        51
                    ],
                    spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "poison spray") {
                                spellObj.description = spellObj.description.replace("Poison damage", "Poison damage \u0026 push 10 ft");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my Poison Spray cantrip."
                    ]
                },
                description: desc([
                    "When I hit a Large or smaller creature with Poison Spray, I can push the creature up to 10 feet straight away from me.",
                ]),
            },
			"repelling blast [true strike] (2+)": {
                name: "Repelling Blast [True Strike] (2+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 2 && isSpellUsed('true strike', true);
                },
                submenu: "[improves Damaging Cantrips]",
                calcChanges: {
                    atkAdd: [
                        function(fields, v) {
                            if (v.baseWeaponName == 'true strike') fields.Description += '; Target pushed back 10 ft';
                        },
                        "When I hit a Large or smaller creature with True Strike, I can push the creature up to 10 feet straight away from me.",
                        51
                    ],
					spellAdd: [
                        function(spellKey, spellObj, spName) {
                            if (spellKey == "true strike") {
                                spellObj.description = spellObj.description.replace("Radiant dmg,", "Radiant dmg \u0026 push 10 ft,");
                                return true;
                            }
                        },
                        "I add my Charisma modifier to the damage of my True Strike cantrip."
                    ]
                },
                description: desc([
                    "When I hit a Large or smaller creature with True Strike, I can push the creature up to 10 feet straight away from me.",
                ]),
            },
            "thirsting blade (pob, 5+)": {
                name: "Thirsting Blade (PoB, 5+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
                },
                submenu: "[Improves Pact of the Blade]",
                action: ["action", "Pact Weapon (2 attacks per action)"],
                description: desc([
                    "I gain the Extra Attack feature for my pact weapon only. With that feature, I can attack twice with the weapon instead of once when I take the Attack action on my turn.",
                ]),
            },
            "visions of distant realms (9+)": {
                name: "Visions of Distant Realms (9+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 9;
                },
                submenu: "[Warlock Level 9+]",
                spellcastingBonus: [{
                    name: "Visions of Distant Realms",
                    spells: ["arcane eye"],
                    selection: ["arcane eye"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Arcane Eye without expending a spell slot.",
                ]),
            },
            "whispers of the grave (7+)": {
                name: "Whispers of the Grave (7+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 7;
                },
                submenu: "[Warlock Level 7+]",
                spellcastingBonus: [{
                    name: "Whispers of the Grave",
                    spells: ["speak with dead"],
                    selection: ["speak with dead"],
                    times: 1,
                    firstCol: "atwill",
                }],
                description: desc([
                    "I can cast Speak with Dead without expending a spell slot.",
                ]),
            },
            "witch sight (15+)": {
                name: "Witch Sight (15+)",
                prereqeval: function(v) {
                    return classes.known.warlock.level >= 15;
                },
                submenu: "[Warlock Level 15+]",
                vision: [
                    ["Truesight", 30]
                ],
                description: desc([
                    "I have Truesight with a range of 30 feet.",
                ]),
            },
        },
        "pact magic": {
            name: "Pact Magic",
            source: [
                ["P24", 153]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
                var splls = [2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast cantrips and Prepared Level 1+ Warlock spells using Cha as my spellcasting ability and an Arcane Focus as my Spellcasting Focus. When I gain a Warlock level, I can replace one of these cantrips with another.",
                "Prepared Spells for other Warlock features count as Warlock spells & don't count against me. I regain all expended Pact Magic spell slots when I finish a Short or Long Rest. I can change one Prepared Spell each time I gain a Warlock level.",
            ]),
        },
        "magical cunning": {
            name: "Magical Cunning",
            source: [
                ["P24", 154]
            ],
            minlevel: 2,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "I can do a 1 min rite to regain up to half my max Pact Magic spell slots.",
            ]),
        },
        "subclassfeature3": {
            name: "Warlock Subclass",
            source: [
                ["P24", 154]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Warlock subclass and put it in the 'Class' field.",
            ]),
        },
        "contact patron": {
            name: "Contact Patron",
            source: [
                ["P24", 155]
            ],
            minlevel: 9,
            usages: 1,
            recovery: "long rest",
            spellcastingBonus: [{
                name: "Contact Patron",
                spells: ["contact other plane"],
                selection: ["contact other plane"],
                times: 1,
                firstCol: "oncelr",
            }],
            description: desc([
                "Once per Long Rest, I can cast Contact Other Plane to contact my Patron without expending a spell slot. I automatically pass the save.",
            ]),
        },
        "mystic arcanum": {
            name: "Mystic Arcanum",
            source: [
                ["P24", 155]
            ],
            minlevel: 11,
            additional: ["", "", "", "", "", "", "", "", "", "", "6th level", "6th level", "6th and 7th level", "6th and 7th level", "6th, 7th, and 8th level", "6th, 7th, and 8th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level"],
            spellcastingBonus: [{
                name: "Mystic Arcanum (level 6)",
                "class": "warlock",
                level: [6, 6],
                times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                firstCol: "oncelr",
            }, {
                name: "Mystic Arcanum (level 7)",
                "class": "warlock",
                level: [7, 7],
                times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1],
                firstCol: "oncelr",
            }, {
                name: "Mystic Arcanum (level 8)",
                "class": "warlock",
                level: [8, 8],
                times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1],
                firstCol: "oncelr",
            }, {
                name: "Mystic Arcanum (level 9)",
                "class": "warlock",
                level: [9, 9],
                times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1],
                firstCol: "oncelr",
            }],
            description: desc([
                "I choose a Warlock spell of the above Level(s) as my Arcanum & can cast each without a spell slot once per Long Rest. I can replace one each time I gain a Warlock level.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 155]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "eldritch master": {
            name: "Eldritch Master",
            source: [
                ["P24", 155]
            ],
            minlevel: 20,
            description: desc([
                "When I use my Magical Cunning feature, I regain all expended Pact Magic spell slots.",
            ]),
        },
    },
});
legacySubClassRefactor("warlock", "the archfey", {
    regExpSearch: /^(?=.*(warlock))(?=.*(archfey)).*$/i,
    subname: "Archfey Patron",
    source: [
        ["P24", 159]
    ],
    spellcastingExtra: ["calm emotions", "faerie fire", "misty step", "phantasmal force", "sleep", "blink", "plant growth", "dominate beast", "greater invisibility", "dominate person", "seeming"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Steps of the Fey",
            source: [
                ["P24", 159]
            ],
            minlevel: 3,
            usages: "Charisma modifier per ",
            usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
            recovery: "long rest",
            description: desc([
                "I can cast Misty Step w/out a spell slot (min once) per Long Rest and can imbue it with one option from the Steps of the Fey feature, (see notes page).",
            ]),
            "refreshing step": {
                name: "Refreshing Step",
                extraname: "Steps of the Fey Option",
                source: [
                    ["P24", 159]
                ],
                description: desc("After I teleport, one creature I can see w/in 10 ft or I gain 1d10 Temp HP."),
            },
            "taunting step": {
                name: "Taunting Step",
                extraname: "Steps of the Fey Option",
                source: [
                    ["P24", 159]
                ],
                description: desc("Creatures w/in 5 ft of the space I left must pass a Wis save or have Disadv on attack rolls against creatures other than me until the start of my next turn."),
            },
            autoSelectExtrachoices: [{
                extrachoice: "refreshing step"
            }, {
                extrachoice: "taunting step"
            }]
        },
        "subclassfeature6": {
            name: "Misty Escape",
            source: [
                ["P24", 159]
            ],
            minlevel: 6,
            action: [
                ["reaction", " (When I take damage)"]
            ],
            description: desc([
                "As a reaction when I take damage, I can cast Misty Step, and gain new options for my steps of the fey feature (see notes page).",
            ]),
            "disappearing step": {
                name: "Disappearing Step",
                extraname: "Steps of the Fey Option",
                source: [
                    ["P24", 159]
                ],
                description: desc("I'm Invisible until the start of my next turn or I attack, deal damage, or cast a spell."),
            },
            "dreadful step": {
                name: "Dreadful Step",
                extraname: "Steps of the Fey Option",
                source: [
                    ["P24", 159]
                ],
                description: desc("Creatures within 5 ft of the space I left OR I appear in must pass a Wis save or take 2d10 Psych damage."),
            },
            autoSelectExtrachoices: [{
                extrachoice: "disappearing step"
            }, {
                extrachoice: "dreadful step"
            }]
        },
        "subclassfeature10": {
            name: "Beguiling Defenses",
            source: [
                ["P24", 159]
            ],
            minlevel: 10,
            savetxt: {
                immune: ["Charmed"]
            },
            usages: 1,
            recovery: "long rest",
            altResource: "SS",
            description: desc([
                "Once per Long Rest as a reaction, after a creature I can see hits me with an attack roll I can reduce the damage by half & force the attacker to pass a Wis save or take equal Psych damage. I'm also immune to being Charmed.",
            ]),
        },
        "subclassfeature14": {
            name: "Bewitching Magic",
            source: [
                ["P24", 160]
            ],
            minlevel: 14,
            description: desc([
                "Right after I cast an Ench or Illus spell with an action + spell slot, I can cast Misty Step as part of the same action and without spending a spell slot.",
            ]),
        },
    },
});
legacySubClassRefactor("warlock", "the celestial", {
    regExpSearch: /^(?=.*(warlock))(?=.*(celestial)).*$/i,
    subname: "Celestial Patron",
    source: [
        ["P24", 160]
    ],
    spellcastingExtra: ["aid", "cure wounds", "guiding bolt", "lesser restoration", "light", "sacred flame", "daylight", "revivify", "guardian of faith", "wall of fire", "greater restoration", "summon celestial"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Healing Light",
            source: [
                ["P24", 160]
            ],
            minlevel: 3,
            limfeaname: "Healing Light (d6s)",
            usages: [0, 0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21],
            recovery: "long rest",
            action: [
                ["bonus action", ""]
            ],
            additional: "(Max per use: Cha Mod)",
            description: desc([
                "As a bonus action, I can heal a creature I can see within 60 ft or myself by spending dice from my pool (min 1), healing HP equal to the roll.",
            ]),
        },
        "subclassfeature6": {
            name: "Radiant Soul",
            source: [
                ["P24", 160]
            ],
            minlevel: 6,
            dmgres: ["Radiant"],
            description: desc([
                "Once per turn, when I deal Radiant or Fire spell damage, I can add my Cha mod to the spell's damage against one of the spell's targets. I'm also resistant to Radiant damage.",
            ]),
        },
        "subclassfeature10": {
            name: "Celestial Resilience",
            source: [
                ["P24", 161]
            ],
            minlevel: 10,
            description: desc([
                "I gain Temp HP when I use Magical Cunning or finish a Rest (my Warlock level + Cha mod). Up to five creatures I can see each gain Temp HP (1/2 my Warlock level + Cha mod).",
            ]),
        },
        "subclassfeature14": {
            name: "Searing Vengeance",
            source: [
                ["P24", 161]
            ],
            minlevel: 14,
            description: desc([
                "Once per Long Rest when an ally within 60 ft or I am about to make a Death Save, I can end Prone & the creature regains half its max HP.",
                "When I do, creatures I choose within 30 ft of the target take 2d8 + Cha mod Radiant damage and are Blinded until the end of the turn.",
            ]),
        },
    },
});
legacySubClassRefactor("warlock", "the fiend", {
    regExpSearch: /^(?=.*(warlock))(?=.*(fiend)).*$/i,
    subname: "Fiend Patron",
    spellcastingExtra: ["burning hands", "command", "scorching ray", "suggestion", "fireball", "stinking cloud", "fire shield", "wall of fire", "geas", "insect plague"],
    spellcastingExtraApplyNonconform: true,
    source: [
        ["P24", 161]
    ],
    features: {
        "subclassfeature3": {
            name: "Dark One's Blessing",
            source: [
                ["P24", 161]
            ],
            minlevel: 3,
            description: desc([
                "When I reduce a hostile to 0 HP, I gain Cha mod + Warlock level temp HP (min 1). I also gain this temp HP if an enemy within 10 ft of me is reduced to 0 Hit Points.",
            ]),
        },
        "subclassfeature6": {
            name: "Dark One's Own Luck",
            source: [
                ["P24", 162]
            ],
            minlevel: 6,
            usages: "Charisma modifier per ",
            usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
            recovery: "long rest",
            description: desc([
                "Once per roll, when I make an ability check or saving throw, I can add 1d10 after rolling the d20 but before any of the roll's effects occur.",
            ]),
        },
        "subclassfeature10": {
            name: "Fiendish Resilience",
            source: [
                ["P24", 162]
            ],
            minlevel: 10,
            description: desc([
                "At the end of a Rest, I can choose a damage type (not Force) to be Resistant to until I choose another.",
            ]),
        },
        "subclassfeature14": {
            name: "Hurl Through Hell",
            source: [
                ["P24", 162]
            ],
            minlevel: 14,
            usages: 1,
            recovery: "long rest",
            altResource: "SS",
            description: desc([
                "Once per turn when I hit a creature with an attack roll I can force it to make a Cha save, or it is Incapacitated and disappears into the Lower Planes until the end of my next turn. When it returns it takes 8d10 Psychic damage if it isn't a Fiend. This Feature can be used 1/LR unless I expend a Warlock SS to regain use of it.",
            ]),
        },
    },
});
legacySubClassRefactor("warlock", "the great old one", {
    regExpSearch: /^(?=.*(warlock))(?=.*(great old one)).*$/i,
    subname: "Great Old One Patron",
    source: [
        ["P24", 162]
    ],
    spellcastingExtra: ["detect thoughts", "dissonant whispers", "phantasmal force", "tasha's hideous laughter", "clairvoyance", "hunger of hadar", "confusion", "summon aberration", "modify memory", "telekinesis"],
    spellcastingExtraApplyNonconform: true,
    features: {
        "subclassfeature3": {
            name: "Awakened Mind",
            source: [
                ["P24", 162]
            ],
            minlevel: 3,
            action: "bonus action",
            description: desc([
                "As a Bonus Action, one creature I can see within 30 ft & I can speak telepathically with each other while within my Cha mod miles (min 1) for my Warlock level minutes as long as we share a language. It lasts until I use it with another creature.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Psychic Spells",
            source: [
                ["P24", 163]
            ],
            minlevel: 3,
            description: desc([
                "When I cast a Warlock spell that deals damage I can change to Psych damage. When I cast Ench or Illus Warlock spells I can forgo Verbal or Somatic components.",
            ]),
        },
        "subclassfeature6": {
            name: "Clairvoyant Combatant",
            source: [
                ["P24", 163]
            ],
            minlevel: 6,
            usages: 1,
            recovery: "short rest",
            altResource: "SS",
            description: desc([
                "When I use Awakened Mind, I can force the creature to pass a Wis save or it has Disadv on attack rolls against me & I have Adv on attack rolls against it for the duration. This Feature can be used 1/LR unless I expend a Warlock SS to regain use of it.",
            ]),
        },
        "subclassfeature10": {
            name: "Eldritch Hex",
            source: [
                ["P24", 163]
            ],
            minlevel: 10,
            spellcastingBonus: [{
                name: "Eldritch Hex",
                spells: ["hex"],
                selection: ["hex"],
                times: 1,
            }],
            description: desc([
                "I always have Hex prepared. When I cast it and choose an Ability the target also has Disadv on those saves for the spell's duration.",
            ]),
        },
        "subclassfeature10.1": {
            name: "Thought Shield",
            source: [
                ["P24", 163]
            ],
            minlevel: 10,
            dmgres: ["Psychic"],
            description: desc([
                "My thoughts can't be read unless I allow it. I'm Resistant to Psych damage, and any creature that deals Psychic damage to me takes equal damage.",
            ]),
        },
        "subclassfeature14": {
            name: "Create Thrall",
            source: [
                ["P24", 163]
            ],
            minlevel: 14,
            description: desc([
                "Summon Aberration can not require Concentration; That casting lasts 1 min and the Aberration has Temp HP (my Warlock level + Cha mod).",
                "The first time each turn the Aberration hits a creature under my Hex it deals extra Psych damage equal to the bonus damage of that spell.",
            ]),
        },
    },
});
legacyClassRefactor("wizard", {
    regExpSearch: /wizard/i,
    name: "Wizard",
    source: [
        ["P24", 165]
    ],
    primaryAbility: ["Intelligence"],
    abilitySave: 4,
    prereqs: "Intelligence 13",
    improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
    die: 6,
    saves: ["Int", "Wis"],
    skillstxt: {
        primary: "Choose 2: Arcana, History, Insight, Investigation, Medicine, Nature, or Religion",
    },
    weaponProfs: {
        primary: [true, false],
    },
    equipment: "Wizard starting equipment:" +
        "\n \u2022 2 Daggers;" +
        "\n \u2022 An Arcane Focus (Quarterstaff);" +
        "\n \u2022 A Robe;" +
        "\n \u2022 A Spellbook;" +
        "\n \u2022 A Scholar's Pack, and 5 gp." +
        "\n\nAlternatively, choose 55 gp worth of starting equipment instead of the class's starting equipment.",
    subclasses: ["Wizard Subclass", []],
    attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    spellcastingAbility: 4,
    spellcastingFactor: 1,
    spellcastingKnown: {
        cantrips: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        spells: "book",
        prepared: [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 18, 19, 21, 22, 23, 24, 25],
    },
    features: {
        "spellcasting": {
            name: "Spellcasting",
            source: [
                ["P24", 165]
            ],
            minlevel: 1,
            additional: levels.map(function(n, idx) {
                var cantr = [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx];
                var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 18, 19, 21, 22, 23, 24, 25][idx];
                return cantr + " cantrips \u0026 " + splls + " spells prepared";
            }),
            description: desc([
                "I can cast Prepared Level 1+ Wizard spells using Int as my spellcasting ability.",
                "I have a unique spellbook for Level 1+ spells; only I or the Identify spell can read it. Prepared spells from other Wizard features count as Wizard spells & don't count against my Prepared Spells.",
                "I regain all slots and can replace my Prepared Spells & one cantrip when I finish a Long Rest. I can use an Arcane Focus as a Spellcasting Focus for my Wizard spells.",
            ]),
            toNotesPage: [{
                name: "Expanding and Replacing a Spellbook",
                note: [
                    "The spells I add to my spellbook as I gain levels reflect my ongoing magical research, but I might find other spells during my adventures that I can add to the book. I could discover a Wizard spell on a Spell Scroll for example, and then copy it into my spellbook.",
                    "Copying a Spell into the Book : When I find a level 1+ Wizard spell, I can copy it into my spellbook if it is of a level I can prepare and if I have time to copy it. For each level of the spell, the transcription takes 2 hours and costs 50 gp. Afterward, I can prepare the spell like the other spells in my spellbook.",
                    "Copying the Book : I can copy a spell from my spellbook into another book. This is like copying a new spell into my spellbook but faster, since I already know how to cast the spell. I need to spend only 1 hour and 10 gp for each level of the copied spell.",
                    "If I lose my spellbook, I can use the same procedure to transcribe the Wizard spells that I have prepared into a new spellbook. Filling out the remainder of the new book requires me to find new spells to do so. For this reason, many wizards keep a backup spellbook",
                ],
            }],
        },
        "ritual adept": {
            name: "Ritual Adept",
            source: [
                ["P24", 166]
            ],
            minlevel: 1,
            description: desc([
                "I can cast any spell as a Ritual if that spell has the Ritual tag and is in my spellbook.",
            ]),
        },
        "arcane recovery": {
            name: "Arcane Recovery",
            source: [
                ["P24", 166]
            ],
            minlevel: 1,
            usages: 1,
            recovery: "long rest",
            additional: levels.map(function(n) {
                var lvls = Math.ceil(n / 2);
                return lvls + " level" + (lvls > 1 ? "s" : "") + " of spell slots";
            }),
            description: desc([
                "On a Short Rest, I can recover spell slots up to a combined level equal to no more than half my Wizard level (round up) up to & including Level 5. I can do this once per Long Rest.",
            ]),
        },
        "scholar": function() {
            var a = {
                name: "Scholar",
                source: [
                    ["P24", 166]
                ],
                minlevel: 2,
                description: desc("I gain Expertise in one of these in which I have proficiency: Arcana, History, Investigation, Medicine, Nature, or Religion."),
                skillstxt: "I gain Expertise in one skill; Arcana, History, Investigation, Medicine, Nature, or Religion",
                additional: levels.map(function(n) {
                    return n < 2 ? "" : "with " + (n < 2 ? 0 : 1) + " skill";
                }),
                extraname: "Scholar Expertise",
                extrachoices: ["Arcana", "History", "Investigation", "Medicine", "Nature", "Religion"],
                extraTimes: levels.map(function(n) {
                    return n < 2 ? 0 : 1;
                })
            };
            for (var i = 0; i < a.extrachoices.length; i++) {
                var attr = a.extrachoices[i].toLowerCase();
                a[attr] = {
                    name: a.extrachoices[i] + " Expertise",
                    description: "",
                    source: a.source,
                    skills: [
                        [a.extrachoices[i], "only"]
                    ],
                    prereqeval: function(v) {
                        return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
                    }
                };
            }
            return a;
        }(),
        "subclassfeature3": {
            name: "Wizard Subclass",
            source: [
                ["P24", 167]
            ],
            minlevel: 3,
            description: desc([
                "Choose a Wizard subclass and put it in the 'Class' field.",
            ]),
        },
        "memorize spell": {
            name: "Memorize Spell",
            source: [
                ["P24", 167]
            ],
            minlevel: 5,
            description: desc([
                "When I finish a Short Rest I can replace one Prepared level 1+ Wizard spell with another.",
            ]),
        },
        "spell mastery": {
            name: "Spell Mastery",
            source: [
                ["P24", 167]
            ],
            minlevel: 18,
            description: desc([
                "One level 1 & one level 2 spell in my spellbook with a casting time of 1 action are always Prepared. I can cast them at their lowest level without a spell slot; To cast either at a higher level I must spend a spell slot. I can replace these at the end of a Long Rest.",
            ]),
        },
        "epic boon": {
            name: "Epic Boon",
            source: [
                ["P24", 167]
            ],
            minlevel: 19,
            description: desc([
                "I gain an Epic Boon feat, or another feat of my choice for which I qualify.",
            ]),
        },
        "signature spells": {
            name: "Signature Spell",
            source: [
                ["P24", 167]
            ],
            minlevel: 20,
            description: desc([
                "Two level 3 spells are always Prepared; Once per Rest I can cast them at their lowest level without a spell slot; To cast either at a higher level I must spend a spell slot.",
            ]),
        },
    },
});
legacySubClassRefactor("wizard", "abjurer", {
    regExpSearch: /^(?=.*(wizard))(?=.*(abjurer)).*$/i,
    subname: "Abjurer",
    source: [
        ["P24", 172]
    ],
    replaces: "abjuration",
    features: {
        "subclassfeature3": {
            name: "Abjuration Savant",
            source: [
                ["P24", 172]
            ],
            minlevel: 3,
            spellcastingBonus: [{
                name: "Abjuration Savant (3)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 3 ? 0 : 2;
                }),
                level: [1, 2],
            }, {
                name: "Abjuration Savant (5)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 5 ? 0 : 1;
                }),
                level: [1, 3],
            }, {
                name: "Abjuration Savant (7)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 7 ? 0 : 1;
                }),
                level: [1, 4],
            }, {
                name: "Abjuration Savant (9)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 9 ? 0 : 1;
                }),
                level: [1, 5],
            }, {
                name: "Abjuration Savant (11)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 11 ? 0 : 1;
                }),
                level: [1, 6],
            }, {
                name: "Abjuration Savant (13)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 13 ? 0 : 1;
                }),
                level: [1, 7],
            }, {
                name: "Abjuration Savant (15)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 15 ? 0 : 1;
                }),
                level: [1, 8],
            }, {
                name: "Abjuration Savant (17)",
                "class": "wizard",
                school: "Abjur",
                times: levels.map(function(n) {
                    return n < 17 ? 0 : 1;
                }),
                level: [1, 9],
            }],
            description: desc([
                "I gain two Wizard spells from the Abjuration school, level 2 or lower, for free. I gain a spell in this way each time I gain access to a new level of spell slots in this class.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Arcane Ward",
            source: [
                ["P24", 172]
            ],
            minlevel: 3,
            action: ["bonus action", " (expend spell slot)"],
            usages: 1,
            recovery: "long rest",
            additional: levels.map(function(n) {
                return n < 3 ? "" : "Ward max HP: " + (n * 2) + "+Int mod";
            }),
            description: desc([
                "Once per Long Rest when I cast an Abj spell with a spell slot I can create a magic ward on myself that lasts until the end of my next Long Rest. When I take damage the ward takes it instead; I apply my Resistances & Vulnerabilities before this. If the ward reaches 0 Hit Points I take any remaining damage and the ward can't take any more.",
                "When I cast an Abj spell with a spell slot or spend a slot as a Bonus Action the ward regains HP equal to twice the slot level.",
            ]),
        },
        "subclassfeature6": {
            name: "Projected Ward",
            source: [
                ["P24", 172]
            ],
            minlevel: 6,
            action: ["reaction", ""],
            description: desc([
                "When a creature I can see w/in 30 ft of me takes damage, I can take a Reaction for my Arcane Ward to absorb that it after that creature's Resistances & Vulnerabilities. If the ward reaches 0 Hit Points the warded creature takes any remaining damage.",
            ]),
        },
        "subclassfeature10": {
            name: "Spell Breaker",
            source: [
                ["P24", 173]
            ],
            minlevel: 10,
            action: [
                ["bonus action", " (Dispel Magic)"]
            ],
            spellcastingBonus: [{
                name: "Spell Breaker",
                spells: ["counterspell", "dispel magic"],
                selection: ["counterspell", "dispel magic"],
                times: 2,
                prepared: true,
            }],
            description: desc([
                "I always have Counterspell & Dispel Magic prepared. I can cast Dispel Magic as a Bonus Action & add my Prof Bonus to its ability check. When I cast either spell with a spell slot that slot isn't expended if the spell fails.",
            ]),
        },
        "subclassfeature14": {
            name: "Spell Resistance",
            source: [
                ["P24", 173]
            ],
            minlevel: 14,
            savetxt: {
                adv_vs: ["spells"],
                text: ["Resistance to the damage of spells"],
            },
            description: desc([
                "I have Adv on saving throws against spells & Resistance to the damage of spells.",
            ]),
        },
    },
});
legacySubClassRefactor("wizard", "diviner", {
    regExpSearch: /^(?=.*(wizard))(?=.*(diviner)).*$/i,
    subname: "Diviner",
    source: [
        ["P24", 173]
    ],
    replaces: "divination",
    features: {
        "subclassfeature3": {
            name: "Divination Savant",
            source: [
                ["P24", 173]
            ],
            minlevel: 3,
            spellcastingBonus: [{
                name: "Divination Savant (3)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 3 ? 0 : 2;
                }),
                level: [1, 2],
            }, {
                name: "Divination Savant (5)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 5 ? 0 : 1;
                }),
                level: [1, 3],
            }, {
                name: "Divination Savant (7)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 7 ? 0 : 1;
                }),
                level: [1, 4],
            }, {
                name: "Divination Savant (9)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 9 ? 0 : 1;
                }),
                level: [1, 5],
            }, {
                name: "Divination Savant (11)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 11 ? 0 : 1;
                }),
                level: [1, 6],
            }, {
                name: "Divination Savant (13)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 13 ? 0 : 1;
                }),
                level: [1, 7],
            }, {
                name: "Divination Savant (15)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 15 ? 0 : 1;
                }),
                level: [1, 8],
            }, {
                name: "Divination Savant (17)",
                "class": "wizard",
                school: "Div",
                times: levels.map(function(n) {
                    return n < 17 ? 0 : 1;
                }),
                level: [1, 9],
            }],
            description: desc([
                "I gain two Wizard spells from the Divination school, level 2 or lower, for free. I gain a spell in this way each time I gain access to a new level of spell slots in this class.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Portent",
            source: [
                ["P24", 173]
            ],
            minlevel: 3,
            additional: levels.map(function(n) {
                return n < 2 ? "" : (n < 14 ? 2 : 3) + "d20 after a long rest";
            }),
            description: desc([
                "When I finish a Long Rest I can record a number of d20 rolls; Once per turn before a d20 test is rolled by me or a crea. I can see, I can replace the roll, spending the d20. These reset when I finish a long rest.",
            ]),
        },
        "subclassfeature6": {
            name: "Expert Divination",
            source: [
                ["P24", 173]
            ],
            minlevel: 6,
            description: desc([
                "When I cast using a level 2+ spell slot, I regain one slot below the level cast & level 5-.",
            ]),
        },
        "subclassfeature10": {
            name: "The Third Eye",
            source: [
                ["P24", 173]
            ],
            minlevel: 10,
            action: "bonus action",
            usages: 1,
            recovery: "short rest",
            description: desc([
                "Once per Rest as a Bonus Action, I gain one of the following benefits until my next rest.",
                "Darkvision: I gain Darkvision with a range of 120 feet.",
                "Greater Comprehension: I can read any language.",
                "See Invisibility: I can cast See Invisibility without spending a spell slot.",
            ]),
        },
        "subclassfeature14": {
            name: "Greater Portent",
            source: [
                ["P24", 173]
            ],
            minlevel: 14,
            description: desc([
                "Roll three d20s for my Portent feature rather than two.",
            ]),
        },
    },
});
legacySubClassRefactor("wizard", "evoker", {
    regExpSearch: /^(?=.*(wizard))(?=.*(evoker)).*$/i,
    subname: "Evoker",
    source: [
        ["P24", 174]
    ],
    replaces: "evocation",
    features: {
        "subclassfeature3": {
            name: "Evocation Savant",
            source: [
                ["P24", 174]
            ],
            minlevel: 3,
            spellcastingBonus: [{
                name: "Evocation Savant (3)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 3 ? 0 : 2;
                }),
                level: [1, 2],
            }, {
                name: "Evocation Savant (5)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 5 ? 0 : 1;
                }),
                level: [1, 3],
            }, {
                name: "Evocation Savant (7)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 7 ? 0 : 1;
                }),
                level: [1, 4],
            }, {
                name: "Evocation Savant (9)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 9 ? 0 : 1;
                }),
                level: [1, 5],
            }, {
                name: "Evocation Savant (11)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 11 ? 0 : 1;
                }),
                level: [1, 6],
            }, {
                name: "Evocation Savant (13)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 13 ? 0 : 1;
                }),
                level: [1, 7],
            }, {
                name: "Evocation Savant (15)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 15 ? 0 : 1;
                }),
                level: [1, 8],
            }, {
                name: "Evocation Savant (17)",
                "class": "wizard",
                school: "Evoc",
                times: levels.map(function(n) {
                    return n < 17 ? 0 : 1;
                }),
                level: [1, 9],
            }],
            description: desc([
                "I gain two Wizard spells from the Evocation school, level 2 or lower, for free. I gain a spell in this way each time I gain access to a new level of spell slots in this class.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Potent Cantrip",
            source: [
                ["P24", 174]
            ],
            minlevel: 3,
            description: desc([
                "When I cast a cantrip at a creature and miss or the target passes its save, the target takes half the cantrip's damage (if any) but suffers no additional effect from the cantrip.",
            ]),
        },
        "subclassfeature6": {
            name: "Sculpt Spell",
            source: [
                ["P24", 174]
            ],
            minlevel: 6,
            description: desc([
                "When I cast an Evoc spell that affects other creatures I can see I can choose the spell's level + 1 creatures who pass automatically & take no damage if they would've taken half.",
            ]),
        },
        "subclassfeature10": {
            name: "Empowered Evocation",
            source: [
                ["P24", 174]
            ],
            minlevel: 10,
            description: desc([
                "When I cast an Evoc Wizard spell I can add my Int mod to one of its damage rolls.",
            ]),
        },
        "subclassfeature14": {
            name: "Overchannel",
            source: [
                ["P24", 174]
            ],
            minlevel: 14,
            description: desc([
                "When I cast a Wizard spell that deals damage with a slot of level 1-5, I can deal max damage with that spell on the turn I cast it once per rest with no adverse effect.",
                "The second time I take 2d12 Necro damage (ignore Resistance/Immunity) for each level of the spell. The Necro damage goes up by 1d12 per level each time. A Long Rest resets it.",
            ]),
        },
    },
});
legacySubClassRefactor("wizard", "illusionist", {
    regExpSearch: /^(?=.*(wizard))(?=.*(illusionist)).*$/i,
    subname: "Illusionist",
    source: [
        ["P24", 175]
    ],
    replaces: "illusion",
    features: {
        "subclassfeature3": {
            name: "Illusion Savant",
            source: [
                ["P24", 175]
            ],
            minlevel: 3,
            spellcastingBonus: [{
                name: "Illusion Savant (3)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 3 ? 0 : 2;
                }),
                level: [1, 2],
            }, {
                name: "Illusion Savant (5)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 5 ? 0 : 1;
                }),
                level: [1, 3],
            }, {
                name: "Illusion Savant (7)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 7 ? 0 : 1;
                }),
                level: [1, 4],
            }, {
                name: "Illusion Savant (9)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 9 ? 0 : 1;
                }),
                level: [1, 5],
            }, {
                name: "Illusion Savant (11)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 11 ? 0 : 1;
                }),
                level: [1, 6],
            }, {
                name: "Illusion Savant (13)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 13 ? 0 : 1;
                }),
                level: [1, 7],
            }, {
                name: "Illusion Savant (15)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 15 ? 0 : 1;
                }),
                level: [1, 8],
            }, {
                name: "Illusion Savant (17)",
                "class": "wizard",
                school: "Illus",
                times: levels.map(function(n) {
                    return n < 17 ? 0 : 1;
                }),
                level: [1, 9],
            }],
            description: desc([
                "I gain two Wizard spells from the Illusion school, level 2 or lower, for free. I gain a spell in this way each time I gain access to a new level of spell slots in this class.",
            ]),
        },
        "subclassfeature3.1": {
            name: "Improved Illusion",
            source: [
                ["P24", 175]
            ],
            minlevel: 3,
            spellcastingBonus: [{
                name: "Improved Illusion",
                spells: ["minor illusion"],
                selection: ["minor illusion"],
                times: 1,
            }],
            description: desc([
                "I can cast Illus spells w/out V components; Illus spells with a range of 10+ ft go up by 60 ft I know and can cast Minor Illusion as a Bonus Action, creating both a sound & image with one cast. It doesn't count against my cantrips known.",
            ]),
        },
        "subclassfeature6": {
            name: "Phantasmal Creatures",
            source: [
                ["P24", 175]
            ],
            minlevel: 6,
            spellcastingBonus: [{
                name: "Phantasmal Creatures",
                spells: ["summon beast", "summon fey"],
                selection: ["summon beast", "summon fey"],
                times: 2,
                firstCol: "oncelr",
            }],
            description: desc([
                "I always have Summon Beast and Summon Fey prepared. Once per Long Rest I can cast each spell as an Illus spell and cast it without a spell slot, halving the summoned creature's HP & making it appear spectral.",
            ]),
        },
        "subclassfeature10": {
            name: "Illusory Self",
            source: [
                ["P24", 175]
            ],
            minlevel: 10,
            action: "reaction",
            usages: 1,
            recovery: "short rest",
            altResource: "SS 2+",
            description: desc([
                "As a reaction, I can block an attack against me with an illusion of myself. It returns on a rest or by spending a Level 2+ spell slot (no action).",
            ]),
        },
        "subclassfeature14": {
            name: "Illusory Reality",
            source: [
                ["P24", 175]
            ],
            minlevel: 14,
            action: "bonus action",
            description: desc([
                "As a Bonus Action during an Illus spell I cast with a spell slot I can make one object in it real for 1 min (does no damage, gives no conditions).",
            ]),
        },
    },
});
//Backgrounds
legacyBackgroundRefactor("acolyte", {
    regExpSearch: /^(?=.*acolyte).*$/i,
    name: "Acolyte",
    source: [
        ["P24", 178]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Intelligence, Wisdom, and Charisma"],
    skills: ["Insight", "Religion"],
    gold: 8,
    equipleft: [
        ["Book (prayers)", "", 5],
        ["Parchment, sheets of", 10, ""],
        ["Robes", "", 4],
    ],
    equipright: [
        ["Calligrapher's Supplies", "", 5],
        ["Holy symbol", "", 1],
        ["Belt pouch (with coins)", "", 1],
    ],
    feature: "Magic Initiate (Cleric) [Origin]",
    trait: [
        "I devoted myself to service in a temple, either nestled in a town or secluded in a sacred grove. There I performed rites in honor of a god or pantheon. I served under a priest and studied religion. Thanks to my priest's instruction and my own devotion, I also learned how to channel a modicum of divine power in service to my place of worship and the people who prayed there."
    ],
});
legacyBackgroundRefactor("artisan", {
    regExpSearch: /^(?=.*artisan).*$/i,
    name: "Artisan",
    source: [
        ["P24", 178]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Intelligence"],
    skills: ["Investigation", "Persuasion"],
    toolProfs: [
        ["Artisan's tools", 1]
    ],
    gold: 32,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Artisan's Tools", "", 5],
        ["Belt pouch (with coins)", 2, 1],
    ],
    feature: "Crafter [Origin]",
    trait: [
        "I began mopping floors and scrubbing counters in an artisan's workshop for a few coppers per day as soon as I was strong enough to carry a bucket. When I was old enough to apprentice, I learned to create basic crafts of my own, as well as how to sweet talk the occasional demanding customer. My trade has also given me a keen eye for detail."
    ],
});
legacyBackgroundRefactor("charlatan", {
    regExpSearch: /^(?=.*charlatan).*$/i,
    name: "Charlatan",
    source: [
        ["P24", 179]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Charisma"],
    skills: ["Deception", "Sleight of Hand"],
    toolProfs: [
        ["Forgery Kit"]
    ],
    gold: 15,
    equipright: [
        ["Fine Clothes", "", 4],
        ["Costume", "", 1],
    ],
    equipleft: [
        ["Forgery Kit", "", 5],
    ],
    feature: "Skilled [Origin]",
    trait: [
        "Once I was old enough to order an ale, I soon had a favorite stool in every tavern within ten miles of where I was born. As I traveled the circuit from public house to watering hole, I learned to prey on unfortunates who were in the market for a comforting lie or two - perhaps a sham potion or forged ancestry records."
    ],
});
legacyBackgroundRefactor("criminal", {
    regExpSearch: /^(?=.*criminal).*$/i,
    name: "Criminal",
    source: [
        ["P24", 179]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Intelligence"],
    skills: ["Sleight of Hand", "Stealth"],
    toolProfs: [
        ["Thieves' Tools"]
    ],
    gold: 16,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Dagger", 2, 1],
        ["Belt pouch (with coins)", 2, 1],
    ],
    equipleft: [
        ["Crowbar", "", 5],
        ["Thieves' Tools", "", 1],
    ],
    feature: "Alert [Origin]",
    trait: [
        "I eked out a living in dark alleyways, cutting purses or burgling shops. Perhaps I were part of a small gang of like-minded wrongdoers who looked out for each other. Or maybe I were a lone wolf, fending for myself against the local thieves' guild and more fearsome lawbreakers."
    ],
});
legacyBackgroundRefactor("entertainer", {
    regExpSearch: /^(?=.*entertainer).*$/i,
    name: "Entertainer",
    source: [
        ["P24", 180]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Charisma"],
    skills: ["Acrobatics", "Performance"],
    toolProfs: [
        ["Musical Instrument", 1]
    ],
    gold: 11,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Costumes", 2, 1],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Mirror", "", 0.5],
        ["Perfume", "", ""],
        ["Musical Instrument", "", ""],
    ],
    feature: "Musician [Origin]",
    trait: [
        "I spent much of my youth following roving fairs and carnivals, performing odd jobs for musicians and acrobats in exchange for lessons. I may have learned how to walk a tightrope, how to play a lute in a distinct style, or how to recite poetry with impeccable diction. To this day, I thrive on applause and long for the stage."
    ],
});
legacyBackgroundRefactor("farmer", {
    regExpSearch: /^(?=.*farmer).*$/i,
    name: "Farmer",
    source: [
        ["P24", 180]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Constitution, and Wisdom"],
    skills: ["Animal Handling", "Nature"],
    toolProfs: [
        ["Carpenter's Tools"]
    ],
    gold: 30,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Sickle", "", 1],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Iron Pot", "", 10],
        ["Shovel", "", 5],
        ["Healer's Kit", "", 3],
        ["Carpenter's Tools", "", 6],
    ],
    feature: "Tough [Origin]",
    trait: [
        "I grew up close to the land. Years tending animals and cultivating the earth rewarded me with patience and good health. I have a keen appreciation for nature's bounty alongside a healthy respect for nature's wrath."
    ],
});
legacyBackgroundRefactor("guard", {
    regExpSearch: /^(?=.*guard).*$/i,
    name: "Guard",
    source: [
        ["P24", 181]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Intelligence, and Wisdom"],
    skills: ["Athletics", "Perception"],
    toolProfs: [
        ["Gaming Set", 1]
    ],
    gold: 12,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Spear", "", 1],
        ["Light Crossbow", "", 5],
        ["Bolt(s)", 20, 0.075],
        ["Case, Crossbow bolt", "", 1],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Manacles", "", 6],
        ["Hooded Lantern", "", 2],
        ["Gaming Set", "", ""],
    ],
    feature: "Alert [Origin]",
    trait: [
        "my feet ache when I remember the countless hours I spent at my post in the tower. I was trained to keep one eye looking outside the wall watching for marauders sweeping from the nearby forest, and my other eye looking inside the wall searching for cut purses and troublemakers."
    ],
});
RunFunctionAtEnd(function() {
    if (BackgroundList.outlander) BackgroundList.outlander.regExpSearch = /^(?=.*(outlander|forester|trapper|homesteader|exile|outcast|tribal nomad|hunter-gatherer|tribal.?marauder)).*$/i;
});
legacyBackgroundRefactor("guide", {
    regExpSearch: /^(?=.*guide).*$/i,
    name: "Guide",
    source: [
        ["P24", 181]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Wisdom"],
    skills: ["Stealth", "Survival"],
    toolProfs: [
        ["Cartographer's Tools"]
    ],
    gold: 3,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Shortbow", "", 1],
        ["Arrow(s)", 20, 0.05],
        ["Quiver", "", 1],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Bedroll", "", 7],
        ["Tent", "", 20],
        ["Cartographer's Tools", "", 6],
    ],
    feature: "Magic Initiate (Druid) [Origin]",
    trait: [
        "I came of age outdoors, far from settled lands. My home was anywhere I chose to spread my bedroll. There are wonders in the wilderness - strange monsters, pristine forests, streams, overgrown ruins of great halls once trod by giants - and I learned to fend for myself as I explored them. From time to time, I guided friendly nature priests who instructed me in the fundamentals of channeling the magic of the wild."
    ],
});
legacyBackgroundRefactor("hermit", {
    regExpSearch: /^(?=.*hermit).*$/i,
    name: "Hermit",
    source: [
        ["P24", 182]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Wisdom, and Charisma"],
    skills: ["Medicine", "Religion"],
    toolProfs: [
        ["Herbalism Kit"]
    ],
    gold: 16,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Quarterstaff", "", 1],
        ["Book (philosophy)", "", 5],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Bedroll", "", 7],
        ["Lamp Oil", 3, 1],
        ["Herbalism Kit", "", 3],
    ],
    feature: "Healer [Origin]",
    trait: [
        "I spent my early years secluded in a hut or monastery located well beyond the outskirts of the nearest settlement. In those days, my only companions were the creatures of the forest and those who would occasionally visit to bring news of the outside world and supplies. The solitude allowed me to spend many hours pondering the mysteries of creation."
    ],
});
legacyBackgroundRefactor("merchant", {
    regExpSearch: /^(?=.*merchant).*$/i,
    name: "Merchant",
    source: [
        ["P24", 182]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Intelligence, and Charisma"],
    skills: ["Animal Handling", "Persuasion"],
    toolProfs: [
        ["Navigator's Tools"]
    ],
    gold: 22,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
    ],
    equipleft: [
        ["Navigator's Tools", "", 2],
    ],
    feature: "Lucky [Origin]",
    trait: [
        "I was apprenticed to a trader, caravan master, or shopkeeper, learning the fundamentals of commerce. I traveled broadly, and I earned a living by buying and selling the raw materials artisans need to practice their craft or finished works from such crafters. I might have transported goods from one place to another (by ship, wagon, or caravan) or bought them from traveling traders and sold them in my own shop."
    ],
});
legacyBackgroundRefactor("noble", {
    regExpSearch: /^(?=.*noble).*$/i,
    name: "Noble",
    source: [
        ["P24", 183]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Intelligence, and Charisma"],
    skills: ["History", "Persuasion"],
    toolProfs: [
        ["Gaming Set", 1]
    ],
    gold: 29,
    equipright: [
        ["Fine Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
    ],
    equipleft: [
        ["Gaming Set", "", ""],
        ["Perfume", "", ""],
    ],
    feature: "Skilled [Origin]",
    trait: [
        "I was raised in a castle, surrounded by wealth, power, and privilege. My family of minor aristocrats ensured that I received a first-class education, some of which I appreciated and some of which I resented. My time in the castle, especially the many hours I spent observing my family at court, also taught me a great deal about leadership."
    ],
});
legacyBackgroundRefactor("sage", {
    regExpSearch: /^(?=.*sage).*$/i,
    name: "Sage",
    source: [
        ["P24", 183]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Intelligence, and Wisdom"],
    skills: ["Arcana", "History"],
    toolProfs: [
        ["Calligrapher's Supplies"]
    ],
    gold: 8,
    equipright: [
        ["Robes", "", 4],
        ["Quarterstaff", "", 1],
        ["Book (history)", "", 5],
        ["Belt pouch (with coins)", 1, 1],
    ],
    equipleft: [
        ["Parchment, Sheets of", 8, ""],
        ["Calligrapher's Supplies", "", 5],
    ],
    feature: "Magic Initiate (Wizard) [Origin]",
    trait: [
        "I spent my formative years traveling between manors and monasteries, performing various odd jobs and services in exchange for access to their libraries. I whiled away many a long evening studying books and scrolls, learning the lore of the multiverse - even the rudiments of magic - and my mind yearns for more."
    ],
});
legacyBackgroundRefactor("sailor", {
    regExpSearch: /^(?=.*sailor).*$/i,
    name: "Sailor",
    source: [
        ["P24", 184]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Wisdom"],
    skills: ["Acrobatics", "Perception"],
    toolProfs: [
        ["Navigator's Tools"]
    ],
    gold: 20,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
        ["Dagger", "", 1],
    ],
    equipleft: [
        ["Navigator's Tools", "", 2],
        ["Rope", "", 5],
    ],
    feature: "Tavern Brawler [Origin]",
    trait: [
        "I lived as a seafarer, wind at my back and decks swaying beneath my feet. I've perched on bar stools in more ports of call than I can remember, faced mighty storms, and swapped stories with folk who live beneath the waves."
    ],
});
legacyBackgroundRefactor("scribe", {
    regExpSearch: /^(?=.*scribe).*$/i,
    name: "Scribe",
    source: [
        ["P24", 184]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Intelligence, and Wisdom"],
    skills: ["Investigation", "Perception"],
    toolProfs: [
        ["Calligrapher's Tools"]
    ],
    gold: 23,
    equipright: [
        ["Fine Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
    ],
    equipleft: [
        ["Calligrapher's Supplies", "", 5],
        ["Lamp Oil, Flasks of", 3, 1],
        ["Parchment, Sheets of", 12, ""],
    ],
    feature: "Skilled [Origin]",
    trait: [
        "I spent formative years in a scriptorium, a monastery dedicated to the preservation of knowledge, or a government agency, where I learned to write with a clear hand and produce finely written texts. Perhaps I scribed government documents or copied tomes of literature, I might have some skill as a writer of poetry, narrative, or scholarly research. Above all, I have a careful attention to detail, helping me avoid introducing mistakes to the documents I copy and create."
    ],
});
legacyBackgroundRefactor("soldier", {
    regExpSearch: /^(?=.*soldier).*$/i,
    name: "Soldier",
    source: [
        ["P24", 185]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Constitution"],
    skills: ["Athletics", "Intimidation"],
    toolProfs: [
        ["Gaming Set", 1]
    ],
    gold: 14,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
        ["Spear", "", 1],
        ["Shortbow", "", 1],
        ["Arrow(s)", 20, 0.05],
        ["Quiver", "", 1],
    ],
    equipleft: [
        ["Gaming Set", "", ""],
        ["Healer's kit", "", 3],
    ],
    feature: "Savage Attacker [Origin]",
    trait: [
        "I began training for war as soon as I reached adulthood and carry precious few memories of life before I took up arms. Battle is in my blood. Sometimes I catch myself reflexively performing the basic fighting exercises I learned first. Eventually, I put that training to use on the battlefield, protecting the realm by waging war."
    ],
});
legacyBackgroundRefactor("wayfarer", {
    regExpSearch: /^(?=.*wayfarer).*$/i,
    name: "Wayfarer",
    source: [
        ["P24", 185]
    ],
    scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Wisdom, and Charisma"],
    skills: ["Insight", "Stealth"],
    toolProfs: [
        ["Thieves' Tools"]
    ],
    gold: 16,
    equipright: [
        ["Traveler's Clothes", "", 4],
        ["Belt pouch (with coins)", 2, 1],
        ["Dagger", 2, 1],
    ],
    equipleft: [
        ["Thieves' Tools", "", 1],
        ["Gaming Set", "", ""],
        ["Bedroll", "", 7],
    ],
    feature: "Lucky [Origin]",
    trait: [
        "I grew up on the streets surrounded by similarly ill-fated castoffs, a few of them friends and a few of them rivals. I slept where I could and did odd jobs for food. At times, when the hunger became unbearable, I resorted to theft Still, I never lost my pride and never abandoned hope. Fate is not finished with me."
    ],
});
BackgroundFeatureList["magic initiate (cleric)"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 178]
    ],
    eval: function() {
        AddFeat("Magic Initiate (Cleric) [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Magic Initiate (Cleric) [Origin]");
    }
};
BackgroundFeatureList["crafter"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 178]
    ],
    eval: function() {
        AddFeat("Crafter [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Crafter [Origin]");
    }
};
BackgroundFeatureList["skilled"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 179]
    ],
    eval: function() {
        AddFeat("Skilled [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Skilled [Origin]");
    }
};
BackgroundFeatureList["alert"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 179]
    ],
    eval: function() {
        AddFeat("Alert [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Alert [Origin]");
    }
};
BackgroundFeatureList["musician"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 180]
    ],
    eval: function() {
        AddFeat("Musician [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Musician [Origin]");
    }
};
BackgroundFeatureList["tough"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 180]
    ],
    eval: function() {
        AddFeat("Tough [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Tough [Origin]");
    }
};
BackgroundFeatureList["magic initiate (druid)"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 181]
    ],
    eval: function() {
        AddFeat("Magic Initiate (Druid) [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Magic Initiate (Druid) [Origin]");
    }
};
BackgroundFeatureList["healer"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 182]
    ],
    eval: function() {
        AddFeat("Healer [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Healer [Origin]");
    }
};
BackgroundFeatureList["lucky"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 182]
    ],
    eval: function() {
        AddFeat("Lucky [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Lucky [Origin]");
    }
};
BackgroundFeatureList["magic initiate (wizard)"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 183]
    ],
    eval: function() {
        AddFeat("Magic Initiate (Wizard) [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Magic Initiate (Wizard) [Origin]");
    }
};
BackgroundFeatureList["tavern brawler"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 184]
    ],
    eval: function() {
        AddFeat("Tavern Brawler [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Tavern Brawler [Origin]");
    }
};
BackgroundFeatureList["savage attacker"] = {
    description: desc([
        "",
    ]),
    source: [
        ["P24", 185]
    ],
    eval: function() {
        AddFeat("Savage Attacker [Origin]");
    },
    removeeval: function() {
        RemoveFeat("Savage Attacker [Origin]");
    }
};
//Species
legacyRaceRefactor("aasimar", {
    regExpSearch: /aasimar/i,
    name: "Aasimar",
    sortname: "Aasimar",
    source: [
        ["P24", 186]
    ],
    plural: "Aasimar",
    size: [3, 4],
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 60]
    ],
    dmgres: ["Necrotic", "Radiant"],
    age: " reach maturity their in late teens and live about 160 years",
    height: " are about 2-4 or 4-7 feet tall",
    features: {
        "healing hands": {
            name: "Healing Hands",
            minlevel: 1,
            limfeaname: "Healing Hands",
            usages: 1,
            recovery: "long rest",
            action: "action",
            description: desc([
                "As a Magic action, I touch a creature and roll a number of d4s equal to my Proficiency Bonus. The creature regains a number of Hit Points equal to the total rolled. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
        "celestial revelation": {
            name: "Celestial Revelation",
            limfeaname: "Celestial Revelation",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Celestial Revelation"]
            ],
            description: desc([
                "When I reach character level 3, I can transform as a Bonus Action using one of the options below (See Notes Page) (choose the option each time I transform). That transformation lasts for 1 minute or until I end it (no action required). Once I transform, I can't do so again until I finish a Long Rest. Once on each of my turns before the transformation ends, I can deal extra damage to one target when I deal damage to it with an attack or a spell. The extra damage equals my Proficiency Bonus, and the extra damage's type is either Necrotic for Necrotic Shroud or Radiant for Heavenly Wings and Inner Radiance.",
            ]),
            toNotesPage: [{
                name: "Celestial Revelation",
                note: [
                    "Heavenly Wings : Two spectral wings sprout from my back temporarily. Until the transformation ends, I have a Fly Speed equal to my Speed.",
                    "Inner Radiance : Searing light temporarily radiates from my eyes and mouth. For the duration, I shed Bright Light in a 10-foot radius and Dim Light for an additional 10 feet, and at the end of each of my turns, each creature within 10 feet of me takes Radiant damage equal to my Proficiency Bonus",
                    "Necrotic Shroud : My eyes briefly become pools of darkness, and flightless wings sprout from my back temporarily. Creatures other than my allies within 10 feet of me must succeed on a Charisma saving throw (DC 8 plus my Charisma modifier and Proficiency Bonus) or have the Frightened condition until the end of my next turn",
                ],
            }],
        },
    },
    spellcastingAbility: 6,
    spellcastingBonus: [{
        name: "Light Bearer",
        spells: ["light"],
        selection: ["light"],
        times: 1,
    }],
    trait: "Aasimar\n\u2022 Healing Hands: Once per Long Rest as a Magic action I can touch a creature & restore my Prof Bonus d4s HP.\n\u2022 Light Bearer: I know the Light cantrip. Charisma is my spellcasting ability for it.\n\u2022 Celestial Revelation: Once per Long Rest as a Bonus Action I can transform for 1 min or until I end it. (no action) (choose an option each time) (See Notes Page)",
    replaces: ["fallen aasimar", "protector aasimar", "scourge aasimar", "multiverse aasimar"]
});
legacyRaceRefactor("dragonborn", {
    regExpSearch: /dragonborn/i,
    name: "Dragonborn",
    source: [
        ["P24", 187]
    ],
    plural: "Dragonborn",
    size: 3,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 60]
    ],
    weaponOptions: [{
        regExpSearch: /^(?=.*breath)(?=.*weapon).*$/i,
        name: "Breath weapon",
        source: [
            ["P24", 187]
        ],
        ability: 3,
        type: "Special",
        damage: [1, 10, "fire"],
        range: "15-ft cone/30-ft line",
        description: "Hits all in area; Dex save, success - half damage; Usable Prof Bonus per long Rest",
        abilitytodamage: false,
        dc: true,
        dbBreathWeapon: true,
        selectNow: true,
        isAlwaysProf: true,
    }],
    age: " reach maturity in late teens and live about 80 years",
    height: " are about 5 - 7 feet tall",
    heightMetric: " are about 1,5 - 2,1 meters tall",
    trait: "Dragonborn\n\u2022 Draconic Ancestry: Use 'Racial Options' above to choose a dragon progenitor, affecting my Breath Weapon, Damage Resistance trait, & appearance.",
    features: {
        "draconic ancestry": {
            name: "Draconic Ancestry",
            limfeaname: "Breath Weapon",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            additional: levels.map(function(n) {
                return (n < 5 ? 1 : n < 11 ? 2 : n < 17 ? 3 : 4) + 'd10';
            }),
            recovery: "long rest",
            action: [
                ["action"]
            ],
            calcChanges: {
                atkAdd: [
                    function(fields, v) {
                        if (v.theWea.dbBreathWeapon && CurrentRace.known === 'dragonborn') {
                            fields.Damage_Die = (CurrentRace.level < 5 ? 1 : CurrentRace.level < 11 ? 2 : CurrentRace.level < 17 ? 3 : 4) + 'd10';
                            if (CurrentRace.variant) {
                                fields.Damage_Type = CurrentRace.dmgres[0];
                            }
                        }
                    },
                    "",
                    1
                ]
            }
        },
        "draconic flight": {
            name: "Draconic Flight",
            source: [
                ["P24", 187]
            ],
            minlevel: 5,
            action: ["bonus action"],
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5, I can channel draconic magic to give myself temporary flight. As a Bonus Action, I sprout spectral wings on my back that last for 10 minutes or until I retract the wings (no action required) or have the incapacitated condition. During that time I have a Fly Speed equal to my Speed. My wings appear to be made of the same energy as my Breath Weapon. Once I use this trait, I can't use it again until I finish a Long Rest",
            ]),
        },
    },
    variants: ["black", "blue", "brass", "bronze", "copper", "gold", "green", "red", "silver", "white"]
});
RaceSubList["dragonborn-black"] = {
    regExpSearch: /black/i,
    name: "Black Dragonborn",
    trait: "Black Dragonborn\n\u2022 Acid Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Acid damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Acid wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Acid"],
};
RaceSubList["dragonborn-blue"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*blue).*$/i,
    name: "Blue Dragonborn",
    sortname: "Dragonborn, Blue",
    trait: "Blue Dragonborn\n\u2022 Lightning Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Lightning damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Lightning wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Lightning"]
};
RaceSubList["dragonborn-brass"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*brass).*$/i,
    name: "Brass Dragonborn",
    sortname: "Dragonborn, Brass",
    trait: "Brass Dragonborn\n\u2022 Fire Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Fire damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Fire wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Fire"]
};
RaceSubList["dragonborn-bronze"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*bronze).*$/i,
    name: "Bronze Dragonborn",
    sortname: "Dragonborn, Bronze",
    trait: "Bronze Dragonborn\n\u2022 Lightning Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Lightning damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Lightning wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Lightning"]
};
RaceSubList["dragonborn-copper"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*copper).*$/i,
    name: "Copper Dragonborn",
    sortname: "Dragonborn, Copper",
    trait: "Copper Dragonborn\n\u2022 Acid Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Acid damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Acid wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Acid"]
};
RaceSubList["dragonborn-gold"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*gold).*$/i,
    name: "Gold Dragonborn",
    sortname: "Dragonborn, Gold",
    trait: "Gold Dragonborn\n\u2022 Fire Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Fire damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Fire wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Fire"]
};
RaceSubList["dragonborn-green"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*green).*$/i,
    name: "Green Dragonborn",
    sortname: "Dragonborn, Green",
    trait: "Green Dragonborn\n\u2022 Poison Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Poison damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Poison wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Poison"]
};
RaceSubList["dragonborn-red"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*red).*$/i,
    name: "Red Dragonborn",
    sortname: "Dragonborn, Red",
    trait: "Red Dragonborn\n\u2022 Fire Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Fire damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Fire wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Fire"]
};
RaceSubList["dragonborn-silver"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*silver).*$/i,
    name: "Silver Dragonborn",
    sortname: "Dragonborn, Silver",
    trait: "Silver Dragonborn\n\u2022 Cold Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Cold damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Cold wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Cold"]
};
RaceSubList["dragonborn-white"] = {
    regExpSearch: /^(?=.*dragonborn)(?=.*white).*$/i,
    name: "White Dragonborn",
    sortname: "Dragonborn, White",
    trait: "White Dragonborn\n\u2022 Cold Breath Weapon: When I Attack on my turn, I can make one of my attacks an exhalation of magical energy (a 15-foot Cone, or a 30-foot Line 5 feet wide) (choose each time) in which each creature must make a Dex save (DC 8 + Con modifier + Prof Bonus) or take 1d10 (2d10 at level 5, 3d10 at level 11, 4d10 at level 17) Cold damage or half on a pass. I can use this Breath Weapon my Prof Bonus times per Long Rest.\n\u2022 Draconic Flight: When I reach character level 5, once per Long Rest as a Bonus Action I can sprout spectral Cold wings on my back that last for 10 min, until I retract them (no action), or I become Incapacitated, during which I have a Fly Speed equal to my Speed.",
    dmgres: ["Cold"]
};
legacyRaceRefactor("dwarf", {
    regExpSearch: /^(?=.*dwarf).*$/i,
    name: "Dwarf",
    sortname: "Dwarf",
    source: [
        ["P24", 188]
    ],
    plural: "Dwarves",
    size: 3,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 120],
        ["Tremorsense", 60]
    ],
    savetxt: {
        adv_vs: ["avoiding or ending the Poisoned condition"]
    },
    dmgres: ["Poison"],
    age: " reach maturity in early 20s and live about 350 years",
    height: " are about 4-5 feet tall",
    calcChanges: {
        hp: function(totalHD) {
            return [totalHD, "Dwarven Toughness"];
        }
    },
    features: {
        "stonecunning": {
            name: "Stonecunning",
            limfeaname: "Stonecunning",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["bonus action", "Tremorsense"]
            ],
            description: desc([
                "As a Bonus Action, I gain Tremorsense with a range of 60 feet for 10 minutes. I must be on a stone surface or touching a stone surface to use this Tremorsense. The stone can be natural or worked. I can use this Bonus Action a number of times equal to my Proficiency Bonus, and I regain all expended uses when I finish a Long Rest.",
            ]),
        },
    },
    trait: "Dwarf\n\u2022 Dwarven Toughness: I add 1 to my max HP every level, including 1.\n\u2022 Stonecunning: As a Bonus Action I gain Tremorsense with a range of 60 feet for 10 min when on or touching natural or worked stone. I can use this my Prof Bonus times per Long Rest.",
    replaces: ["hill dwarf", "mountain dwarf"]
});
legacyRaceRefactor("elf", {
    regExpSearch: /^(?=.*elf).*$/i,
    name: "Elf",
    sortname: "Elf",
    source: [
        ["P24", 190]
    ],
    plural: "Elves",
    size: 3,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 60]
    ],
    savetxt: {
        adv_vs: ["avoiding or ending the Charmed condition"]
    },
    skillstxt: "Choose one between Insight, Perception, or Survival",
    age: " reach maturity in early 20s and live about 750 years",
    height: " are about 5-6 feet tall",
    trait: "Elf\n\u2022 Elven Lineage: Use 'Racial Options' above to choose a lineage that grants me supernatural abilities. Int, Wis, or Cha is my spellcasting ability for spells I cast with this trait. (Choose the ability with the lineage)\n\u2022 Trance: I don't need to sleep, and magic can't put me to sleep. I can finish a Long Rest in 4 hours if I spend those hours in a trance-like meditation, during which I retain consciousness",
    variants: ["dark", "high", "wood"],
    replaces: ["dark elf", "high elf", "wood elf"]
});
RaceSubList["elf-dark"] = {
    regExpSearch: /^(?=.*elf)(?=.*dark).*$/i,
    name: "Dark Elf",
    sortname: "Drow",
    vision: [
        ["Darkvision", 120]
    ],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Drow Lineage",
        spells: ["dancing lights"],
        selection: ["dancing lights"],
        times: 1,
        firstCol: "atwill",
    }],
    trait: "Drow\n\u2022 Drow Lineage: I gain the Dancing Lights cantrip. I learn Faerie Fire at level 3 & Darkness at level 5; These spells are always Prepared & I can cast them without a spell slot once each per Long Rest or use Spell Slots; Int, Wis, or Cha is my spellcasting ability. (Choose the ability with the lineage).\n\u2022 Trance: I don't need to sleep & magic can't put me to sleep. I can finish a Long Rest in 4 hours if I spend that time in a trance like meditation, during which I retain consciousness.",
    features: {
        "drow lineage3": {
            name: "Faerie Fire",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the Faerie Fire spell.",
            ]),
            spellcastingBonus: [{
                name: "Drow Lineage",
                spells: ["faerie fire"],
                selection: ["faerie fire"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "drow lineage5": {
            name: "Darkness",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Darkness spell.",
            ]),
            spellcastingBonus: [{
                name: "Drow Lineage",
                spells: ["darkness"],
                selection: ["darkness"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
RaceSubList["elf-high"] = {
    regExpSearch: /^(?=.*elf)(?=.*high).*$/i,
    name: "High Elf",
    sortname: "High Elf",
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "High Elf Lineage",
        "class": ["wizard"],
        selection: ["prestidigitation"],
        level: [0, 0],
        times: 1,
        firstCol: "atwill",
    }],
    trait: "High Elf\n\u2022 High Elf Lineage: I gain the Prestidigitation cantrip & can replace it with another from the Wizard spell list at the end of a Long Rest. I learn Detect Magic at level 3 & Misty Step at level 5; These spells are always Prepared & I can cast them without a spell slot once each per Long Rest or use Spell Slots; Int, Wis, or Cha is my spellcasting ability. (Choose the ability with the lineage).\n\u2022 Trance: I don't need to sleep & magic can't put me to sleep. I can finish a Long Rest in 4 hours if I spend that time in a trance like meditation, during which I retain consciousness.",
    features: {
        "high elf lineage3": {
            name: "Detect Magic",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the Detect Magic spell.",
            ]),
            spellcastingBonus: [{
                name: "High Elf Lineage",
                spells: ["detect magic"],
                selection: ["detect magic"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "high elf lineage5": {
            name: "Misty Step",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Misty Step spell.",
            ]),
            spellcastingBonus: [{
                name: "High Elf Lineage",
                spells: ["misty step"],
                selection: ["misty step"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
RaceSubList["elf-wood"] = {
    regExpSearch: /^(?=.*elf)(?=.*wood).*$/i,
    name: "Wood Elf",
    sortname: "Wood Elf",
    speed: {
        walk: {
            spd: 35,
            enc: 25
        }
    },
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Wood Elf Lineage",
        spells: ["druidcraft"],
        selection: ["druidcraft"],
        times: 1,
        firstCol: "atwill",
    }],
    trait: "Wood Elf\n\u2022 Wood Elf Lineage: I gain the Druidcraft cantrip. I learn Longstrider at level 3 & Pass without Trace at level 5; These spells are always Prepared & I can cast them without a spell slot once each per Long Rest or use Spell Slots; Int, Wis, or Cha is my spellcasting ability. (Choose the ability when I select the lineage)\n\u2022 Trance: I don't need to sleep & magic can't put me to sleep. I can finish a Long Rest in 4 hours if I spend that time in a trance like meditation, during which I retain consciousness.",
    features: {
        "wood elf lineage3": {
            name: "Longstrider",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the Longstrider spell.",
            ]),
            spellcastingBonus: [{
                name: "Wood Elf Lineage",
                spells: ["longstrider"],
                selection: ["longstrider"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "wood elf lineage5": {
            name: "Pass without Trace",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Pass without Trace spell.",
            ]),
            spellcastingBonus: [{
                name: "Wood Elf Lineage",
                spells: ["pass without trace"],
                selection: ["pass without trace"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
legacyRaceRefactor("gnome", {
    regExpSearch: /^(?=.*gnome).*$/i,
    name: "Gnome",
    sortname: "Gnome",
    source: [
        ["P24", 191]
    ],
    plural: "Gnomes",
    size: 4,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    savetxt: {
        text: ["Adv. on Int, Wis, and Cha Saves; "]
    },
    vision: [
        ["Darkvision", 60]
    ],
    age: " reach maturity in early 20s and live about 425 years",
    height: " are about 3-4 feet tall",
    trait: "Gnome\n\u2022 Gnomish Lineage: Use 'Racial Options' above to choose a lineage. I can choose Int, Wis, or Cha as my spellcasting ability for spells I cast with this trait (choose the ability with the lineage).\n\u2022 Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
    variants: ["forest", "rock"],
    replaces: ["forest gnome", "rock gnome"]
});
RaceSubList["gnome-forest"] = {
    regExpSearch: /^(?=.*gnome)(?=.*forest).*$/i,
    name: "Forest Gnome",
    sortname: "Gnome, Forest",
    vision: [
        ["Darkvision", 60]
    ],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Forest Gnome Lineage",
        spells: ["minor illusion"],
        selection: ["minor illusion"],
        times: 1,
        firstCol: "atwill",
    }, {
        name: "Forest Gnome Lineage",
        spells: ["speak with animals"],
        selection: ["speak with animals"],
        times: 1,
        prepared: true,
    }],
    trait: "Forest Gnome\n\u2022 Forest Gnome Lineage: I know the Minor Illusion cantrip. I always have Speak with Animals Prepared & can cast it without a spell slot my Prof Bonus times per Long Rest or use Spell slots.\n\u2022 Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
    features: {
        "forest gnome lineage": {
            name: "Forest Gnome Lineage",
            minlevel: 1,
            limfeaname: "Speak with Animals",
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            description: desc([
                "I always have the Speak with Animals spell prepared. I can cast it without a spell slot a number of times equal to my Proficiency Bonus and I regain all expended uses when I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["gnome-rock"] = {
    regExpSearch: /^(?=.*gnome)(?=.*rock).*$/i,
    name: "Rock Gnome",
    sortname: "Gnome, Rock",
    vision: [
        ["Darkvision", 60]
    ],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Rock Gnome Lineage",
        spells: ["mending", "prestidigitation"],
        selection: ["mending", "prestidigitation"],
        times: 2,
        firstCol: "atwill",
    }],
    trait: "Rock Gnome\n\u2022 Rock Gnome Lineage: I know the Mending & Prestidigitation cantrips. I can create a Tiny clockwork device (AC 5, 1 HP) if I spend 10 min casting Prestidigitation; I choose (one option of) one effect, which the device produces when a creature uses a Bonus Action to activate it via touch. I can have three such devices in existence at a time, and each falls apart after 8 hours or when I dismantle it via touch as a Utilize action.\n\u2022 Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
    features: {
        "rock gnome lineage": {
            name: "Clockwork Devices",
            minlevel: 1,
            usages: "3",
            recovery: "long rest",
            action: ["bonus action", "Clockwork Device (Use)"],
            description: desc([
                "I know the Mending and Prestidigitation cantrips. In addition, I can spend 10 minutes casting Prestidigitation to create a Tiny clockwork device (AC 5, 1 HP), such as a toy, fire starter, or music box. When I create the device, I determine its function by choosing one effect from Prestidigitation; the device produces that effect whenever I or another creature takes a Bonus Action to activate it with a touch. If the chosen effect has options for the device when I create it. For example, if I choose the spell's ignite extinguish effect, I determine whether the device ignites or extinguishes fire; the device doesn't do both. I can have three such devices in existence at a time, and each falls apart 8 hours after its creation or when I dismantle it with a touch as a Utilize action.",
            ]),
        },
    },
};
legacyRaceRefactor("goliath", {
    regExpSearch: /^(?=.*goliath).*$/i,
    name: "Goliath",
    sortname: "Goliath",
    source: [
        ["P24", 192]
    ],
    plural: "Goliaths",
    size: 3,
    speed: {
        walk: {
            spd: 35,
            enc: 25
        }
    },
    languageProfs: ["Common", 2],
    savetxt: {
        text: ["Adv. on Ability Checks vs. ending the Grappled condition; "]
    },
    age: " reach maturity in late teens and live about 80 years",
    height: " are about 7-8 feet tall",
    trait: "Goliath\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    variants: ["cloud", "fire", "frost", "hill", "stone", "storm"],
    replaces: ["goliath", "multiverse goliath"]
});
RaceSubList["goliath-cloud"] = {
    regExpSearch: /^(?=.*goliath)(?=.*cloud).*$/i,
    name: "Cloud Goliath",
    sortname: "Goliath, Cloud",
    trait: "Cloud Goliath\n\u2022 Giant Ancestry (Cloud's Jaunt (Cloud Giant)): As a Bonus Action I magically teleport up to 30 ft to an unoccupied space I can see.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "cloud's jaunt": {
            name: "Cloud's Jaunt",
            limfeaname: "Cloud's Jaunt",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: "bonus action",
            description: desc([
                "As a Bonus Action, I magically teleport up to 30 feet to an unoccupied space I can see.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["goliath-fire"] = {
    regExpSearch: /^(?=.*goliath)(?=.*fire).*$/i,
    name: "Fire Goliath",
    sortname: "Goliath, Fire",
    trait: "Fire Goliath\n\u2022 Giant Ancestry (Fire's Burn (Fire Giant)): When I hit a target with an attack roll and deal damage to it I can also deal 1d10 Fire damage to that target.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "fire's burn": {
            name: "Fire's Burn",
            limfeaname: "Fire's Burn",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["action", "Fire's Burn (When I hit a target w/ Atk Roll)"]
            ],
            description: desc([
                "When I hit a target with an attack roll and deal damage to it, I can also deal 1d10 Fire damage to that target.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["goliath-frost"] = {
    regExpSearch: /^(?=.*goliath)(?=.*frost).*$/i,
    name: "Frost Goliath",
    sortname: "Goliath, Frost",
    trait: "Frost Goliath\n\u2022 Giant Ancestry (Frost's Chill (Frost Giant)): When I hit a target with an attack roll and deal damage I can also deal 1d6 Cold damage & reduce its Speed by 10 ft until the start of my next turn.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "frost's chill": {
            name: "Frost's Chill",
            limfeaname: "Frost's Chill",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["action", "Frost's Chill(When I hit a target w/ Atk Roll)"]
            ],
            description: desc([
                "When I hit a target with an attack roll and deal damage to it, I can also deal 1d6 Cold damage to that target and reduce its Speed by 10 feet until the start of my next turn.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["goliath-hill"] = {
    regExpSearch: /^(?=.*goliath)(?=.*hill).*$/i,
    name: "Hill Goliath",
    sortname: "Goliath, Hill",
    trait: "Hill Goliath\n\u2022 Giant Ancestry (Hill's Tumble (Hill Giant)): When I hit a Large or smaller creature with an Attack Roll and deal damage I can also inflict Prone.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "hill's tumble": {
            name: "Hill's Tumble",
            limfeaname: "Hill's Tumble",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["action", "Hill's Tumble (When I hit Large or smaller crea w/ atk roll)"]
            ],
            description: desc([
                "When I hit a Large or smaller creature with an Attack Roll and deal damage to it, I can give that target the Prone condition.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["goliath-stone"] = {
    regExpSearch: /^(?=.*goliath)(?=.*stone).*$/i,
    name: "Stone Goliath",
    sortname: "Goliath, Stone",
    trait: "Stone Goliath\n\u2022 Giant Ancestry (Stone's Endurance (Stone Giant)): As a Reaction when I take damage I can reduce it by 1d12 + Con mod.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "stone's endurance": {
            name: "Stone's Endurance",
            limfeaname: "Stone's Endurance",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["reaction", "Stone's Endurance (When I take Dmg)"]
            ],
            description: desc([
                "When I take damage, I can take a Reaction to roll 1d12. Add my Constitution modifier to the number rolled and reduce the damage by that total.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
RaceSubList["goliath-storm"] = {
    regExpSearch: /^(?=.*goliath)(?=.*storm).*$/i,
    name: "Storm Goliath",
    sortname: "Goliath, Storm",
    trait: "Storm Goliath\n\u2022 Giant Ancestry (Storm's Thunder (Storm Giant)): When I take damage from a creature within 60 ft of me, I can take a Reaction to deal 1d8 Thunder damage to it.\n\u2022 Large Form: Starting at 5th level, once per Long Rest I can change my size to Large as a Bonus Action if I'm in a big enough space for 10 min or until I end it (no action). While Large I have Adv on Str checks and my Speed increases by 10 ft\n\u2022 Powerful Build: I count as one size larger when determining my carrying capacity.",
    carryingCapacity: 2,
    features: {
        "storm's thunder": {
            name: "Storm's Thunder",
            limfeaname: "Storm's Thunder",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "long rest",
            action: [
                ["reaction", "Storm's Thunder (When taking Dmg from Crea W/I 60 ft)"]
            ],
            description: desc([
                "When I take damage from a creature within 60 feet of me, I can take a Reaction to deal 1d8 Thunder damage to that creature.",
            ]),
        },
        "large form": {
            name: "Large Form",
            limfeaname: "Large Form",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            action: [
                ["bonus action", "Large Form"]
            ],
            description: desc([
                "Starting at 5th level, I can change my size to Large as Bonus Action if I'm in a big enough space. This transformation lasts for 10 minutes or until I end it (no action required). For that duration, I have Advantage on Strength checks, and my Speed increases by 10 feet. Once I use this trait, I can't use it again until I finish a Long Rest.",
            ]),
        },
    },
};
legacyRaceRefactor("halfling", {
    regExpSearch: /^(?=.*halfling).*$/i,
    name: "Halfling",
    sortname: "Halfling",
    source: [
        ["P24", 193]
    ],
    plural: "Halflings",
    size: 4,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    savetxt: {
        adv_vs: ["avoiding or ending the Frightened condition"]
    },
    age: " reach maturity in late teens and live about 150 years",
    height: " are about 2-3 feet tall",
    trait: "Halfling\n\u2022 Halfling Nimbleness: I can move through the space of any creature larger than me but can't stop in the same space.\n\u2022 Luck: When I roll a 1 on a D20 Test, I can reroll & must use the new roll.\n\u2022 Naturally Stealthy: I can take the Hide action even when I am obscured only by a creature that is at least one size larger than me.",
    replaces: ["lightfoot halfling", "stout halfling"]
});
legacyRaceRefactor("human", {
    regExpSearch: /^(?=.*human).*$/i,
    name: "Human",
    sortname: "Human",
    source: [
        ["P24", 194]
    ],
    plural: "Humans",
    size: [3, 4],
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    skillstxt: "Choose any one skill",
    age: " reach maturity in late teens and live about 80 years",
    height: " are about 2-4 or 4-7 feet tall",
    trait: "Human\n\u2022 Resourceful: I gain Heroic Inspiration when I finish a Long Rest.\n\u2022 Versatile : I gain an Origin feat of my choice.",
    eval: function() {
        AddString('Feat Note 1', 'Human bonus feat', '; ');
    },
    removeeval: function() {
        RemoveString('Feat Note 1', 'Human bonus feat');
    },
    replaces: ["human"]
});
legacyRaceRefactor("orc", {
    regExpSearch: /^(?=.*orc).*$/i,
    name: "Orc",
    sortname: "Orc",
    source: [
        ["P24", 195]
    ],
    plural: "Orcs",
    size: 3,
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 120]
    ],
    age: " reach maturity in late teens and live about 80 years",
    height: " are about 6-7 feet tall",
    trait: "Orc\n\u2022 Adrenaline Rush: I can Dash as a Bonus Action and I gain my Prof Bonus Temp HP when I do. I can use this my Prof Bonus times per Rest.\n\u2022 Relentless Endurance: Once per Long Rest when I am reduced to 0 Hit Points but not killed outright, I can drop to 1 Hit Point instead.",
    features: {
        "adrenaline rush": {
            name: "Adrenaline Rush",
            limfeaname: "Adrenaline Rush",
            minlevel: 1,
            usages: "Proficiency bonus per ",
            usagescalc: "event.value = How('Proficiency Bonus');",
            recovery: "short rest",
            action: [
                ["bonus action", "Dash"]
            ],
            description: desc([
                "I can take the Dash action as a Bonus Action. When I do so, I gain a number of Temporary Hit Points equal to my Proficiency Bonus. I can use this trait a number of times equal to my Proficiency Bonus, and I regain all expended uses when I finish a Short or Long Rest.",
            ]),
        },
        "relentless endurance": {
            name: "Relentless Endurance",
            limfeaname: "Relentless Endurance",
            minlevel: 1,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I am reduced to 0 Hit Points but not killed outright, I can drop to 1 Hit Point instead. Once I use this trait, I can't do so again until I finish a Long Rest.",
            ]),
        },
    },
    replaces: ["multiverse orc", "orc"]
});
legacyRaceRefactor("tiefling", {
    regExpSearch: /^(?=.*tiefling).*$/i,
    name: "Tiefling",
    sortname: "Tiefling",
    source: [
        ["P24", 197]
    ],
    plural: "Tieflings",
    size: [3, 4],
    speed: {
        walk: {
            spd: 30,
            enc: 20
        }
    },
    languageProfs: ["Common", 2],
    vision: [
        ["Darkvision", 60]
    ],
    age: " reach maturity in late teens and live about 80 years",
    height: " are about 3-4 feet tall if small or 4-7 feet tall if medium",
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Otherworldly Presence",
        spells: ["thaumaturgy"],
        selection: ["thaumaturgy"],
        times: 1,
        firstCol: "atwill",
    }],
    trait: "Tiefling\n\u2022 Fiendish Legacy: Use 'Racial Options' above to choose a legacy & spellcasting ability. I can choose Int, Wis, or Cha as my spellcasting ability for spells I cast with this trait (choose the ability with the legacy).\n\u2022 Otherworldly Presence: I know the Thaumaturgy cantrip; It uses the same spellcasting ability as Fiendish Legacy.",
    variants: ["abyssal", "chthonic", "infernal"],
    replaces: ["tiefling", ]
});
RaceSubList["tiefling-abyssal"] = {
    regExpSearch: /^(?=.*tiefling)(?=.*abyssal).*$/i,
    name: "Abyssal Tiefling",
    sortname: "Tiefling, Abyssal",
    plural: "Tieflings",
    vision: [
        ["Darkvision", 60]
    ],
    dmgres: ["Poison"],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Abyssal Lineage",
        spells: ["thaumaturgy", "poison spray"],
        selection: ["thaumaturgy", "poison spray"],
        times: 2,
        firstCol: "atwill",
    }],
    trait: "Abyssal Tiefling\n\u2022 Fiendish Legacy: I gain the Poison Spray cantrip. I learn Ray of Sickness at level 3 & Hold Person at level 5; These spells are always Prepared & I can cast them once each without a spell slot per Long Rest, or use Spell Slots; Int, Wis, or Cha is my spellcasting ability (choose the ability with the legacy).\n\u2022 Otherworldly Presence: I know the Thaumaturgy cantrip; It uses the same spellcasting ability as Fiendish Legacy.",
    features: {
        "abyssal lineage3": {
            name: "Ray of Sickness",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the Ray of Sickness spell.",
            ]),
            spellcastingBonus: [{
                name: "Abyssal Lineage",
                spells: ["ray of sickness"],
                selection: ["ray of sickness"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "abyssal lineage5": {
            name: "Hold Person",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Hold Person spell.",
            ]),
            spellcastingBonus: [{
                name: "Abyssal Lineage",
                spells: ["hold person"],
                selection: ["hold person"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
RaceSubList["tiefling-chthonic"] = {
    regExpSearch: /^(?=.*tiefling)(?=.*chthonic).*$/i,
    name: "Chthonic Tiefling",
    sortname: "Tiefling, Chthonic",
    plural: "Tieflings",
    vision: [
        ["Darkvision", 60]
    ],
    dmgres: ["Necrotic"],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Chthonic Lineage",
        spells: ["thaumaturgy", "chill touch"],
        selection: ["thaumaturgy", "chill touch"],
        times: 2,
        firstCol: "atwill",
    }],
    trait: "Chthonic Tiefling\n\u2022 Fiendish Legacy: I gain the Chill Touch cantrip. I learn False Life at level 3 & Ray of Enfeeblement at level 5; These spells are always Prepared & I can cast them once each without a spell slot per Long Rest, or use Spell Slots; Int, Wis, or Cha is my spellcasting ability (choose the ability with the legacy).\n\u2022 Otherworldly Presence: I know the Thaumaturgy cantrip; It uses the same spellcasting ability as Fiendish Legacy.",
    features: {
        "chthonic lineage3": {
            name: "False Life",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the False Life spell.",
            ]),
            spellcastingBonus: [{
                name: "Chthonic Lineage",
                spells: ["false life"],
                selection: ["false life"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "chthonic lineage5": {
            name: "Ray of Enfeeblement",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Ray of Enfeeblement spell.",
            ]),
            spellcastingBonus: [{
                name: "Chthonic Lineage",
                spells: ["ray of enfeeblement"],
                selection: ["ray of enfeeblement"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
RaceSubList["tiefling-infernal"] = {
    regExpSearch: /^(?=.*tiefling)(?=.*infernal).*$/i,
    name: "Infernal Tiefling",
    sortname: "Tiefling, Infernal",
    plural: "Tieflings",
    vision: [
        ["Darkvision", 60]
    ],
    dmgres: ["Fire"],
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Infernal Lineage",
        spells: ["thaumaturgy", "fire bolt"],
        selection: ["thaumaturgy", "fire bolt"],
        times: 2,
        firstCol: "atwill",
    }],
    trait: "Infernal Tiefling\n\u2022 Fiendish Legacy: I gain the Fire Bolt cantrip. I learn Hellish Rebuke at level 3, & Darkness at level 5; These spells are always Prepared & I can cast them once each without a spell slot per Long Rest or use Spell Slots; Int, Wis, or Cha is my spellcasting ability (choose the ability with the legacy).\n\u2022 Otherworldly Presence: I know the Thaumaturgy cantrip; It uses the same spellcasting ability as Fiendish Legacy.",
    features: {
        "infernal lineage3": {
            name: "Hellish Rebuke",
            minlevel: 3,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 3 I learn the Hellish Rebuke spell.",
            ]),
            spellcastingBonus: [{
                name: "Infernal Lineage",
                spells: ["hellish rebuke"],
                selection: ["hellish rebuke"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
        "infernal lineage5": {
            name: "Darkness",
            minlevel: 5,
            usages: 1,
            recovery: "long rest",
            description: desc([
                "When I reach character level 5 I learn the Darkness spell.",
            ]),
            spellcastingBonus: [{
                name: "Infernal Lineage",
                spells: ["darkness"],
                selection: ["darkness"],
                times: 1,
                firstCol: "oncelr",
            }],
        },
    },
};
//Origin Feats
FeatsList["alert"] = {
    name: "Alert [Origin]",
    source: [
        ["P24", 200]
    ],
    regExpSearch: /^(?=.*alert).*$/i,
    addMod: [{
        type: "skill",
        field: "Init",
        mod: "prof",
        text: "I can add my Proficiency Bonus to initiative rolls."
    }],
    description: "I add my Prof Bonus to Initiative rolls. I may swap Initiative with one willing ally as long as neither of us has the Incapacitated condition.",
    descriptionFull: desc([
        "You gain the following benefits",
        "When you roll Initiative, you can add your Proficiency Bonus to the roll.",
        "Immediately after you roll Initiative, you can swap your Initiative with the Initiative of one willing ally in the same combat. You can't make this swap if you or the ally has the Incapacitated condition.",
    ]),
};
FeatsList["crafter"] = {
    name: "Crafter [Origin]",
    source: [
        ["P24", 200]
    ],
    regExpSearch: /^(?=.*crafter).*$/i,
    toolProfs: [
        ["Artisan's tools", 3]
    ],
    description: "I gain proficiency in three Fast Craft Artisan Tools of choice and can use them to Fast Craft during a long rest, (see Notes Page for details), the fast crafted item lasts until my next long rest. I received a 20% discount on non-magical objects.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "You gain proficiency with three different Artisan's Tools of your choice from the Fast Crafting table. (See Notes Page for details)",
        "Whenever you buy a nonmagical item, you receive a 20 percent discount on it.",
        "When you finish a Long Rest, you can craft one piece of gear from the Fast Crafting table, provided you have the Artisan's Tools associated with that item and have proficiency with those tools. The item lasts until you finish another Long Rest, at which point the item falls apart.",
    ]),
    toNotesPage: [{
        name: "Fast Crafting",
        note: [
            "Artisan's tools & Associated Crafted Gear",
            "Carpenter's Tools : Ladder, Torch",
            "Leatherworker's Tools : Case, Pouch",
            "Mason's Tools : Block and Tackle",
            "Potter's Tools : Jug, lamp",
            "Smith's Tools : Ball Bearings, Bucket, Caltrops, Grappling Hook, Iron Pot",
            "Tinker's Tools : Bell, Shovel, Tinder Box",
            "Weaver's Tools : Basket, Rope, Net, Tent",
            "Woodcarver's Tools : Club, Greatclub, Quarterstaff",
        ],
    }],
};
FeatsList["healer"] = {
    name: "Healer [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*healer).*$/i,
    action: [
        ["action", "Battle Medic"]
    ],
    description: "I can expend a use of a Healer's Kit as an action to allow 1 creature within 5ft of me to roll a Hit Die and regain HP equal to the roll plus my Prof Bonus, and when I roll a 1 on the die to heal using a spell or this feat I can reroll, but must use the new roll.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Battle Medic : If you have a Healer's Kit, you can expend one use of it and tend to a creature within 5 feet of yourself as a Utilize action. That creature can expend one of its Hit Point Dice, and you then roll that die. The creature regains a number of Hit Points equal to the roll plus your Proficiency Bonus",
        "Healing Rerolls : Whenever you roll a die to determine the number of Hit Points you restore with a spell or with this feat's Battle Medic benefit, you can reroll the die if it rolls a 1, and you must use the new roll.",
    ]),
};
FeatsList["lucky"] = {
    name: "Lucky [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*lucky).*$/i,
    limfeaname: "Luck Points",
    usages: "Proficiency bonus per ",
    usagescalc: "event.value = How('Proficiency Bonus');",
    recovery: "long rest",
    description: "I gain a number of Luck Points equal to my Prof Bonus and can use them to give myself Advantage on a D20 Test, or to give a creature who rolls a d20 for an attack roll against me Disadvantage on that roll.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Luck Point : You have a number of Luck Points equal to your Proficiency Bonus and can spend the points on the benefits below. You regain my expended Luck Points when you finish a Long Rest.",
        "Advantage : When you roll a d20 for a D20 Test, you can spend 1 Luck Point to give yourself Advantage on the roll.",
        "Disadvantage : When a creature rolls a d20 for an attack roll against you, you can spend 1 Luck Point to impose Disadvantage on that roll.",
    ]),
};
FeatsList["magic initiate (cleric)"] = {
    name: "Magic Initiate (Cleric) [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*cleric).*$/i,
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Magic Initiate Cantrips",
        "class": "cleric",
        level: [0, 0],
        times: 2,
        firstCol: "atwill",
    }, {
        name: "Magic Initiate 1st-Level",
        "class": "cleric",
        level: [1, 1],
        times: 1,
        firstCol: "oncelr",
    }],
    description: "I gain 2 Cantrips and 1 1st-level spell of choice from the Cleric spell list, I may swap any one of these spells with another from the Cleric spell list when I gain a level, I may cast the 1st-level spell once without using a spell slot before a long rest, otherwise I may cast it using any spell slots I have.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Two Cantrips of your choice from the Cleric spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
        "Choose a level 1 spell from the Cleric spell list, you always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when I finish a Long Rest. You can also cast the spell using any spell slots you have.",
        "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Cleric spell list.",
        "You can take this feat more than once, but must choose either the Druid spell list or Wizard spell list.",
    ]),
};
FeatsList["magic initiate (druid)"] = {
    name: "Magic Initiate (Druid) [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*druid).*$/i,
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Magic Initiate Cantrips",
        "class": "druid",
        level: [0, 0],
        times: 2,
        firstCol: "atwill",
    }, {
        name: "Magic Initiate 1st-Level",
        "class": "druid",
        level: [1, 1],
        times: 1,
        firstCol: "oncelr",
    }],
    description: "I gain 2 Cantrips and 1 1st-level spell of choice from the Druid spell list, I may swap any one of these spells with another from the Druid spell list when I gain a level, I may cast the 1st-level spell once without using a spell slot before a long rest, otherwise I may cast it using any spell slots I have.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Two Cantrips of your choice from the Druid spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
        "Choose a level 1 spell from the Druid spell list, you always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have.",
        "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Druid spell list.",
        "You can take this feat more than once, but must choose either the Cleric spell list or Wizard spell list.",
    ]),
};
FeatsList["magic initiate (wizard)"] = {
    name: "Magic Initiate (Wizard) [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*wizard).*$/i,
    spellcastingAbility: [4, 5, 6],
    spellcastingBonus: [{
        name: "Magic Initiate Cantrips",
        "class": "wizard",
        level: [0, 0],
        times: 2,
        firstCol: "atwill",
    }, {
        name: "Magic Initiate 1st-Level",
        "class": "wizard",
        level: [1, 1],
        times: 1,
        firstCol: "oncelr",
    }],
    description: "I gain 2 Cantrips and 1 1st-level spell of choice from the Wizard spell list, I may swap any one of these spells with another from the Wizard spell list when I gain a level, I may cast the 1st-level spell once without using a spell slot before a long rest, otherwise I may cast it using any spell slots I have.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Two Cantrips of your choice from the Wizard spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
        "Choose a level 1 spell from the Wizard spell list, you always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have.",
        "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Wizard spell list.",
        "You can take this feat more than once, but must choose either the Cleric spell list or Druid spell list.",
    ]),
};
FeatsList["musician"] = {
    name: "Musician [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*musician).*$/i,
    toolProfs: [
        ["Musical Instrument", 3]
    ],
    description: "I gain proficiency in 3 Musical Instruments and at the end of a Short or Long Rest I can play a song to give a number of allies up to my Prof Bonus Heroic Inspiration.",
    descriptionFull: desc([
        "You gain the following benefits",
        "You gain proficiency with three Musical Instruments of your choice.",
        "As you finish a Short or Long Rest, you can play a song on a Musical Instrument with which you have proficiency and give Heroic Inspiration to allies who hear the song. The number of allies you can affect in this way equals your Proficiency Bonus.",
    ]),
};
FeatsList["savage attacker"] = {
    name: "Savage Attacker [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*savage)(?=.*attacker).*$/i,
    description: "I've trained to deal particularly damaging strikes. Once per turn when I hit a target with a weapon, I can roll the weapon's damage dice twice and use either roll against the target.",
    descriptionFull: desc([
        "you've trained to deal particularly damaging strikes. Once per turn when you hit a target with a weapon, you can roll the weapon's damage dice twice and use either roll against the target.",
    ]),
};
FeatsList["skilled"] = {
    name: "Skilled [Origin]",
    source: [
        ["P24", 201]
    ],
    regExpSearch: /^(?=.*skilled).*$/i,
    skillstxt: ["I gain Proficiency in three skills or tools of my choice"],
    description: "I gain Proficiency in three skills or tools of my choice",
    descriptionFull: desc([
        "You gain proficiency in any combination of three skills or tools of your choice",
        "You can take this feat more than once.",
    ]),
    allowDuplicates: true,
};
FeatsList["tavern brawler"] = {
    name: "Tavern Brawler [Origin]",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*tavern)(?=.*brawler).*$/i,
    weaponProfs: [false, false, ["Improvised weapons"]],
    calcChanges: {
        atkAdd: [
            function(fields, v) {
                if (v.baseWeaponName == "unarmed strike" || (/improvised/i).test(v.WeaponName + v.baseWeaponName) || (/improvised weapon/i).test(v.theWea.type)) {
                    fields.Proficiency = true;
                    if (v.isMeleeWeapon) fields.Description += (fields.Description ? '; ' : '') + 'On a hit, can deal damage and Push target 5 ft.';
                }
                if (v.baseWeaponName == "unarmed strike" && fields.Damage_Die == 1) {
                    fields.Damage_Die = '1d4';
                }
            },
            "My unarmed strikes deal 1d4 damage instead of 1.\n \u2022 As part of the Attack action on my turn, I can deal damage and push the target 5ft away from me."
        ]
    },
    description: "My Unarmed Strikes deal 1d4 instead of normal damage and as part of the attack action, I can push a target 5 feet as well as deal damage. When I roll a 1 on the damage die I can reroll, but must use the new roll.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Enhanced Unarmed Strike : When you hit with your Unarmed Strike and deal damage, you can deal Bludgeoning damage equal to 1d4 plus your Strength modifier instead of the normal damage of an Unarmed Strike.",
        "Damage Rerolls : Whenever you roll a damage die for my Unarmed Strike, you can reroll the die if it rolls a 1, and you must use the new roll.",
        "Improvised Weaponry : You have proficiency with improvised weapons.",
        "Push : When you hit a creature with an Unarmed Strike as part of the Attack action on your turn, you can deal damage to the target and also push it 5 feet away from you. You can use this benefit only once per turn.",
    ]),
};
FeatsList["tough"] = {
    name: "Tough [Origin]",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*tough).*$/i,
    calcChanges: {
        hp: function(totalHD) {
            return [totalHD * 2, '\n + ' + totalHD + ' \xD7 2 from the Tough feat (' + (totalHD * 2) + ')', true];
        }
    },
    description: "My Hit Point maximum increases by an amount equal to twice my character level when I gain this feat. Whenever I gain a character level thereafter, my Hit Point maximum increases by an additional 2 Hit Points.",
    descriptionFull: desc([
        "Your Hit Point maximum increases by an amount equal to twice your character level when you gain this feat. Whenever you gain a character level thereafter, your Hit Point maximum increases by an additional 2 Hit Points.",
    ]),
};
//General Feats
FeatsList["actor"] = {
    name: "Actor",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*actor).*$/i,
    scores: [0, 0, 0, 0, 0, 1],
    description: "+1 Cha. Adv on Cha (Deception or Performance) checks to impersonate a real or fictional person. Able to mimic the sounds of others; DC (8 + Cha + PB) Insight check to determine mimicry.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Charisma score by 1 to a maximum of 20.",
        "Impersonation : While you're disguised as a real or fictional person, you have Advantage on Charisma (Deception or Performance) checks to convince others that you are that person.",
        "Mimicry : You can mimic sounds of other creatures, including speech. A creature that hears the mimicry must succeed on a Wisdom (Insight) check to determine the effect is faked (DC 8 plus your Charisma modifier and Proficiency Bonus).",
    ]),
    prerequisite: "Level 4 and Charisma 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Cha') >= 13;
    },
};
FeatsList["athlete"] = {
    name: "Athlete",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*athlete).*$/i,
    speed: {
        climb: {
            spd: "walk",
            enc: "walk"
        }
    },
    description: "+1 Str or Dex, gain a climb speed equal to speed, can right self from prone using only 5 ft of movement, can make running long or high jump after only 5 feet of movement.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Climb Speed : You gain a Climb Speed equal to your Speed.",
        "Hop Up : When you have the Prone condition, you can right yourself with only 5 feet of movement.",
        "Jumping : You can make a running Long or High Jump after moving only 5 feet.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "Gain a climb speed equal to speed, can right self from prone using only 5 ft of movement, can make running long or high jump after only 5 feet of movement. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "Gain a climb speed equal to speed, can right self from prone using only 5 ft of movement, can make running long or high jump after only 5 feet of movement. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["charger"] = {
    name: "Charger",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*charger).*$/i,
    scorestxt: "My Strength or Dexterity score increases by 1, to a maximum of 20.",
    description: "+1 Str or Dex, When I take the Dash action my base speed increases by 10 ft for that action. If I move at least 10 ft in a straight line towards an enemy and attack as part of the Attack action, I may either deal an additional 1d8 damage or push the target 10 feet away if no more than 1 size larger.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Improved Dash : When you take the Dash action, your Speed increases by 10 feet for that action.",
        "Charge Attack : If you move at least 10 feet in a straight line toward a target immediately before hitting it with a melee attack roll as part of the Attack action, choose one of the following effects: gain a 1d8 bonus to the attack's damage roll, or push the target up to 10 feet away if it is no more than one size larger than you. You can use this benefit only once on each of your turns.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "When I take the Dash action my base speed increases by 10 ft for that action. If I move at least 10 ft in a straight line towards an enemy and attack as part of the Attack action, I may either deal an additional 1d8 damage or push the target 10 feet away if no more than 1 size larger. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "When I take the Dash action my base speed increases by 10 ft for that action. If I move at least 10 ft in a straight line towards an enemy and attack as part of the Attack action, I may either deal an additional 1d8 damage or push the target 10 feet away if no more than 1 size larger. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["chef"] = {
    name: "Chef",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*chef).*$/i,
    scorestxt: "My Constitution or Wisdom score increases by 1, to a maximum of 20.",
    toolProfs: [
        ["Cook's Utensils"]
    ],
    description: "+1 Con or Wis, gain proficiency in Cook's Utensils, as part of a short rest, I can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, I can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to my PB.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Constitution or Wisdom score by 1 to a maximum of 20.",
        "Cook's Utensils : You gain proficiency with Cook's Utensils if you don't already have it.",
        "Replenishing Meal : As part of a Short Rest, you can cook special food if you have ingredients and Cook's Utensils on hand, you can prepare enough of this food for a number of creatures equal to 4 plus your Proficiency Bonus. At the end of the Short Rest, any creature who eats the food and spends one or more Hit Dice to regain Hit Points regains an extra 1d8 Hit Points.",
        "Bolstering Treats : With 1 hour of work or when you finish a Long Rest, you can cook a number of treats equal to your Proficiency Bonus if you have ingredients and Cook's Utensils on hand. These special treats last 8 hours after being made. A creature can use a Bonus Action to eat one of those treats to gain a number of Temporary Hit Points equal to your Proficiency Bonus.",
    ]),
    choices: ["Constitution", "Wisdom"],
    "constitution": {
        description: "Gain proficiency in Cook's Utensils, as part of a short rest, I can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, I can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to my PB. [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
    },
    "wisdom": {
        description: "Gain proficiency in Cook's Utensils, as part of a short rest, I can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, I can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to my PB. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    prerequisite: "Level 4 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["crossbow expert"] = {
    name: "Crossbow Expert",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*crossbow)(?=.*expert).*$/i,
    scores: [0, 1, 0, 0, 0, 0],
    description: "+1 Dex, I ignore the Loading property of crossbows, firing at an enemy within 5 feet does not impose disadvantage, and I can make an off-hand attack with a crossbow that has the light property and add my Dex modifier to the damage of the attack.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Dexterity score by 1 to a maximum of 20.",
        "Ignore Loading : You ignore the Loading property of the Hand Crossbow, Heavy Crossbow, and Light Crossbow (all called crossbows elsewhere in this feat). If you're holding one of them, you can load a piece of ammunition into it even if you lack a free hand.",
        "Firing in Melee : Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with crossbows.",
        "Dual Wielding : When you make the extra attack of the Light property, you can add your ability modifier to the damage of the extra attack if that attack is with a crossbow that has the Light property and you are not already adding that modifier to the damage.",
    ]),
    prerequisite: "Level 4 and Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Dex') >= 13;
    },
};
FeatsList["crusher"] = {
    name: "Crusher",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*crusher).*$/i,
    description: "+1 Str or Con, 1/turn when I hit a creature with Blud. dmg, I can push it 5 ft to unoccupied space if it's no more than 1 size larger than me. When I score a Critical Hit that deals Blud. dmg to a creature, atks against it have Advantage until the start of my next turn. ",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
        "Push : Once per turn, when you hit a creature with an attack that deals Bludgeoning damage, you can move it 5 feet to an unoccupied space if the target is no more than one size larger than you.",
        "Enhanced Critical : When you score a Critical Hit that deals Bludgeoning damage to a creature, attack rolls against that creature have Advantage until the start of your next turn.",
    ]),
    choices: ["Strength", "Constitution"],
    "strength": {
        description: "1/turn when I hit a creature with Blud. dmg, I can push it 5 ft to unoccupied space if it's no more than 1 size larger than me. When I score a Critical Hit that deals Blud. dmg to a creature, atks against it have Advantage until the start of my next turn.  [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "constitution": {
        description: "1/turn when I hit a creature with Blud. dmg, I can push it 5 ft to unoccupied space if it's no more than 1 size larger than me. When I score a Critical Hit that deals Blud. dmg to a creature, atks against it have Advantage until the start of my next turn.  [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
    },
    prerequisite: "Level 4 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["defensive duelist"] = {
    name: "Defensive Duelist",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*defensive)(?=.*duelist).*$/i,
    scores: [0, 1, 0, 0, 0, 0],
    action: ["reaction", "Parry"],
    description: "+1 Dex, If I'm holding a Finesse weapon and another creature hits me with a melee attack, I can take a Reaction to add my Proficiency Bonus to my Armor Class, potentially causing the attack to miss me. I gain this bonus to my AC against melee attacks until the start of my next turn.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Dexterity score by 1 to a maximum of 20.",
        "Parry : If you're holding a Finesse weapon and another creature hits you with a melee attack, you can take a Reaction to add your Proficiency Bonus to your Armor Class, potentially causing the attack to miss you. You gain this bonus to your AC against melee attacks until the start of your next turn.",
    ]),
    prerequisite: "Level 4 and Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Dex') >= 13;
    },
};
FeatsList["dual wielder"] = {
    name: "Dual Wielder",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*dual)(?=.*wielder).*$/i,
    scorestxt: "My Strength or Dexterity score increases by 1, to a maximum of 20.",
    description: "+1 Str or Dex, If I take the attack action with a weapon that has the light property, I can make an off-hand attack with another weapon that doesn't have the Two-Handed property, I do not add the modifier to this atk unless it is negative, I can also draw and stow 2 non-Two-Handed weapons at a time.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Enhanced Dual Wielding : When you take the Attack action on your turn and attack with a weapon that has the Light property, you can make one extra attack as a Bonus Action later on the same turn with a different weapon, which must be a Melee weapon that lacks the Two-Handed property. You don't add your ability modifier to the extra attack's damage unless the modifier is negative.",
        "Quick Draw : You can draw or stow two weapons that lack the Two-Handed property when you would normally be able to draw or stow only one.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "If I take the attack action with a weapon that has the light property, I can make an off-hand attack with another weapon that doesn't have the Two-Handed property, I do not add the modifier to this atk unless it is negative, I can also draw and stow 2 non-Two-Handed weapons at a time. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "If I take the attack action with a weapon that has the light property, I can make an off-hand attack with another weapon that doesn't have the Two-Handed property, I do not add the modifier to this atk unless it is negative, I can also draw and stow 2 non-Two-Handed weapons at a time. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["durable"] = {
    name: "Durable",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*durable).*$/i,
    scores: [0, 0, 1, 0, 0, 0],
    savetxt: "Adv. on Death Saving Throws",
    action: [
        ["bonus action", "Speedy Recovery"]
    ],
    description: "+1 Con, Adv vs Death Saves, Bonus Action to expend 1 Hit Die to regain HP equal to the roll.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Constitution score by 1 to a maximum of 20.",
        "Defy Death : You have Advantage on Death Saving Throws.",
        "Speedy Recovery : As a Bonus Action, you can expend one of your Hit Point Dice, roll the die, and regain a number of Hit Points equal to the roll.",
    ]),
    prerequisite: "Level 4 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["elemental adept"] = {
    name: "Elemental Adept",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*elemental)(?=.*adept).*$/i,
    scorestxt: "My Intelligence, Wisdom, or Charisma score increases by 1, to a maximum of 20.",
    description: "+1 Int, Wis, or Cha, Choose one of the damage types: Acid, Cold, Fire, Lightning, or Thunder. Spells I cast ignore resistance to damage from this damage type. For any spell I cast that deals this damage type, I can treat any 1 on a damage die as a 2.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
        "Energy Mastery : Choose one of the following damage types; Acid, Cold, Fire, Lightning, or Thunder. Spells you cast ignore Resistance to damage of the chosen type. In addition, when you roll damage for a spell you cast that deals damage of that type you can treat any 1 on the damage die as a 2.",
        "Repeatable : You can take this feat more than once, but you must choose a different damage type each time for Energy Mastery.",
    ]),
    prerequisite: "Level 4 and The Spellcasting or Pact Magic Feature",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.isSpellcaster;
    },
    allowDuplicates: true,
    choices: ["Acid", "Cold", "Fire", "Lightning", "Thunder"],
    "acid": {
        description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to Acid damage. For any spell I cast that deals Acid damage, I can treat any 1 on a damage die as a 2."
    },
    "cold": {
        description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to Cold damage. For any spell I cast that deals Cold damage, I can treat any 1 on a damage die as a 2."
    },
    "fire": {
        description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to Fire damage. For any spell I cast that deals Fire damage, I can treat any 1 on a damage die as a 2."
    },
    "lightning": {
        description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to Lightning damage. For any spell I cast that deals Lightning damage, I can treat any 1 on a damage die as a 2."
    },
    "thunder": {
        description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to Thunder damage. For any spell I cast that deals Thunder damage, I can treat any 1 on a damage die as a 2."
    },
};
FeatsList["fey touched"] = {
    name: "Fey Touched",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*fey)(?=.*touched).*$/i,
    spellcastingBonus: [{
        name: "Misty Step",
        spells: ["misty step"],
        selection: ["misty step"],
        firstCol: "oncelr"
    }, {
        name: "1st-level Ench/Div spell",
        'class': "any",
        school: ["Ench", "Div"],
        level: [1, 1],
        firstCol: "oncelr"
    }],
    spellcastingAbility: 4,
    allowUpCasting: true,
    description: "+1 Int, Wis, or Cha, I learn the Misty Step and one other 1st-level spell from the Divination or Enchantment school.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
        "Fey Magic : Choose one level 1 spell from the Divination or Enchantment school of magic. You always have that spell and the Misty Step spell prepared. You can cast each of these spells without expending a spell slot. Once you cast either spell in this way, you can't cast that spell in this way again until you finish a Long Rest. You can also cast these spells using spell slots you have of the appropriate level. The spells' spellcasting ability is the ability increased by this feat.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Intelligence is my spellcasting ability for these spells. [+1 Intelligence]",
        spellcastingAbility: 4,
        scores: [0, 0, 0, 1, 0, 0]
    },
    "wisdom": {
        description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Wisdom is my spellcasting ability for these spells. [+1 Wisdom]",
        spellcastingAbility: 5,
        scores: [0, 0, 0, 0, 1, 0]
    },
    "charisma": {
        description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Charisma]",
        spellcastingAbility: 6,
        scores: [0, 0, 0, 0, 0, 1]
    },
    prerequisite: "Level 4 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["grappler"] = {
    name: "Grappler",
    source: [
        ["P24", 202]
    ],
    regExpSearch: /^(?=.*grappler).*$/i,
    description: "+1 Str or Dex, Once per turn when I make an Unarmed Strike, as part of the Attack Action, I may deal damage and grapple the target. I have advantage on attack rolls against a target I'm grappling and can move my normal speed with a grappled target as long as they are my size or smaller.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Punch and Grab : When you hit a creature with an Unarmed Strike as part of the Attack action on your turn, you can use both the Damage and the Grapple option. You can use this benefit only once per turn.",
        "Attack Advantage : You have Advantage on attack rolls against a creature Grappled by you.",
        "Fast Wrestler : You don‚Äôt have to spend extra movement to move a creature Grappled by you if the creature is your size or smaller.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "Once per turn when I make an Unarmed Strike, as part of the Attack Action, I may deal damage and grapple the target. I have advantage on attack rolls against a target I'm grappling and can move my normal speed with a grappled target as long as they are my size or smaller. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "Once per turn when I make an Unarmed Strike, as part of the Attack Action, I may deal damage and grapple the target. I have advantage on attack rolls against a target I'm grappling and can move my normal speed with a grappled target as long as they are my size or smaller. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["great weapon master"] = {
    name: "Great Weapon Master",
    source: [
        ["P24", 203]
    ],
    regExpSearch: /^(?=.*great)(?=.*weapon)(?=.*master).*$/i,
    scores: [1, 0, 0, 0, 0, 0],
    description: "+1 Str. When I hit with a weapon as part of the Attack action, that has the Heavy property, I can deal extra damage equal to my Prof Bonus. If I score a Crit or reduce a creature to 0 HP with Melee weapon, I may make another attack with the same weapon as a Bonus Action.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength score by 1 to a maximum of 20.",
        "Heavy Weapon Master : When you hit a creature with a weapon that has the Heavy property as part of the Attack action on your turn, you can cause the weapon to deal extra damage to the target. The extra damage equals your Proficiency Bonus.",
        "Hew : Immediately after you score a Critical Hit with a Melee weapon or reduce a creature to 0 Hit Points with one, you can make one attack with the same weapon as a Bonus Action",
    ]),
    action: [
        ["bonus action", " (Hew)"]
    ],
    calcChanges: {
        atkCalc: [
            function(fields, v, output) {
                if (v.isWeapon && (/heavy/i).test(fields.Description) && (/\bgwm\b|power.{0,3}attack|great.{0,3}weapon.{0,3}master/i).test(v.WeaponText)) {
                    output.extraDmg += What("Proficiency Bonus");
                }
            },
            "If I include the words 'Power Attack', 'Great Weapon Master', or just 'GWM' in a heavy melee weapon's name or description, the attack's damage will gain a bonus equal to my Proficiency Bonus."
        ]
    },
    prerequisite: "Level 4 and Strength 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13;
    },
};
FeatsList["heavily armored"] = {
    name: "Heavily Armored",
    source: [
        ["P24", 204]
    ],
    regExpSearch: /^(?=.*heavily)(?=.*armored).*$/i,
    description: "+1 Dex/Con, I gain training with Heavy armor.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
        "Armor Training : You gain training with Heavy armor.",
    ]),
    armorProfs: [false, false, true, false],
    choices: ["Strength", "Constitution"],
    "strength": {
        description: "I gain training with Heavy armor. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "constitution": {
        description: "I gain training with Heavy armor. [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
    },
    prerequisite: "Level 4 and Medium Armor training",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.mediumArmorProf;
    },
};
FeatsList["heavy armor master"] = {
    name: "Heavy Armor Master",
    source: [
        ["P24", 204]
    ],
    regExpSearch: /^(?=.*heavy)(?=.*armor)(?=.*master).*$/i,
    description: "+1 Dex/Con, I take my Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
        "Damage Reduction : When you're hit by an attack while you're wearing Heavy armor, any Bludgeoning, Piercing, and Slashing damage dealt to you by that attack is reduced by an amount equal to your Proficiency Bonus.",
    ]),
    choices: ["Strength", "Constitution"],
    "strength": {
        description: "I take my Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "constitution": {
        description: "I take my Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor. [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
    },
    prerequisite: "Level 4 and Heavy Armor training",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.heavyArmorProf;
    },
};
FeatsList["inspiring leader"] = {
    name: "Inspiring Leader",
    source: [
        ["P24", 204]
    ],
    regExpSearch: /^(?=.*inspiring)(?=.*leader).*$/i,
    description: "+1 Wis or Cha, After a rest I can give a performance that grants up to 6 allies (can include myself) Temp HP = my Character level + Wis/Cha.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Wisdom or Charisma score by 1 to a maximum of 20.",
        "Bolstering Performance : When you finish a Short or Long Rest, you give an inspiring performance; a speech, song, or dance. When you do so, choose up to six allies (which can include yourself) within 30 feet of yourself who witness the performance. The chosen creatures each gain Temporary Hit Points equal to your character level plus the modifier of the ability you increased with this feat.",
    ]),
    choices: ["Wisdom", "Charisma"],
    "wisdom": {
        description: "After a rest, I can give a performance that grants up to 6 allies (can include myself) Temp HP = my Character level + Wis. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    "charisma": {
        description: "After a rest, I can give a performance that grants up to 6 allies (can include myself) Temp HP = my Character level + Cha. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
    },
    prerequisite: "Level 4 and Wisdom or Charisma 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Wis') >= 13 || What('Cha') >= 13;
    },
};
FeatsList["keen mind"] = {
    name: "Keen Mind",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*keen)(?=.*mind).*$/i,
    scores: [0, 0, 0, 1, 0, 0],
    action: ["bonus action", "Study"],
    skillstxt: "Choose 1 : Arcana, History, Investigation, Nature or Religion. I gain Proficiency in the chosen skill if I am already proficient I gain Expertise.",
    description: "+1 Int, I gain proficiency or expertise (if I already have proficiency) in one of the Intelligence skills, and can take the Study action as a Bonus Action.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence score by 1 to a maximum of 20.",
        "Lore Knowledge : Choose one of the following skills; Arcana, History, Investigation, Nature, or Religion. If you lack proficiency in the chosen skill, you gain proficiency in it, if you already have proficiency in it, you gain Expertise in it.",
        "Quick Study : You can take the Study action as a Bonus Action",
    ]),
    prerequisite: "Level 4 and Intelligence 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Int') >= 13;
    },
};
FeatsList["lightly armored"] = {
    name: "Lightly Armored",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*lightly)(?=.*armored).*$/i,
    armorProfs: [true, false, false, true],
    description: "+1 Str/Dex, I gain training with Light armor and Shields.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Armor Training : You gain training with Light armor and Shields.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "I gain training with Light armor and Shields. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "I gain training with Light armor and Shields. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },

    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["mage slayer"] = {
    name: "Mage Slayer",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*mage)(?=.*slayer).*$/i,
    limfeaname: "Guarded Mind (Mage Slayer)",
    usages: 1,
    recovery: "short rest",
    description: "+1 Str/Dex, When I deal damage to a creature concentrating on a spell, they have Disadvantage on the saving throw to maintain concentration. Once per rest, when I fail an Int, Wis, or Cha save, I can choose to succeed.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Concentration Breaker : When you deal damage to a creature that is concentrating, It has Disadvantage on the saving throw to maintain Concentration.",
        "Guarded Mind : If you fail an Intelligence, a Wisdom, or a Charisma saving throw, you can cause yourself to succeed instead. Once you use this benefit you can't use it again until you finish a Short or Long Rest.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "When I deal damage to a creature concentrating on a spell, they have Disadvantage on the saving throw to maintain concentration. Once per rest, when I fail an Int, Wis, or Cha save, I can choose to succeed. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "When I deal damage to a creature concentrating on a spell, they have Disadvantage on the saving throw to maintain concentration. Once per rest, when I fail an Int, Wis, or Cha save, I can choose to succeed. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["martial weapon training"] = {
    name: "Martial Weapon Training",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*martial)(?=.*weapon)(?=.*training).*$/i,
    weaponProfs: [false, true],
    description: "+1 Str/Dex, I gain proficiency with Martial weapons.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Weapon Proficiency : You gain proficiency with Martial weapons.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "I gain proficiency with Martial weapons. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "I gain proficiency with Martial weapons. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["medium armor master"] = {
    name: "Medium Armor Master",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*medium)(?=.*armor)(?=.*master).*$/i,
    description: "+1 Dex/Con, I can add 3 while wearing medium armor if I have a Dex of 16+, instead of 2.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
        "Dexterous Wearer. While you're wearing Medium armor, you can add 3, rather than 2, to your AC if you have a Dexterity score of 16 or higher.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "I can add 3 while wearing medium armor if I have a Dex of 16+, instead of 2. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "I can add 3 while wearing medium armor if I have a Dex of 16+, instead of 2. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Medium Armor training",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.mediumArmorProf;
    },
    eval: function() {
        Value('Medium Armor Max Mod', 3);
        ApplyArmor(What("AC Armor Description"));
    },
    removeeval: function() {
        tDoc.resetForm(['Medium Armor Max Mod']);
        ApplyArmor(What("AC Armor Description"));
    },
};
FeatsList["moderately armored"] = {
    name: "Moderately Armored",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*moderately)(?=.*armored).*$/i,
    armorProfs: [false, true, false, false],
    description: "+1 Str/Dex, I gain training with Medium armor.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Armor Training : You gain training with Medium armor.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "I gain training with Medium armor. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "I gain training with Medium armor. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Medium Armor training",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.lightArmorProf;
    },
};
FeatsList["mounted combatant"] = {
    name: "Mounted Combatant",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*mounted)(?=.*combatant).*$/i,
    description: "+1 Str/Dex/Wis, While mounted: I have adv on atk rolls against unmounted creatures in 5 ft that are smaller than my mount; if my mount makes a Dex save to take half dmg from an effect, it takes no dmg on a pass and half on a fail; when an atk hits my mount, I can have it hit me instead if I'm not Incapacitated.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength, Dexterity, or Wisdom score by 1 to a maximum of 20.",
        "Mounted Strike : While mounted, you have Advantage on attack rolls against any unmounted creature within 5 feet of your mount that is at least one size smaller than the mount.",
        "Leap Aside : If your mount is subjected to an effect that allows it to make a Dexterity saving throw to take only half damage, it instead takes no damage if it succeeds on the saving throw and only half damage if it fails. For your mount to gain this benefit, you must be riding it, and neither of you can have the Incapacitated condition.",
        "Veer : While mounted, you can force an attack that hits your mount to hit you instead if you don't have the Incapacitated.",
    ]),
    choices: ["Strength", "Dexterity", "Wisdom"],
    "strength": {
        description: "While mounted: I have adv on atk rolls against unmounted creatures in 5 ft that are smaller than my mount; if my mount makes a Dex save to take half dmg from an effect, it takes no dmg on a pass and half on a fail; when an atk hits my mount, I can have it hit me instead if I'm not Incapacitated. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "While mounted: I have adv on atk rolls against unmounted creatures in 5 ft that are smaller than my mount; if my mount makes a Dex save to take half dmg from an effect, it takes no dmg on a pass and half on a fail; when an atk hits my mount, I can have it hit me instead if I'm not Incapacitated. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    "wisdom": {
        description: "While mounted: I have adv on atk rolls against unmounted creatures in 5 ft that are smaller than my mount; if my mount makes a Dex save to take half dmg from an effect, it takes no dmg on a pass and half on a fail; when an atk hits my mount, I can have it hit me instead if I'm not Incapacitated. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["observant"] = {
    name: "Observant",
    source: [
        ["P24", 205]
    ],
    regExpSearch: /^(?=.*observant).*$/i,
    skillstxt: "Choose 1 : Insight, Investigation, or Perception. I gain Proficiency in the chosen skill, if I am already proficient I gain Expertise.",
    action: ["bonus action", "Search"],
    description: "+1 Int/Wis, I gain proficiency or expertise (if I already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence or Wisdom score by 1 to a maximum of 20.",
        "Keen Observer : Choose one of the following skills; Insight, Investigation, or Perception. If you lack proficiency with the chosen skill, you gain proficiency in it, and if you already have proficiency in it, you gain Expertise in it.",
        "Quick Search : You can take the Search action as a Bonus Action.",
    ]),
    choices: ["Intelligence", "Wisdom"],
    "intelligence": {
        description: "I gain proficiency or expertise (if I already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
    },
    "wisdom": {
        description: "I gain proficiency or expertise (if I already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    prerequisite: "Level 4 and Intelligence or Wisdom 13+",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Int') >= 13 || What('Wis') >= 13;
    },
};
FeatsList["piercer"] = {
    name: "Piercer",
    source: [
        ["P24", 206]
    ],
    regExpSearch: /^(?=.*piercer).*$/i,
    description: "+1 Str/Dex, When I hit a creature with an atk roll with a Piercing weapon I can reroll one of the attack damage dice. On a Crit I deal one additional damage die.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Puncture : Once per turn, when you hit a creature with an attack that deals Piercing damage, you can reroll one of the attack's damage dice, and you must use the new roll.",
        "Enhanced Critical : When you score a Critical Hit that deals Piercing damage to a creature, you can roll one additional damage die when determining the extra Piercing damage the target takes.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "When I hit a creature with an atk roll with a Piercing weapon I can reroll one of the attack damage dice. On a Crit I deal one additional damage die. [+1 Strength]",
        weaponProfs: [false, true],
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "When I hit a creature with an atk roll with a Piercing weapon I can reroll one of the attack damage dice. On a Crit I deal one additional damage die. [+1 Dexterity]",
        weaponProfs: [false, true],
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["poisoner"] = {
    name: "Poisoner",
    source: [
        ["P24", 206]
    ],
    regExpSearch: /^(?=.*poisoner).*$/i,
    toolProfs: [
        ["Poisoner's Kit"]
    ],
    description: "+1 Dex/Int, my poison ignores Poison Resistance, I gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when I deal damage with an atk, the target makes a Con save or takes 2d8 Poison dmg and be Poisoned. DC=8+Dex-or-Int+Prof",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Dexterity or Intelligence score by 1 to a maximum of 20.",
        "Potent Poison : When you make a damage roll that deals Poison damage, it ignores Resistance to Poison damage.",
        "Brew Poison : You gain proficiency with the Poisoner's Kit. With 1 hour of work using such a kit and expending 50 GP worth of materials, you can creature a number of poison doses equal to my Proficiency Bonus. As a Bonus Action, you can apply a poison dose to a weapon or piece of ammunition. Once applied, the poison retains its potency for 1 minute or until you deal damage with the poisoned item, whichever is shorter. When a creature takes damage from the poisoned item, that creature must succeed on a Constitution saving throw (DC 8 plus the modifier of the ability increased by this feat and your Proficiency Bonus) or take 2d8 Poison damage and have the Poisoned condition until the end of your next turn.",
    ]),
    choices: ["Dexterity", "Intelligence"],
    "dexterity": {
        description: "My poison ignores Poison Resistance, I gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when I hit with an atk, the target makes a Con save or take 2d8 Poison dmg and be Poisoned. DC=8+Dex+Prof [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    "intelligence": {
        description: "My poison ignores Poison Resistance, I gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when I hit with an atk, the target makes a Con save or take 2d8 Poison dmg and be Poisoned. DC=8+Int+Prof [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["polearm master"] = {
    name: "Polearm Master",
    source: [
        ["P24", 206]
    ],
    regExpSearch: /^(?=.*polearm)(?=.*master).*$/i,
    weaponOptions: [{
        regExpSearch: /^(?=.*(polearm|(glaive|guandao|bisento|naginata)|(halberd|\bji\b|kamayari)|(quarterstaff|\bstaff\b|\bbo\b)|(spear|qiang|\byaris?\b)))(?=.*butt)(?=.*end).*$/i,
        name: "Polearm Butt End",
        source: [
            ["P24", 206]
        ],
        ability: 1,
        type: "polearm butt end",
        damage: [1, 4, "bludgeoning"],
        range: "Melee",
        description: "As bonus action after Attack action with only a glaive, halberd, spear, or quarterstaff",
        abilitytodamage: true,
        selectNow: true
    }],
    action: [
        ["bonus action", "Butt End Attack (after attack with polearm)"],
        ["reaction", "Reactive Strike"]
    ],
    weaponProfs: [false, false, ["polearm butt end"]],
    description: "+1 Str/+1 Dex, As a Bonus Action when I take the Attack Action with a Quarterstaff, Spear, or Heavy and Reach weapon, I can strike with the opposite end for 1d4 Bludgeoning.  While holding a Quarterstaff, Spear, or Heavy and Reach weapon, I can make one melee attack against a creature that enters the weapon's reach as a Reaction.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Pole Strike : Immediately after you take the Attack action and attack with a Quarterstaff, a Spear, or a weapon that has the Heavy and Reach properties, you can use a Bonus Action to make a melee attack with the opposite end of the weapon. The weapon deals Bludgeoning, and the weapon damage die for this is a d4.",
        "Reactive Strike : While you're holding a Quarterstaff, a Spear, or a weapon that has the Heavy and Reach properties, you can take a Reaction to make one melee attack against a creature that enters the reach you have with that weapon.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "As a Bonus Action when I take the Attack Action with a Quarterstaff, Spear, or Heavy and Reach weapon, I can strike with the opposite end for 1d4 Bludgeoning.  While holding a Quarterstaff, Spear, or Heavy and Reach weapon, I can make one melee attack against a creature that enters the weapon's reach as a Reaction. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "As a Bonus Action when I take the Attack Action with a Quarterstaff, Spear, or Heavy and Reach weapon, I can strike with the opposite end for 1d4 Bludgeoning.  While holding a Quarterstaff, Spear, or Heavy and Reach weapon, I can make one melee attack against a creature that enters the weapon's reach as a Reaction. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["resilient"] = {
    name: "Resilient",
    source: [
        ["P24", 206]
    ],
    regExpSearch: /^(?=.*resilient).*$/i,
    description: "Select an ability score using the square button on this feat line. I gain proficiency with the saving throw of that ability score and a +1 added to it.",
    descriptionFull: "Choose one ability in which you lack saving throw proficiency. You gain the following benefits:\n \u2022 Increase the chosen ability score by 1, to a maximum of 20.\n \u2022 you gain proficiency in saving throws using the chosen ability.",
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        description: "I gain proficiency with Strength saving throws. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        saves: ["Str"]
    },
    "dexterity": {
        description: "I gain proficiency with Dexterity saving throws. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        saves: ["Dex"]
    },
    "constitution": {
        description: "I gain proficiency with Constitution saving throws. [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        saves: ["Con"]
    },
    "intelligence": {
        description: "I gain proficiency with Intelligence saving throws. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        saves: ["Int"]
    },
    "wisdom": {
        description: "I gain proficiency with Wisdom saving throws. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        saves: ["Wis"]
    },
    "charisma": {
        description: "I gain proficiency with Charisma saving throws. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        saves: ["Cha"]
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["ritual caster"] = {
    name: "Ritual Caster",
    source: [
        ["P24", 206]
    ],
    regExpSearch: /^(?=.*ritual)(?=.*caster).*$/i,
    spellcastingBonus: [{
        name: "1st-level Ritual spells",
        "class": "any",
        ritual: true,
        level: [1, 1],
        times: [0, 0, 0, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6],
    }],
    description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells I can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.",
        "Ritual Spells : Choose a number of level 1 spells equal to your Proficiency Bonus that have the Ritual tag. You always have those spells prepared, and you can cast them with any spell slots you have. The spells' spellcasting ability is the ability increased by this feat. Whenever your Proficiency Bonus increases hereafter, you can add an additional level 1 spell with the Ritual tag to the spells always prepared with this feature.",
        "Quick Ritual : With this benefit, you can cast a Ritual spell that you have prepared using its regular casting time rather than the extended time for a Ritual. Doing so doesn't require a spell slot. Once you cast the spell in this way, you can't use this benefit again until you finish a Long Rest.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells I can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        spellcastingAbility: 4,
    },
    "wisdom": {
        description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells I can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        spellcastingAbility: 5,
    },
    "charisma": {
        description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells I can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        spellcastingAbility: 6,
    },
    prerequisite: "Intelligence, Wisdom, or Charisma 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Int') >= 13 || What('Wis') >= 13 || What('Cha') >= 13;
    },
};
FeatsList["sentinel"] = {
    name: "Sentinel",
    source: [
        ["P24", 207]
    ],
    regExpSearch: /^(?=.*sentinel).*$/i,
    description: "+1 Str/+1 Dex, Reaction when creature in 5 ft takes Disengage action or hits target other than me, I can make an Opportunity Attack vs them. When I make an Opportunity Attack against a creature, its Speed becomes 0 for the rest of the current turn.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
        "Guardian : Immediately after a creature within 5 feet of you takes the Disengage action or hits a target other than you with an attack, you can make an Opportunity Attack against that creature.",
        "Halt : When you hit a creature with an Opportunity Attack, the creature's Speed becomes 0 for the rest of the current turn.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "Reaction when creature in 5 ft takes Disengage action or hits target other than me, I can make an Opportunity Attack vs them. When I make an Opportunity Attack against a creature, its Speed becomes 0 for the rest of the current turn. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "Reaction when creature in 5 ft takes Disengage action or hits target other than me, I can make an Opportunity Attack vs them. When I make an Opportunity Attack against a creature, its Speed becomes 0 for the rest of the current turn. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    action: ["reaction", " (after Disengage/hit on other)"],
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["shadow touched"] = {
    name: "Shadow Touched",
    source: [
        ["P24", 207]
    ],
    regExpSearch: /^(?=.*shadow)(?=.*touched).*$/i,
    spellcastingBonus: [{
        name: "Invisibility",
        spells: ["invisibility"],
        selection: ["invisibility"],
        firstCol: "oncelr"
    }, {
        name: "1st-level Illus/Necro spell",
        'class': "any",
        school: ["Illus", "Necro"],
        level: [1, 1],
        firstCol: "oncelr"
    }],
    description: "+1 Int, Wis, or Cha, I learn the Invisibility and one other 1st-level spell from the Illusion or Necromancy school.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
        "Shadow Magic : Choose one level 1 spell from the Illusion or Necromancy school of magic. You always have that spell and the Invisibility spell prepared. You can cast each of these spells without expending a spell slot. Once you cast either spell in this way, you can't cast that spell in this way again until you finish a Long Rest. You can also cast these spells using spell slots you have of the appropriate level. The spells' spellcasting ability is the ability increased by this feat.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Intelligence]",
        spellcastingAbility: 4,
        scores: [0, 0, 0, 1, 0, 0]
    },
    "wisdom": {
        description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Wisdom]",
        spellcastingAbility: 5,
        scores: [0, 0, 0, 0, 1, 0]
    },
    "charisma": {
        description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Charisma]",
        spellcastingAbility: 6,
        scores: [0, 0, 0, 0, 0, 1]
    },
    prerequisite: "Level 4 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["sharpshooter"] = {
    name: "Sharpshooter",
    source: [
        ["P24", 207]
    ],
    regExpSearch: /^(?=.*sharpshooter).*$/i,
    scores: [0, 1, 0, 0, 0, 0],
    description: "My ranged weapon attacks don't have disadvantage in melee or on long-range and ignore half cover and three-quarters cover. [+1 Dexterity]",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Ability Score Increase : Increase your Dexterity score by 1, to a maximum of 20.",
        "Bypass Cover : Your ranged attacks with weapons ignore Half and Three-Quarter Cover.",
        "Firing in Melee : Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with Ranged weapons.",
        "Long Shots : Attacking at long range doesn't impose Disadvantage on your attack rolls with Ranged weapons.",
    ]),
    calcChanges: {
        atkAdd: [
            function(fields, v) {
                if (v.isRangedWeapon || v.isThrownWeapon) {
                    fields.Description += (fields.Description ? '; ' : '') + "No disadv. in melee or at long range; Ignore \u00BD and \u00BE cover";
                }
            },
            "My ranged weapon attacks suffer no disadvantage in melee or for long range and ignore half cover and three-quarters cover. This includes thrown weapons."
        ],
    },
    prerequisite: "Level 4 and Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Dex') >= 13;
    },
};
FeatsList["shield master"] = {
    name: "Shield Master",
    source: [
        ["P24", 207]
    ],
    regExpSearch: /^(?=.*shield)(?=.*master).*$/i,
    scores: [1, 0, 0, 0, 0, 0],
    weaponOptions: [{
        regExpSearch: /^(?=.*shield)(?=.*bash).*$/i,
        name: "Shield Bash",
        source: [
            ["P24", 207]
        ],
        ability: 1,
        type: "special",
        damage: ["", "", ""],
        range: "Melee",
        description: "Once per turn when hit with Melee weapon during Attack action, use shield to knock an enemy prone or push 5 ft",
        abilitytodamage: false,
        dc: true,
        selectNow: true,
        isNotWeapon: true,
        isAlwaysProf: true,
    }],
    description: "Once per turn when I use the Attack action and hit with melee weapon, I can cause the creature I hit to make a STR save (DC 8 + STR + Prof). If it fails I can either push the creature 5 feet or knock it Prone. As a reaction, if I succeed on a Dex save for half damage, I can interpose my shield to avoid the damage. [+1 Str]",
    descriptionFull: desc([
        "You gain the following benefits:",
        "Ability Score Increase : Increase your Strength score by 1, to a maximum of 20.",
        "Shield Bash : If you attack a creature within 5 feet of you as part of the Attack action and hit with a Melee weapon, you can immediately bash the target with your Shield if it's equipped forcing the target to make a Strength saving throw (DC 8 plus your Strength modifier and Proficiency Bonus). On a failed save, you either push the target 5 feet from you or cause it to have the Prone condition (your choice). You can use this benefit only once on each of your turns.",
        "Interpose Shield. If you're subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you can take a Reaction to take no damage if you succeed on the saving throw and are holding a Shield.",
    ]),
    action: [
        ['reaction', 'Interpose shield']
    ],
    prerequisite: "Level 4 and Shield Training",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.shieldProf;
    },
};
FeatsList["skill expert"] = {
    name: "Skill Expert",
    source: [
        ["P24", 207]
    ],
    regExpSearch: /^(?=.*skill)(?=.*expert).*$/i,
    skillstxt: "Proficiency with one skill, and Expertise with one skill I'm proficient with",
    scorestxt: "+1 to one ability score of my choice",
    description: "I gain proficiency in one skill and expertise in that same skill or another skill I'm proficient with. [+1 to one ability score of my choice]",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase one ability score of your choice by 1, to a maximum of 20.",
        "Skill Proficiency : You gain proficiency in one skill of your choice.",
        "Expertise : Choose one skill in which you have proficiency but lack Expertise. You gain expertise with that skill.",
    ]),
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["skulker"] = {
    name: "Skulker",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*skulker).*$/i,
    scores: [0, 1, 0, 0, 0, 0],
    vision: [
        ["Blindsight", 10]
    ],
    description: "Adv. to hide in combat. My position is not revealed when I am hidden from a creature and miss it with an attack. Blindsight 10ft",
    descriptionFull: desc([
        "You gain the following benefits",
        "Blindsight : You have Blindsight with a range of 10 feet.",
        "Fog of War : You exploit the distractions of battle, gaining Advantage on any Dexterity (Stealth) check you make as part of the Hide action during combat.",
        "Sniper : If you make an attack roll while hidden and the roll misses, making the attack roll doesn't reveal your location.",
    ]),
    prerequisite: "Level 4 and Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Dex') >= 13;
    },
};
FeatsList["slasher"] = {
    name: "Slasher",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*slasher).*$/i,
    description: "+1 Str/Dex, Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. ",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity by 1, to a maximum of 20.",
        "Hamstring : Once per turn, when you hit a creature with an attack that deals Slashing damage, you can reduce the speed of that creature by 10 feet until the start of your next turn.",
        "Enhanced Critical : When you score a Critical Hit that deals Slashing damage to a creature, it has Disadvantage on attack rolls until the start of your next turn.",
    ]),
    choices: ["Strength", "Dexterity"],
    "strength": {
        description: "Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        description: "Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
    },
};
FeatsList["speedy"] = {
    name: "Speedy",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*speedy).*$/i,
    speed: {
        walk: "+10"
    },
    description: "+1 Dex/Con, +10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against me.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Dexterity or Constitution by 1, to a maximum of 20.",
        "Speed Increase : Your Speed increases by 10 feet.",
        "Dash over Difficult Terrain : When you take the Dash action on your turn, Difficult Terrain doesn't cost you extra movement for the rest of that turn.",
        "Agile Movement : Opportunity Attacks have Disadvantage against you.",
    ]),
    choices: ["Dexterity", "Constitution"],
    "dexterity": {
        description: "+10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against me. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
    },
    "constitution": {
        description: "+10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against me. [+1 Constitution]",
        scores: [0, 0, 1, 0, 0, 0],
    },
    prerequisite: "Level 4 and Dexterity or Constitution 13 or higher",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && What('Dex') >= 13 || What('Con') >= 13;
    },
};
FeatsList["spell sniper"] = {
    name: "Spell Sniper",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*spell)(?=.*sniper).*$/i,
    description: "+1 Int/Wis/Cha my spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; my ranged spells with a range of 10ft or more have their range increased by 60 ft",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.",
        "Bypass Cover : Your attack rolls for spells ignore Half Cover and Three-quarter Cover.",
        "Casting in Melee : Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with spells.",
        "Increased Range. When you cast a spell that has a range of at least 10 feet and requires you to make an attack roll, you can increase the spell's range by 60 feet.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "My spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; my ranged spells with a range of 10ft or more have their range increased by 60 ft. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
    },
    "wisdom": {
        description: "My spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; my ranged spells with a range of 10ft or more have their range increased by 60 ft. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    "charisma": {
        description: "My spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; my ranged spells with a range of 10ft or more have their range increased by 60 ft. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
    },
    prerequisite: "Level 4 and has Spellcasting or Pact Magic Feature",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.isSpellcaster;
    },
};
FeatsList["telekinetic"] = {
    name: "Telekinetic",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*telekinetic).*$/i,
    description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft It must make a Str save vs. this feat's spell save DC or be moved 5 ft from or towards me. My spellcasting ability is the ability I choose to increase when I gain this feat. [+1 Int, Wis, or Cha]",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.",
        "Minor Telekinesis : You learn the mage hand cantrip. you can cast it without verbal or somatic components, and you can make the spectral hand invisible. If you already know this spell, its range and the distance it can be away from you both increase by 30 feet when you cast it. Its spellcasting ability is the ability increased by this feat.",
        "Telekinetic Shove : As a bonus action, you can try to telekinetically shove one creature you can see within 30 feet of you. When you do so, the target must succeed on a Strength saving throw (DC 8 + your proficiency bonus + the ability modifier of the score increased by this feat) or be moved 5 feet toward you or away from you. A creature can willingly fail this save.",
    ]),
    action: [
        ["bonus action", " Shove"]
    ],
    spellcastingBonus: {
        name: "Mage Hand",
        spells: ["mage hand"],
        selection: ["mage hand"],
        firstCol: "atwill"
    },
    calcChanges: {
        spellAdd: [
            function(spellKey, spellObj, spName) {
                if (spellKey !== "mage hand") return;
                spellObj.components = "";
                if (spellObj.description === SpellsList["mage hand"].description) spellObj.description = "Create (in)visible spectral hand for simple tasks or carry up to 10 lb; 1 a to control; can't have multiple";
                var rangeRx = /(\d+)( ?ft| ?m)/i;
                if (!/^(?=.*telekinetic)(?=.*feat).*$/i.test(CurrentSpells[spName].name) && rangeRx.test(spellObj.range)) {
                    // add the +30 ft rang only if not the entry for the feat itself
                    var spRangeM = spellObj.range.match(rangeRx);
                    spellObj.range = spellObj.range.replace(rangeRx, Number(spRangeM[1]) + (What("Unit System") === "metric" ? 9 : 30) + spRangeM[2]);
                }
                return true;
            },
            "My Telekinetic feat allows me to cast the Mage Hand cantrip without verbal or somatic components and I can make the spectral hand invisible. If I already know the cantrip from another source, its range and the distance it can be away from you both increase by 30 feet."
        ]
    },
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft" + (typePF ? "" : " away") + " from or towards me. Intelligence is my spellcasting ability for these. [+1 Intelligence]",
        spellcastingAbility: 4,
        scores: [0, 0, 0, 1, 0, 0]
    },
    "wisdom": {
        description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft" + (typePF ? "" : " away") + " from or towards me. Wisdom is my spellcasting ability for these. [+1 Wisdom]",
        spellcastingAbility: 5,
        scores: [0, 0, 0, 0, 1, 0]
    },
    "charisma": {
        description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft" + (typePF ? "" : " away") + " from or towards me. Charisma is my spellcasting ability for these. [+1 Charisma]",
        spellcastingAbility: 6,
        scores: [0, 0, 0, 0, 0, 1]
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["telepathic"] = {
    name: "Telepathic",
    source: [
        ["P24", 208]
    ],
    regExpSearch: /^(?=.*telepathic).*$/i,
    description: "I can telepathically speak to a creature I can see within 60 ft in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. My spellcasting ability is the ability I increase with this feat. [+1 Int, Wis, or Cha]",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.",
        "Telepathic Utterance : You can speak telepathically to any creature you can see within 60 feet of you. Your telepathic utterances are in a language you know, and the creature understands you only if it knows that language. Your communication doesn't give the creature the ability to respond to you telepathically.",
        "Detect thoughts : You can cast the detect thoughts spell, requiring no spell slot or components, and you must finish a long rest before you can cast it this way again. Your spellcasting ability for the spell is the ability increased by this feat. If you have spell slots of 2nd level or higher, you can cast this spell with them.",
    ]),
    spellcastingBonus: {
        name: "Detect Thoughts",
        spells: ["detect thoughts"],
        selection: ["detect thoughts"],
        firstCol: "oncelr"
    },
    spellChanges: {
        "detect thoughts": {
            components: "(V,S,M)",
            changes: "My Telepathic feat allows me to cast Detect Thoughts once per long rest without requiring a spell slot or spell components, or by using a spell slot and cast it with components as normal."
        }
    },
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "I can telepathically speak to a creature I can see within 60 ft in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Intelligence is my spellcasting ability for this. [+1 Int" + (typePF ? "" : "elligence") + "]",
        spellcastingAbility: 4,
        scores: [0, 0, 0, 1, 0, 0]
    },
    "wisdom": {
        description: "I can telepathically speak to a creature I can see within 60 ft in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Wisdom is my spellcasting ability for this. [+1 Wis" + (typePF ? "" : "dom") + "]",
        spellcastingAbility: 5,
        scores: [0, 0, 0, 0, 1, 0]
    },
    "charisma": {
        description: "I can telepathically speak to a creature I can see within 60 ft in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Charisma is my spellcasting ability for this. [+1 Cha" + (typePF ? "" : "risma") + "]",
        spellcastingAbility: 6,
        scores: [0, 0, 0, 0, 0, 1]
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["war caster"] = {
    name: "War Caster",
    source: [
        ["P24", 209]
    ],
    regExpSearch: /^(?=.*war)(?=.*caster).*$/i,
    action: ["reaction", " (Opportunity Spell)"],
    savetxt: {
        text: "Adv. on Con (Concentration) saves when damaged"
    },
    description: "+1 Int/Wis/Cha Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack.",
    descriptionFull: desc([
        "You gain the following benefits.",
        "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.",
        "Concentration : You have Advantage on Constitution saving throws that you make to maintain Concentration.",
        "Reactivate Spell : When a creature provokes an Opportunity Attack from you by leaving your reach, you can take a Reaction to cast a spell at the creature rather than making an Opportunity Attack. The spell must have a casting time of one action and must target only that creature.",
        "Somatic Components : You can perform the Somatic components of spells even when you have Weapons or a Shield in one or both hands.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
    },
    "wisdom": {
        description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
    },
    "charisma": {
        description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
    },
    prerequisite: "Level 4 and has Spellcasting or Pact Magic Feature",
    prereqeval: function(v) {
        return v.characterLevel >= 4 && v.isSpellcaster;
    },
};
FeatsList["weapon master"] = {
    name: "Weapon Master",
    source: [
        ["P24", 209]
    ],
    regExpSearch: /^(?=.*weapon)(?=.*master).*$/i,
    scorestxt: "My Strength or Dexterity score increases by 1, to a maximum of 20.",
    description: "+1 Str/Dex, Gain Weapon Mastery in one weapon of choice. can change choice during a long rest provided I have the appropriate proficiencies.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Increase : Increase your Strength or Dexterity score by 1, to a maximum of 20.",
        "Mastery Property : Your training with weapons allows you to use the mastery property of one kind of Simple or Martial weapon of your choice, provided you have proficiency with it. Whenever you finish a Long Rest, you can change the kind of weapon to another kind.",
    ]),
    choices: ["Weapon Master (Club)", "Weapon Master (Dagger)", "Weapon Master (Greatclub)", "Weapon Master (Handaxe)", "Weapon Master (Javelin)", "Weapon Master (Light Hammer)", "Weapon Master (Mace)", "Weapon Master (Quarterstaff)", "Weapon Master (Sickle)", "Weapon Master (Spear)", "Weapon Master (Dart)", "Weapon Master (Light Crossbow)", "Weapon Master (Shortbow)", "Weapon Master (Sling)", "Weapon Master (Battleaxe)", "Weapon Master (Flail)", "Weapon Master (Glaive)", "Weapon Master (Greataxe)", "Weapon Master (Greatsword)", "Weapon Master (Halberd)", "Weapon Master (Lance)", "Weapon Master (Longsword)", "Weapon Master (Maul)", "Weapon Master (Morningstar)", "Weapon Master (Pike)", "Weapon Master (Rapier)", "Weapon Master (Scimitar)", "Weapon Master (Shortsword)", "Weapon Master (Trident)", "Weapon Master (Warhammer)", "Weapon Master (War Pick)", "Weapon Master (Whip)", "Weapon Master (Blowgun)", "Weapon Master (Hand Crossbow)", "Weapon Master (Heavy Crossbow)", "Weapon Master (Longbow)", "Weapon Master (Musket)", "Weapon Master (Pistol)"],
    "weapon master (club)": {
        name: "Weapon Master (Club)",
        description: "I gain access to the Club's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Club Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("club") !== -1;
        },
    },
    "weapon master (dagger)": {
        name: "Weapon Master (Dagger)",
        description: "I gain access to the Dagger's 'Nick' Mastery feature. Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
        prerequisite: "Dagger Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("dagger") !== -1;
        },
    },
    "weapon master (greatclub)": {
        name: "Weapon Master (Greatclub)",
        description: "I gain access to the Greatclub's 'Push' Mastery feature. Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
        prerequisite: "Greatclub Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("greatclub") !== -1;
        },
    },
    "weapon master (handaxe)": {
        name: "Weapon Master (Handaxe)",
        description: "I gain access to the Handaxe's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Handaxe Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("handaxe") !== -1;
        },
    },
    "weapon master (javelin)": {
        name: "Weapon Master (Javelin)",
        description: "I gain access to the Javelin's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Javelin Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("javelin") !== -1;
        },
    },
    "weapon master (light hammer)": {
        name: "Weapon Master (Light Hammer)",
        description: "I gain access to the Light Hammer's 'Nick' Mastery feature. Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
        prerequisite: "Light Hammer Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("light hammer") !== -1;
        },
    },
    "weapon master (mace)": {
        name: "Weapon Master (Mace)",
        description: "I gain access to the Mace's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
        prerequisite: "Mace Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("mace") !== -1;
        },
    },
    "weapon master (quarterstaff)": {
        name: "Weapon Master (Quarterstaff)",
        description: "I gain access to the Quarterstaff's 'Topple' Mastery feature. Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        prerequisite: "Quarterstaff Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("quarterstaff") !== -1;
        },
    },
    "weapon master (sickle)": {
        name: "Weapon Master (Sickle)",
        description: "I gain access to the Sickle's 'Nick' Mastery feature. Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
        prerequisite: "Sickle Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("sickle") !== -1;
        },
    },
    "weapon master (spear)": {
        name: "Weapon Master (Spear)",
        description: "I gain access to the Spear's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
        prerequisite: "Spear Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("spear") !== -1;
        },
    },
    "weapon master (dart)": {
        name: "Weapon Master (Dart)",
        description: "I gain access to the Dart's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Dart Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("dart") !== -1;
        },
    },
    "weapon master (light crossbow)": {
        name: "Weapon Master (Light Crossbow)",
        description: "I gain access to the Light Crossbow's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Light Crossbow Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("light crossbow") !== -1;
        },
    },
    "weapon master (shortbow)": {
        name: "Weapon Master (Shortbow)",
        description: "I gain access to the Shortbow's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Shortbow Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("shortbow") !== -1;
        },
    },
    "weapon master (sling)": {
        name: "Weapon Master (Sling)",
        description: "I gain access to the Sling's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Sling Proficiency",
        prereqeval: function(v) {
            return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("sling") !== -1;
        },
    },
    "weapon master (battleaxe)": {
        name: "Weapon Master (Battleaxe)",
        description: "I gain access to the Battleaxe's 'Topple' Mastery feature. Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        prerequisite: "Battleaxe Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("battleaxe") !== -1;
        },
    },
    "weapon master (flail)": {
        name: "Weapon Master (Flail)",
        description: "I gain access to the Flail's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
        prerequisite: "Flail Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("flail") !== -1;
        },
    },
    "weapon master (glaive)": {
        name: "Weapon Master (Glaive)",
        description: "I gain access to the Glaive's 'Graze' Mastery feature. Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        prerequisite: "Glaive Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("glaive") !== -1;
        },
    },
    "weapon master (greataxe)": {
        name: "Weapon Master (Greataxe)",
        description: "I gain access to the Greataxe's 'Cleave' Mastery feature. Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
        prerequisite: "Greataxe Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("greataxe") !== -1;
        },
    },
    "weapon master (greatsword)": {
        name: "Weapon Master (Greatsword)",
        description: "I gain access to the Greatsword's 'Graze' Mastery feature. Graze : If my attack roll with this weapon misses a creature, I can deal damage to that creature equal to the ability modifier I used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        prerequisite: "Greatsword Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("greatsword") !== -1;
        },
    },
    "weapon master (halberd)": {
        name: "Weapon Master (Halberd)",
        description: "I gain access to the Halberd's 'Cleave' Mastery feature. Cleave : If I hit a creature with a melee attack roll using this weapon, I can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within my reach. On a hit, the second creature takes the weapon's damage, but don't add my ability modifier to that damage unless the modifier is negative. I can make this extra attack only once per turn.",
        prerequisite: "Halberd Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("halberd") !== -1;
        },
    },
    "weapon master (lance)": {
        name: "Weapon Master (Lance)",
        description: "I gain access to the Lance's 'Topple' Mastery feature. Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        prerequisite: "Lance Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("lance") !== -1;
        },
    },
    "weapon master (longsword)": {
        name: "Weapon Master (Longsword)",
        description: "I gain access to the Longsword's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
        prerequisite: "Longsword Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("longsword") !== -1;
        },
    },
    "weapon master (maul)": {
        name: "Weapon Master (Maul)",
        description: "I gain access to the Maul's 'Topple' Mastery feature. Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        prerequisite: "Maul Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("maul") !== -1;
        },
    },
    "weapon master (morningstar)": {
        name: "Weapon Master (Morningstar)",
        description: "I gain access to the Morningstar's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",
        prerequisite: "Morningstar Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("morningstar") !== -1;
        },
    },
    "weapon master (pike)": {
        name: "Weapon Master (Pike)",
        description: "I gain access to the Pike's 'Push' Mastery feature. Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
        prerequisite: "Pike Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("pike") !== -1;
        },
    },
    "weapon master (rapier)": {
        name: "Weapon Master (Rapier)",
        description: "I gain access to the Rapier's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Rapier Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("rapier") !== -1;
        },
    },
    "weapon master (scimitar)": {
        name: "Weapon Master (Scimitar)",
        description: "I gain access to the Scimitar's 'Nick' Mastery feature. Nick : When I make the extra attack of the Light property, I can make it as part of the Attack action instead of as a Bonus Action. I can make this extra attack only once per turn.",
        prerequisite: "Scimitar Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("scimitar") !== -1;
        },
    },
    "weapon master (shortsword)": {
        name: "Weapon Master (Shortsword)",
        description: "I gain access to the Shortsword's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Shortsword Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("shortsword") !== -1;
        },
    },
    "weapon master (trident)": {
        name: "Weapon Master (Trident)",
        description: "I gain access to the Trident's 'Topple' Mastery feature. Topple : If I hit a creature with this weapon, I can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and my Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        prerequisite: "Trident Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("trident") !== -1;
        },
    },
    "weapon master (warhammer)": {
        name: "Weapon Master (Warhammer)",
        description: "I gain access to the Warhammer's 'Push' Mastery feature. Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
        prerequisite: "Warhammer Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("warhammer") !== -1;
        },
    },
    "weapon master (war pick)": {
        name: "Weapon Master (War Pick)",
        description: "I gain access to the War Pick's 'Sap' Mastery feature. Sap : If I hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of my next turn.",

        prerequisite: "War Pick Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("war pick") !== -1;
        },
    },
    "weapon master (whip)": {
        name: "Weapon Master (Whip)",
        description: "I gain access to the Whip's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",

        prerequisite: "Whip Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("whip") !== -1;
        },
    },
    "weapon master (blowgun)": {
        name: "Weapon Master (Blowgun)",
        description: "I gain access to the Blowgun's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Blowgun Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("blowgun") !== -1;
        },
    },
    "weapon master (hand crossbow)": {
        name: "Weapon Master (Hand Crossbow)",
        description: "I gain access to the Hand Crossbow's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Hand Crossbow Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("hand crossbow") !== -1;
        },
    },
    "weapon master (heavy crossbow)": {
        name: "Weapon Master (Heavy Crossbow)",
        description: "I gain access to the Heavy Crossbow's 'Push' Mastery feature. Push : If I hit a creature with this weapon, I can push the creature up to 10 feet straight away from me if it is Large or smaller.",
        prerequisite: "Heavy Crossbow Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("heavy crossbow") !== -1;
        },
    },
    "weapon master (longbow)": {
        name: "Weapon Master (Longbow)",
        description: "I gain access to the Longbow's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Longbow Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("longbow") !== -1;
        },
    },
    "weapon master (musket)": {
        name: "Weapon Master (Musket)",
        description: "I gain access to the Musket's 'Slow' Mastery feature. Slow : If I hit a creature with this weapon and deal damage to it, I can reduce its Speed by 10 feet until the start of my next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        prerequisite: "Musket Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("musket" || "firearms") !== -1;
        },
    },
    "weapon master (pistol)": {
        name: "Weapon Master (Pistol)",
        description: "I gain access to the Pistol's 'Vex' Mastery feature. Vex : If I hit a creature with this weapon and deal damage to the creature, I have Advantage on my next attack roll against the creature before the end of my next turn.",
        prerequisite: "Pistol Proficiency",
        prereqeval: function(v) {
            return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("pistol" || "firearms") !== -1;
        },
    },
    prerequisite: "Level 4",
    prereqeval: function(v) {
        return v.characterLevel >= 4;
    },
};
FeatsList["fighting style"] = {
    name: "Fighting Style",
    source: [
        ["P24", 209]
    ],
    regExpSearch: /^(?=.*fighting)(?=.*style).*$/i,
    descriptionFull: "Choose a Fighting Style.",
    description: "Choose a Fighting Style.",
    choices: ["Fighting Style [Archery]", "Fighting Style [Blind Fighting]", "Fighting Style [Defense]", "Fighting Style [Dueling]", "Fighting Style [Great Weapon Fighting]", "Fighting Style [Interception]", "Fighting Style [Protection]", "Fighting Style [Thrown Weapon Fighting]", "Fighting Style [Two-Weapon Fighting]", "Fighting Style [Unarmed Fighting]"],
    "fighting style [archery]": {
        name: "Fighting Style [Archery]",
        description: "I gain a +2 bonus to attack rolls I make with Ranged weapons.",
        calcChanges: {
            atkCalc: [
                function(fields, v, output) {
                    if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
                },
                "My ranged weapons get a +2 bonus on the To Hit."
            ]
        }
    },
    "fighting style [blind fighting]": {
        name: "Fighting Style [Blind Fighting]",
        description: "I have Blindsight with a range of 10 feet.",
        vision: [
            ["Blindsight", 10]
        ],
    },
    "fighting style [defense]": {
        name: "Fighting Style [Defense]",
        description: "While I'm wearing Light, Medium, or Heavy armor, I gain a +1 bonus to Armor Class.",
        extraAC: {
            name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
            mod: 1,
            text: "I gain a +1 bonus to AC while wearing armor.",
            stopeval: function(v) {
                return !v.wearingArmor;
            }
        },
    },
    "fighting style [dueling]": {
        name: "Fighting Style [Dueling]",
        description: "When I'm holding a Melee weapon in one hand and no other weapons, I gain a +2 bonus to damage rolls with that weapon.",
        calcChanges: {
            atkCalc: [
                function(fields, v, output) {
                    for (var i = 1; i <= FieldNumbers.actions; i++) {
                        if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
                    }
                    if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
                },
                "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
            ]
        }
    },
    "fighting style [great weapon fighting]": {
        name: "Fighting Style [Great Weapon Fighting]",
        description: "When I roll damage for an attack I make with a Melee weapon that I am holding with two hands, I can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
        calcChanges: {
            atkAdd: [
                function(fields, v) {
                    if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
                        fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
                    }
                },
                "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
            ]
        },
    },
    "fighting style [interception]": {
        name: "Fighting Style [Interception]",
        description: "When a creature I can see hits another creature within 5 feet of me with an attack roll, I can take a Reaction to reduce the damage dealt to the target by 1d10 plus my Proficiency Bonus. I must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
        action: "reaction",
    },
    "fighting style [protection]": {
        name: "Fighting Style [Protection]",
        description: "When a creature I can see attacks a target other than me that is within 5 feet of me, I can take a Reaction to interpose my Shield if I'm holding one. I impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of my next turn if I remain within 5 feet of the target.",
        action: "reaction",
    },
    "fighting style [thrown weapon fighting]": {
        name: "Fighting Style [Thrown Weapon Fighting]",
        description: "When I hit with a ranged attack roll using a weapon that has the Thrown property, I gain a +2 bonus to the damage roll.",
        calcChanges: {
            atkAdd: [
                function(fields, v) {
                    if (v.isThrownWeapon && v.isMeleeWeapon) {
                        fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
                    }
                },
                "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
            ],
            atkCalc: [
                function(fields, v, output) {
                    if (v.isThrownWeapon && !v.isMeleeWeapon) {
                        output.extraDmg += 2;
                    }
                },
                ""
            ],
        },
    },
    "fighting style [two-weapon fighting]": {
        name: "Fighting Style [Two-Weapon Fighting]",
        description: "When I make an extra attack as a result of using a weapon that has the Light property, I can add my ability modifier to the damage to that attack if I am not already adding it to the damage.",
        calcChanges: {
            atkCalc: [
                function(fields, v, output) {
                    if (v.isOffHand) output.modToDmg = true;
                },
                "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
            ]
        },
    },
    "fighting style [unarmed fighting]": {
        name: "Fighting Style [Unarmed Fighting]",
        description: "When I hit with my Unarmed Strike and deal damage, I can deal Bludgeoning damage equal to 1d6 plus my Strength modifier instead of the normal damage of an Unarmed Strike. If I am not holding any weapons or a Shield when I make the attack roll, the d6 becomes a d8.\n At the start of each of my turns, I can deal 1d4 Bludgeoning damage to one creature Grappled by me.",
        calcChanges: {
            atkAdd: [
                function(fields, v) {
                    if (v.baseWeaponName == "unarmed strike") {
                        if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
                        fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
                    }
                },
                "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
                1
            ]
        },
    },
    allowDuplicates: true,
};
//Epic Boon Feats
FeatsList["boon of combat prowess"] = {
    name: "Boon of Combat Prowess",
    source: [
        ["P24", 210]
    ],
    description: "+1 to Any, Once per turn, when I miss with an attack, I can instead hit.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Peerless Aim : When you miss with an attack roll, You can hit instead. Once you use this benefit, you can't use it again until the start of your next turn.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Combat Prowess - STR",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Combat Prowess - DEX",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Combat Prowess - CON",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Combat Prowess - INT",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Combat Prowess - WIS",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Combat Prowess - CHA",
        description: "Once per turn, when I miss with an attack, I can instead hit. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of dimensional travel"] = {
    name: "Boon of Dimensional Travel",
    source: [
        ["P24", 210]
    ],
    description: "+1 to Any, Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Blink Steps : Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Dimensional Travel - STR",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Dimensional Travel - DEX",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Dimensional Travel - CON",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Dimensional Travel - INT",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Dimensional Travel - WIS",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Dimensional Travel - CHA",
        description: "Immediately after I take the Attack action or the Magic action, I can teleport up to 30 feet to an unoccupied space I can see. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of energy resistance"] = {
    name: "Boon of Energy Resistance",
    source: [
        ["P24", 210]
    ],
    action: ["reaction", "Energy Redirection"],
    scorestxt: ["An ability score of my choice increases by 1, to a Maximum of 30"],
    description: "+1 to Any, +2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Energy Resistances : You gain Resistance to two of the following damage types of my choice: Acid, Cold, Fire, Lightning, Necrotic, Poison, Psychic, Radiant, or Thunder. Whenever you finish a Long Rest, you can change your choices.",
        "Energy Redirection : When you take damage of one of the types chosen for the Energy Resistances benefit, you can take a Reaction to direct damage of the same type toward another creature you can see within 60 feet of yourself that isn't behind Total Cover. If you do so, that creature must succeed on a Dexterity saving throw (DC 8 plus my Constitution modifier and Proficiency Bonus) or take damage equal to 2d12 plus your Constitution modifier.",
    ]),
    choices: ["Acid & Cold", "Acid & Fire", "Acid & Lightning", "Acid & Necrotic", "Acid & Poison", "Acid & Psychic", "Acid & Radiant", "Acid & Thunder", "Cold & Fire", "Cold & Lightning", "Cold & Necrotic", "Cold & Poison", "Cold & Psychic", "Cold & Radiant", "Cold & Thunder", "Fire & Lightning", "Fire & Necrotic", "Fire & Poison", "Fire & Psychic", "Fire & Radiant", "Fire & Thunder", "Lightning & Necrotic", "Lightning & Poison", "Lightning & Psychic", "Lightning & Radiant", "Lightning & Thunder", "Necrotic & Poison", "Necrotic & Psychic", "Necrotic & Radiant", "Necrotic & Thunder", "Poison & Psychic", "Poison & Radiant", "Poison & Thunder", "Psychic & Radiant", "Psychic & Thunder", "Radiant & Thunder"],
    "acid & cold": {
        name: "Boon of Energy Res - [Acid+Cold]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Cold"],
    },
    "acid & fire": {
        name: "Boon of Energy Res - [Acid+Fire]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Fire"],
    },
    "acid & lightning": {
        name: "Boon of Energy Res - [Acid+Lightning]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Lightning"],
    },
    "acid & necrotic": {
        name: "Boon of Energy Res - [Acid+Necrotic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Necrotic"],
    },
    "acid & poison": {
        name: "Boon of Energy Res - [Acid+Poison]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Poison"],
    },
    "acid & psychic": {
        name: "Boon of Energy Res - [Acid+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Psychic"],
    },
    "acid & radiant": {
        name: "Boon of Energy Res - [Acid+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Radiant"],
    },
    "acid & thunder": {
        name: "Boon of Energy Res - [Acid+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Acid", "Thunder"],
    },
    "cold & fire": {
        name: "Boon of Energy Res - [Cold+Fire]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Fire"],
    },
    "cold & lightning": {
        name: "Boon of Energy Res - [Cold+Lightning]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Lightning"],
    },
    "cold & necrotic": {
        name: "Boon of Energy Res - [Cold+Necrotic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Necrotic"],
    },
    "cold & poison": {
        name: "Boon of Energy Res - [Cold+Poison]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Poison"],
    },
    "cold & psychic": {
        name: "Boon of Energy Res - [Cold+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Psychic"],
    },
    "cold & radiant": {
        name: "Boon of Energy Res - [Cold+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Radiant"],
    },
    "cold & thunder": {
        name: "Boon of Energy Res - [Cold+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Cold", "Thunder"],
    },
    "fire & lightning": {
        name: "Boon of Energy Res - [Fire+Lightning]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Lightning"],
    },
    "fire & necrotic": {
        name: "Boon of Energy Res - [Fire+Necrotic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Necrotic"],
    },
    "fire & poison": {
        name: "Boon of Energy Res - [Fire+Poison]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Poison"],
    },
    "fire & psychic": {
        name: "Boon of Energy Res - [Fire+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Psychic"],
    },
    "fire & radiant": {
        name: "Boon of Energy Res - [Fire+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Radiant"],
    },
    "fire & thunder": {
        name: "Boon of Energy Res - [Fire+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Fire", "Thunder"],
    },
    "lightning & necrotic": {
        name: "Boon of Energy Res - [Lightning+Necrotic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Lightning", "Necrotic"],
    },
    "lightning & poison": {
        name: "Boon of Energy Res - [Lightning+Poison]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Lightning", "Poison"],
    },
    "lightning & psychic": {
        name: "Boon of Energy Res - [Lightning+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Lightning", "Psychic"],
    },
    "lightning & radiant": {
        name: "Boon of Energy Res - [Lightning+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Lightning", "Radiant"],
    },
    "lightning & thunder": {
        name: "Boon of Energy Res - [Lightning+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Lightning", "Thunder"],
    },
    "necrotic & poison": {
        name: "Boon of Energy Res - [Necrotic+Poison]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Necrotic", "Poison"],
    },
    "necrotic & psychic": {
        name: "Boon of Energy Res - [Necrotic+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Necrotic", "Psychic"],
    },
    "necrotic & radiant": {
        name: "Boon of Energy Res - [Necrotic+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Necrotic", "Radiant"],
    },
    "necrotic & thunder": {
        name: "Boon of Energy Res - [Necrotic+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Necrotic", "Thunder"],
    },
    "poison & psychic": {
        name: "Boon of Energy Res - [Poison+Psychic]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Poison", "Psychic"],
    },
    "poison & radiant": {
        name: "Boon of Energy Res - [Poison+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Poison", "Radiant"],
    },
    "poison & thunder": {
        name: "Boon of Energy Res - [Poison+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Poison", "Thunder"],
    },
    "psychic & radiant": {
        name: "Boon of Energy Res - [Psychic+Radiant]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Psychic", "Radiant"],
    },
    "psychic & thunder": {
        name: "Boon of Energy Res - [Psychic+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Psychic", "Thunder"],
    },
    "radiant & thunder": {
        name: "Boon of Energy Res - [Radiant+Thunder]",
        description: "+2 Energy Resistances which I can change after a Long Rest. When hit with a damage type I have resistance to, I can use a Reaction to redirect that energy to another creature in 60 ft of me. They take 2d12 + Con of that energy type as long as they aren't behind total cover. [+1 Any Ability Score, up to Max of 30]",
        dmgres: ["Radiant", "Thuder"],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of fate"] = {
    name: "Boon of Fate",
    source: [
        ["P24", 210]
    ],
    description: "+1 to Any, Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me.",
    descriptionFull: desc([
        "you gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Improved Fate : When you or another creature within 60 feet of you succeeds or fails a D20 Test you can roll 2d4 and apply the total rolled as a bonus or penalty to the d20 roll. Once you use this benefit, you can't use it again until you roll Initiative or finish a Short or Long Rest.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Fate - STR",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Fate - DEX",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Fate - CON",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Fate - INT",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Fate - WIS",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Fate - CHA",
        description: "Once per Initiative/Rest I can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by myself or another creature within 60 feet of me. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of fortitude"] = {
    name: "Boon of Fortitude",
    source: [
        ["P24", 210]
    ],
    description: "+1 to Any, +40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Fortified Health : Your Hit Point maximum increases by 40. In addition, whenever you regain Hit Points, you can regain additional Hit Points equal to your Constitution modifier. Once you've regained these additional Hit Points, you can't do so again until the start of my next turn.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Fortitude - STR",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Fortitude - DEX",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Fortitude - CON",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Fortitude - INT",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Fortitude - WIS",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Fortitude - CHA",
        description: "+40 to HP max; Once per turn when I regain HP I can add my Con mod to the HP regained. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    calcChanges: {
        hp: function(totalHD) {
            return [+40, '\n + ' + totalHD + ' + 40 from the Boon of Fortitude feat ', true];
        },
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of irresistible offense"] = {
    name: "Boon of Irresistible Offense",
    source: [
        ["P24", 211]
    ],
    description: "+1 to Any, Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to the ability score I increased by this feat.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Overcome Defenses : The Bludgeoning, Piercing, and Slashing damage you deal always ignores Resistance.",
        "Overwhelming Strike : When you roll a 20 on the d20 for an attack roll, you can deal extra damage to the target equal to the ability score increased by this feat.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Irresistible Offense - STR",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Strength. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Irresistible Offense - DEX",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Dexterity. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Irresistible Offense - CON",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Constitution. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Irresistible Offense - INT",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Intelligence. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Irresistible Offense - WIS",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Wisdom. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Irresistible Offense - CHA",
        description: "Blud/Pierc/Slash ignores resistance, I deal extra damage on a crit equal to my Charisma. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of recovery"] = {
    name: "Boon of Recovery",
    source: [
        ["P24", 211]
    ],
    action: ["bonus action", "Recovery"],
    extraLimitedFeatures: [{
        name: "Last Stand",
        usages: 1,
        recovery: "Long Rest",
    }, {
        name: "Recovery (d10)",
        usages: 10,
        recovery: "Long Rest",
    }],
    description: "+1 to Any, Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of you choice by 1, to a Maximum of 30.",
        "Last Stand : When you would be reduced to 0 Hit Points, you can drop to 1 Hit Point instead and regain a number of Hit Points equal to half you Hit Point maximum. Once you use this benefit, you can't use it again until you finish a Long Rest.",
        "Recover : You have a pool of ten d10s. As a Bonus Action, you can expend dice from the pool, roll those dice, and regain a number of Hit Points equal to the roll's total. You regain all the expended dice when you finish a Long Rest.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Recovery - STR",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 Strength]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Recovery - DEX",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 Dexterity]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Recovery - CON",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 constitution]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Recovery - INT",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 Intelligence]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Recovery - WIS",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 Wisdom]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Recovery - CHA",
        description: "Once per Long Rest when I would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 my max HP; I gain 10 d10s that I can roll as a bns. a. which recover over a Long Rest. [+1 Charisma]",
        limfeaname: "Recovery Dice",
        usages: 10,
        recovery: "long rest",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of skill"] = {
    name: "Boon of Skill",
    source: [
        ["P24", 211]
    ],
    skills: ["Athletics", "Acrobatics", "Sleight of Hand", "Stealth", "Arcana", "History", "Investigation", "Nature", "Religion", "Animal Handling", "Insight", "Medicine", "Perception", "Survival", "Deception", "Intimidation", "Performance", "Persuasion"],
    skillstxt: "I gain expertise in one skill of choice.",
    description: "+1 to Any, I gain Proficiency in all skills, and Expertise in one skill of choice.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "All-Around Adept : You gain proficiency in all skills.",
        "Expertise : Choose one skill in which you lack Expertise. You gain Expertise in that skill.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Skill - STR",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Skill - DEX",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Skill - CON",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Skill - INT",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Skill - WIS",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Skill - CHA",
        description: "I gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of speed"] = {
    name: "Boon of Speed",
    source: [
        ["P24", 211]
    ],
    description: "+1 to Any, Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Escape Artist : As a Bonus Action, you can take the Disengage action, which also ends the Grappled condition on you.",
        "Quickness : Your Speed increases by 30 feet.",
    ]),
    speed: {
        walk: "+30"
    },
    action: ["bonus action", "Disengage"],
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Speed - STR",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Speed - DEX",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Speed - CON",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Speed - INT",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Speed - WIS",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Speed - CHA",
        description: "Speed +30 ft, Bonus Action to Disengage, which also ends the Grappled condition. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of spell recall"] = {
    name: "Boon of Spell Recall",
    source: [
        ["P24", 211]
    ],
    description: "+1 Int/Wis/Cha, When I cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase your Intelligence, Wisdom, or Charisma score by 1, to a Maximum of 30.",
        "Free Casting : Whenever you cast a spell with a level 1-4 spell slot, roll 1d4. If the number you roll is the same as the slot's level, the slot isn't expended.",
    ]),
    choices: ["Intelligence", "Wisdom", "Charisma"],
    "intelligence": {
        name: "Boon of Spell Recall - INT",
        description: "When I cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Spell Recall - WIS",
        description: "When I cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Spell Recall - CHA",
        description: "When I cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19 && v.isSpellcaster;
    },
};
FeatsList["boon of the night spirit"] = {
    name: "Boon of the Night Spirit",
    source: [
        ["P24", 211]
    ],
    action: [
        ["bonus action", "Merge with Shadows"],
        ["reaction", "Merge with Shadows"]
    ],
    description: "+1 to Any, While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Merge with Shadows : While within Dim Light or Darkness, you can give yourself the Invisible condition as a Bonus Action, or a Reaction.",
        "Shadowy Form : While within Dim Light or Darkness, you have Resistance to all damage except Psychic and Radiant.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of the Night Spirit - STR",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of the Night Spirit - DEX",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of the Night Spirit - CON",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of the Night Spirit - INT",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of the Night Spirit - WIS",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of the Night Spirit - CHA",
        description: "While in Dim Light or Darkness, I have Resistance to all damage except Psychic or Radiant, and as a bns/rea I can turn invisible while in Dim Light or Darkness. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
FeatsList["boon of truesight"] = {
    name: "Boon of Truesight",
    source: [
        ["P24", 211]
    ],
    vision: [
        ["Truesight", 60]
    ],
    description: "+1 to Any, I have Truesight with a range of 60 feet.",
    descriptionFull: desc([
        "You gain the following benefits",
        "Ability Score Improvement : Increase one ability score of your choice by 1, to a Maximum of 30.",
        "Truesight : You have Truesight with a range of 60 feet.",
    ]),
    choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
    "strength": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 Strength]",
        scores: [1, 0, 0, 0, 0, 0],
        scoresMaximum: [30, 0, 0, 0, 0, 0],
    },
    "dexterity": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 Dexterity]",
        scores: [0, 1, 0, 0, 0, 0],
        scoresMaximum: [0, 30, 0, 0, 0, 0],
    },
    "constitution": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 constitution]",
        scores: [0, 0, 1, 0, 0, 0],
        scoresMaximum: [0, 0, 30, 0, 0, 0],
    },
    "intelligence": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 Intelligence]",
        scores: [0, 0, 0, 1, 0, 0],
        scoresMaximum: [0, 0, 0, 30, 0, 0],
    },
    "wisdom": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 Wisdom]",
        scores: [0, 0, 0, 0, 1, 0],
        scoresMaximum: [0, 0, 0, 0, 30, 0],
    },
    "charisma": {
        name: "Boon of Truesight",
        description: "I have Truesight with a range of 60 feet. [+1 Charisma]",
        scores: [0, 0, 0, 0, 0, 1],
        scoresMaximum: [0, 0, 0, 0, 0, 30],
    },
    prereqeval: function(v) {
        return v.characterLevel >= 19;
    },
};
//Weapons
//Simple Melee Weapons
WeaponsList["unarmed strike"] = {
    regExpSearch: /\b(fists?|arms?|legs?|foot|feet|claws?|talons?)\b|^(?=.*unarmed)(?=.*strike).*$|^(?=.*martial)(?=.*arts).*$|^(?=.*tavern)(?=.*brawler).*$/i,
    name: "Unarmed strike (Damage)",
    source: [
        ["SRD24", 190],
        ["P24", 377]
    ],
    list: "melee", // Hardcoded in dropdown
    ability: 1,
    type: "Natural",
    damage: [1, "", "bludgeoning"],
    range: "Melee",
    description: "Instead of damage, can Shove or Grapple (with DC)",
    monkweapon: true,
    abilitytodamage: true
};
WeaponsList["unarmed strike dc"] = {
    regExpSearch: /\b(fists?|arms?|legs?|foot|feet|claws?|talons?)\b|^(?=.*unarmed)(?=.*strike).*$|^(?=.*martial)(?=.*arts).*$|^(?=.*tavern)(?=.*brawler).*$/i,
    name: "Unarmed strike (DC)",
    list: "melee", // Hardcoded in dropdown
    source: [
        ["SRD24", 190],
        ["P24", 377]
    ],
    ability: 1,
    type: "Natural",
    damage: ["Str save", "", "Shove/Grapple"],
    range: "Melee",
    description: "Up to 1 size larger; Push 5 ft or prone or grappled condition; Can damage instead (with attack roll)",
    monkweapon: true,
    abilitytodamage: false,
    dc: true
};
WeaponsList["club"] = {
    name: "Club",
    infoname: "Club [1 sp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /club/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 4, "bludgeoning"],
    range: "Melee",
    description: "Light; Slow",
    list: "melee",
    weight: 2,
    monkweapon: true,
};
WeaponsList["dagger"] = {
    name: "Dagger",
    infoname: "Dagger [2 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /dagger/i,
    type: "Simple",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 4, "piercing"],
    range: "Melee, 20/60 ft",
    description: "Finesse, Light, Thrown; Nick",
    list: "melee",
    weight: 1,
    ammo: "dagger",
    monkweapon: true,
};
WeaponsList["greatclub"] = {
    name: "Greatclub",
    infoname: "Greatclub [2 sp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /greatclub/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "bludgeoning"],
    range: "Melee",
    description: "Two-Handed; Push",
    list: "melee",
    weight: 10,
    monkweapon: true,
};
WeaponsList["handaxe"] = {
    name: "Handaxe",
    infoname: "Handaxe [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /handaxe/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "slashing"],
    range: "Melee, 20/60 ft",
    description: "Light, Thrown; Vex",
    list: "melee",
    weight: 2,
    ammo: "handaxe",
    monkweapon: true,
};
WeaponsList["javelin"] = {
    name: "Javelin",
    infoname: "Javelin [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /javelin/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "piercing"],
    range: "Melee, 30/120 ft",
    description: "Thrown; Slow",
    list: "melee",
    weight: 2,
    ammo: "javelin",
    monkweapon: true,
};
WeaponsList["light hammer"] = {
    name: "Light Hammer",
    infoname: "Light Hammer [2 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /^(?=.*light)(?=.*hammer).*$/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 4, "bludgeoning"],
    range: "Melee, 20/60 ft",
    description: "Light, Thrown; Nick",
    list: "melee",
    weight: 2,
    ammo: "light hammer",
    monkweapon: true,
};
WeaponsList["mace"] = {
    name: "Mace",
    infoname: "Mace [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /mace/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "bludgeoning"],
    range: "Melee",
    description: "Sap",
    list: "melee",
    weight: 4,
    monkweapon: true,
};
WeaponsList["quarterstaff"] = {
    name: "Quarterstaff",
    nameAlt: ["Staff"],
    infoname: "Quarterstaff [2 sp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /quarterstaff|\bstaffs?\b|\bbos?\b|^gun(.?(\+|-)\d+)?$/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "bludgeoning"],
    range: "Melee",
    description: "Versatile (1d8); Topple",
    list: "melee",
    weight: 4,
    monkweapon: true,
};
WeaponsList["sickle"] = {
    name: "Sickle",
    infoname: "Sickle [1 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /sickle/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 4, "slashing"],
    range: "Melee",
    description: "Light; Nick",
    list: "melee",
    weight: 2,
    monkweapon: true,
};
WeaponsList["spear"] = {
    name: "Spear",
    infoname: "Spear [1 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /spear/i,
    type: "Simple",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "piercing"],
    range: "Melee, 20/60 ft",
    description: "Thrown, Versatile (1d8); Sap",
    list: "melee",
    weight: 3,
    ammo: "spear",
    monkweapon: true,
};
//Simple Ranged Weapons
WeaponsList["dart"] = {
    name: "Dart",
    infoname: "Dart [5 cp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /dart/i,
    type: "Simple",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 4, "piercing"],
    range: "20/60 ft",
    description: "Finesse, Thrown; Vex",
    list: "ranged",
    weight: 0.25,
    ammo: "dart",
    monkweapon: false,
};
WeaponsList["light crossbow"] = {
    name: "Light Crossbow",
    infoname: "Light Crossbow [25 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /^(?=.*light)(?=.*crossbow).*$/i,
    type: "Simple",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "80/320 ft",
    description: "Ammunition (Bolt), Loading, Two-Handed; Slow",
    list: "ranged",
    weight: 5,
    ammo: "bolts",
    monkweapon: false,
};
WeaponsList["shortbow"] = {
    name: "Shortbow",
    infoname: "Shortbow [25 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /shortbow/i,
    type: "Simple",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 6, "piercing"],
    range: "80/320 ft",
    description: "Ammunition (Arrow), Two-Handed; Vex",
    list: "ranged",
    weight: 2,
    ammo: "arrows",
    monkweapon: false,
};
WeaponsList["sling"] = {
    name: "Sling",
    infoname: "Sling [1 sp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /sling/i,
    type: "Simple",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 4, "bludgeoning"],
    range: "30/120 ft",
    description: "Ammunition (Bullet, Sling); Slow",
    list: "ranged",
    ammo: "bullets, sling",
    monkweapon: false,
};
//Martial Melee Weapons
WeaponsList["battleaxe"] = {
    name: "Battleaxe",
    infoname: "Battleaxe [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /battleaxe/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "slashing"],
    range: "Melee",
    description: "Versatile (1d10); Topple",
    list: "melee",
    weight: 4,
    monkweapon: false,
};
WeaponsList["flail"] = {
    name: "Flail",
    infoname: "Flail [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /flail/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "bludgeoning"],
    range: "Melee",
    description: "Sap",
    list: "melee",
    weight: 2,
    monkweapon: false,
};
WeaponsList["glaive"] = {
    name: "Glaive",
    infoname: "Glaive [20 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /glaive/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 10, "slashing"],
    range: "Melee",
    description: "Heavy, Reach, Two-Handed; Graze",
    list: "melee",
    weight: 6,
    monkweapon: false,
};
WeaponsList["greataxe"] = {
    name: "Greataxe",
    infoname: "Greataxe [30 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /greataxe/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 12, "slashing"],
    range: "Melee",
    description: "Heavy, Two-Handed; Cleave",
    list: "melee",
    weight: 7,
    monkweapon: false,
};
WeaponsList["greatsword"] = {
    name: "Greatsword",
    infoname: "Greatsword [50 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /greatsword/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [2, 6, "slashing"],
    range: "Melee",
    description: "Heavy, Two-Handed; Graze",
    list: "melee",
    weight: 6,
    monkweapon: false,
};
WeaponsList["halberd"] = {
    name: "Halberd",
    infoname: "Halberd [20 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /halberd/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 10, "slashing"],
    range: "Melee",
    description: "Heavy, Reach, Two-Handed; Cleave",
    list: "melee",
    weight: 6,
    monkweapon: false,
};
WeaponsList["lance"] = {
    name: "Lance",
    infoname: "Lance [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /lance/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 10, "piercing"],
    range: "Melee",
    description: "Heavy, Reach, Two-Handed (unless mounted); Topple",
    list: "melee",
    weight: 6,
    monkweapon: false,
};
WeaponsList["longsword"] = {
    name: "Longsword",
    infoname: "Longsword [15 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /longsword/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "slashing"],
    range: "Melee",
    description: "Versatile (1d10); Sap",
    list: "melee",
    weight: 3,
    monkweapon: false,
};
WeaponsList["maul"] = {
    name: "Maul",
    infoname: "Maul [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /maul/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [2, 6, "bludgeoning"],
    range: "Melee",
    description: "Heavy, Two-Handed; Topple",
    list: "melee",
    weight: 10,
    monkweapon: false,
};
WeaponsList["morningstar"] = {
    name: "Morningstar",
    infoname: "Morningstar [15 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /morningstar/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "Melee",
    description: "Sap",
    list: "melee",
    weight: 4,
    monkweapon: false,
};
WeaponsList["pike"] = {
    name: "Pike",
    infoname: "Pike [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /pike/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 10, "piercing"],
    range: "Melee",
    description: "Heavy, Reach, Two-Handed; Push",
    list: "melee",
    weight: 18,
    monkweapon: false,
};
WeaponsList["rapier"] = {
    name: "Rapier",
    infoname: "Rapier [25 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /rapier/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "Melee",
    description: "Finesse; Vex",
    list: "melee",
    weight: 2,
    monkweapon: false,
};
WeaponsList["scimitar"] = {
    name: "Scimitar",
    infoname: "Scimitar [25 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /scimitar/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 6, "slashing"],
    range: "Melee",
    description: "Finesse, Light; Nick",
    list: "melee",
    weight: 3,
    monkweapon: true,
};
WeaponsList["shortsword"] = {
    name: "Shortsword",
    infoname: "Shortsword [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /shortsword/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 6, "piercing"],
    range: "Melee",
    description: "Finesse, Light; Vex",
    list: "melee",
    weight: 2,
    monkweapon: true,
};
WeaponsList["trident"] = {
    name: "Trident",
    infoname: "Trident [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /trident/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "Melee, 20/60 ft",
    description: "Thrown, Versatile (1d10); Topple",
    list: "melee",
    weight: 4,
    ammo: "trident",
    monkweapon: false,
};
WeaponsList["warhammer"] = {
    name: "Warhammer",
    infoname: "Warhammer [15 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /warhammer/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "bludgeoning"],
    range: "Melee",
    description: "Versatile (1d10); Push",
    list: "melee",
    weight: 5,
    monkweapon: false,
};
WeaponsList["war pick"] = {
    name: "War Pick",
    infoname: "War Pick [5 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /^(?=.*war)(?=.*pick).*$/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "Melee",
    description: "Versatile (1d10); Sap",
    list: "melee",
    weight: 2,
    monkweapon: false,
};
WeaponsList["whip"] = {
    name: "Whip",
    infoname: "Whip [2 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /whip/i,
    type: "Martial",
    ability: 1,
    abilitytodamage: true,
    damage: [1, 4, "slashing"],
    range: "Melee",
    description: "Finesse, Reach; Slow",
    list: "melee",
    weight: 3,
    monkweapon: false,
};
//Martial Ranged Weapons
WeaponsList["blowgun"] = {
    name: "Blowgun",
    infoname: "Blowgun [10 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /blowgun/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, "", "piercing"],
    range: "25/100 ft",
    description: "Ammunition (Needle), Loading; Vex",
    list: "ranged",
    weight: 1,
    ammo: "needles",
    monkweapon: false,
};
WeaponsList["hand crossbow"] = {
    name: "Hand Crossbow",
    infoname: "Hand Crossbow [75 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /^(?=.*hand)(?=.*crossbow).*$/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 6, "piercing"],
    range: "30/120 ft",
    description: "Ammunition (Bolt), Light, Loading; Vex",
    list: "ranged",
    weight: 3,
    ammo: "bolts",
    monkweapon: false,
};
WeaponsList["heavy crossbow"] = {
    name: "Heavy Crossbow",
    infoname: "Heavy Crossbow [50 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /^(?=.*heavy)(?=.*crossbow).*$/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 10, "piercing"],
    range: "100/400 ft",
    description: "Ammunition (Bolt), Heavy, Loading, Two-Handed; Push",
    list: "ranged",
    weight: 18,
    ammo: "bolts",
    monkweapon: false,
};
WeaponsList["longbow"] = {
    name: "Longbow",
    infoname: "Longbow [50 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /longbow/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 8, "piercing"],
    range: "150/600 ft",
    description: "Ammunition (Arrow), Two-Handed, Heavy; Slow",
    list: "ranged",
    weight: 2,
    ammo: "arrows",
    monkweapon: false,
};
WeaponsList["musket"] = {
    name: "Musket",
    infoname: "Musket [500 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /musket/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 12, "piercing"],
    range: "40/120 ft",
    description: "Ammunition (Bullet, Firearm), Loading, Two-Handed; Slow",
    list: ["ranged", "firearm"],
    weight: 10,
    ammo: "renaissance bullet",
    monkweapon: false,
};
WeaponsList["pistol"] = {
    name: "Pistol",
    infoname: "Pistol [250 gp]",
    source: [
        ["P24", 215]
    ],
    regExpSearch: /pistol/i,
    type: "Martial",
    ability: 2,
    abilitytodamage: true,
    damage: [1, 10, "piercing"],
    range: "30/90 ft",
    description: "Ammunition (Bullet, Firearm), Loading; Vex",
    list: ["ranged", "firearm"],
    weight: 3,
    ammo: "renaissance bullet",
    monkweapon: false,
};
//Adventuring Gear That Functions as a Weapon
WeaponsList["improvised weapon"] = {
    regExpSearch: /improvised/i,
    name: "Improvised Weapon",
    source: [
        ["SRD24", 183],
        ["P24", 369]
    ],
    // list : "gear", // Hardcoded in dropdown
    ability: 1,
    type: "Improvised Weapons",
    damage: [1, 4, "bludgeoning"],
    range: "Melee, 20/60 ft",
    description: "Damage die, type, range, etc. are at the DM's discretion",
    abilitytodamage: true
};
WeaponsList["vials of acid"] = {
    name: "Vial of Acid",
    source: [
        ["P24", 222]
    ],
    regExpSearch: /^(?=.*vial)(?=.*acid).*$/i,
    list: "gear",
    ability: 2,
    type: "Adventuring Gear",
    dc: true,
    damage: [2, 6, "acid"],
    range: "20 ft",
    weight: 1,
    description: "",
    abilitytodamage: true,
    isAlwaysProf: true,
    ammo: "vials of acid",
    isNotWeapon: true,
};
WeaponsList["alchemist fire"] = {
    name: "Alchemist's Fire",
    source: [
        ["P24", 222]
    ],
    regExpSearch: /^(?=.*alchemist)(?=.*fire).*$/i,
    list: "gear",
    ability: 2,
    type: "Adventuring Gear",
    dc: true,
    damage: [1, 4, "fire"],
    range: "20 ft",
    weight: 1,
    description: "Target +1d4 at the start of each of its turns; Can end if target falls prone and uses their action to extinguish.",
    abilitytodamage: true,
    isAlwaysProf: true,
    ammo: "alchemist fire",
    isNotWeapon: true,
};
WeaponsList["holy water"] = {
    name: "Holy Water",
    source: [
        ["P24", 226]
    ],
    regExpSearch: /^(?=.*holy)(?=.*water).*$/i,
    list: "gear",
    ability: 2,
    type: "Adventuring Gear",
    dc: true,
    damage: [2, 6, "radiant"],
    range: "20 ft",
    weight: 1,
    description: "Only does damage against fiends and undead; Comes in flasks",
    abilitytodamage: true,
    ammo: "holy water",
    isNotWeapon: true
};
WeaponsList["net"] = {
    regExpSearch: /\bnet(ting)?s?\b/i,
    name: "Net",
    source: [
        ["P24", 227]
    ],
    list: "gear",
    ability: 2,
    type: "Adventuring Gear",
    damage: ["Dex save", "", "Restrained"],
    range: "15 ft",
    weight: 3,
    description: "Up to Large target; DC 10 Athletics to escape as an Action",
    tooltip: "When you take the Attack action, you can replace one of your attacks with throwing a Net. Target a creature you can see within 15 feet of yourself. The target must succeed on a Dexterity saving throw (DC 8 plus your Dexterity modifier and Proficiency Bonus) or have the Restrained condition until it escapes. The target succeeds automatically if it is Huge or larger." +
        "\nTo escape, the target or a creature within 5 feet of it must take an action to make a DC 10 Strength (Athletics) check, freeing the Restrained creature on a success. Destroying the Net (AC 10; 5 HP; Immunity to Bludgeoning, Poison, and Psychic damage) also frees the target, ending the effect.",
    abilitytodamage: false,
    dc: true,
    isAlwaysProf: true,
    isNotWeapon: true,
};
WeaponsList["oil"] = {
    regExpSearch: /oil/i,
    name: "Oil",
    source: [
        ["SRD24", 98],
        ["P24", 227]
    ],
    list: "gear",
    ability: 2,
    type: "Adventuring Gear",
    damage: ["Dex save", "", "Covered"],
    range: "20 ft",
    weight: 1,
    description: "If covered target takes fire damage in next minute, the oil burns for 5 fire damage",
    abilitytodamage: false,
    ammo: "oil",
    dc: true,
    isAlwaysProf: true,
    isNotWeapon: true
};
WeaponsList["burning torch"] = {
    regExpSearch: /^(?=.*torch)(?=.*burning).*$/i,
    name: "Torch, Burning",
    source: [
        ["SRD24", 100],
        ["P24", 229]
    ],
    list: "gear",
    ability: 1,
    type: "Simple", // PHB'24 changed
    damage: [1, "", "fire"],
    range: "Melee",
    weight: 1,
    description: "Only damages if burning",
    abilitytodamage: false
};
//Cantrips
WeaponsList["spell attack"] = {
    regExpSearch: /^(?=.*spell)(?=.*attack).*$/i,
    name: "Spell attack",
    source: [
        ["SRD24", 188],
        ["P24", 374]
    ],
    // list : "spell", // Hardcoded in dropdown
    ability: 0,
    type: "Spell",
    damage: ["", "", ""],
    range: "",
    description: "",
    abilitytodamage: false
};
WeaponsList["acid splash"] = {
    regExpSearch: /^(?=.*acid)(?=.*splash).*$/i,
    name: "Acid Splash",
    source: [
        ["P24", 239]
    ],
    list: "spell",
    ability: 4,
    type: "Cantrip",
    damage: ["C", 6, "acid"],
    range: "60 ft",
    description: "5ft rad. sphere Dex save, success - no damage;",
    abilitytodamage: false,
    dc: true
};
WeaponsList["chill touch"] = {
    regExpSearch: /^(?=.*chill)(?=.*touch).*$/i,
    name: "Chill Touch",
    source: [
        ["P24", 249]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 10, "necrotic"],
    range: "Touch",
    description: "Target can't regain HP; Undead dis. on attacks vs. me until my next turn",
    abilitytodamage: false
};
WeaponsList["eldritch blast"] = {
    regExpSearch: /(agonizing|eldritch|repelling).(spear|blast)/i,
    name: "Eldritch Blast",
    source: [
        ["P24", 267]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C\xD7" + 1, 10, "force"],
    range: "120 ft",
    description: "Each d10 is a separate beam requiring separate rolls",
    abilitytodamage: false
};
WeaponsList["fire bolt"] = {
    regExpSearch: /^(?=.*fire)(?=.*bolt).*$/i,
    name: "Fire Bolt",
    source: [
        ["P24", 274]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 10, "fire"],
    range: "120 ft",
    description: "Unattended flammable objects ignite",
    abilitytodamage: false
};
WeaponsList["mind sliver"] = {
    regExpSearch: /^(?=.*mind)(?=.*sliver).*$/i,
    name: "Mind Sliver",
    source: [
        ["P24", 298]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 6, "psychic"],
    range: "60 ft",
    description: "1 creature Int save, success - no damage, fail - also -1d4 on first save before my next turn ends",
    abilitytodamage: false,
    dc: true
};
WeaponsList["poison spray"] = {
    regExpSearch: /^(?=.*poison)(?=.*spray).*$/i,
    name: "Poison Spray",
    source: [
        ["P24", 306]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 12, "poison"],
    range: "30 ft",
    description: "Spell attack; 1 creature",
    abilitytodamage: false,
    dc: false,
};
WeaponsList["produce flame"] = {
    regExpSearch: /^(?=.*produce)(?=.*flame).*$/i,
    name: "Produce Flame",
    source: [
        ["P24", 308]
    ],
    list: "spell",
    ability: 5,
    type: "Cantrip",
    damage: ["C", 8, "fire"],
    range: "30 ft",
    description: "10-ft radius bright light and 10-ft radius dim light until thrown",
    abilitytodamage: false
};
WeaponsList["ray of frost"] = {
    regExpSearch: /^(?=.*ray)(?=.*frost).*$/i,
    name: "Ray of Frost",
    source: [
        ["P24", 311]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 8, "cold"],
    range: "60 ft",
    description: "Target -10 ft speed until start of my next turn",
    abilitytodamage: false
};
WeaponsList["sacred flame"] = {
    regExpSearch: /^(?=.*sacred)(?=.*flame).*$/i,
    name: "Sacred Flame",
    source: [
        ["P24", 313]
    ],
    list: "spell",
    ability: 5,
    type: "Cantrip",
    damage: ["C", 8, "radiant"],
    range: "60 ft",
    description: "Dex save, no bonus from cover, success - no damage; 1 creature",
    abilitytodamage: false,
    dc: true
};
WeaponsList["shillelagh-club"] = {
    baseWeapon: "club",
    regExpSearch: /^(?=.*shillelagh)(?=.*\b(club|bian|tonfa)s?\b).*$/i,
    name: "Shillelagh (club)",
    source: [
        ["SRD24", 162],
        ["P24", 316]
    ],
    list: "spell",
    ability: 5,
    damage: [1, 8, "force"],
    description: "Light; Imbued club or quarterstaff",
};
WeaponsList["shillelagh-quarterstaff"] = {
    baseWeapon: "quarterstaff",
    regExpSearch: /^(?=.*shillelagh)(?=.*(quarterstaff|\bstaffs?\b|\bbos?\b)).*$/i,
    name: "Shillelagh (staff)",
    source: [
        ["SRD24", 162],
        ["P24", 316]
    ],
    list: "spell",
    ability: 5,
    damage: [1, 8, "force"],
    description: "Imbued club or quarterstaff"
};
WeaponsList["shocking grasp"] = {
    regExpSearch: /^(?=.*shocking)(?=.*grasp).*$/i,
    name: "Shocking Grasp",
    source: [
        ["P24", 316]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 8, "lightning"],
    range: "Melee",
    description: "Target cannot make opportunity attacks until its next turn",
    abilitytodamage: false
};
WeaponsList["sorcerous burst"] = {
    regExpSearch: /^(?=.*sorcerous)(?=.*burst).*$/i,
    name: "Sorcerous Burst",
    source: [
        ["P24", 318]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 8, "acid"],
    range: "120 ft",
    description: "(Acid/Cold/Fire/Lightn/Pois/Psy/Thund) dmg; if I roll an 8 add 1d8 dmg(I can add a number of d8's equal to spell mod)",
    abilitytodamage: false
};
WeaponsList["starry wisp"] = {
    regExpSearch: /^(?=.*starry)(?=.*wisp).*$/i,
    name: "Starry Wisp",
    source: [
        ["P24", 320]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 8, "radiant"],
    range: "60 ft",
    description: "target emits dim light in a 10ft rad., can't benefit from Invis.",
    abilitytodamage: false
};
WeaponsList["toll the dead"] = {
    regExpSearch: /^(?=.*toll)(?=.*dead).*$/i,
    name: "Toll the Dead",
    source: [
        ["P24", 334]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 8, "necrotic"],
    range: "60 ft",
    description: "If target has less than full HP, Damage Die becomes d12.",
    abilitytodamage: false,
    dc: true
};
WeaponsList["thorn whip"] = {
    regExpSearch: /^(?=.*thorn)(?=.*whip).*$/i,
    name: "Thorn Whip",
    source: [
        ["P24", 333]
    ],
    list: "spell",
    ability: 5,
    type: "Cantrip",
    damage: ["C", 6, "piercing"],
    range: "Melee, 30 ft",
    description: "Melee spell attack, pull target up to 10 ft closer",
    abilitytodamage: false
};
WeaponsList["thunderclap"] = {
    regExpSearch: /thunderclap/i,
    name: "Thunderclap",
    source: [
        ["P24", 333]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 6, "thunder"],
    range: "5-ft radius",
    description: "Con save, success - no damage; all creatures in area; audible in 100 ft",
    abilitytodamage: false,
    dc: true
};
WeaponsList["true strike"] = {
    regExpSearch: /true strike/i,
    name: "True Strike",
    source: [
        ["P24", 333]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["1", 6, "radiant"],
    range: "Melee, 5 ft",
    description: "As Part of this Spell make one Weapon Atk using your Spell mod instead of Str/Dex, Dmg can become Radiant",
    abilitytodamage: false,
    dc: false
};
WeaponsList["vicious mockery"] = {
    regExpSearch: /^(?=.*vicious)(?=.*mockery).*$/i,
    name: "Vicious Mockery",
    source: [
        ["P24", 337]
    ],
    list: "spell",
    ability: 6,
    type: "Cantrip",
    damage: ["C", 6, "psychic"],
    range: "60 ft",
    description: "Wis save, success - no damage, fail - also disadv. on next attack roll in next turn; 1 creature",
    abilitytodamage: false,
    dc: true
};
WeaponsList["word of radiance"] = {
    regExpSearch: /^(?=.*word)(?=.*radiance).*$/i,
    name: "Word of Radiance",
    source: [
        ["P24", 343]
    ],
    list: "spell",
    ability: 5,
    type: "Cantrip",
    damage: ["C", 6, "radiant"],
    range: "5-ft radius",
    description: "Con save, success - no damage; Only chosen creatures I can see are affected",
    abilitytodamage: false,
    dc: true
};
// Add weapon die scaling for true strike
addEvals({
    atkAdd: [
        function(fields, v) {
            if (v.WeaponName === "true strike") {
                fields.Damage_Die = function(n) {
                    return n < 5 ? '' : n < 11 ? '1d6' : n < 17 ? '2d6' : '3d6'
                }(classes.totallevel);
            }
        },
        "", // no description means it doesn't appear in the attack line menu's pop-up dialog
        1
    ]
}, "True strike damage progression", true, "items");
CurrentUpdates.types = []; // don't trigger the changes dialog for this
// Add weapon die scaling for shillelagh
addEvals({
    atkAdd: [
        function(fields, v) {
            if (v.WeaponName === "shillelagh-club" || v.WeaponName === "shillelagh-quarterstaff") {
                fields.Damage_Die = function(n) {
                    return n < 5 ? '1d8' : n < 11 ? '1d10' : n < 17 ? '1d12' : '2d6'
                }(classes.totallevel);
            }
        },
        "", // no description means it doesn't appear in the attack line menu's pop-up dialog
        1
    ]
}, "Shillelagh damage progression", true, "items");
CurrentUpdates.types = []; // don't trigger the changes dialog for this

//Ammo
AmmoList["arrows"] = {
    name: "Arrows",
    infoname: "Arrows [1 gp]",
    source: [
        ["P24", 222]
    ],
    icon: "Arrows",
    amount: 20,
    weight: 0.05,
};
AmmoList["bolts"] = {
    name: "Bolts",
    infoname: "Bolts [1 gp]",
    source: [
        ["P24", 222]
    ],
    icon: "Arrows",
    invName: "Crossbow bolts",
    weight: 0.075,
};
AmmoList["renaissance bullet"] = {
    name: "Bullets, Renaissance",
    source: [
        ["P24", 222]
    ],
    weight: 0.1,
    icon: "Bullets",
    invName: "Bullets, renaissance",
    alternatives: [/^(?=.*bullet)(?=.*renaissance).*$/i],
};
AmmoList["bullets, sling"] = {
    name: "Bullets, Sling",
    infoname: "Bullets, Sling [4 cp]",
    source: [
        ["P24", 222]
    ],
    icon: "Arrows",
    invName: "Sling bullets",
    weight: 0.075,
};
AmmoList["needles"] = {
    name: "Needles",
    infoname: "Needles [1 gp]",
    source: [
        ["P24", 222]
    ],
    invName: "Blowgun needles",
    amount: 50,
    weight: 0.02,
};
AmmoList["dagger"] = {
    name: "Daggers",
    source: [
        ["P24", 215]
    ],
    weight: 1,
    icon: "Daggers"
};
AmmoList["dart"] = {
    name: "Darts",
    source: [
        ["P24", 215]
    ],
    weight: 0.25,
    icon: "Arrows"
};
AmmoList["flask"] = {
    name: "Flasks (1 pint)",
    source: [
        ["P24", 215]
    ],
    weight: 1,
    icon: "Flasks"
};
AmmoList["handaxe"] = {
    name: "Handaxes",
    source: [
        ["P24", 215]
    ],
    weight: 2,
    icon: "Axes",
    alternatives: ["Axe"]
};
AmmoList["javelin"] = {
    name: "Javelins",
    source: [
        ["P24", 215]
    ],
    weight: 2,
    icon: "Spears"
};
AmmoList["light hammer"] = {
    name: "Light Hammers",
    source: [
        ["P24", 215]
    ],
    weight: 2,
    icon: "Hammers",
    alternatives: ["Hammer"]
};
AmmoList["spear"] = {
    name: "Spears",
    source: [
        ["P24", 215]
    ],
    weight: 3,
    icon: "Spears"
};
AmmoList["trident"] = {
    name: "Tridents",
    source: [
        ["P24", 215]
    ],
    weight: 4,
    icon: "Spears"
};
AmmoList["vial"] = {
    name: "Vials (4 ounces)",
    source: [
        ["P24", 215]
    ],
    weight: 0.25,
    icon: "Vials"
};
AmmoList["alchemist fire"] = {
    name: "Alchemist's Fire, flasks",
    source: [
        ["P24", 215]
    ],
    weight: 1,
    icon: "Flasks",
    invName: "Alchemist's fire, flasks of",
    alternatives: [/^(?=.*alchemist)(?=.*fire).*$/i]
};
AmmoList["vials of acid"] = {
    name: "Vials of Acid",
    source: [
        ["P24", 215]
    ],
    weight: 1,
    icon: "Vials",
    invName: "Acid, vials of",
    alternatives: [/^(?=.*acid)(?=.*vial).*$/i]
};
AmmoList["holy water"] = {
    name: "Holy Water, flasks",
    source: [
        ["P24", 215]
    ],
    weight: 1,
    icon: "Flasks",
    invName: "Holy Water, flasks of",
    alternatives: [/^(?=.*holy)(?=.*water).*$/i]
};
AmmoList["oil"] = {
    name: "Oil, flasks",
    source: [
        ["SRD24", 98],
        ["P24", 227]
    ],
    weight: 1,
    icon: "Flasks",
    invName: "Oil, flasks of",
    alternatives: [/oil/i]
};
//Armour
ArmourList["unarmored"] = {
    regExpSearch: /(unarmou?red|naked|nothing|bare|no.?armou?r)/i,
    name: "Unarmored",
    source: [
        ["SRD24", 177],
        ["P24", 361]
    ],
    ac: 10,
    addMod: true,
    list: "firstlist",
};
ArmourList["mage armor"] = {
    regExpSearch: /^(?=.*(mage|magic))(?=.*armou?r).*$/i,
    name: "Mage armor",
    source: [
        ["SRD24", 145],
        ["P24", 293]
    ],
    ac: 13,
    list: "magic",
    affectsWildShape: true,
};
ArmourList["padded"] = {
    name: "Padded",
    invName: "Padded armor",
    infoname: "Padded Armor [5 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?!.*(plate|hide))(?=.*(padding|padded)).*$/i,
    ac: 11,
    type: "light",
    stealthdis: true,
    weight: 8,
};
ArmourList["leather"] = {
    name: "Leather",
    invName: "Leather armor",
    infoname: "Leather Armor [10 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?!.*(padding|padded|studded|studs))(?=.*leather).*$/i,
    ac: 11,
    type: "light",
    stealthdis: false,
    weight: 10,
};
ArmourList["studded leather"] = {
    name: "Studded leather",
    invName: "Studded leather armor",
    infoname: "Studded Leather Armor [45 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*(studded|studs))(?=.*leather).*$/i,
    ac: 12,
    type: "light",
    stealthdis: false,
    weight: 13,
};
ArmourList["hide"] = {
    name: "Hide",
    invName: "Hide armor",
    infoname: "Hide Armor [10 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?!.*(dragon|draconic|molten bronze))(?=.*(hide|skin)).*$/i,
    ac: 12,
    type: "medium",
    stealthdis: false,
    weight: 12,
};
ArmourList["chain shirt"] = {
    name: "Chain shirt",
    infoname: "Chain Shirt [50 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*chain)(?=.*shirt).*$/i,
    ac: 13,
    type: "medium",
    stealthdis: false,
    weight: 20,
};
ArmourList["scale mail"] = {
    name: "Scale mail",
    infoname: "Scale Mail [50 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*scale)(?=.*mail).*$/i,
    ac: 14,
    type: "medium",
    stealthdis: true,
    weight: 45,
};
ArmourList["breastplate"] = {
    name: "Breastplate",
    infoname: "Breastplate [400 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*breast)(?=.*plate).*$/i,
    ac: 14,
    type: "medium",
    stealthdis: false,
    weight: 20,
};
ArmourList["half plate"] = {
    name: "Half Plate",
    infoname: "Half Plate [750 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*half)(?=.*plate).*$/i,
    ac: 15,
    type: "medium",
    stealthdis: true,
    weight: 40,
};
ArmourList["ring mail"] = {
    name: "Ring Mail",
    infoname: "Ring Mail [30 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*ring)(?=.*mail).*$/i,
    ac: 14,
    type: "heavy",
    stealthdis: true,
    weight: 40,
};
ArmourList["chain mail"] = {
    name: "Chain Mail",
    infoname: "Chain Mail [75 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?!.*(scale|plate|ring|shirt))(?=.*chain)(?=.*mail).*$/i,
    ac: 16,
    type: "heavy",
    stealthdis: true,
    weight: 55,
    strReq: 13,
};
ArmourList["splint"] = {
    name: "Splint",
    invName: "Splint armor",
    infoname: "Splint Armor [200 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?=.*splint).*$/i,
    ac: 17,
    type: "heavy",
    stealthdis: true,
    weight: 60,
    strReq: 15,
};
ArmourList["plate"] = {
    name: "Plate",
    invName: "Plate armor",
    infoname: "Plate Armor [1500 gp]",
    source: [
        ["P24", 219]
    ],
    regExpSearch: /^(?!.*(half|breast))(?=.*plate).*$/i,
    ac: 18,
    type: "heavy",
    stealthdis: true,
    weight: 65,
    strReq: 15,
};
//Tools
ToolsList["alchemist's supplies"] = {
    infoname: "Alchemist's Supplies [50 gp]",
    name: "Alchemist's Supplies",
    amount: "",
    weight: 8,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["brewer's supplies"] = {
    infoname: "Brewer's Supplies [20 gp]",
    name: "Brewer's Supplies",
    amount: "",
    weight: 9,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["calligrapher's supplies"] = {
    infoname: "Calligrapher's Supplies [10 gp]",
    name: "Calligrapher's Supplies",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["carpenter's tools"] = {
    infoname: "Carpenter's Tools [8 gp]",
    name: "Carpenter's Tools",
    amount: "",
    weight: 6,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["cartographer's tools"] = {
    infoname: "Cartographer's Tools [15 gp]",
    name: "Cartographer's Tools",
    amount: "",
    weight: 6,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["cobbler's tools"] = {
    infoname: "Cobbler's tools [5 gp]",
    name: "Cobbler's Tools",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["cook's utensils"] = {
    infoname: "Cook's Utensils [1 gp]",
    name: "Cook's Utensils",
    amount: "",
    weight: 8,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["glassblower's tools"] = {
    infoname: "Glassblower's Tools [30 gp]",
    name: "Glassblower's Tools",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["jeweler's tools"] = {
    infoname: "Jeweler's Tools [20 gp]",
    name: "Jeweler's Tools",
    amount: "",
    weight: 2,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["leatherworker's tools"] = {
    infoname: "Leatherworker's Tools [5 gp]",
    name: "Leatherworker's tools",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 220]
    ],
};
ToolsList["mason's tools"] = {
    infoname: "Mason's Tools [10 gp]",
    name: "Mason's Tools",
    amount: "",
    weight: 8,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["painter's supplies"] = {
    infoname: "Painter's Supplies [10 gp]",
    name: "Painter's Supplies",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["potter's tools"] = {
    infoname: "Potter's Tools [10 gp]",
    name: "Potter's Tools",
    amount: "",
    weight: 3,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["smith's tools"] = {
    infoname: "Smith's Tools [20 gp]",
    name: "Smith's Tools",
    amount: "",
    weight: 8,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["tinker's tools"] = {
    infoname: "Tinker's Tools [50 gp]",
    name: "Tinker's Tools",
    amount: "",
    weight: 10,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["weaver's tools"] = {
    infoname: "Weaver's Tools [1 gp]",
    name: "Weaver's Tools",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["woodcarver's tools"] = {
    infoname: "Woodcarver's Tools [1 gp]",
    name: "Woodcarver's Tools",
    amount: "",
    weight: 5,
    type: "artisan's tools",
    source: [
        ["P24", 221]
    ],
};
ToolsList["disguise kit"] = {
    infoname: "Disguise Kit [25 gp]",
    name: "Disguise Kit",
    amount: "",
    weight: 3,
    source: [
        ["P24", 221]
    ],
};
ToolsList["forgery kit"] = {
    infoname: "Forgery Kit [15 gp]",
    name: "Forgery Kit",
    amount: "",
    weight: 5,
    source: [
        ["P24", 221]
    ],
};
ToolsList["dice"] = {
    infoname: "Dice [1 sp]",
    name: "Dice",
    amount: "",
    weight: "",
    type: "gaming set",
    source: [
        ["P24", 221]
    ],
};
ToolsList["dragonchess"] = {
    infoname: "Dragonchess [1 gp]",
    name: "Dragonchess",
    amount: "",
    weight: "",
    type: "gaming set",
    source: [
        ["P24", 221]
    ],
};
ToolsList["playing cards"] = {
    infoname: "Playing Cards [5 sp]",
    name: "Playing Cards",
    amount: "",
    weight: "",
    type: "gaming set",
    source: [
        ["P24", 221]
    ],
};
ToolsList["three-dragon ante"] = {
    infoname: "Three-Dragon Ante [1 gp]",
    name: "Three-Dragon Ante",
    amount: "",
    weight: "",
    type: "gaming set",
    source: [
        ["P24", 221]
    ],
};
ToolsList["herbalism kit"] = {
    infoname: "Herbalism Kit [5 gp]",
    name: "Herbalism Kit",
    amount: "",
    weight: 3,
    source: [
        ["P24", 221]
    ],
};
ToolsList["bagpipes"] = {
    infoname: "Bagpipes [30 gp]",
    name: "Bagpipes",
    amount: "",
    weight: 6,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["drum"] = {
    infoname: "Drum [6 gp]",
    name: "Drum",
    amount: "",
    weight: 3,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["dulcimer"] = {
    infoname: "Dulcimer [25 gp]",
    name: "Dulcimer",
    amount: "",
    weight: 10,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["flute"] = {
    infoname: "Flute [2 gp]",
    name: "Flute",
    amount: "",
    weight: 1,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["horn"] = {
    infoname: "Horn [3 gp]",
    name: "Horn",
    amount: "",
    weight: 2,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["lute"] = {
    infoname: "Lute [35 gp]",
    name: "Lute",
    amount: "",
    weight: 2,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["lyre"] = {
    infoname: "Lyre [30 gp]",
    name: "Lyre",
    amount: "",
    weight: 2,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["pan flute"] = {
    infoname: "Pan Flute [12 gp]",
    name: "Pan Flute",
    amount: "",
    weight: 2,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["shawm"] = {
    infoname: "Shawm [2 gp]",
    name: "Shawm",
    amount: "",
    weight: 1,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["viol"] = {
    infoname: "Viol [30 gp]",
    name: "Viol",
    amount: "",
    weight: 1,
    type: "musical instrument",
    source: [
        ["P24", 221]
    ],
};
ToolsList["navigator's tools"] = {
    infoname: "Navigator's Tools [25 gp]",
    name: "Navigator's Tools",
    amount: "",
    weight: 2,
    source: [
        ["P24", 221]
    ],
};
ToolsList["poisoner's kit"] = {
    infoname: "Poisoner's Kit [50 gp]",
    name: "Poisoner's Kit",
    amount: "",
    weight: 2,
    source: [
        ["P24", 221]
    ],
};
ToolsList["thieves' tools"] = {
    infoname: "Thieves' Tools [25 gp]",
    name: "Thieves' Tools",
    amount: "",
    weight: 1,
    source: [
        ["P24", 221]
    ],
};
//Gear
GearList["acid"] = {
    infoname: "Acid [25 gp]",
    name: "Acid",
    amount: "",
    weight: 1,
};
GearList["alchemist's fire"] = {
    infoname: "Alchemist's Fire [50 gp]",
    name: "Alchemist's Fire",
    amount: "",
    weight: 1,
};
GearList["animal feed (1 day)"] = {
    infoname: "Animal feed (1 day) [5 cp]",
    name: "Animal feed, days of",
    amount: 1,
    weight: 10
};
GearList["arrows (20)"] = {
    infoname: "Arrows (20) [1 gp]",
    name: "Arrows",
    amount: 20,
    weight: 0.05,
    type: "ammunition"
};
GearList["blowgun needles (50)"] = {
    infoname: "Blowgun needles (50) [1 gp]",
    name: "Blowgun needles",
    amount: 50,
    weight: 0.02,
    type: "ammunition"
};
GearList["crossbow bolts (20)"] = {
    infoname: "Crossbow bolts (20) [1 gp]",
    name: "Crossbow bolts",
    amount: 20,
    weight: 0.075,
    type: "ammunition"
};
GearList["firearm bullets (10)"] = {
    infoname: "Firearm bullets (10) [3 gp]",
    name: "Firearm Bullets",
    amount: 10,
    weight: 0.2,
    type: "ammunition",
};
GearList["sling bullets (20)"] = {
    infoname: "Sling bullets (20) [4 cp]",
    name: "Sling bullets",
    amount: 20,
    weight: 0.075,
    type: "ammunition"
};
GearList["antitoxin"] = {
    infoname: "Antitoxin [50 gp]",
    name: "Antitoxin",
    amount: "",
    weight: "",
};
GearList["crystal"] = {
    infoname: "Crystal [10 gp]",
    name: "Crystal arcane focus",
    amount: "",
    weight: 1,
    type: "arcane focus"
};
GearList["orb"] = {
    infoname: "Orb [20 gp]",
    name: "Orb arcane focus",
    amount: "",
    weight: 3,
    type: "arcane focus"
};
GearList["rod"] = {
    infoname: "Rod [10 gp]",
    name: "Rod arcane focus",
    amount: "",
    weight: 2,
    type: "arcane focus"
};
GearList["staff"] = {
    infoname: "Staff [5 gp]",
    name: "Staff arcane focus",
    amount: "",
    weight: 4,
    type: "arcane focus"
};
GearList["wand"] = {
    infoname: "Wand [10 gp]",
    name: "Wand arcane focus",
    amount: "",
    weight: 1,
    type: "arcane focus"
};
GearList["backpack"] = {
    infoname: "Backpack [2 gp]",
    name: "Backpack",
    amount: "",
    weight: 5
};
GearList["ball bearings"] = {
    infoname: "Ball bearings [1 gp]",
    name: "Bag of ball bearings",
    amount: "",
    weight: 2
};
GearList["barrel"] = {
    infoname: "Barrel [2 gp]",
    name: "Barrel",
    amount: "",
    weight: 70
};
GearList["basket"] = {
    infoname: "Basket [4 sp]",
    name: "Basket",
    amount: "",
    weight: 2
};
GearList["bedroll"] = {
    infoname: "Bedroll [1 gp]",
    name: "Bedroll",
    amount: "",
    weight: 7
};
GearList["bell"] = {
    infoname: "Bell [1 gp]",
    name: "Bell",
    amount: "",
    weight: ""
};
GearList["blanket"] = {
    infoname: "Blanket [5 sp]",
    name: "Blanket",
    amount: "",
    weight: 3
};
GearList["block and tackle"] = {
    infoname: "Block and tackle [1 gp]",
    name: "Block and tackle",
    amount: "",
    weight: 5
};
GearList["book"] = {
    infoname: "Book [25 gp]",
    name: "Book",
    amount: "",
    weight: 5
};
GearList["bottle, glass"] = {
    infoname: "Bottle, glass [2 gp]",
    name: "Glass bottle",
    amount: "",
    weight: 2
};
GearList["bucket"] = {
    infoname: "Bucket [5 sp]",
    name: "Bucket",
    amount: "",
    weight: 2
};
GearList["caltrops"] = {
    infoname: "Caltrops [1 gp]",
    name: "Caltrops",
    amount: "",
    weight: 2,
};
GearList["candle"] = {
    infoname: "Candle [1 cp]",
    name: "Candle",
    amount: "",
    weight: ""
};
GearList["case, crossbow bolt"] = {
    infoname: "Case, crossbow bolt [1 gp]",
    name: "Crossbow bolt case",
    amount: "",
    weight: 1
};
GearList["case, map or scroll"] = {
    infoname: "Case, map or scroll [1 gp]",
    name: "Map or scroll case",
    amount: "",
    weight: 1
};
GearList["chain"] = {
    infoname: "Chain [5 gp]",
    name: "Chain",
    amount: "",
    weight: 1
};
GearList["chest"] = {
    infoname: "Chest [5 gp]",
    name: "Chest",
    amount: "",
    weight: 25
};
GearList["climber's kit"] = {
    infoname: "Climber's kit [25 gp]",
    name: "Climber's kit",
    amount: "",
    weight: 12
};
GearList["costume"] = {
    infoname: "Costume [5 gp]",
    name: "Costume clothes",
    amount: "",
    weight: 4,
    type: "clothes"
};
GearList["fine"] = {
    infoname: "Fine [15 gp]",
    name: "Fine clothes",
    amount: "",
    weight: 6,
    type: "clothes"
};
GearList["traveler's"] = {
    infoname: "Traveler's [2 gp]",
    name: "Traveler's clothes",
    amount: "",
    weight: 4,
    type: "clothes"
};
GearList["component pouch"] = {
    infoname: "Component pouch [25 gp]",
    name: "Component pouch",
    amount: "",
    weight: 2
};
GearList["crowbar"] = {
    infoname: "Crowbar [2 gp]",
    name: "Crowbar",
    amount: "",
    weight: 5
};
GearList["sprig of mistletoe"] = {
    infoname: "Sprig of mistletoe [1 gp]",
    name: "Sprig of mistletoe druidic focus",
    amount: "",
    weight: "",
    type: "druidic focus"
};
GearList["wooden staff"] = {
    infoname: "Wooden staff [5 gp]",
    name: "Wooden staff druidic focus",
    amount: "",
    weight: 4,
    type: "druidic focus",
};
GearList["yew wand"] = {
    infoname: "Yew wand  [10 gp]",
    name: "Yew wand druidic focus",
    amount: "",
    weight: 1,
    type: "druidic focus"
};
GearList["flask"] = {
    infoname: "Flask [2 cp]",
    name: "Flask",
    amount: "",
    weight: 1
};
GearList["grappling hook"] = {
    infoname: "Grappling hook [2 gp]",
    name: "Grappling hook",
    amount: "",
    weight: 4
};
GearList["healer's kit"] = {
    infoname: "Healer's kit [5 gp]",
    name: "Healer's kit",
    amount: "",
    weight: 3,
};
GearList["amulet"] = {
    infoname: "Amulet [5 gp]",
    name: "Amulet holy symbol",
    amount: "",
    weight: 1,
    type: "holy symbol"
};
GearList["emblem"] = {
    infoname: "Emblem [5 gp]",
    name: "Emblem holy symbol",
    amount: "",
    weight: "",
    type: "holy symbol"
};
GearList["reliquary"] = {
    infoname: "Reliquary [5 gp]",
    name: "Reliquary holy symbol",
    amount: "",
    weight: 2,
    type: "holy symbol"
};
GearList["holy water (flask)"] = {
    infoname: "Holy water (flask) [25 gp]",
    name: "Holy water, flasks of",
    amount: "",
    weight: 1
};
GearList["hunting trap"] = {
    infoname: "Hunting trap [5 gp]",
    name: "Hunting trap",
    amount: "",
    weight: 25
};
GearList["ink (1 ounce bottle)"] = {
    infoname: "Ink (1 ounce bottle) [10 gp]",
    name: "Ink, 1 ounce bottle of",
    amount: "",
    weight: ""
};
GearList["ink pen"] = {
    infoname: "Ink pen [2 cp]",
    name: "Ink pen",
    amount: "",
    weight: ""
};
GearList["jug"] = {
    infoname: "Jug [2 cp]",
    name: "Jug",
    amount: "",
    weight: 4
};
GearList["ladder (10-foot)"] = {
    infoname: "Ladder (10-foot) [1 sp]",
    name: "10-foot ladder",
    amount: "",
    weight: 25
};
GearList["lamp"] = {
    infoname: "Lamp [5 sp]",
    name: "Lamp",
    amount: "",
    weight: 1
};
GearList["lantern, bullseye"] = {
    infoname: "Lantern, bullseye [10 gp]",
    name: "Bullseye lantern",
    amount: "",
    weight: 2
};
GearList["lantern, hooded"] = {
    infoname: "Lantern, hooded [5 gp]",
    name: "Hooded lantern",
    amount: "",
    weight: 2
};
GearList["lock"] = {
    infoname: "Lock [10 gp]",
    name: "Lock",
    amount: "",
    weight: 1
};
GearList["magnifying glass"] = {
    infoname: "Magnifying glass [100 gp]",
    name: "Magnifying glass",
    amount: "",
    weight: ""
};
GearList["manacles"] = {
    infoname: "Manacles [2 gp]",
    name: "Manacles",
    amount: "",
    weight: 6
};
GearList["mirror, steel"] = {
    infoname: "Mirror, steel [5 gp]",
    name: "Steel mirror",
    amount: "",
    weight: 0.5
};
GearList["net"] = {
    infoname: "Net [1 gp]",
    name: "Net",
    amount: "",
    weight: 3,
};
GearList["oil (flask)"] = {
    infoname: "Oil (flask) [1 sp]",
    name: "Oil, flasks of",
    amount: "",
    weight: 1,
};
GearList["paper (one sheet)"] = {
    infoname: "Paper (one sheet) [2 sp]",
    name: "Paper, sheets of",
    amount: "",
    weight: ""
};
GearList["parchment (one sheet)"] = {
    infoname: "Parchment (one sheet) [1 sp]",
    name: "Parchment, sheets of",
    amount: "",
    weight: ""
};
GearList["perfume (vial)"] = {
    infoname: "Perfume (vial) [5 gp]",
    name: "Perfume, vials of",
    amount: "",
    weight: ""
};
GearList["poison, basic (vial)"] = {
    infoname: "Poison, basic (vial) [100 gp]",
    name: "Basic poison, vials of",
    amount: "",
    weight: ""
};
GearList["pole (10-foot)"] = {
    infoname: "Pole (10-foot) [5 cp]",
    name: "10-foot pole",
    amount: "",
    weight: 7
};
GearList["pot, iron"] = {
    infoname: "Pot, iron [2 gp]",
    name: "Iron pot",
    amount: "",
    weight: 10
};
GearList["potion of healing"] = {
    infoname: "Potion of healing [50 gp]",
    name: "Potion of healing",
    amount: "",
    weight: 0.5
};
GearList["pouch"] = {
    infoname: "Pouch [5 sp]",
    name: "Pouch",
    amount: "",
    weight: 1
};
GearList["quiver"] = {
    infoname: "Quiver [1 gp]",
    name: "Quiver",
    amount: "",
    weight: 1
};
GearList["ram, portable"] = {
    infoname: "Ram, portable [4 gp]",
    name: "Portable ram",
    amount: "",
    weight: 35
};
GearList["rations (1 day)"] = {
    infoname: "Rations (1 day) [5 sp]",
    name: "Rations, days of",
    amount: 1,
    weight: 2
};
GearList["robes"] = {
    infoname: "Robes [1 gp]",
    name: "Robes",
    amount: "",
    weight: 4
};
GearList["rope"] = {
    infoname: "Rope [1 gp]",
    name: "Rope",
    amount: "",
    weight: 5
};
GearList["sack"] = {
    infoname: "Sack [1 cp]",
    name: "Sack",
    amount: "",
    weight: 0.5
};
GearList["exotic"] = {
    infoname: "Exotic [60 gp]",
    name: "Exotic saddle",
    amount: "",
    weight: 40,
    type: "saddle"
};
GearList["military"] = {
    infoname: "Military [20 gp]",
    name: "Military saddle",
    amount: "",
    weight: 30,
    type: "saddle"
};
GearList["riding"] = {
    infoname: "Riding [10 gp]",
    name: "Riding saddle",
    amount: "",
    weight: 25,
    type: "saddle"
};
GearList["shovel"] = {
    infoname: "Shovel [2 gp]",
    name: "Shovel",
    amount: "",
    weight: 5
};
GearList["signal whistle"] = {
    infoname: "Signal whistle [5 cp]",
    name: "Signal whistle",
    amount: "",
    weight: ""
};
GearList["spellbook"] = {
    infoname: "Spellbook [50 gp]",
    name: "Spellbook",
    amount: "",
    weight: 3
};
GearList["spell scroll (cantrip)"] = {
    infoname: "Spell Scroll (Cantrip) [30 gp]",
    name: "Spell Scroll (Cantrip)",
    amount: "",
    weight: "",
};
GearList["spell scroll (level 1)"] = {
    infoname: "Spell Scroll (Level 1) [50 gp]",
    name: "Spell Scroll (Level 1)",
    amount: "",
    weight: "",
};
GearList["spikes, iron (10)"] = {
    infoname: "Spikes, iron (10) [1 gp]",
    name: "Iron spike",
    amount: 10,
    weight: 0.5
};
GearList["spyglass"] = {
    infoname: "Spyglass [1000 gp]",
    name: "Spyglass",
    amount: "",
    weight: 1
};
GearList["string"] = {
    infoname: "String [1 sp]",
    name: "String",
    amount: 10,
    weight: "",
};
GearList["tent, two-person"] = {
    infoname: "Tent, two-person [2 gp]",
    name: "Two-person tent",
    amount: "",
    weight: 20
};
GearList["tinderbox"] = {
    infoname: "Tinderbox [5 sp]",
    name: "Tinderbox",
    amount: "",
    weight: 1
};
GearList["torch"] = {
    infoname: "Torch [1 cp]",
    name: "Torch",
    amount: "",
    weight: 1
};
GearList["vial"] = {
    infoname: "Vial [1 gp]",
    name: "Vial",
    amount: "",
    weight: ""
};
GearList["waterskin"] = {
    infoname: "Waterskin [2 sp]",
    name: "Waterskin",
    amount: "",
    weight: 5
};
//Packs
PacksList["burglar"] = {
    name: "Burglar's pack (16 gp)",
    source: [
        ["P24", 224]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Bag of ball bearings", "", 2],
        ["Bell", "", ""],
        ["Candles", 10, ""],
        ["Crowbar", "", 5],
        ["Hooded lantern", "", 2],
        ["Oil, flasks of", 7, 1],
        ["Rations, days of", 5, 2],
        ["Rope", "", 5],
        ["Tinderbox", "", 1],
        ["Waterskin", "", 5],
    ]
};
PacksList["diplomat"] = {
    name: "Diplomat's pack (39 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Chest, with:", "", 25],
        ["Fine clothes", "", 6],
        ["Ink", "", ""],
        ["Ink Pens", 5, ""],
        ["Lamp", "", 1],
        ["Cases, Map or Scroll", 2, 1],
        ["Oil, flasks of", 4, 1],
        ["Paper, sheets of", 5, ""],
        ["Parchment, sheets of", 5, ""],
        ["Perfume, vial of", "", ""],
        ["Tinderbox", "", 1],
    ]
};
PacksList["dungeoneer"] = {
    name: "Dungeoneer's pack (12 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Caltrops", 20, 0.1],
        ["Crowbar", "", 5],
        ["Oil, flasks of", 2, 1],
        ["Rations, days of", 10, 2],
        ["Rope", "", 5],
        ["Tinderbox", "", 1],
        ["Torches", 10, 1],
        ["Waterskin", "", 5],
    ]
};
PacksList["entertainer"] = {
    name: "Entertainer's pack (40 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Bedroll", "", 7],
        ["Bell", "", ""],
        ["Bullseye Lantern", "", 2],
        ["Costume clothes", 3, 4],
        ["Mirror, steel", "", 0.5],
        ["Oil, flasks of", 8, 1],
        ["Rations, days of", 9, 2],
        ["Tinderbox", "", 1],
        ["Waterskin", "", 5],
    ]
};
PacksList["explorer"] = {
    name: "Explorer's pack (10 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Bedroll", "", 7],
        ["Oil, flasks of", 2, 1],
        ["Rations, days of", 10, 2],
        ["Rope", "", 5],
        ["Torches", 10, 1],
        ["Tinderbox", "", 1],
        ["Waterskin", "", 5],
    ]
};
PacksList["priest"] = {
    name: "Priest's pack (33 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Blanket", "", 3],
        ["Holy Water, flask of", 1, 1],
        ["Lamp", "", 1],
        ["Rations, days of", 7, 2],
        ["Robe", "", 4],
        ["Tinderbox", "", 1],
    ]
};
PacksList["scholar"] = {
    name: "Scholar's pack (40 gp)",
    source: [
        ["P24", 225]
    ],
    items: [
        ["Backpack, with:", "", 5],
        ["Book", "", 5],
        ["Ink", "", ""],
        ["Ink Pen", "", ""],
        ["Lamp", "", 1],
        ["Oil, flasks of", 10, 1],
        ["Parchment, sheets of", 10, ""],
        ["Tinderbox", "", 1],
    ]
};
//Spells
legacySpellRefactor("acid splash", {
    name: "Acid Splash",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 239]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "Each creature in 5-ft radius sphere save or 1d6 Acid dmg; +1d6 at CL 5, 11, and 17",
    descriptionCantripDie: "Each creature in 5-ft radius sphere save or `CD`d6 Acid dmg",
    descriptionFull: "You create an acidic bubble at a point within range, where it explode in a 5-foot radius Sphere. Each creature in that Sphere must succeed on a Dexterity saving throw or take 1d6 Acid damage." + "\n   " + toUni("Cantrip Upgrade") + ". This spell's damage increases by 1d6 when you reach 5th Level (2d6), 11th level (3d6) and 17th level (4d6).",
});
legacySpellRefactor("aid", {
    name: "Aid",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 239]
    ],
    level: 2,
    school: "Abjur",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A strip of white cloth",
    duration: "8 h",
    description: "3 creatures gain 5 + 5/SL current HP and HP max for the duration",
    descriptionFull: "Choose up to three creatures within range. Each target's Hit Point maximum and Current Hit Points increase by 5 for the duration." + AtHigherLevels + "Each target's Hit Points increases by 5 for each spell slot level above 2."
});
legacySpellRefactor("alarm", {
    name: "Alarm",
    classes: ["artificer", "ranger", "wizard"],
    source: [
        ["P24", 239]
    ],
    ritual: true,
    level: 1,
    school: "Abjur",
    time: "1 min",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A bell and silver wire",
    duration: "8 h",
    description: "Door, window, or 20-ft cube area; audible (60 ft) or mental alarm (1 mile) if undesignated crea enters",
    descriptionFull: "You set an alarm against intrusion. Choose a door, a window, or an area within range that is no larger than a 20-foot Cube. Until the spell ends, an alarm alerts you whenever a creature touches or enters the warded area. When you cast the spell, you can designate creatures that won't set off the alarm. You also choose whether the alarm is audible or mental." + toUni("Audible Alarm") + ". The alarm produces the sound of a handbell for 10 seconds within 60 feet of the warded area." + toUni("Mental Alarm") + ". You are alerted by a mental ping if you are within 1 mile of the warded area. This ping awakens you if you're asleep."
});
legacySpellRefactor("alter self", {
    name: "Alter Self",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 239]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 1 h",
    description: "Alter appearance, gain natural wea (1d6, use spell ability), or water breathing \u0026 swim spd; a to switch",
    descriptionFull: "You alter your physical form. Choose one of the following options. Its effects last for the duration, during which you can take a Magic action to replace the option you chose with a different one." + "\n   " + toUni("Aquatic Adaptation") + ": You sprout gills and grow webs between your fingers. You can breathe underwater and gain a Swim Speed equal to your Speed." + "\n   " + toUni("Change Appearance") + ": You alter your appearance. You decide what you look like, including your height, weight, facial features, sound of your voice, hair length, coloration, and other distinguishing characteristics. You can make yourself appear as a member of another species, though none of your statistics change. You can't appear as a creature of a different size, and your basic shape stays the same; if you're bipedal, you can't use this spell to become quadrupedal, for instance. For the duration, you can take a Magic action to change your appearance in this way again." + "\n   " + toUni("Natural Weapons") + ": You grow claws (Slashing), fangs (Piercing), horns (Piercing), or hooves (Bludgeoning). When you use your Unarmed Strike to deal damage with that new growth, it deals 1d6 damage of the type in parenthesis instead of dealing the normal damage for your Unarmed Strike, and you use your spellcasting ability modifier for the attack and damage rolls rather than using Strength."
});
legacySpellRefactor("animal friendship", {
    name: "Animal Friendship",
    nameShort: "Animal Friendship*",
    classes: ["bard", "druid", "ranger"],
    source: [
        ["P24", 239]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A morsel of food",
    duration: "24 h",
    save: "Wis",
    description: "1+1/SL beasts save or Charmed. Ends if the beast is damaged by me or my allies.",
    descriptionFull: "Target a Beast that you can see within range. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. If you or one of your allies deals damage to the target, the spell ends." + AtHigherLevels + "You can target one additional Beast for each spell slot above 1."
});
legacySpellRefactor("animal messenger", {
    name: "Animal Messenger",
    nameShort: "Animal Messenger*",
    classes: ["bard", "druid", "ranger"],
    source: [
        ["P24", 240]
    ],
    ritual: true,
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A morsel of food",
    duration: "24 h",
    save: "Cha",
    description: "Tiny CR0 beast save or delivers 25 word message up to 25 miles (50 miles if flyer); +48h/SL duration",
    descriptionFull: "A Tiny Beast of your choice that you can see within range must succeed on a Charisma saving throw, or it attempts to deliver a message for you (if the target's Challenge Rating isn't 0, it automatically succeeds). You specify a location you have visited and a recipient who matches a general description such as 'a person dressed in the uniform of the town guard' or 'a red-haired dwarf wearing a pointed hat'. You also communicate a message of up to twenty-five words. The Beast travels for the duration toward the specified location, covering 25 miles per 24 hours or 50 miles if the Beast can fly." + "\n   " + "When the Beast arrives, it delivers your message to the creature that you described, mimicking your communication. If the Beast doesn't reach its destination before the spell ends, the message is lost, and the Beast returns to where you cast the spell." + AtHigherLevels + "The spell's duration increases by 48 hours for each spell slot level above 2."
});
legacySpellRefactor("animal shapes", {
    name: "Animal Shapes",
    nameShort: "Animal Shapes*",
    classes: ["druid"],
    source: [
        ["P24", 240]
    ],
    level: 8,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "24 h",
    description: "Any willing crea into \u2264CR4 beast (\u2264Lg); a to change again; beast HP as THP; ends 0 THP or bns; see B",
    descriptionFull: "Choose any number of willing creatures that you can see within range. Each target shape-shifts into a Large or smaller Beast of your choice that has a Challenge Rating of 4 or lower. You can choose a different form for each target. On later turns, you can take a Magic action to transform the targets again." + "\n   " + "A target's game statistics are replaced by the chosen Beast's statistics, but the target retains its creature type; Hit Points; Hit Point Dice; alignment; ability to communicate and Intelligence, Wisdom, and Charisma scores. The target's actions are limited by the Beast form's anatomy, and it can't cast spells, the target's equipment melds into the new form, and the target can't use any of that equipment while in that form." + "\n   " + "The target gains a number of Temporary Hit Points equal to the Hit Points of the first form into which it shape-shifts. These Temporary Hit Points vanish if any remain when the spell ends. The transformation lasts for the duration or until the target ends it as a Bonus Action."
});
legacySpellRefactor("animate dead", {
    name: "Animate Dead",
    classes: ["cleric", "wizard"],
    source: [
        ["P24", 240]
    ],
    level: 3,
    school: "Necro",
    time: "1 min",
    range: "10 ft",
    components: "V,S,M",
    compMaterial: "A drop of blood, a piece of flesh, and a pinch of bone dust",
    duration: "Instantaneous",
    description: "Turn corpses into 1+2/SL Skeletons or Zombies; control for 24h; bns command within 60 ft",
    descriptionFull: "Choose a pile of bones or a corpse of a Medium or Small Humanoid within range. The target becomes an Undead creature: a Skeleton if you chose bones or a Zombie if you chose a corpse (see appendix B for the stat blocks)." + "\n   " + "On each of your turns, you can take a Bonus Action to mentally command any creature you made with this spell if the creature is within 60 feet of you (if you control multiple creatures, you can command all of them at the same time, issuing the same command to each one). You decide what action the creature will take and where it will move on its next turn, or you can issue a general command, such as to guard a chamber or corridor. If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. Once given an order, the creature continues to follow it until its task is complete." + "\n   " + "The creature is under your control for 24 hours, after which it stops obeying any command you've given it. To maintain control of the creature for another 24 hours, you must cast this spell on the creature again before the current 24-hour period ends. This use of the spell reasserts your control over up to four creatures you have animated with this spell rather than animating a new creature." + AtHigherLevels + "You animate or reassert control over two additional Undead creatures for each spell slot level above 3.Each of the creatures must come from a different corpse or pile of bones."
});
legacySpellRefactor("animate objects", {
    name: "Animate Objects",
    classes: ["artificer", "bard", "sorcerer", "wizard"],
    source: [
        ["P24", 240]
    ],
    level: 5,
    school: "Trans",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Spell modifier nonmagical unattended loose objects (M=1/L=2/H=3); bns command in 500 ft; see B",
    descriptionFull: "Objects animate at your command. Choose a number of nonmagical objects within range that aren't being worn or carried, aren't fixed to a surface, and aren't Gargantuan. The maximum number of objects is equal to your spellcasting ability modifier, for this number, a Medium or smaller target counts as one object, a Large target counts as two, and a Huge target counts as three." + "\n   " + "Each target animates, sprouts legs, and becomes a Construct that uses the Animated Object stat block; this creature is under your control until the spell ends or until it is reduced to 0 Hit Points. Each creature you make with this spell is an ally to you and your allies. In combat, it shares your Initiative count and takes its turn immediately after yours." + "\n   " + "Until the spell ends you can take a Bonus Action you can mentally command any creatures you made with this spell if the creature is within 500 feet of you (if you control multiple creatures, you can command any of them at the same time, issuing the same command to each one). If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. When the creature drops to 0 Hit Points it reverts to its object form, and any remaining damage carries over to that form." + AtHigherLevels + "The creature's Slam damage increases by 1d4 (Medium or smaller), 1d6 (Large), or 1d12 (Huge) for each spell slot level above 5."
});
legacySpellRefactor("antilife shell", {
    name: "Antilife Shell",
    classes: ["druid"],
    source: [
        ["P24", 241]
    ],
    level: 5,
    school: "Abjur",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S",
    duration: "Conc, 1 h",
    description: "Only undead and constructs can enter area; spell ends if I move within 10ft of living creature",
    descriptionFull: "An aura extends from you in a 10-foot Emanation for the duration. The aura prevents creatures other than Constructs and Undead from passing or reaching through it. An affected creature can cast spells or making attacks with Ranged or Reach weapons through the barrier." + "\n   " + "If you move so that an affected creature is forced to pass through the barrier, the spell ends.",
});
legacySpellRefactor("antimagic field", {
    name: "Antimagic Field",
    classes: ["cleric", "wizard"],
    source: [
        ["P24", 241]
    ],
    level: 8,
    school: "Abjur",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S,M",
    compMaterial: "iron filings",
    duration: "Conc, 1 h",
    description: "Nothing magical functions in area except spells cast by an artifact or a deity; can't teleport or Dispel",
    descriptionFull: "An aura of antimagic surrounds you in a 10-foot Emanation. No one can cast spells, take Magic actions, or create other magical effects inside the aura, and those things can't target or otherwise affect anything inside it. Magical properties of magic items don't work inside the aura or on anything inside it." + "\n   " + "Areas of effect created by spells or other magic can't extend into the aura, and no one can teleport into or out of it, or use planar travel there. Portals close temporarily while in the aura." + "\n   " + "Ongoing spells, except those cast by an Artifact or a deity, are suppressed in the are. While an effect is suppressed, it doesn't function, but the time it spends suppressed counts against its duration." + "\n   " + "Dispel Magic has no effect on the aura, and the auras created by different Antimagic Field spells don't nullify each other."
});
legacySpellRefactor("antipathy/sympathy", {
    name: "Antipathy/Sympathy",
    classes: ["bard", "druid", "wizard"],
    source: [
        ["P24", 242]
    ],
    level: 8,
    school: "Ench",
    time: "1 h",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "a mix of vinegar and honey",
    duration: "10 days",
    save: "Wis",
    description: "1 creature or object (\u2264Huge) attracts (save vs Charm) or repels (save vs Fear) chosen crea type; see B",
    descriptionFull: "As you cast the spell, choose whether it creates antipathy or sympathy, and target one creature or object that is Huge or smaller. Then specify a kind of creature, such as red dragons, goblins, or vampires. A creature of the chosen kind makes a Wisdom saving throw when it comes within 120 feet of the target. You choice of antipathy or sympathy determines what happens to a creature when it fails the save:" + "\n   " + toUni("Antipathy") + ": The creature has the Frightened condition. The Frightened creature must use its movement on its turn to get as far away as possible from the target, moving by the safest route." + "\n   " + toUni("Sympathy") + ": The creature has the Charmed condition. The Charmed creature must use its movement on its turns to get as close as possible to the target, moving by the safest route. If the creature is within 5 feet of the target, the creature can't willingly move away. IF the target damages the Charmed creature, that creature can make a Wisdom saving throw to end the effect, as described below." + "\n   " + toUni("Ending the Effect") + ": If the Frightened or Charmed creature ends its turn more than 120 feet away from the target, the creature makes a Wisdom saving throw. On a Successful save, the creature is no longer affected by the target. A creature that successfully saves against this effect is immune to it for 1 minute, after which it can be affected again.",
});
legacySpellRefactor("arcane eye", {
    name: "Arcane Eye",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 242]
    ],
    level: 4,
    school: "Div",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A bit of bat fur",
    duration: "Conc, 1 h",
    description: "Create Invisible 1\" magic eye I see through; 30ft Darkvision; bns to move (unlimited range, 30 ft/rnd)",
    descriptionFull: "You create an Invisible, invulnerable eye within range that hovers for the duration. You mentally receive visual information from the eye, which can see in every direction. It also has Darkvision with a range of 30 feet." + "\n   " + "As a Bonus Action, you can move the eye up to 30 feet in any direction. A solid barrier blocks the eye's movement, but the eye can pass through an opening as small as 1 inch in diameter."
});
legacySpellRefactor("arcane gate", {
    name: "Arcane Gate",
    nameShort: "Arcane Gate*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 242]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "500 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Two portals up to 500 ft apart filled with opaque mist; teleport any between; bns change orientation",
    descriptionFull: "You create linked teleportation portals. Choose two Large, unoccupied spaces on the ground that you can see, one space within range and the other one within 10 feet of you. A circular portal opens in each of those spaces and remains for the duration." + "\n   " + "The portals are two-dimensional glowing rings filled with mist that blocks sight. They hover inches from the ground and are perpendicular to it." + "\n   " + "A portal is open on only one side (you choose which). Anything entering the open side of a portal exits from the open side on the other portal as if they two were adjacent to each other. As a Bonus Action, you can change the facing of the open sides."
});
legacySpellRefactor("arcane lock", {
    name: "Arcane Lock",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 242]
    ],
    level: 2,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Gold dust worth 25+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "Entryway/lid locked; only password, designated creature or magic opens (25gp cons.)",
    descriptionFull: "You touch a closed door, window, gate, container, or hatch and magically lock it for the duration. This lock can't be unlocked by any nonmagical means. You and any creatures you designate when you cast the spell can open and close the object despite the lock. You can also set a password that, when spoken within 5 feet of the object, unlocks it for 1 minute."
});
legacySpellRefactor("arcane vigor", {
    name: "Arcane Vigor",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 242]
    ],
    level: 2,
    school: "Abjur",
    time: "1 bns",
    range: "Self",
    components: "V,S",
    duration: "Instantaneous",
    description: "Roll 1-2+1/SL unused hit dice and regain roll + spellcasting mod HP. Hit dice then expended.",
    descriptionFull: "You tap into your life force to heal yourself. Roll one or two of your unexpended Hit Point Dice, and regain a number of Hit Point's equal to the rolls total plus your spellcasting ability modifier. Those dice are expended." + AtHigherLevels + "The number of unexpended Hit Dice you can roll increases by one for each spell slot level above 2.",
});
legacySpellRefactor("armor of agathys", {
    name: "Armor of Agathys",
    classes: ["warlock"],
    source: [
        ["P24", 243]
    ],
    level: 1,
    school: "Abjur",
    time: "1 bns",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A shard of blue glass",
    duration: "1 h",
    description: "5+5/SL temp HP; while I have any temp HP any crea that hits me with melee atk takes 5+5/SL Cold",
    descriptionFull: "Protective magical frost surrounds you. You gain 5 Temporary Hit Points. If a creature hits you with a melee attack roll before the spell ends, the creature takes 5 Cold damage. The spell ends early if you have no Temporary Hit Points." + AtHigherLevels + "The Temporary Hit Points and the Cold damage both increase by 5 for each spell slot above 1."
});
legacySpellRefactor("arms of hadar", {
    name: "Arms of Hadar",
    classes: ["warlock"],
    source: [
        ["P24", 243]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S",
    duration: "Instantaneous",
    save: "Str",
    description: "2d6+1d6/SL Necrotic dmg; save halves; on failed save no reactions until next turn",
    descriptionFull: "Invoking Hadar, you cause tendrils to erupt from yourself. Each creature in a 10-foot Emanation originating from you makes a Strength saving throw. On a failed save, a target takes 2d6 necrotic damage and can't take Reactions until the start of its next turn. On a successful save, a target takes half as much damage only." + AtHigherLevels + "The damage increases by 1d6 for each spell slot levels above 1."
});
legacySpellRefactor("astral projection", {
    name: "Astral Projection",
    classes: ["cleric", "warlock", "wizard"],
    source: [
        ["P24", 243]
    ],
    level: 9,
    school: "Necro",
    time: "1 h (D)",
    range: "10 ft",
    components: "V,S,M\u2020",
    compMaterial: "For each of the spell's targets, one jacinth worth 1,000+ gp and one silver bar worth 100+ gp, all of which the spell consumes",
    duration: "Till dispelled",
    description: "Me + 8 willing crea projected to Astral Plane with identical stats; see book (per crea 1100gp cons.)",
    descriptionFull: "You and up to eight willing creatures within range project your astral bodies into the Astral Plane (the spell ends instantly if you are already on that plane). Each target's body is left behind in a state of suspended animation; it has the Unconscious condition, doesn't need food or air, and doesn't age." + "\n   " + "A target's astral form resembles its body in almost every way, replicating its game statistics and possessions. The principal difference is the addition of a silvery cord that trails from between the shoulder blades of the astral form. The cord fades from view after 1 foot. If the cord is cut‚Äîwhich happens only when an effect states that it does so‚Äîthe target's body and astral form both die." + "\n   " + "A target's astral form can travel through the Astral Plane. The moment an astral form leaves that plane, the target's body and possessions travel along the silver cord, causing the target to re-enter its body on the new plane." + "\n   " + "Any damage or other effects that apply to an astral form have no effect on the target's body and vice versa. If a target's body or astral form drops to 0 Hit Points, the spell ends for that target. The spell ends for all the targets if you take a Magic action to dismiss it." + "\n   " + "When the spell ends for a target who isn't dead, the target reappears in a body and exits the state of suspended animation."
});
legacySpellRefactor("augury", {
    name: "Augury",
    classes: ["cleric", "druid", "wizard"],
    source: [
        ["P24", 244]
    ],
    ritual: true,
    level: 2,
    school: "Div",
    time: "1 min",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "Specially marked sticks, bones, cards, or other divinatory tokens worth 25+ gp",
    duration: "Instantaneous",
    description: "Omen about specific course of action I plan to take in next 30 min: weal/woe/both/neither (25gp)",
    descriptionFull: "You receive an omen from an otherworldly entity about the result of a course of action that you plan to take within the next 30 minutes. The DM chooses the omen from the Omens table." + "\n " + "\u2022 Weal, for good results" + "\n " + "\u2022 Woe, for bad results" + "\n " + "\u2022 Weal and woe, for both good and bad results" + "\n " + "\u2022 Indifference, for results that aren't especially good or bad" + "\n\n" + "The spell doesn't account for circumstances, such as other spells, that might change the results." + "\n   " + "If you cast the spell more than once before finishing a Long Rest, there is a cumulative 25 percent chance for each casting after the first that you get no answer."
});
legacySpellRefactor("aura of life", {
    name: "Aura of Life",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 244]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Conc, 10 min",
    description: "Me + allies in area resist Necrotic dmg \u0026 no max HP reduction; at turn start, 0 HP ally heal 1 HP",
    descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Resistance to Necrotic damage, and your Hit Point maximums can't be reduced. If an ally with 0 Hit Points starts its turn in the aura, that ally regains 1 Hit Point."
});
legacySpellRefactor("aura of purity", {
    name: "Aura of Purity",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 244]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Conc, 10 min",
    description: "Me + allies in area resist Poison, adv. on saves vs. Blind/Charm/Deaf/Frightened/Paralyze/Poison/Stun",
    descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Resistance to Poison damage and Advantage on saving throws to avoid or end effects that include the Blinded, Charmed, Deafened, Frightened, Paralyzed, Poisoned, or Stunned condition."
});
legacySpellRefactor("aura of vitality", {
    name: "Aura of Vitality",
    classes: ["cleric", "druid", "paladin"],
    source: [
        ["P24", 244]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Conc, 1 min",
    description: "On cast and at the start of each of my turns, I can heal 2d6 HP to 1 creature in range",
    descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. When you create the aura and at the start of each of your turns while it persists, you can restore 2d6 Hit Points to one creature in it."
});
legacySpellRefactor("awaken", {
    name: "Awaken",
    classes: ["bard", "druid"],
    source: [
        ["P24", 244]
    ],
    level: 5,
    school: "Trans",
    time: "8 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "An agate worth 1,000+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Give beast or plant speech, Int 10 and ability to move. Charmed for 30 days; see book (1000gp cons.)",
    descriptionFull: "You spend the casting time tracing magical pathways within a precious gemstone, and then touch the target. The target must be either a Beast or Plant creature with an Intelligence of 3 or less or a natural plant that isn't a creature. The target gains an Intelligence of 10 and the ability to speak one language you know. If the target is a natural plant, it becomes a Plant creature and gains the ability to move its limbs, roots, vines, creepers, and so forth, and it gains senses similar to a human's. The DM chooses statistics appropriate for the awakened Plant, such as the statistics for the Awakened Shrub or Awakened Tree in the Monster Manual." + "\n   " + "The awakened target has the Charmed condition for 30 days or until you or your allies deal damage to it. When the condition ends, the awakened creature chooses its attitude toward you."
});
legacySpellRefactor("bane", {
    name: "Bane",
    nameShort: "Bane*",
    classes: ["bard", "cleric", "warlock"],
    source: [
        ["P24", 245]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A drop of blood",
    duration: "Conc, 1 min",
    save: "Cha",
    description: "3+1/SL creatures save or subtract 1d4 on every attack and save for the duration",
    descriptionFull: "Up to three creatures of your choice that you can see within range must each make a Charisma saving throw. Whenever a target that fails this save makes an attack roll or a saving throw before the spell ends, the target must subtract 1d4 from the attack roll or save." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("banishing smite", {
    name: "Banishing Smite",
    classes: ["paladin"],
    source: [
        ["P24", 245]
    ],
    level: 5,
    school: "Conj",
    time: "1 bns*",
    timeFull: "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
    range: "Self",
    components: "V",
    duration: "Conc, 1 min",
    description: "Melee wea/unarmed hit +5d10 Force dmg; if this brings target HP<51, banished until spell ends",
    descriptionFull: "The target hit by the attack roll takes an extra 5d10 Force damage from the attack. If the attack reduces the target to 50 Hit Points or fewer, the target must succeed on a Charisma saving throw or be transported to a harmless demiplane for the duration. While there, the target has the Incapacitated condition. When the spell ends, the target reappears in the space it left or in the nearest unoccupied space if that space is occupied.",
});
legacySpellRefactor("banishment", {
    name: "Banishment",
    nameShort: "Banishment*",
    classes: ["cleric", "paladin", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 245]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A pentacle",
    duration: "Conc, 1 min",
    save: "Cha",
    description: "1+1/SL crea save or banished; aberration/celestial/elemental/fey/fiend don't return if spell lasts 1 min",
    descriptionFull: "One creature that you can see within range must succeed on a Charisma saving throw or be transported to a harmless demiplane for the duration. While there, the target has the Incapacitated condition. When the spell ends, the target reappears in the space it left or in the nearest unoccupied space if that space is occupied." + "\n   " + "If the target is an Aberration, a Celestial, an Elemental, a Fey, or a Fiend, the target doesn't return if the spell lasts for 1 minute. The target is instead transported to a random location on a plane (DM's choice) associated with its creature type." + AtHigherLevels + "You can target one additional creature for each spell slot above 4."
});
legacySpellRefactor("barkskin", {
    name: "Barkskin",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 245]
    ],
    level: 2,
    school: "Trans",
    time: "1 bns",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A handful of bark",
    duration: "1 h",
    description: "1 willing creature's AC cannot be reduced below 17, regardless of armor it is wearing",
    descriptionFull: "You touch a willing creature. Until the spell ends, the target's skin assumes a bark-like appearance, and the target has an AC of 17 if its AC is lower than that."
});
legacySpellRefactor("beacon of hope", {
    name: "Beacon of Hope",
    classes: ["cleric"],
    source: [
        ["P24", 245]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "For duration, any crea has adv. on Wisdom \u0026 Death saves, \u0026 gain max HP from any healing",
    descriptionFull: "Choose any number of creatures within range. For the duration, each target has Advantage on Wisdom saving throws and Death Saving Throws and regains the maximum number of Hit Points possible from any healing."
});
legacySpellRefactor("beast sense", {
    name: "Beast Sense",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 245]
    ],
    ritual: true,
    level: 2,
    school: "Div",
    time: "1 a",
    range: "Touch",
    components: "S",
    duration: "Conc, 1 h",
    description: "Use 1 willing beast's senses as well as my own for the duration",
    descriptionFull: "You touch a willing Beast. For the duration, you can perceive through the Beast's senses as well as your own. When perceiving through the Beast's senses, you benefit from any special senses it has."
});
legacySpellRefactor("befuddlement", {
    name: "Befuddlement",
    nameShort: "Befuddlement*",
    replaces: "feeblemind",
    classes: ["bard", "druid", "warlock", "wizard"],
    source: [
        ["P24", 245]
    ],
    level: 8,
    school: "Ench",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A key ring with no keys",
    duration: "Instantaneous",
    save: "Int",
    description: "1 crea 10d12 Psychic \u0026 can't cast spells/take Magic action; save 1/2 dmg only; resave every 30 days ",
    descriptionFull: "You blast the mind of a creature that you can see within range. The target makes an Intelligence saving throw." + "\n   " + "On a failed save, the target takes 10d12 Psychic damage and can't cast spells or take the Magic action. At the end of every 30 days, he target repeats the save, ending the effect on a success. The effect can also be ended by the Greater Restoration, Heal, or Wish spell." + "\n   " + "On a successful save, the target takes half as much damage only",
});
legacySpellRefactor("bestow curse", {
    name: "Bestow Curse",
    classes: ["bard", "cleric", "wizard"],
    source: [
        ["P24", 246]
    ],
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 creature save or cursed, see B; duration SL4: conc, 10 min; SL5: 8h; SL7: 24h; SL9: until dispelled",
    descriptionFull: "You touch a creature, which must succeed on a Wisdom saving throw or become cursed for the duration. Until the curse ends, the target suffers one of the following effects of your choice:." + "\n " + "\u2022 Choose one ability. The target has Disadvantage on ability check and saving throws made with that ability." + "\n " + "\u2022 The target has Disadvantage on attack rolls against you." + "\n " + "\u2022 In combat, the target must succeed on a Wisdom saving throw at the start of each of its turns or be forced to take the Dodge action on that turn." + "\n " + "\u2022 If you deal damage to the target with an attack roll or a spell, the target takes an extra 1d8 Necrotic damage." + AtHigherLevels + "If you cast this spell using a level 4 spell slot, you can maintain Concentration on it for up to 10 minutes. If you use a level 5+ spell slot, the spell doesn't require Concentration, and the duration becomes 8 hours (level 5-6 slot) or 24 hours (7-8 slot). If you use a level 9 spell slot, the spell lasts until dispelled."
});
legacySpellRefactor("bigby's hand", {
    name: "Bigby's Hand",
    nameShort: "Bigby's Hand*",
    nameAlt: "Arcane Hand",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 246]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "An eggshell and a glove",
    duration: "Conc, 1 min",
    description: "Large hand attacks, pushes, grapples or protects; see B; AC 20, my max HP; bns move 60 ft \u0026 act",
    descriptionFull: "You create a Large hand of shimmering magical energy in an unoccupied space that you can see within range. The hand lasts for the duration, and it moves at your command, mimicking the movements of your own hand." + "\n   " + "The hand is an object that has AC 20 and Hit Points equal to your Hit Point maximum. If it drops to 0 Hit Points, the spell ends. The hand doesn't occupy its space." + "\n   " + "When you cast the spell and as a Bonus Action on your later turns, you can move the hand up to 60 feet and then cause one of the following effects:" + toUni("Clenched Fist") + ". The hand strikes a target within 5 feet of it. Make a melee spell attack. On a hit, the target takes 5d8 Force damage." + toUni("Forceful Hand") + ". The hand attempts to push a Huge or smaller creature within 5 feet of it. The target must succeed on a Strength saving throw, or the hand pushes the target up to 5 feet plus a number of feet equal to five times your spellcasting ability modifier. The hand moves with the target, remaining within 5 feet of it." + toUni("Grasping Hand") + ". The hand attempts to grapple a Huge or smaller creature within 5 feet of it. The target must succeed on a Dexterity saving throw, or the target has the Grappled condition, with an escape DC equal to your spell save DC. While the hand grapples the target, you can take a Bonus Action to cause the hand to crush it, dealing Bludgeoning damage to the target equal to 4d6 plus your spellcasting ability modifier." + toUni("Interposing Hand") + ". The hand grants you Half Cover against attacks and other effects that originate from its space or that pass through it. In addition, the space counts as Difficult Terrain for your enemies." + AtHigherLevels + "The damage of the Clenched Fist increases by 2d8 and the damage of the Grasping Hand increases by 2d6 for each spell slot level above 5."
});
legacySpellRefactor("blade barrier", {
    name: "Blade Barrier",
    classes: ["cleric"],
    source: [
        ["P24", 247]
    ],
    level: 6,
    school: "Evoc",
    time: "1 a",
    range: "90 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    save: "Dex",
    description: "100|20|5ft (l|h|w) wall or 30|20|5ft (r|h|w) cir; 3/4 cover; dif. ter.; now/enter/end 6d10 Slash. (1/t/c, S:1/2)",
    descriptionMetric: "60|6|1,5m (l|h|w) wall or 9|6|1,5m (r|h|w) cir; 3/4 cover; dif. ter.; now/enter/end 6d10 Slash. (1/t/c, S:1/2)",
    descriptionShorter: typePF ? false : "100|20|5ft (l|h|w) wall or 30|20|5ft (r|h|w) ring; now/enter/end 6d10 Slash.; save 1/2; \u00BEcover",
    descriptionShorterMetric: typePF ? false : "60|6|1,5m (l|h|w) wall or 9|6|1,5m (r|h|w) ring; now/enter/end 6d10 Slash.; save 1/2; \u00BEcover",
    descriptionFull: "You create a wall of whirling blades made of magical energy. The wall appears within range and lasts for the duration. You make a straight wall up to 100 feet long, 20 feet high, and 5 feet thick, or a ringed wall up to 60 feet in diameter, 20 feet high, and 5 feet thick. The wall provides Three-Quarters Cover, and its space is Difficult Terrain." + "\n   " + "Any creature in the wall's space makes a Dexterity saving throw, taking 6d10 Force damage on a failed save or half as much damage on a successful one. A creature also makes that save if it enters the wall's space or ends it turn there. A creature makes that save only once per turn.",
});
legacySpellRefactor("blade ward", {
    name: "Blade Ward",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 247]
    ],
    level: 0,
    school: "Abjur",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "For the duration, creatures subtract 1d4 from attack rolls made against me",
    descriptionFull: "Whenever a creature makes an attack roll against you before the spell ends, the attacker subtracts 1d4 from the attack roll."
});
legacySpellRefactor("bless", {
    name: "Bless",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 247]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M\u0192",
    compMaterial: "A holy symbol worth 5+ gp",
    duration: "Conc, 1 min",
    description: "3+1/SL creatures can add 1d4 on every attack roll and saving throw for the duration (5gp)",
    descriptionFull: "You bless up to three creatures within range. Whenever a target makes an attack roll or a saving throw before the spell ends, the target adds 1d4 to the attack roll or save." + AtHigherLevels + "You can target one additional creature for each spell slot above 1."
});
legacySpellRefactor("blight", {
    name: "Blight",
    nameShort: "Blight*",
    classes: ["druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 247]
    ],
    level: 4,
    school: "Necro",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Con",
    description: "Kill nonmagical plant or target 1 crea for 8d8+1d8/SL Necrotic dmg; save halves; plant crea auto fails",
    descriptionFull: "A creature that you can see within range makes a Constitution saving throw, taking 8d8 Necrotic damage on a failed save or half as much damage on a successful one. A Plant creature automatically fails the save." + "\n   " + "Alternatively, target a nonmagical plant that isn't a creature, such as a tree or shrub. It doesn't make a save; it simply withers and dies." + AtHigherLevels + "The damage increases by 1d8 for each spell slot above 4."
});
legacySpellRefactor("blinding smite", {
    name: "Blinding Smite",
    classes: ["paladin"],
    source: [
        ["P24", 247]
    ],
    level: 3,
    school: "Evoc",
    time: "1 bns*",
    timeFull: "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
    range: "Self",
    components: "V",
    duration: "1 min",
    save: "Con",
    description: "Melee weapon/unarmed hit +3d8+1d8/SL Radiant dmg; crea Blinded for 1 min; EoT save to end",
    descriptionFull: "The target hit by the strike takes an extra 3d8 Radiant damage from the attack, and the target has the Blinded condition until the spell ends. At the end of each of its turns, the Blinded target makes a Constitution saving throw, ending the spell on itself on a success." + AtHigherLevels + "The extra damage increases by 1d8 for each spell slot level above 3."
});
legacySpellRefactor("blindness/deafness", {
    name: "Blindness/Deafness",
    nameShort: "Blindness/Deafness*",
    classes: ["bard", "cleric", "sorcerer", "wizard"],
    source: [
        ["P24", 248]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "120 ft",
    components: "V",
    duration: "1 min",
    save: "Con",
    description: "1+1/SL creature save vs Blinded or Deafened; repeat save at end of each turn",
    descriptionFull: "One creature that you can see within range must succeed on a Constitution saving throw, or it has the Blinded or deafened condition (your choice) for the duration. At the end of each of its turns, the target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "You can target one additional creature for each spell slot level above 2."
});
legacySpellRefactor("blink", {
    name: "Blink",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 248]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "1 min",
    description: "50% chance to travel to Ethereal Plane each EoT; return to an empty space within 10ft next turn",
    descriptionFull: "Roll 1d6 at the end of each of your turns for the duration. On a roll of 4-6, you vanish from your current plane of existence and appear in the Ethereal Plane (the spell ends instantly if you are already on that plane). While on the Ethereal Plane, you can perceive the plane you left, which is cast in shades of gray, but you can't see anything there more than 60 feet away. You can affect and be affected only by other creatures on the Ethereal Plane, and creatures on the other plane can't perceive you unless they have a special ability that lets them perceive things on the Ethereal Plane." + "\n   " + "You return to the other plane at the start of your next turn and when the spell ends if you are on the Ethereal Plane. You return to an unoccupied space of your choice that you can see within 10 feet of the space you left If no unoccupied space is available within that range, you appear in the nearest unoccupied space."
});
legacySpellRefactor("blur", {
    name: "Blur",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 248]
    ],
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "Self",
    components: "V",
    duration: "Conc, 1 min",
    description: "Creatures have disadvantage on attacks vs me unless creature has Blindsight or Truesight",
    descriptionFull: "Your body becomes blurred. For the duration, any creature has Disadvantage on attack rolls against you. An attacker is immune to the effect if it perceives you with Blindsight or Truesight."
});
legacySpellRefactor("burning hands", {
    name: "Burning Hands",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 248]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "S:15ft cone",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "All in area 3d6+1d6/SL Fire dmg; save halves; unattended flammable objects ignite",
    descriptionFull: "A thin sheet of flames shoots forth from you. Each creature in a 15-foot Cone makes a Dexterity saving throw, taking 3d6 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "Flammable objects in the Cone that aren't being worn or carried start burning." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("call lightning", {
    name: "Call Lightning",
    nameShort: "Call Lightning*",
    classes: ["druid"],
    source: [
        ["P24", 248]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    save: "Dex",
    description: "60-ft rad 10-ft high cloud; 1 a 5-ft rad of visible point under cloud all 3d10+1d10/SL Lightn.; save 1/2",
    descriptionShorter: "60-ft rad 10-ft high cloud; all in 5-ft rad under it 3d10+1d10/SL Lightn.; save half; 1 a to repeat",
    descriptionFull: "A storm cloud appears at a point within range that you can see above yourself. It takes the shape of a Cylinder that is 10 feet tall with a 60-foot radius." + "\n   " + "When you cast the spell, choose a point you can see under the cloud. A lightning bolt shoots from the cloud to that point. Each creature within 5 feet of that point makes a Dexterity saving throw, taking 3d10 Lightning damage on a failed save or half as much damage on a successful one." + "\n   " + "Until the spell ends, you can take a Magic action to call down lightning in that way again, targeting the same point or a different one." + "\n   " + "If you're outdoors in a storm when you cast this spell, the spell gives you control over that storm instead of creating a new one. Under such conditions, the spell's damage increases by 1d10." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 3."
});
legacySpellRefactor("calm emotions", {
    name: "Calm Emotions",
    classes: ["bard", "cleric"],
    source: [
        ["P24", 249]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Cha",
    description: "20-ft rad all humanoids suppress Charmed \u0026 Frightened, or hostility to any crea till it or allies dmged",
    descriptionFull: "Each Humanoid in a 20-foot-radius Sphere centered on a point you choose within range must succeed on a Charisma saving throw or be affected by one of the following effects (choose for each creature):" +
        "\n The creature has Immunity to the Charmed and Frightened conditions until the spell ends. If the creature was already Charmed or Frightened, those conditions are suppressed for the duration." +
        "\n The creature becomes indifferent about creatures of your choice that it's Hostile toward. This indifference ends if the target takes damage or witnesses its allies taking damage. When the spell ends, the creature's attitude returns to normal."
});
legacySpellRefactor("chain lightning", {
    name: "Chain Lightning",
    nameShort: "Chain Lightning*",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 249]
    ],
    level: 6,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "Three silver pins",
    duration: "Instantaneous",
    save: "Dex",
    description: "Lightning bolt 1 visible crea/obj and 3+1/SL crea/obj in 30 ft of 1st; 10d8 Lightning dmg; save halves",
    descriptionFull: "You launch a lightning bolt toward a target you can see within range. Three bolts then leap from that target to as many as three other targets of your choice, each of which must be within 30 feet of the first target. A target can be a creature or an object and can be targeted by only one of the bolts." + "\n   " + "Each target makes a Dexterity saving throw, taking 10d8 Lightning damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "One additional bolt leaps from the first target to another target for each spell slot level above 6."
});
legacySpellRefactor("charm monster", {
    name: "Charm Monster",
    nameShort: "Charm Monster*",
    classes: ["bard", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 249]
    ],
    level: 4,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "1 h",
    save: "Wis",
    description: "1+1/SL crea save or Charmed \u0026 Friendly; adv. on save if fighting me/ally; ends if we dmg it",
    descriptionFull: "One creature you can see within range makes a Wisdom saving throw. It does so with Advantage if you or your allies are fighting it. On a failed save, the target has the Charmed condition until the spell ends or until you or your allies damage it. The Charmed creature is Friendly to you. When the spell ends, the target knows it was Charmed by you." + AtHigherLevels + "You can target one additional creature for each spell slot level above 4."
});
legacySpellRefactor("charm person", {
    name: "Charm Person",
    nameShort: "Charm Person*",
    classes: ["bard", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 249]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "1 h",
    save: "Wis",
    description: "1+1/SL humanoids save or Charmed \u0026 Friendly; adv. on save if fighting me/ally; ends if we dmg it",
    descriptionFull: "One Humanoid you can see within range makes a Wisdom saving throw. It does so with Advantage if you or your allies are fighting it. On a failed save, the target has the Charmed condition until the spell ends or until you or your allies damage it. The Charmed creature is Friendly to you. When the spell ends, the target knows it was Charmed by you." + AtHigherLevels + "you can target on additional creature for each spell slot level above 1."
});
legacySpellRefactor("chill touch", {
    name: "Chill Touch",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 249]
    ],
    level: 0,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Instantaneous",
    description: "Melee spell atk for 1d10 Necrotic; can't regain HP until my next EoT; +1d10 at CL 5, 11, and 17",
    descriptionShorter: "Melee spell atk for 1d10 Necrotic; can't regain HP until my next EoT; +1d10 at CL 5/11/17",
    descriptionCantripDie: "Melee spell attack for `CD`d10 Necrotic; can't regain HP until my next EoT",
    descriptionFull: "Channeling the chill of the grave, make a melee spell attack against a target within reach. On a hit, the target takes 1d10 Necrotic damage, and it can't regain Hit Points until the end of your next turn." + "\n   " + toUni("Cantrip Upgrade") + ".  The damage increases by 1d10 when you reach levels 5 (2d10), 11 (3d10), and 17 (4d10)."
});
legacySpellRefactor("chromatic orb", {
    name: "Chromatic Orb",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 249]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A diamond worth 50+ gp",
    duration: "Instantaneous",
    description: "Spell atk 3d8+1d8/SL Acid/Cold/Fire/Lghtn/Poison/Thdr; if dup. atk new target in 30ft; leap 1/SL (50gp)",
    descriptionFull: "You hurl an orb of energy at a target within range. Choose Acid, Cold, Fire, Lightning, Poison, or Thunder for the type of orb you create, and then make a ranged spell attack against the target. On a hit, the target takes 3d8 damage of the chosen type." + "\n   " + "If you roll the same number on two or more of the d8s, the orb leaps to a different target of your choice within 30 feet of the target. Make a new attack roll against the new target, and make a new damage roll. The orb can't leap again unless you cast the spell with a level 2+ spell slot." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 1. The orb can leap a maximum number of times equal to the level of the slot expended, and a creature can be targeted only once by each casting of this spell..",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["acid", "cold", "fire", "lightning", "poison", "thunder"],
            inDescriptionAs: "Acid, Cold, Fire, Lightning, Poison or Thunder",
        },
    },
});
legacySpellRefactor("circle of death", {
    name: "Circle of Death",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 250]
    ],
    level: 6,
    school: "Necro",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M\u0192",
    compMaterial: "The powder of a crushed black pearl worth 500+ gp",
    duration: "Instantaneous",
    save: "Con",
    description: "60-ft radius all creatures 8d8+2d8/SL Necrotic dmg; save halves (500gp)",
    descriptionFull: "Negative energy ripples out in a 60-foot-radius Sphere from a point you choose within range. Each creature in that area makes a Constitution saving throw, taking 8d8 Necrotic damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 2d8 for each spell slot level above 6."
});
legacySpellRefactor("circle of power", {
    name: "Circle of Power",
    classes: ["artificer", "cleric", "paladin", "wizard"],
    source: [
        ["P24", 250]
    ],
    level: 5,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Conc, 10 min",
    description: "While in area, me + allies adv. on saves vs magical effects; if save would half dmg, we take no dmg",
    descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Advantage on saving throws against spells and other magical effects. When an affected creature makes a saving throw against a spell or magical effect that allows a save to take only half damage, it takes no damage if it succeeds on the save."
});
legacySpellRefactor("clairvoyance", {
    name: "Clairvoyance",
    classes: ["bard", "cleric", "sorcerer", "wizard"],
    source: [
        ["P24", 250]
    ],
    level: 3,
    school: "Div",
    time: "10 min",
    range: "1 mile",
    components: "V,S,M\u0192",
    compMaterial: "A focus worth 100+ gp, either a jeweled horn for hearing or a glass eye for seeing",
    duration: "Conc, 10 min",
    description: "See or hear familiar place or obvious location; bns switch between seeing and hearing (100gp)",
    descriptionFull: "You create an invisible sensor within range in a location familiar to you (a place you have visited or seen before) or in an obvious location that is unfamiliar to you (such as behind a door, around a corner, or in a grove of trees). The intangible, invulnerable sensor remains in place for the duration." + "\n   " + "When you cast the spell, choose seeing or hearing. You can use the chosen sense through the sensor as if you were in its space. As a Bonus Action, you can switch between seeing and hearing." + "\n   " + "A creature that sees the sensor (such as a creature benefiting from See Invisibility or Truesight) sees a luminous orb about the size of your fist."
});
legacySpellRefactor("clone", {
    name: "Clone",
    classes: ["wizard"],
    source: [
        ["P24", 251]
    ],
    level: 8,
    school: "Necro",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A diamond worth 1000+ gp, which the spell consumes, and a sealable vessel worth 2000+ gp that is large enough to hold the creature being cloned",
    duration: "Instantaneous",
    description: "Create a clone of living crea; after 120 days its soul can move to the clone if dies (1K gp cons.; 2K gp)",
    descriptionFull: "You touch a creature or at least 1 cubic inch of its flesh. An inert duplicate of that creature forms inside the vessel used in the spell's casting and finishes growing after 120 days; you choose whether the finished clone is the same age as the creature or younger. The clone remains inert and endures indefinitely while its vessel remains undisturbed." + "\n   " + "If the original creature dies after the clone finishes forming, the creature's soul transfers to the clone if the soul is free and willing to return. The clone is physically identical to the original and has the same personality, memories, and abilities, but none of the original's equipment. The creature's original remains, if any, become inert and can't be revived, since the creature's soul is elsewhere."
});
legacySpellRefactor("cloudkill", {
    name: "Cloudkill",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 251]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    save: "Con",
    description: "Heavily obsc. 20ft rad; now/cover/enter/end 5d8+1d8/SL Poison (1/turn/crea, save 1/2); move 10ft/rnd",
    descriptionShorter: "20ft rad 5d8+1d8/SL Poison; save halves; move 10 ft/rnd; heavily obscured",
    descriptionFull: "You create a 20-foot-radius Sphere of yellow-green fog centered on a point within range. The fog lasts for the duration or until string wind (such as the one created by Gust of Wind) disperses it, ending the spell. Its area is Heavily Obscured." + "\n   " + "Each creature in the Sphere makes a Constitution saving throw, taking 5d8 Poison damage on a failed save or half as much damage on a successful one. A creature must also make this save when the Sphere moves into its space and when it enters the Sphere or ends its turn there. A creature makes this save only once per turn." + "\n   " + "The Sphere moves 10 feet away from you at the start of each of your turns." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("cloud of daggers", {
    name: "Cloud of Daggers",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 251]
    ],
    level: 2,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A sliver of glass",
    duration: "Conc, 1 min",
    description: "5-ft cube all now/cover/enter/end 4d4+2d4/SL Slashing (1/turn/creature); a to teleport cube 30 ft",
    descriptionFull: "You conjure spinning daggers in a 5-foot Cube centered on a point within range. Each creature in that area takes 4d4 Slashing damage. A creature also takes this damage if it enters the Cube or ends its turn there or if the Cube moves into its space. A creature takes this damage only once per turn." + "\n   " + "On your later turns, you can take a Magic action to teleport the Cube up to 30 feet." + AtHigherLevels + "The damage increases by 2d4 for each spell slot level above 2."
});
legacySpellRefactor("color spray", {
    name: "Color Spray",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 251]
    ],
    level: 1,
    school: "Illus",
    time: "1 a",
    range: "S:15ft cone",
    components: "V,S,M",
    compMaterial: "A pinch of colorful sand",
    duration: "Instantaneous",
    save: "Con",
    description: "All creatures in area save or Blinded until my next turn ends",
    descriptionFull: "You launch a dazzling array of flashing, colorful light. Each creature in a 15-foot Cone originating from you must succeed on a Constitution saving throw or have the Blinded condition until the end of your next turn."
});
legacySpellRefactor("command", {
    name: "Command",
    nameShort: "Command*",
    classes: ["bard", "cleric", "paladin"],
    source: [
        ["P24", 251]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    save: "Wis",
    description: "1+1/SL crea, save or follow one word command: Approach, Drop, Flee, Grovel or Halt; see book",
    descriptionFull: "You speak a one-word command to a creature you can see within range. The target must succeed on a Wisdom saving throw or follow the command on its next turn. Choose the command from these options:" + "\n   " + toUni("Approach") + ": The target moves toward you by the shortest and most direct route, ending its turn if it moves within 5 feet of you." + "\n   " + toUni("Drop") + ": The target drops whatever it is holding and then ends its turn." + "\n   " + toUni("Flee") + ": The target spends its turn moving away from you by the fastest available means." + "\n   " + toUni("Grovel") + ": The target has the Prone condition and then ends its turn." + "\n   " + toUni("Halt") + ": On its turn, the target doesn't move and takes no action or Bonus Action." + AtHigherLevels + "You can affect one additional creature for each spell slot level above 1."
});
legacySpellRefactor("commune", {
    name: "Commune",
    classes: ["cleric"],
    source: [
        ["P24", 252]
    ],
    ritual: true,
    level: 5,
    school: "Div",
    time: "1 min",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Incense",
    duration: "1 min",
    description: "Ask 3 yes/no questions of deity or divine proxy; receive correct word or short phrase (if knows answer)",
    descriptionFull: "You contact a deity or a divine proxy and ask up to three questions that can be answered with a yes or no. You must ask your questions before the spell ends. You receive a correct answer for each question." + "\n   " + "Divine beings aren't necessarily omniscient, so you might receive \"unclear\" as an answer if a question pertains to information that lies beyond the deity's knowledge. In a case where a one-word answer could be misleading or contrary to the deity's interests, the DM might offer a short phrase as an answer instead." + "\n   " + "If you cast the spell more than once before finishing a Long Rest, there is a cumulative 25 percent chance for each casting after the first that you get no answer."
});
legacySpellRefactor("commune with nature", {
    name: "Commune with Nature",
    nameShort: "Commune w. Nature",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 252]
    ],
    ritual: true,
    level: 5,
    school: "Div",
    time: "1 min",
    range: "Self",
    components: "V,S",
    duration: "Instantaneous",
    description: "Know 3 facts about natural features within 3 miles (300 ft underground); see book",
    descriptionFull: "You commune with nature spirits and gain knowledge of the surrounding area. In the outdoors, the spell gives you knowledge of the area within 3 miles of you. In caves and other natural underground settings, the radius is limited to 300 feet. The spell doesn't function where nature has been replaced by construction, such as in castles and settlements." + "\n   " + "Choose three of the following facts; you learn those facts as the pertain to the spell's area:\n \u2022Locations of Settlements\n \u2022Locations of portals to other planes of existence\n \u2022Location of one Challenge Rating 10+ creature (DM's choice) that is a Celestial, an Elemental, a Fey, a Fiend, or an Undead\n \u2022The most prevalent, kind of plant, mineral, or Beast (you choose which to learn)\n \u2022Locations of bodies of water." + "\n   " + "For example, you could determine the location of a powerful monster in the area, the locations of bodies of water, and the locations of any towns"
});
legacySpellRefactor("compelled duel", {
    name: "Compelled Duel",
    nameShort: "Compelled Duel*",
    classes: ["paladin"],
    source: [
        ["P24", 252]
    ],
    level: 1,
    school: "Ench",
    time: "1 bns",
    range: "30 ft",
    components: "V",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 crea save or dis. atks vs not-me, can't move >30ft away; ends if ally dmgs/I target dif. crea/end>30ft",
    descriptionFull: "You try to compel a creature into a duel. One creature that you can see within range makes a Wisdom saving throw. On a failed save, the target has Disadvantage on attack rolls against creatures other than you, and it can't willingly move to a space that is more than 30 feet away from you." + "\n   " + "The spell ends if you make an attack roll against a creature other than the target, if you cast a spell on an enemy other than the target, if an ally of yours damages the target, or if your end your turn more than 30 feet away from the target."
});
legacySpellRefactor("comprehend languages", {
    name: "Comprehend Languages",
    nameShort: "Comp. Languages",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 252]
    ],
    ritual: true,
    level: 1,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A pinch of soot and salt",
    duration: "1 h",
    description: "Understand all spoken and signed languages and writing when touched; doesn't help vs codes",
    descriptionFull: "For the duration, you understand the literal meaning of any language that you hear or see signed. You also understand any written language that you see, but you must be touching the surface on which the words are written. It takes about 1 minute to read one page of text. This spell doesn't decode symbols or secret messages."
});
legacySpellRefactor("compulsion", {
    name: "Compulsion",
    nameShort: "Compulsion*",
    classes: ["bard"],
    source: [
        ["P24", 252]
    ],
    level: 4,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "Any crea save or Charmed; bns pick horizontal direction; on turn Charmed crea move then redo save",
    descriptionFull: "Each creature of your choice that you can see within range must succeed on a Wisdom saving throw or have the Charmed condition until the spell ends." + "\n   " + "For the duration, you can take a Bonus Action to designate a direction that is horizontal to you. Each Charmed target must use as much of its movement as possible to move in that direction on its next turn, taking the safest route. After moving in this way, a target repeats the save, ending the spell on itself on a success."
});
legacySpellRefactor("cone of cold", {
    name: "Cone of Cold",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 253]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "S:60ft cone",
    components: "V,S,M",
    compMaterial: "A small crystal or glass cone",
    duration: "Instantaneous",
    save: "Con",
    description: "8d8+1d8/SL Cold dmg; save halves; creatures killed become frozen statues until thawed",
    descriptionFull: "You unleash a blast of cold air. Each creature in a 60-foot Cone originating from you makes a Constitution saving throw, taking 8d8 Cold damage on a failed save or half as much damage on a successful one. A creature killed by this spell becomes a frozen statue until it thaws." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("confusion", {
    name: "Confusion",
    classes: ["bard", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 253]
    ],
    level: 4,
    school: "Ench",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "Three nut shells",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "10+5ft/SL rad all crea save or no bns/reactions and confused; see book; repeat save at end of turn",
    descriptionFull: "Each creature in a 10-foot-radius Sphere centered on a point you choose within range must succeed on a Wisdom saving throw, or that target can't take Bonus Actions or Reactions and must roll 1d10 at the start of each of its turns to determine its behavior for that turn, consulting the table below." + "\n\n" + toUni("d10") + "\t" + toUni("Behavior for the Turn") + "\n   " + "1\tThe target doesn't take an action, and it uses all its movement to move. Roll 1d4 for the direction: 1, north; 2, east; 3, south; or 4,west." + "\n   " + "2-6\tThe target doesn't move or take actions." + "\n   " + "7-8\tThe target doesn't move, and it takes the Attack action to make one melee attack against a random creature within reach. If none are within reach, the target takes no action." + "\n   " + "9-10\tThe target chooses its behavior." + "\n\n" + "At the end of each of its turns, an affected target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "The Sphere's radius increases by 5 feet for each spell slot level above 4."
});
legacySpellRefactor("conjure animals", {
    name: "Conjure Animals",
    nameShort: "Conjure Animals*",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 254]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    save: "Dex",
    duration: "Conc, 10 min",
    description: "Lg spirit; moves/enter/end in 10ft save or 3d10+1d10/SL Slashing (1/t/c); Adv STR save 5ft; 30ft move",
    descriptionFull: "You conjure nature spirits that appear as a Large pack of spectral, intangible animals in an unoccupied space you can see within range. The pack lasts for the duration, and you choose the spirits' animal form, such as wolves, serpents, or birds." + "\n   " + "You have Advantage on Strength saving throws while you're within 5 feet of the pack, and when you move on your turn, you can also move the pack up to 30 feet to an unoccupied space you can see." + "\n   " + "Whenever the pack moves within 10 feet of a creature you can see and whenever a creature you can see enters a space within 10 feet of the pack or ends its turn there, you can force that creature to make a Dexterity saving throw. On a failed save, the creature takes 3d10 Slashing damage. A creature makes this save only once per turn." + AtHigherLevels + "The damage increases by 1d10 for each sell slot level above 3."
});
legacySpellRefactor("conjure barrage", {
    name: "Conjure Barrage",
    nameShort: "Conjure Barrage*",
    classes: ["ranger"],
    source: [
        ["P24", 254]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "S:60ft cone",
    components: "V,S,M",
    compMaterial: "A Melee or Ranged weapon worth at least 1 cp",
    duration: "Instantaneous",
    save: "Dex",
    description: "Conjure weapon or ammo; any creatures in area 5d8+1d8/SL Force dmg; save halves",
    descriptionFull: "You brandish the weapon used to cast the spell and conjure similar spectral weapons (or ammunition appropriate to the weapon) that launch forward and then disappear. Each creature of your choice that you can see in a 60-foot Cone makes a Dexterity saving throw, taking 5d8 Force damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 3."
});
legacySpellRefactor("conjure celestial", {
    name: "Conjure Celestial",
    nameShort: "Conjure Celestial*",
    classes: ["cleric"],
    source: [
        ["P24", 254]
    ],
    level: 7,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "20\xD740ft cyl.; now/cover/enter/end (1/t/c) heal 4d12+mod or 6d12 Rad.; save 1/2; +1d12/SL; 30ft move",
    descriptionFull: "You conjure a spirit from the Upper planes, which manifests as a pillar of light in a 10-foot-radius, 40-foot-high Cylinder centered on a point within range. For each creature you can see in the Cylinder, choose which of these lights shines on it:" + toUni("Healing Light") + ". The target regains Hit Points equal to 4d12 plus your spellcasting ability modifier." + toUni("Searing Light") + ". The target makes a Dexterity saving throw, taking 6d12 Radiant damage on a failed save or half as much damage on a successful one." + "\n   " + "Until the spell ends, Bright Light fills the Cylinder, and when you move on your turn, you can also move the Cylinder up to 30 feet." + "\n   " + "Whenever the Cylinder moves into the space of a creature you can see and whenever a creature you can see enters the Cylinder or ends its turn there you can bathe it in one of the lights. A creature can be affected by this spell only once per turn." + AtHigherLevels + "The healing and damage increases by 1d12 for each spell slot level above 7."
});
legacySpellRefactor("conjure elemental", {
    name: "Conjure Elemental",
    nameShort: "Conjure Elemental*",
    classes: ["druid", "wizard"],
    source: [
        ["P24", 254]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "10ft cu; no R enter/SoT 5ft 8d8+2d8/SL Lightn./Thdr/Fire/Cold + Restrain; S:1/2 only; SoT R save or 4d8",
    descriptionFull: "You conjure a Large, intangible spirit from the Elemental Planes that appears in an unoccupied space within range. Choose the spirit's element, which determines its damage type: air (Lightning), earth (Thunder), fire (Fire), or water (Cold), the spirit lasts for the duration." + "\n   " + "Whenever a creature you can see enters the spirit's space or starts its turn within 5 feet of the spirit, you can force that creature to make a Dexterity saving throw if the spirit has no creature Restrained. On failed save, the target takes 8d8 damage of the spirit's type, and the target has the Restrained condition until the spell ends. At the start of each of its turns, the Restrained target repeats the save. On a failed save, the target takes 4d8 damage of the spirit's type. On a successful save, the target isn't Restrained by the spirit." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5.",
});
legacySpellRefactor("conjure fey", {
    name: "Conjure Fey",
    nameShort: "Conjure Fey*",
    classes: ["druid"],
    source: [
        ["P24", 255]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Med. fey; spell atk any 1 in 5ft; 3d12+2d12/SL+mod Psychic \u0026 Frightened 1 rnd; bns teleport 30ft \u0026 atk",
    descriptionFull: "You conjure a Medium spirit from the Feywild in an unoccupied space you can see within range. The spirit lasts for the duration, and it looks like a Fey creature of your choice. When the spirit appears, you can make one melee spell attack against a creature within 5 feet of it. On a hit, the target takes Psychic damage equal to 3d12 plus your spellcasting ability modifier, and the target has the Frightened condition until the start of your next turn, with both you and the spirit as the source of the fear." + "\n   " + "As a Bonus Action on your later turns, you can teleport the spirit to an unoccupied space you can see within 30 feet of the space it left and make the attack against a creature within 5 feet of it." + AtHigherLevels + "The damage increases by 1d12 for each spell slot level above 6."
});
legacySpellRefactor("conjure minor elementals", {
    name: "Conjure Minor Elementals",
    nameShort: "Conj. Minor Elementals",
    classes: ["druid", "wizard"],
    source: [
        ["P24", 255]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "S:15-ft rad",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Atks at targets in area deal +2d8+2d8/SL Acid/Cold/Fire/Lightn. (choice); area is dif. ter. for enemies",
    descriptionFull: "You conjure spirits from the Elemental Plans that flit around you in a 15-foot Emanation for the duration. Until the spell ends, any attack you make deals an extra 2d8 damage when you hit a creature in the Emanation. This damage is Acid, Cold, Fire, or Lightning (your choice when you make the attack)." + "\n   " + "In addition, the ground in the Emanation is Difficult Terrain for your enemies." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 4."
});
legacySpellRefactor("conjure volley", {
    name: "Conjure Volley",
    nameShort: "Conjure Volley*",
    classes: ["ranger"],
    source: [
        ["P24", 255]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A Melee or Ranged weapon worth at least 1 cp",
    duration: "Instantaneous",
    save: "Dex",
    description: "Volley falls in 40-ft rad 20-ft high cylinder; any creatures take 8d8 Force dmg; save halves",
    descriptionFull: "You brandish the weapon used to cast the spell and choose a point within range. Hundreds of similar spectral weapons (or ammunition appropriate to the weapon) fall in a volley and then disappear. Each creature of your choice that you can see in a 40-foot-radius, 20-foot-high Cylinder centered on that point makes a Dexterity saving throw. A creature takes 8d8 Force damage on a failed save or half as much damage on a successful one."
});
legacySpellRefactor("conjure woodland beings", {
    name: "Conjure Woodland Beings",
    nameShort: "Conj. Woodland Beings*",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 255]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S",
    duration: "Conc, 10 min",
    save: "Wis",
    description: "Disengage as bns; when crea covered/enters/ends in area (1/turn/crea) 5d8+1d8/SL Force; save 1/2",
    descriptionFull: "You conjure nature spirits that flit around you in a 10-foot Emanation for the duration. Whenever the Emanation enters the space of a creature you can see and whenever a creature you can see enters the Emanation or ends its turn there, you can force that creature to make a Wisdom saving throw. The creature takes 5d8 Force damage on a failed save or half as much damage on a successful one. A creature makes this save only once per turn." + "\n   " + "In addition, you can take the Disengage action as a Bonus Action for the spell's duration." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 4."
});
legacySpellRefactor("contact other plane", {
    name: "Contact Other Plane",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 255]
    ],
    ritual: true,
    level: 5,
    school: "Div",
    time: "1 min",
    range: "Self",
    components: "V",
    duration: "1 min",
    save: "Int",
    description: "DC 15 to ask planar entity 5 questions; 1 word/phrase answer; fail 6d6 Psychic \u0026 Incapac. till Gr Rest/LR",
    descriptionFull: "You mentally contact a demigod, the spirit of a long-dead sage, or some other knowledgeable entity from another plane. Contacting this otherworldly intelligence can break your mind. When you cast this spell, make a DC 15 Intelligence saving throw. On a successful save, you can ask the entity up to five questions. You must ask your questions before the spell ends. The DM answers each question with one word, such as \"yes\", \"no\", \"maybe\", \"maybe\", \"never\", \"irrelevant\", or \"unclear\" (if the entity doesn't know the answer to the question). If a one-word answer would be misleading, the DM might instead offer a short phrase as an answer." + "\n   " + "On a failed save, you take 6d6 Psychic damage and have the Incapacitated condition until you finish a Long Rest. A Greater Restoration spell cast on you ends this effect."
});
legacySpellRefactor("contagion", {
    name: "Contagion",
    classes: ["cleric", "druid"],
    source: [
        ["P24", 256]
    ],
    level: 5,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "7 days",
    save: "Con",
    description: "Target save or 11d8 Necrotic, Poisoned \u0026 Disadv 1 save type; EoT save till 3 pass (end) or 3 fail (7 days)",
    descriptionFull: "Your touch inflicts a magical contagion. The target must succeed on a Constitution saving throw or take 11d8 Necrotic damage and have the Poisoned condition. Also, choose one ability when you cast the spell. While Poisoned, the target has Disadvantage on saving throws made with the chosen ability." + "\n   " + "The target must repeat the saving throw at the end of each of its turns until it gets three successes or failures. If the target succeeds on three of these saves, the spell ends on the target. If the target fails three of the saves, the spell lasts for 7 days on it." + "\n   " + "Whenever the Poisoned target receives an effect that would end the Poisoned condition, the target must succeed on a Constitution saving throw, or the Poisoned condition doesn't end on it."
});
legacySpellRefactor("contingency", {
    name: "Contingency",
    classes: ["wizard"],
    source: [
        ["P24", 256]
    ],
    level: 6,
    school: "Evoc",
    time: "10 min",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "a gem-encrusted statuette of yourself worth 1500 gp",
    duration: "10 days",
    description: "Cast another SL<6 action spell that targets me to activate when a condition is met (1500gp)",
    descriptionFull: "Choose a spell of level 5 or lower that you can cast, that has a casting time of an action, and that can target you. You cast that spell ‚Äî called the contingent spell ‚Äî as part of casting Contingency, expending spell slots for both, but the contingent spell doesn't come into effect. Instead, it takes effect when a certain trigger occurs. You describe that trigger when you cast the two spells. For example, a Contingency cast with Water Breathing might stipulate that Water Breathing comes into effect when you are engulfed in water or a similar liquid." + "\n   " + "The contingent spell takes effect immediately after the trigger occurs for the first time, whether or not you want it to, and then Contingency ends." + "\n   " + "The contingent spell takes effect only on you, even if it can normally target others. You can use only one Contingency spell at a time. If you cast this spell again, the effect of another Contingency spell on you ends. Also, Contingency ends on you if its material component is ever not on your person."
});
legacySpellRefactor("continual flame", {
    name: "Continual Flame",
    classes: ["artificer", "cleric", "druid", "wizard"],
    source: [
        ["P24", 256]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Ruby dust worth 50+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "Create a permanent magical flame on obj that emits 20-ft rad bright light \u0026 20-ft dim (50gp cons.)",
    descriptionFull: "A flame springs from an object that you touch. The effect casts Bright Light in a 20-foot radius and Dim Light for an additional 20 feet. It looks like a regular flame, but it creates no heat and consumes no fuel. The flame can be covered or hidden but not smothered or quenched."
});
legacySpellRefactor("control water", {
    name: "Control Water",
    classes: ["cleric", "druid", "wizard"],
    source: [
        ["P24", 256]
    ],
    level: 4,
    school: "Trans",
    time: "1 a",
    range: "300 ft",
    components: "V,S,M",
    compMaterial: "A mixture of water and dust",
    duration: "Conc, 10 min",
    description: "Control any water in a 100 ft cube as 1 a: Flood, Part Water, Redirect Flow, or Whirlpool, see book",
    descriptionFull: "Until the spell ends, you control any water inside an area you choose that is a Cube up to 100 feet on a side, using one of the following effects. As a Magic action on your later turns, you can repeat the same effect or choose a different one." + "\n   " + toUni("Flood") + ": You cause the water level of all standing water in the area to rise by as much as 20 feet. If you choose an area in a large body of water, you instead create a 20-foot tall wave that travels from one side of the area to the other and then crashes. Any Huge or smaller vehicles in the wave's path are carried with it to the other side. Any Huge or smaller vehicles struck by the wave have a 25 percent chance of capsizing." + "\n   " + "The water level remains elevated until the spell ends or you choose a different effect. If this effect produces a wave, the wave repeats on the start of your next turn while the flood effect lasts." + "\n   " + toUni("Part Water") + ": You part water in the area and create a trench. The trench extends across the spell's area, and the separated water forms a wall to either side. The trench remains until the spell ends or you choose a different effect. The water then slowly fills in the trench over the course of the next round until the normal water level is restored." + "\n   " + toUni("Redirect Flow") + ": You cause flowing water in the area to move in a direction you choose, even if the water has to flow over obstacles, up walls, or in other unlikely directions. The water in the area moves as you direct it, but once it moves beyond the spell's area, it resumes its flow based on the terrain. The water continues to move in the direction you chose until the spell ends or you choose a different effect." + "\n   " + toUni("Whirlpool") + ": You cause a whirlpool to form in the center of the area, which must be at least 50 feet square and 25 feet deep. The whirlpool lasts until you choose a different effect or the spell ends. The whirlpool is 5 feet wide at the base, up to 50 feet wide at the top, and 25 feet tall. Any creature in the water and within 25 feet of the whirlpool is pulled 10 feet toward it. When a creature enters the whirlpool for the first time on a turn or ends its turn there, it makes a strength saving throw. On a failed save, the creature takes 2d8 Bludgeoning damage. On a successful save, the creature takes half as much damage. A creature can swim away from the whirlpool only if it first takes an action to pull away and succeeds on a Strength (Athletics) check against your spell save DC."
});
legacySpellRefactor("control weather", {
    name: "Control Weather",
    classes: ["cleric", "druid", "wizard"],
    source: [
        ["P24", 257]
    ],
    level: 8,
    school: "Trans",
    time: "10 min",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Burning incense",
    duration: "Conc, 8 h",
    description: "Change weather precipitation, temp, and wind in 5 miles; changes take 1d4\xD710 min; see book",
    descriptionFull: "You take control of the weather within 5 miles of you for the duration. You must be outdoors to cast this spell, and it ends early if you go indoors." + "\n   " + "When you cast the spell, you change the current weather conditions, which are determined by the DM. You can change precipitation, temperature, and wind. It takes 1d4 \xD7 10 minutes for the new conditions to take effect. Once they do so, you can change the conditions again. When the spell ends, the weather gradually returns to normal." + "\n   " + "When you change the weather conditions, find a current condition on the following tables and change its stage by one, up or down. When changing the wind, you can change its direction." + "\n\n" + toUni("Precipitation") + "\n " + toUni("Stage") + "\t" + toUni("Condition") + "\n     " + "1\tClear" + "\n     " + "2\tLight clouds" + "\n     " + "3\tOvercast or ground fog" + "\n     " + "4\tRain, hail or snow" + "\n     " + "5\tTorrential rain, driving hail or blizzard" + "\n\n" + toUni("Temperature") + "\t\t" + toUni("Wind") + "\n " + toUni("Stage") + "\t" + toUni("Condition") + "\t " + toUni("Stage") + "\t" + toUni("Condition") + "\n     " + "1\tHeat wave" + "\t     " + "1\tCalm" + "\n     " + "2\tHot" + "\t\t     " + "2\tModerate wind" + "\n     " + "3\tWarm" + "\t\t     " + "3\tStrong wind" + "\n     " + "4\tCool" + "\t\t     " + "4\tGale" + "\n     " + "5\tCold" + "\t\t     " + "5\tStorm" + "\n     " + "6\tFreezing"
});
legacySpellRefactor("cordon of arrows", {
    name: "Cordon of Arrows",
    classes: ["ranger"],
    source: [
        ["P24", 258]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "An ornamental braid",
    duration: "8 h",
    save: "Dex",
    description: "4+2/SL arrows/bolts in space; undesignated crea enter/end in 30ft, 1 ammo atks; save or 2d4 Piercing",
    descriptionFull: "You touch up to four nonmagical Arrows or Bolts and plant them in the ground in your space. Until the spell ends, the ammunition can't be physically uprooted, and whenever a creature other than you enters a space within 30 feet of the ammunition for the first time on a turn or ends its turn there, one piece of ammunition flies up to strike it. The creature must succeed on a Dexterity saving throw or take 2d4 Piercing damage. The piece of ammunition is then destroyed. The spell ends when none of the ammunition remains planted in the ground." + "\n   " + "When you cast this spell, you can designate any creatures you choose, and the spell ignores them." + AtHigherLevels + "The amount of ammunition that can be affected increases by two for each spell slot level above 2."
});
legacySpellRefactor("counterspell", {
    name: "Counterspell",
    nameShort: "Counterspell*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 258]
    ],
    level: 3,
    school: "Abjur",
    time: "1 rea",
    timeFull: "Reaction, which you take when you see a creature within 60 feet of yourself casting a spell with Verbal, Somatic, or Material components",
    range: "60 ft",
    components: "S",
    duration: "Instantaneous",
    save: "Con",
    description: "Stop spell being cast; target save to keep casting; if fail spell action wasted but spell slot unused",
    descriptionFull: "You attempt to interrupt a creature in the process of casting a spell. The creature makes a Constitution saving throw. On a failed save, the spell dissipates with no effect, and the action, Bonus Action, or Reaction used to cast it is wasted. If that spell was cast with a spell slot, the slot isn't expended."
});
legacySpellRefactor("create food and water", {
    name: "Create Food and Water",
    classes: ["artificer", "cleric", "paladin"],
    source: [
        ["P24", 258]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Create 45 pounds of food and 30 gallons of fresh water on ground/in containers; food lasts 24 hrs",
    descriptionFull: "You create 45 pounds of food and 30 gallons of fresh water on the ground or in containers within range ‚Äî both useful in fending off the hazards of malnutrition and dehydration. The food is bland but nourishing and looks like a food of your choice, and the water is clean. The food spoils after 24 hours if uneaten."
});
legacySpellRefactor("create or destroy water", {
    name: "Create or Destroy Water",
    classes: ["cleric", "druid"],
    source: [
        ["P24", 258]
    ],
    level: 1,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A mix of water and sand",
    duration: "Instantaneous",
    description: "Create/destroy 10+10/SL gal of water in open container or create rain/destroy fog in 30+5ft/SL cu",
    descriptionFull: "You do one of the following." + "\n   " + toUni("Create Water") + ": You create up to 10 gallons of clean water within range in an open container. Alternatively, the water falls as rain in a 30-foot cube within range, extinguishing exposed flames there." + "\n   " + toUni("Destroy Water") + ": You destroy up to 10 gallons of water in an open container within range. Alternatively, you destroy fog in a 30-foot cube within range." + AtHigherLevels + "You create or destroy 10 additional gallons of water, or the size of the Cube increases by 5 feet, for each spell slot level above 1."
});
legacySpellRefactor("create undead", {
    name: "Create Undead",
    classes: ["cleric", "warlock", "wizard"],
    source: [
        ["P24", 258]
    ],
    level: 6,
    school: "Necro",
    time: "1 min",
    range: "10 ft",
    components: "V,S,M\u2020",
    compMaterial: "one 150+ gp black onyx stone for each corpse.",
    duration: "Instantaneous",
    description: "Turn corpses into 3+1/SL ghouls i.a.; control 24h; bns command 120 ft; see B (150gp/corpse cons.)", // i.a. -> inter alia -> among others
    descriptionFull: "You can cast this spell only at night. Choose up to three corpses of Medium or Small Humanoids within range. Each one becomes a Ghoul under your control (see the Monster Manual for its stat block)." + "\n   " + "As a Bonus Action on each of your turns, you can mentally command any creature you animated with this spell if the creature is within 120 feet of you (if you control multiple creatures, you can command any of them at the same time, issuing the same command to them). You decide what action the creature will take and where it will move on its next turn, or you can issue a general command, such as to guard a particular place. If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. Once given an order, the creature continues to follow the order until its task is complete." + "\n   " + "The creature is under your control for 24 hours, after which it stops obeying any command you've given it. To maintain control of the creature for another 24 hours, you must cast this spell on the creature before the current 24-hour period ends. This use of the spell reasserts your control over up to three creatures you have animated with this spell rather than animating new ones." + AtHigherLevels + "If you use a level 7 spell slot, you can animate or reassert control over four Ghouls. If you use a level 8 spell slot, you can animate or reassert control over five Ghouls or two Ghasts or Wights. If you use a level 9 spell slot, you can animate or reassert control over six Ghouls, three Ghasts or Wights, or two Mummies. See the Monster Manual for these stat blocks."
});
legacySpellRefactor("creation", {
    name: "Creation",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 259]
    ],
    level: 5,
    school: "Illus",
    time: "1 min",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A paintbrush",
    duration: "Special",
    description: "Create familiar object up to 5+5ft/SL cube of plant matter, stone, metal, gems or rare metals; see B",
    descriptionFull: "You pull wisps of shadow material from the Shadowfell to create an object within range. It is either an object of vegetable matter (soft goods, rope, wood, and the like) or mineral matter (stone, crystal, metal, and the like). The object must be no larger than a 5-foot Cube, and the object must be of a form and material that you have seen." + "\n   " + "The spell's duration depends on the object's material, as shown in the Materials table. If the object is composed of multiple materials, use the shortest duration. Using any object created by this spell as another spell's Material component causes the other spell to fail." + "\n\n" + toUni("Material") + "\t\t" + toUni("Duration") + "\n" + "Vegetable matter\t1 day" + "\n" + "Stone or crystal\t12 hours" + "\n" + "Precious metals\t1 hour" + "\n" + "Gems\t\t10 minutes" + "\n\n" + "Adamantine/Mithral - 1 minute" + "\n   " + AtHigherLevels + "The Cube increases by 5 feet for each spell slot level above 5."
});
legacySpellRefactor("crown of madness", {
    name: "Crown of Madness",
    nameShort: "Crown of Madness*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 259]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 humanoid save or Charmed; a to maintain; melee atk crea I choose before move; redo save EoT; see B",
    descriptionFull: "One creature that you can see within range must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The creature succeeds automatically if it isn't Humanoid." + "\n   " + "A spectral crown appears on the Charmed target's head, and it must use its action before moving on each of its turns to make a melee attack against a creature other than itself that you mentally choose. The target can act normally on its turn if you choose no creature or if no creature is within its reach. The target repeats the save at the end of each of its turns, ending the spell on itself on a success." + "\n   " + "On your later turns, you must take the Magic action to maintain control of the target, or the spell ends."
});
legacySpellRefactor("crusader's mantle", {
    name: "Crusader's Mantle",
    classes: ["paladin"],
    source: [
        ["P24", 259]
    ],
    level: 3,
    school: "Evoc",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Conc, 1 min",
    description: "While in area, me and allies deal +1d4 Radiant dmg with weapons and unarmed strikes",
    descriptionFull: "You radiate a magical aura in a 30-foot Emanation. While in the aura, you and your allies each deal an extra 1d4 Radiant damage when hitting with a weapon or an Unarmed Strike."
});
legacySpellRefactor("cure wounds", {
    name: "Cure Wounds",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 259]
    ],
    level: 1,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Instantaneous",
    description: "1 creature heals 2d8+2d8/SL+spellcasting ability modifier HP",
    descriptionFull: "A creature you touch regains a number of Hit Points equal to 2d8 plus your spellcasting Ability modifier." + AtHigherLevels + "The healing increases by 2d8 for each spell slot level above 1."
});
legacySpellRefactor("dancing lights", {
    name: "Dancing Lights",
    classes: ["artificer", "bard", "sorcerer", "wizard"],
    source: [
        ["P24", 259]
    ],
    level: 0,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A bit of phosphorous",
    duration: "Conc, 1 min",
    description: "4 torch-sized lights or 1 humanlike Medium light; each emits 10-ft rad dim light; bns to move 60 ft",
    descriptionFull: "You create up to four torch-size lights within range, making them appear as torches, lanterns, or glowing orbs that hover for the duration. Alternatively, you combine the four lights into one glowing Medium form that is vaguely humanlike. Whichever form you choose, each light sheds Dim Light in a 10-foot radius." + "\n   " + "As a Bonus Action, you can move the lights up to 60 feet to a space within range. A light must be within 20 feet of another light created by this spell, and a light vanishes if it exceeds the spell's range."
});
legacySpellRefactor("darkness", {
    name: "Darkness",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 260]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,M",
    compMaterial: "Bat fur and a piece of coal",
    duration: "Conc, 10 min",
    description: "15-ft rad darkness on point or object; Darkvision doesn't work; only magical light of SL 3+ works in it",
    descriptionFull: "For the duration, magical Darkness spreads from a point within range and fills a 15-foot-radius Sphere. Darkvision can't see through it, and nonmagical light can't illuminate it." + "\n   " + "Alternatively, you cast the spell on an object that isn't being worn or carried, causing the Darkness to fill a 15-foot Emanation originating from that object. Covering that object with something opaque, such as a bowl or helm, blocks the Darkness." + "\n   " + "If any of this spell's area overlaps with an area of Bright Light or Dim Light created by a spell of level 2 or lower, that other spell is dispelled."
});
legacySpellRefactor("darkvision", {
    name: "Darkvision",
    classes: ["artificer", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 260]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A dried carrot",
    duration: "8 h",
    description: "1 willing creature has Darkvision 150 ft for the duration",
    descriptionFull: "For the duration, a willing creature you touch has Darkvision with a range of 150 feet."
});
legacySpellRefactor("daylight", {
    name: "Daylight",
    classes: ["sorcerer", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 260]
    ],
    level: 3,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "1 h",
    description: "60-ft rad bright sunlight \u0026 60-ft rad dim on point or obj; only magical darkness of SL 4+ works in it",
    descriptionFull: "For the duration, sunlight spreads from a point within range and fills a 60-foot-radius Sphere. The sunlight's area is Bright Light and sheds Dim Light for an additional 60 feet." + "\n   " + "Alternatively, you cast the spell on an object that isn't being worn or carried, causing the sunlight to fill a 60-foot Emanation originating from that object. Covering that object with something opaque, such as a bowl or helm, blocks the sunlight." + "\n   " + "If any of this spell's area overlaps with an area of Darkness created by a spell of level 3 or lower, that other spell is dispelled."
});
legacySpellRefactor("death ward", {
    name: "Death Ward",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 261]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "8 h",
    description: "First time crea drops to 0 HP it drops to 1 HP instead; or negates first instantaneous kill effect",
    descriptionFull: "You touch a creature and grant it a measure of protection from death. The first time the target would drop to 0 Hit Points before the spell ends, the target instead drops to 1 Hit Point, and the spell ends." + "\n   " + "If the spell is still in effect when the target is subjected to an effect that would kill it instantly without dealing damage, that effect is negated against the target, and the spell ends."
});
legacySpellRefactor("delayed blast fireball", {
    name: "Delayed Blast Fireball",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 261]
    ],
    level: 7,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A ball of bat guano and sulfur",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "Create bead; when conc. ends all 20ft rad 12d6+1d6/SL+1d6/EoT Fire; save 1/2; unattended obj ignite",
    descriptionFull: "A beam of yellow light flashes from you, then condenses at a chosen point within range as a glowing bead for the duration. When the spell ends, the bead explodes, and each creature in a 20-foot-radius Sphere centered on that point makes a Dexterity saving throw. A creature takes Fire damage equal to the total accumulated damage on a failed save or half as much damage on a successful one." + "\n   " + "The spell's base damage is 12d6, and the damage increases by 1d6 whenever your turn ends and the spell hasn't ended." + "\n   " + "If a creature touches the glowing bead before the spell ends, that creature makes a Dexterity saving throw. On a failed save, the spell ends, causing the bead to explode. On a successful save, the creature can throw the bead up to 40 feet. If the thrown bead enters a creature's space or collides with a solid object, the spell ends, and the bead explodes." + "\n   " + "When the bead explodes, flammable objects in the explosion that aren't being worn or carried start burning." + AtHigherLevels + "The base damage increases by 1d6 for each spell slot level above 7.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("demiplane", {
    name: "Demiplane",
    nameShort: "Demiplane*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 261]
    ],
    level: 8,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "S",
    duration: "1 h",
    description: "Create door to 30-ft cu demiplane (new or existing); when spell ends, obj remain, crea choose if stay",
    descriptionFull: "You create a shadowy Medium door on a flat solid surface that you can see within range. This door can be opened and closed, and it leads to a demiplane that is an empty room 30 feet in each dimension, made of wood or stone (your choice)." + "\n   " + "When the spell ends, the door vanishes, and any objects inside the demiplane remain there. Any creatures inside also remain unless they opt to be shunted through the door as it vanishes, landing with the Prone condition in the unoccupied spaces closest to the door's former space." + "\n   " + "Each time you cast this spell, you can create a new demiplane or connect the shadowy door to a demiplane you created with a previous casting of this spell. Additionally, if you know the nature and contents of a demiplane created by a casting of this spell by another creature, you can connect the shadowy door to that demiplane instead."
});
legacySpellRefactor("destructive wave", {
    name: "Destructive Wave",
    classes: ["paladin"],
    source: [
        ["P24", 261]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V",
    duration: "Instantaneous",
    save: "Con",
    description: "Any crea 5d6 Thunder dmg \u0026 5d6 Radiant or Necrotic dmg \u0026 knocked prone; save halves, not prone",
    descriptionShorter: "Any crea 5d6 Thunder dmg \u0026 5d6 Radiant or Necrotic dmg \u0026 prone; save half, not prone",
    descriptionFull: "Destructive energy ripples outward from you in a 30-foot Emanation. Each creature you choose in the Emanation makes a Constitution saving throw. On a failed save, a target takes 5d6 Thunder damage and 5d6 Radiant or Necrotic damage (your choice) and has the Prone condition. On a successful save, a target takes half as much damage only.",
    dynamicDamageBonus: {
        allDmgTypesSingleMoment: true,
        multipleDmgTypes: {
            dmgTypes: ["radiant", "necrotic"],
            inDescriptionAs: "Radiant or Necrotic"
        }
    }
});
legacySpellRefactor("detect evil and good", {
    name: "Detect Evil and Good",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 261]
    ],
    level: 1,
    school: "Div",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Know location of aberration, celestial, elemental, fey, fiend, undead, and Hallow spell in 30ft",
    descriptionFull: "For the duration, you sense the location of any Aberration, Celestial, Elemental, Fey, Fiend, or Undead within 30 feet of yourself. You also sense whether the Hallow spell is active there and, if so, where." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect magic", {
    name: "Detect Magic",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger", "sorcerer", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 262]
    ],
    ritual: true,
    level: 1,
    school: "Div",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Sense magic effects in 30ft; 1 a to see aura on magical object/creature and determine school",
    descriptionFull: "For the duration, you sense the presence of magical effects within 30 feet of yourself. If you sense such effects, you can take the Magic Action to see a faint aura around any visible creature or object in the area that bears the magic, and if an effect was created by a spell, you learn the spell's school of magic." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect poison and disease", {
    name: "Detect Poison and Disease",
    nameShort: "Detect Poison/Disease",
    classes: ["cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 262]
    ],
    ritual: true,
    level: 1,
    school: "Div",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S,M",
    compMaterial: "A yew leaf",
    duration: "Conc, 10 min",
    description: "Know location and type of poisons, poisonous/venomous creatures, and magical contagions in 30 ft",
    descriptionFull: "For the duration, you sense the location of poisons, poisonous or venomous creatures, and magical contagions within 30 feet of yourself. You sense the kind of poison, creature, or contagion in each case." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect thoughts", {
    name: "Detect Thoughts",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 262]
    ],
    level: 2,
    school: "Div",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S,M",
    compMaterial: "A copper piece",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "Sense thinking crea/read 1 vis. crea surface thoughts; 1 a switch/probe (save \u0026 knows, Int (Arcana) end)",
    descriptionFull: "You activate one of the effects below. Until the spell ends, you can activate either effect as a Magic Action on your later turns." + "\n   " + "Sense Thoughts. You sense the presence of thoughts within 30 feet of yourself that belong to creatures that know languages or are telepathic. You don't read the thoughts, but you know that a thinking creature is present." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead." + "\n   " + "Read Thoughts. Target one creature you can see within 30 feet of yourself or one creature within 30 feet of yourself that you detected with the Sense Thoughts option. You learn what is most on the target's mind right now. If the target doesn't know any languages and isn't telepathic, you learn nothing." + "\n   " + "As a Magic action on your next turn, you can try to probe deeper into the target's mind. If you probe deeper, the target makes a Wisdom saving throw. On a failed save, you discern the target's reasoning, emotions, and something that looms large in its mind (such as a worry, love, or hate). On a successful save, the spell ends. Either way, the target knows that you are probing into its mind, and until you shift your attention away from the target's mind, the target can take an action on its turn to make an Intelligence (Arcana) check against your spell save DC, ending the spell on a success."
});
legacySpellRefactor("dimension door", {
    name: "Dimension Door",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 262]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "500 ft",
    components: "V",
    duration: "Instantaneous",
    description: "Teleport myself and 1 willing crea within 5 ft, up to 500 ft to place I can see, visualize or describe",
    descriptionFull: "You teleport to a location within range. You arrive at exactly the spot desired. It can be a place you can see, one you can visualize, or one you can describe by stating distance and direction, such as 200 feet straight downward or 300 feet upward to the northwest at a 45-degree angle." + "\n   " + "You can also teleport one willing creature. The creature must be within 5 feet of you when you teleport, and it teleports to a space within 5 feet of your destination space." + "\n   " + "If you, the other creature, or both would arrive in a space occupied by a creature or completely filled by one or more objects, you and any creature traveling with you each take 4d6 Force damage, and the teleportation fails."
});
legacySpellRefactor("disguise self", {
    name: "Disguise Self",
    classes: ["artificer", "bard", "sorcerer", "wizard"],
    source: [
        ["P24", 262]
    ],
    level: 1,
    school: "Illus",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "1 h",
    description: "Alter appearance with illusion; Int (Investigation) check vs. spell DC to determine disguise",
    descriptionFull: "You make yourself ‚Äî including your clothing, armor, weapons, and other belongings on your person ‚Äî look different until the spell ends. You can seem 1 foot shorter or taller and can appear heavier or lighter. You must adopt a form that has the same basic arrangement of limbs as you have. Otherwise, the extent of the illusion is up to you." + "\n   " + "The changes wrought by this spell fail to hold up to physical inspection. For example, if you use this spell to add a hat to your outfit, objects pass through the hat, and anyone who touches it would feel nothing or would feel your head and hair. If you use this spell to appear thinner than you are, the hand of someone who reaches out to touch you would bump into you while it was seemingly still in midair." + "\n   " + "To discern that you are disguised, a creature can use its action to inspect your appearance and must succeed on an Intelligence (Investigation) check against your spell save DC."
});
legacySpellRefactor("disintegrate", {
    name: "Disintegrate",
    nameShort: "Disintegrate*",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 263]
    ],
    level: 6,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A lodestone and dust",
    duration: "Instantaneous",
    save: "Dex",
    description: "1 crea save or 40+10d6+3d6/SL Force; or destroy up to 10ft cube nonmagical obj/force creation",
    descriptionFull: "You launch a green ray at a target you can see within range. The target can be a creature, a nonmagical object, or a creation of magical force, such as the wall created by Wall of Force." + "\n   " + "A creature targeted by this spell makes a Dexterity saving throw. On a failed save, the target takes 10d6 + 40 Force damage. If this damage reduces it to 0 Hit Points, it and everything nonmagical it is wearing and carrying are disintegrated into gray dust. The target can be revived only by a True Resurrection or a Wish spell." + "\n   " + "This spell automatically disintegrates a Large or smaller nonmagical object or a creation of magical force. If such a target is Huge or larger, this spell disintegrates a 10-foot-Cube portion of it." + AtHigherLevels + "The damage increases by 3d6 for each spell slot level above 6."
});
legacySpellRefactor("dispel evil and good", {
    name: "Dispel Evil and Good",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 263]
    ],
    level: 5,
    school: "Abjur",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "powdered silver and iron",
    duration: "Conc, 1 min",
    description: "Celestial, elem., fey, fiend, undead dis. on atks vs me; a to end for Dismissal/Break enchantment; see B",
    descriptionFull: "For the duration, Celestials, Elementals, Fey, Fiends, and Undead have Disadvantage on attack rolls against you. You can end the spell early by using either of the following special functions." + "\n   " + toUni("Break Enchantment") + ": As a Magic action, you touch a creature that is possessed by or has the Charmed or Frightened condition from one or more creatures of the types above. The target is no longer possessed, Charmed, or Frightened by such creatures." + "\n   " + toUni("Dismissal") + ": As a Magic action, you target one creature you can see within 5 feet of you that has one of the creature types above. The target must succeed on a Charisma saving throw or be sent back to its home plane if it isn't there already. If they aren't on their home plane, Undead are sent to the Shadowfell, and Fey are sent to the Feywild."
});
legacySpellRefactor("dispel magic", {
    name: "Dispel Magic",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 264]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Dispel all spells on crea, obj, or magical effect; if above casting SL, DC 10+SL spellcasting ability chk",
    descriptionFull: "Choose one creature, object, or magical effect within range. Any ongoing spell of level 3 or lower on the target ends. For each ongoing spell of level 4 or higher on the target, make an ability check using your spellcasting ability (DC 10 plus that spell's level). On a successful check, the spell ends." + AtHigherLevels + "You automatically end a spell on the target if the spell's level is equal to or less than the level of the spell slot you use."
});
legacySpellRefactor("dissonant whispers", {
    name: "Dissonant Whispers",
    nameShort: "Dissonant Whispers*",
    classes: ["bard"],
    source: [
        ["P24", 264]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    save: "Wis",
    description: "1 creature 3d6+1d6/SL Psychic dmg and flee via safest route; save for half damage only",
    descriptionFull: "One creature of your choice that you can see within range hears a discordant melody in its mind. The target makes a Wisdom saving throw. On a failed save, it takes 3d6 Psychic damage and must immediately use its Reaction, if available, to move as far away from you as it can, using the safest route. On a successful save, the target takes half as much damage only." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("divination", {
    name: "Divination",
    classes: ["cleric", "druid", "wizard"],
    source: [
        ["P24", 264]
    ],
    ritual: true,
    level: 4,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M\u2020",
    compMaterial: "Incense worth 25+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Receive answer to 1 question about goal, event, or activity to occur within the next 7 days (25gp cons.)",
    descriptionFull: "This spell puts you in contact with a god or a god's servants. You ask one question about a specific goal, event, or activity to occur within 7 days. The DM offers a truthful reply, which might be a short phrase or cryptic rhyme. The spell doesn't account for circumstances that might change the answer, such as the casting of other spells." + "\n   " + "If you cast the spell more than once before finishing a Long Rest, there is a cumulative 25 percent chance for each casting after the first that you get no answer."
});
legacySpellRefactor("divine favor", {
    name: "Divine Favor",
    classes: ["paladin"],
    source: [
        ["P24", 265]
    ],
    level: 1,
    school: "Trans",
    time: "1 bns",
    range: "Self",
    components: "V,S",
    duration: "1 min",
    description: "My weapon attacks deal +1d4 Radiant damage for the duration",
    descriptionFull: "Until the spell ends, your attacks with weapons deal an extra 1d4 Radiant damage on a hit."
});
legacySpellRefactor("divine smite", {
    name: "Divine Smite",
    classes: ["paladin"],
    source: [
        ["P24", 265]
    ],
    level: 1,
    school: "Evoc",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or Unarmed Strike.",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    description: "Melee weapon/unarmed hit deals +2d8+1d8/SL Radiant dmg; fiends \u0026 undead take extra 1d8 Radiant",
    descriptionFull: "The target takes an extra 2d8 Radiant damage from the attack. The damage increases by 1d8 if the target is a Fiend or an Undead." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 1."
});
legacySpellRefactor("divine word", {
    name: "Divine Word",
    classes: ["cleric"],
    source: [
        ["P24", 265]
    ],
    level: 7,
    school: "Evoc",
    time: "1 bns",
    range: "30 ft",
    components: "V",
    duration: "Instantaneous",
    save: "Cha",
    description: "Any crea save or Deaf/Blind/Stunned/Dead based on current HP; banishes extraplanar crea; see B",
    descriptionFull: "You utter a word imbued with power from the Upper Planes. Each creature of your choice in range makes a Charisma saving throw. On a failed save, a target that has 50 Hit Points or fewer suffers an effect based on its current Hit Points, as shown in the Divine Word Effects table." + "\n " + "\u2022 41-50: Deafened for 1 minute" + "\n " + "\u2022 31-40: Deafened and Blinded for 10 minutes" + "\n " + "\u2022 21-30: Blinded, Deafened, and Stunned for 1 hour" + "\n " + "\u2022 0-20: the target dies" + "\n\n" + "Regardless of its Hit Points, a Celestial, an Elemental, a Fey, or a Fiend target that fails its save is forced back to its plane of origin (if it isn't there already) and can't return to the current plane for 24 hours by any means short of a Wish spell."
});
legacySpellRefactor("dominate beast", {
    name: "Dominate Beast",
    nameShort: "Dominate Beast*",
    classes: ["druid", "ranger", "sorcerer"],
    source: [
        ["P24", 265]
    ],
    level: 4,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 beast save or Charmed; redo on dmg; follows telepathic commands; rea to use rea; +SL for dur.",
    descriptionFull: "One Beast you can see within range must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target has Advantage on the save if you or your allies are fighting it. Whenever the target takes damage, it repeats the save, ending the spell on itself on a success." + "\n   " + "You have a telepathic link with the Charmed target while the two of you are on the same plane of existence. On your turn, you can use this link to issue commands to the target (no action required), such as \"Attack that creature,\" \"Move over there,\" or \"Fetch that object.\" The target does its best to obey on its turn. If it completes an order and doesn't receive further direction from you, it acts and moves as it likes, focusing on protecting itself." + "\n   " + "You can command the target to take a Reaction but must take your own Reaction to do so." + AtHigherLevels + "Your Concentration can last longer with a spell slot of level 5 (up to 10 minutes), 6 (up to 1 hour), or 7+ (up to 8 hours)."
});
legacySpellRefactor("dominate monster", {
    name: "Dominate Monster",
    nameShort: "Dominate Monster*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 265]
    ],
    level: 8,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 h",
    save: "Wis",
    description: "1 crea save or Charmed; redo on dmg; follows telepathic commands; rea to use rea; SL9: conc, 8h",
    descriptionFull: "One creature you can see within range must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target has Advantage on the save if you or your allies are fighting it. Whenever the target takes damage, it repeats the save, ending the spell on itself on a success." + "\n   " + "You have a telepathic link with the Charmed target while the two of you are on the same plane of existence. On your turn, you can use this link to issue commands to the target (no action required), such as \"Attack that creature,\" \"Move over there,\" or \"Fetch that object.\" The target does its best to obey on its turn. If it completes an order and doesn't receive further direction from you, it acts and moves as it likes, focusing on protecting itself." + "\n   " + "You can command the target to take a Reaction but must take your own Reaction to do so." + AtHigherLevels + "Your Concentration can last longer with a level 9 spell slot (up to 8 hours)."
});
legacySpellRefactor("dominate person", {
    name: "Dominate Person",
    nameShort: "Dominate Person*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 266]
    ],
    level: 5,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 humanoid save or Charmed; redo on dmg; follows telepathic commands; rea to use rea; +SL for dur.",
    descriptionFull: "One Humanoid you can see within range must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target has Advantage on the save if you or your allies are fighting it. Whenever the target takes damage, it repeats the save, ending the spell on itself on a success." + "\n   " + "You have a telepathic link with the Charmed target while the two of you are on the same plane of existence. On your turn, you can use this link to issue commands to the target (no action required), such as \"Attack that creature,\" \"Move over there,\" or \"Fetch that object.\" The target does its best to obey on its turn. If it completes an order and doesn't receive further direction from you, it acts and moves as it likes, focusing on protecting itself." + "\n   " + "You can command the target to take a Reaction but must take your own Reaction to do so." + AtHigherLevels + "Your Concentration can last longer with a spell slot of level 6 (up to 10 minutes), 7 (up to 1 hour), or 8+ (up to 8 hours)."
});
legacySpellRefactor("dragon's breath", {
    name: "Dragon's Breath",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 266]
    ],
    level: 2,
    school: "Trans",
    time: "1 bns",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A hot pepper",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "1 willing crea: for dur. 1 a exhale 15-ft cone all 3d6+1d6/SL Acid/Cold/Fire/Lightn./Poison; save halves",
    descriptionShorter: "1 willing crea: 1 a 15ft cone all 3d6+1d6/SL Acid/Cold/Fire/Lightn./Poison; save 1/2",
    descriptionFull: "You touch one willing creature, and choose Acid, Cold, Fire, Lightning, or Poison. Until the spell ends, the target can take a Magic action to exhale a 15-foot Cone. Each creature in that area makes a Dexterity saving throw, taking 3d6 damage of the chosen type on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 2.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["acid", "cold", "fire", "lightning", "poison"],
            inDescriptionAs: "Acid/Cold/Fire/Lightn.?/Poison"
        }
    }
});
legacySpellRefactor("drawmij's instant summons", {
    name: "Drawmij's Instant Summons",
    nameShort: "Draw. Instant Sum.",
    nameAlt: "Instant Summons",
    classes: ["wizard"],
    source: [
        ["P24", 266]
    ],
    ritual: true,
    level: 6,
    school: "Conj",
    time: "1 min",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A sapphire worth 1,000+ gp",
    duration: "Till dispelled",
    description: "Link \u226410 lb, \u22646ft obj to sapphire (M); 1 a crush gem to summon the unattended obj or learn of holder",
    descriptionFull: "You touch the sapphire used in the casting and an object weighing 10 pounds or less whose longest dimension is 6 feet or less. The spell leaves an Invisible mark on that object and invisibly inscribes the object's name on the sapphire. Each time you cast this spell, you must use a different sapphire." + "\n   " + "Thereafter, you can take a Magic action to speak the object's name and crush the sapphire. The object instantly appears in your hand regardless of physical or planar distances, and the spell ends." + "\n   " + "If another creature is holding or carrying the object, crushing the sapphire doesn't transport it, but instead you learn who that creature is and where that creature is currently located."
});
legacySpellRefactor("dream", {
    name: "Dream",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 266]
    ],
    level: 5,
    school: "Illus",
    time: "1 min",
    range: "Special",
    components: "V,S,M",
    compMaterial: "A handful of sand",
    duration: "8 h",
    save: "Wis",
    description: "Me/willing crea enters 1 crea dream; communicate for dur. or terrify (save or 3d6 Psych, no LR benefit)",
    descriptionFull: "You target a creature you know on the same plane of existence. You or a willing creature you touch enters a trance state to act as a dream messenger. While in the trance, the messenger is Incapacitated and has a Speed of 0." + "\n   " + "If the target is asleep, the messenger appears in the target's dreams and can converse with the target as long as it remains asleep, through the spell's duration. The messenger can also shape the dream's environment, creating landscapes, objects, and other images. The messenger can emerge from the trance at any time, ending the spell. The target recalls the dream perfectly upon waking." + "\n   " + "If the target is awake when you cast the spell, the messenger knows it and can either end the trance (and the spell) or wait for the target to sleep, at which point the messenger enters its dreams." + "\n   " + "You can make the messenger terrifying to the target. If you do so, the messenger can deliver a message of no more than ten words, and then the target makes a Wisdom saving throw. On a failed save, the target gains no benefit from its rest, and it takes 3d6 Psychic damage when it wakes up."
});
legacySpellRefactor("druidcraft", {
    name: "Druidcraft",
    classes: ["druid"],
    source: [
        ["P24", 266]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Predict weather 24 hrs, grow/bloom tiny plant, harmless sensory effect in 5ft cu, snuff/light small fire",
    descriptionFull: "Whispering to the spirits of nature, you create one of the following effects within range." + "\n " + "\u2022 Weather Sensor. You create a Tiny, harmless sensory effect that predicts what the weather will be at your location for the next 24 hours. The effect might manifest as a golden orb for clear skies, a cloud for rain, falling snowflakes for snow, and so on. This effect persists for 1 round." + "\n " + "\u2022 Bloom. You instantly make a flower blossom, a seed pod open, or a leaf bud bloom." + "\n " + "\u2022 Sensory Effect. You create a harmless sensory effect, such as falling leaves, spectral dancing fairies, a gentle breeze, the sound of an animal, or the faint odor of skunk. The effect must fit in a 5-foot Cube." + "\n " + "\u2022 Fire Play. You light or snuff out a candle, a torch, or a campfire."
});
legacySpellRefactor("earthquake", {
    name: "Earthquake",
    nameShort: "Earthquake*",
    classes: ["cleric", "druid", "sorcerer"],
    source: [
        ["P24", 267]
    ],
    level: 8,
    school: "Trans",
    time: "1 a",
    range: "500 ft",
    components: "V,S,M",
    compMaterial: "A fractured rock",
    duration: "Conc, 1 min",
    description: "Create earthquake in a 100-ft rad, affecting any crea, damaging structures \u0026 creating fissures, see book",
    descriptionFull: "Choose a point on the ground that you can see within range. For the duration, an intense tremor rips through the ground in a 100-foot-radius circle centered on that point. The ground there is Difficult Terrain." + "\n   " + "When you cast this spell and at the end of each of your turns for the duration, each creature on the ground in the area makes a Dexterity saving throw. On a failed save, a creature has the Prone condition, and its Concentration is broken." + "\n   " + "You can also cause the effects below." + "\n   " + "Fissures. A total of 1d6 fissures open in the spell's area at the end of the turn you cast it. You choose the fissures' locations, which can't be under structures. Each fissure is 1d10 \xD7 10 feet deep and 10 feet wide, and it extends from one edge of the spell's area to another edge. A creature in the same space as a fissure must succeed on a Dexterity saving throw or fall in. A creature that successfully saves moves with the fissure's edge as it opens." + "\n   " + "Structures. The tremor deals 50 Bludgeoning damage to any structure in contact with the ground in the area when you cast the spell and at the end of each of your turns until the spell ends. If a structure drops to 0 Hit Points, it collapses." + "\n   " + "A creature within a distance from a collapsing structure equal to half the structure's height makes a Dexterity saving throw. On a failed save, the creature takes 12d6 Bludgeoning damage, has the Prone condition, and is buried in the rubble, requiring a DC 20 Strength (Athletics) check as an action to escape. On a successful save, the creature takes half as much damage only."
});
legacySpellRefactor("eldritch blast", {
    name: "Eldritch Blast",
    classes: ["warlock"],
    source: [
        ["P24", 267]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Spell attack 1d10 Force damage per beam; same or different targets; CL5: 2, CL11: 3, CL17: 4 beams",
    descriptionShorter: "Spell atk beam 1d10 Force; can combine/split beams; CL5:2, CL11:3, CL17:4 beams",
    descriptionCantripDie: "Spell attack for `CD` beam(s), each 1d10 Force damage; same or different targets",
    descriptionFull: "You hurl a beam of crackling energy. Make a ranged spell attack against one creature or object in range. On a hit, the target takes 1d10 Force damage." + "\n   " + toUni("Cantrip Upgrade") + ". The spell creates two beams at level 5, three beams at level 11, and four beams at level 17. You can direct the beams at the same target or at different ones. Make a separate attack roll for each beam.",
    dynamicDamageBonus: {
        multipleDmgMoments: true
    }
});
SpellsList.elementalism = {
    name: "Elementalism",
    classes: ["artificer", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 167]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Create minor effect: strong breeze; dust/sand/word; embers/smoke; mist/water; sculpt element; see B",
    descriptionFull: "You exert control over the elements, creating one of the following effects within range." + "\n   " + "Beckon Air. You create a breeze strong enough to ripple cloth, stir dust, rustle leaves, and close open doors and shutters, all in a 5-foot Cube. Doors and shutters being held open by someone or something aren't affected." + "\n   " + "Beckon Earth. You create a thin shroud of dirt or sand that covers surfaces in a 5-foot-square area, or you cause a single word to appear in your handwriting in a patch of dirt or sand." + "\n   " + "Beckon Fire. You create a thin cloud of harmless embers and colored, scented smoke in a 5-foot Cube. You choose the color and scent, and the embers can light candles, torches, or lamps in the area. The smoke's scent lingers for 1 minute." + "\n   " + "Beckon Water. You create a spray of cool mist that lightly dampens creatures and objects in a 5-foot Cube. Alternatively, you create 1 cup of clean water either in an open container or on a surface, and the water evaporates in 1 minute." + "\n   " + "Sculpt Element. You cause dirt, sand, fire, smoke, mist, or water that can fit in a 1-foot cube to assume a crude shape (such as that of a creature or an object) for 1 hour."
};
legacySpellRefactor("elemental weapon", {
    name: "Elemental Weapon",
    classes: ["artificer", "druid", "paladin", "ranger"],
    source: [
        ["P24", 268]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 h",
    description: "Mundane wea to +1 magic wea; +1d4 Acid/Cold/Fire/Lightn./Thndr dmg; SL5: +2/+2d4, SL7: +3/+3d4",
    descriptionShorter: "+1 wea; +1d4 Acid/Cold/Fire/Lightning/Thunder; SL5: +2/+2d4, SL7: +3/+3d4",
    descriptionFull: "A nonmagical weapon you touch becomes a magic weapon. Choose one of the following damage types: acid, cold, fire, lightning, or thunder. For the duration, the weapon has a +1 bonus to attack rolls and deals an extra 1d4 damage of the chosen type when it hits." + AtHigherLevels + "If you use a level 5‚Äì6 spell slot, the bonus to attack rolls increases to +2, and the extra damage increases to 2d4. If you use a level 7+ spell slot, the bonus increases to +3, and the extra damage increases to 3d4.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["acid", "cold", "fire", "lightning", "thunder"],
            inDescriptionAs: "Acid, Cold, Fire, Lightning, or Thunder|Acid/Cold/Fire/Lightning/Thunder"
        }
    }
});
legacySpellRefactor("enhance ability", {
    name: "Enhance Ability",
    classes: ["artificer", "bard", "cleric", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 268]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "Fur or a feather",
    duration: "Conc, 1 h",
    description: "1+1/SL creature adv. on checks with 1 stat (choose for each target): Str, Dex, Int, Wis, or Cha",
    descriptionFull: "You touch a creature and choose Strength, Dexterity, Intelligence, Wisdom, or Charisma. For the duration, the target has Advantage on ability checks using the chosen ability." + AtHigherLevels + "You can target one additional creature for each spell slot level above 2. You can choose a different ability for each target."
});
legacySpellRefactor("enlarge/reduce", {
    name: "Enlarge/Reduce",
    nameShort: "Enlarge/Reduce*",
    classes: ["artificer", "bard", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 268]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A pinch of powdered iron",
    duration: "Conc, 1 min",
    save: "Con",
    description: "1 crea/obj save or Enlarged (Str adv. +1d4 weapon/unarmed dmg), Reduced (Str disadv; -1d4, min 1)",
    descriptionFull: "For the duration, the spell enlarges or reduces a creature or an object you can see within range (see the chosen effect below). A targeted object must be neither worn nor carried. If the target is an unwilling creature, it can make a Constitution saving throw. On a successful save, the spell has no effect." + "\n   " + "Everything that a targeted creature is wearing and carrying changes size with it. Any item it drops returns to normal size at once. A thrown weapon or piece of ammunition returns to normal size immediately after it hits or misses a target." + "\n   " + toUni("Enlarge") + ": The target's size increases by one category‚Äîfrom Medium to Large, for example. The target also has Advantage on Strength checks and Strength saving throws. The target's attacks with its enlarged weapons or Unarmed Strikes deal an extra 1d4 damage on a hit." + "\n   " + toUni("Reduce") + ": The target's size decreases by one category‚Äîfrom Medium to Small, for example. The target also has Disadvantage on Strength checks and Strength saving throws. The target's attacks with its reduced weapons or Unarmed Strikes deal 1d4 less damage on a hit (this can't reduce the damage below 1).",
    dynamicDamageBonus: {
        doNotProcess: true
    } // Not actual damage from the spell
});
legacySpellRefactor("ensnaring strike", {
    name: "Ensnaring Strike",
    classes: ["ranger"],
    source: [
        ["P24", 268]
    ],
    level: 1,
    school: "Conj",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a creature with a weapon",
    range: "Self",
    components: "V",
    duration: "Conc, 1 min",
    save: "Str",
    description: "Hit crea save (Large adv.) or Restrained, 1d6+1d6/SL Piercing each turn; Str (Ath) chk vs DC to end",
    descriptionShorter: "Hit crea save (Large adv.) or restrained, 1d6+1d6/SL Piercing each turn; Str (Ath) to escape",
    descriptionFull: "As you hit the target, grasping vines appear on it, and it makes a Strength saving throw. A Large or larger creature has Advantage on this save. On a failed save, the target has the Restrained condition until the spell ends. On a successful save, the vines shrivel away, and the spell ends." + "\n   " + "While Restrained, the target takes 1d6 Piercing damage at the start of each of its turns. The target or a creature within reach of it can take an action to make a Strength (Athletics) check against your spell save DC. On a success, the spell ends." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("entangle", {
    name: "Entangle",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 268]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Str",
    description: "20-ft square all but me save or Restrained; Str (Ath) check vs DC to escape; for duration area is dif. ter.",
    descriptionFull: "Grasping plants sprout from the ground in a 20-foot square within range. For the duration, these plants turn the ground in the area into Difficult Terrain. They disappear when the spell ends." + "\n   " + "Each creature (other than you) in the area when you cast the spell must succeed on a Strength saving throw or have the Restrained condition until the spell ends. A Restrained creature can take an action to make a Strength (Athletics) check against your spell save DC. On a success, it frees itself from the grasping plants and is no longer Restrained by them."
});
legacySpellRefactor("enthrall", {
    name: "Enthrall",
    nameShort: "Enthrall*",
    classes: ["bard", "warlock"],
    source: [
        ["P24", 269]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "Any creature save (auto pass if fighting) or -10 on Wis (Perception) chks and Passive Perception",
    descriptionFull: "You weave a distracting string of words, causing creatures of your choice that you can see within range to make a Wisdom saving throw. Any creature you or your companions are fighting automatically succeeds on this save. On a failed save, a target has a -10 penalty to Wisdom (Perception) checks and Passive Perception until the spell ends."
});
legacySpellRefactor("etherealness", {
    name: "Etherealness",
    classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 269]
    ],
    level: 7,
    school: "Conj",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "8 h",
    description: "Me or 3/SL willing crea in 10ft to Ethereal Plane for duration; can perceive 60ft into source plane",
    descriptionFull: "You step into the border regions of the Ethereal Plane, where it overlaps with your current plane. You remain in the Border Ethereal for the duration. During this time, you can move in any direction. If you move up or down, every foot of movement costs an extra foot. You can perceive the plane you left, which looks gray, and you can't see anything there more than 60 feet away." + "\n   " + "While on the Ethereal Plane, you can affect and be affected only by creatures, objects, and effects on that plane. Creatures that aren't on the Ethereal Plane can't perceive or interact with you unless a feature gives them the ability to do so." + "\n   " + "You ignore all objects and effects that aren't on the Ethereal Plane, allowing you to move through objects you perceive on the plane you originated from." + "\n   " + "When the spell ends, you return to the plane you left in the spot that corresponds to your space in the Border Ethereal. If you appear in an occupied space, you are shunted to the nearest unoccupied space and take Force damage equal to twice the number of feet you are moved." + "\n   " + "This spell ends instantly if you cast it while you are on the Ethereal Plane or a plane that doesn't border it, such as one of the Outer Planes." + AtHigherLevels + "You can target up to three willing creatures (including yourself) for each spell slot level above 7. The creatures must be within 10 feet of you when you cast the spell."
});
legacySpellRefactor("evard's black tentacles", {
    name: "Evard's Black Tentacles",
    nameShort: "Evard's Black Tentacles*",
    nameAlt: "Black Tentacles",
    classes: ["wizard"],
    source: [
        ["P24", 270]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "A tentacle",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "20-ft vis. sq. dif. ter.; all now/enter/end save or Restrained \u0026 3d6 Bludg. (1/t/c); Str (Ath) chk to escape",
    descriptionShorter: "20-ft sq dif. ter.; now/enter/end save or restrained \u0026 3d6 Bludg. (1/t/c); Str (Ath) chk escape",
    descriptionFull: "Squirming, ebony tentacles fill a 20-foot square on ground that you can see within range. For the duration, these tentacles turn the ground in that area into Difficult Terrain." + "\n   " + "Each creature in that area makes a Strength saving throw. On a failed save, it takes 3d6 Bludgeoning damage, and it has the Restrained condition until the spell ends. A creature also makes that save if it enters the area or ends it turn there. A creature makes that save only once per turn." + "\n   " + "A Restrained creature can take an action to make a Strength (Athletics) check against your spell save DC, ending the condition on itself on a success."
});
legacySpellRefactor("expeditious retreat", {
    name: "Expeditious Retreat",
    classes: ["artificer", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 270]
    ],
    level: 1,
    school: "Trans",
    time: "1 bns",
    range: "Self",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "I can take the Dash action now and as a bonus action for the duration",
    descriptionFull: "You take the Dash action, and until the spell ends, you can take that action again as a Bonus Action."
});
legacySpellRefactor("eyebite", {
    name: "Eyebite",
    nameShort: "Eyebite*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 270]
    ],
    level: 6,
    school: "Necro",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 crea in 60 ft save vs Unconscious, Frightened, or Poisoned. 1 a target another crea that hasn't saved",
    descriptionFull: "For the duration, your eyes become an inky void. One creature of your choice within 60 feet of you that you can see must succeed on a Wisdom saving throw or be affected by one of the following effects of your choice for the duration." + "\n   " + "On each of your turns until the spell ends, you can take a Magic action to target another creature but can't target a creature again if it has succeeded on a save against this casting of the spell." + "\n   " + toUni("Asleep") + ": The target has the Unconscious condition. It wakes up if it takes any damage or if another creature takes an action to shake it awake." + "\n   " + toUni("Panicked") + ": The target has the Frightened condition. On each of its turns, the Frightened target must take the Dash action and move away from you by the safest and shortest route available. If the target moves to a space at least 60 feet away from you where it can't see you, this effect ends." + "\n   " + toUni("Sickened") + ": The target has the Poisoned condition."
});
legacySpellRefactor("fabricate", {
    name: "Fabricate",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 271]
    ],
    level: 4,
    school: "Trans",
    time: "10 min",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Create \u2264Large object from raw materials (10 ft cu or 8 5ft cu); or complex obj if prof. in right tools",
    descriptionFull: "You convert raw materials into products of the same material. For example, you can fabricate a wooden bridge from a clump of trees, a rope from a patch of hemp, or clothes from flax or wool." + "\n   " + "Choose raw materials that you can see within range. You can fabricate a Large or smaller object (contained within a 10-foot Cube or eight connected 5-foot Cubes) given a sufficient quantity of material. If you're working with metal, stone, or another mineral substance, however, the fabricated object can be no larger than Medium (contained within a 5-foot Cube). The quality of any fabricated objects is based on the quality of the raw materials." + "\n   " + "Creatures and magic items can't be created by this spell. You also can't use it to create items that require a high degree of skill‚Äîsuch as weapons and armor‚Äîunless you have proficiency with the type of Artisan's Tools used to craft such objects."
});
legacySpellRefactor("faerie fire", {
    name: "Faerie Fire",
    classes: ["artificer", "bard", "druid"],
    source: [
        ["P24", 271]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "20-ft cube all obj/crea save or emit 10 ft dim light and attacks have adv.; no benefit from Invisible",
    descriptionFull: "Objects in a 20-foot Cube within range are outlined in blue, green, or violet light (your choice). Each creature in the Cube is also outlined if it fails a Dexterity saving throw. For the duration, objects and affected creatures shed Dim Light in a 10-foot radius and can't benefit from the Invisible condition." + "\n   " + "Attack rolls against an affected creature or object have Advantage if the attacker can see it."
});
legacySpellRefactor("false life", {
    name: "False Life",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 271]
    ],
    level: 1,
    school: "Necro",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A drop of alcohol",
    duration: "Instantaneous",
    description: "I gain 2d4+4+5/SL temporary hit points.",
    descriptionFull: "You gain 2d4 + 4 Temporary Hit Points." + AtHigherLevels + "You gain 5 additional Temporary Hit Points for each spell slot level above 1."
});
legacySpellRefactor("fear", {
    name: "Fear",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 271]
    ],
    level: 3,
    school: "Illus",
    time: "1 a",
    range: "S:30ft cone",
    components: "V,S,M",
    compMaterial: "A white feather",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "All crea save or drop held items and Frightened; Dash away; extra save at EoT if no line of sight",
    descriptionFull: "Each creature in a 30-foot Cone must succeed on a Wisdom saving throw or drop whatever it is holding and have the Frightened condition for the duration." + "\n   " + "A Frightened creature takes the Dash action and moves away from you by the safest route on each of its turns unless there is nowhere to move. If the creature ends its turn in a space where it doesn't have line of sight to you, the creature makes a Wisdom saving throw. On a successful save, the spell ends on that creature."
});
legacySpellRefactor("feather fall", {
    name: "Feather Fall",
    classes: ["artificer", "bard", "sorcerer", "wizard"],
    source: [
        ["P24", 271]
    ],
    level: 1,
    school: "Trans",
    time: "1 rea",
    timeFull: "Reaction, which you take when you or a creature you can see within 60 feet of you falls",
    range: "60 ft",
    components: "V,M",
    compMaterial: "A small feather or piece of down",
    duration: "1 min",
    description: "5 creatures descend only 60 ft/rnd for duration or until land, taking no falling damage",
    descriptionFull: "Choose up to five falling creatures within range. A falling creature's rate of descent slows to 60 feet per round until the spell ends. If a creature lands before the spell ends, the creature takes no damage from the fall, and the spell ends for that creature."
});
legacySpellRefactor("feign death", {
    name: "Feign Death",
    classes: ["bard", "cleric", "druid", "wizard"],
    source: [
        ["P24", 271]
    ],
    ritual: true,
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A pinch of graveyard dirt",
    duration: "1 h",
    description: "Willing crea looks dead: Blinded, Incapacitated, resist. all dmg but Psychic, speed 0, immune Poisoned",
    descriptionFull: "You touch a willing creature and put it into a cataleptic state that is indistinguishable from death." + "\n   " + "For the duration, the target appears dead to outward inspection and to spells used to determine the target's status. The target has the Blinded and Incapacitated conditions, and its Speed is 0." + "\n   " + "The target also has Resistance to all damage except Psychic damage, and it has Immunity to the Poisoned condition."
});
legacySpellRefactor("find familiar", {
    name: "Find Familiar",
    classes: ["wizard"],
    source: [
        ["P24", 272]
    ],
    ritual: true,
    level: 1,
    school: "Conj",
    time: "1 h",
    range: "10 ft",
    components: "V,S,M\u2020",
    compMaterial: "burning incense worth 10+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Gain the services of a familiar; bns see through its eyes; it can deliver touch spells; see B (10gp cons.)",
    descriptionFull: "You gain the service of a familiar, a spirit that takes an animal form you choose: Bat, Cat, Frog, Hawk, Lizard, Octopus, Owl, Rat, Raven, Spider, Weasel, or another Beast that has a Challenge Rating of 0. Appearing in an unoccupied space within range, the familiar has the statistics of the chosen form (see appendix B), though it is a Celestial, Fey, or Fiend (your choice) instead of a Beast. Your familiar acts independently of you, but it obeys your commands." + "\n   " + "Telepathic Connection. While your familiar is within 100 feet of you, you can communicate with it telepathically. Additionally, as a Bonus Action, you can see through the familiar's eyes and hear what it hears until the start of your next turn, gaining the benefits of any special senses it has." + "\n   " + "Finally, when you cast a spell with a range of touch, your familiar can deliver the touch. Your familiar must be within 100 feet of you, and it must take a Reaction to deliver the touch when you cast the spell." + "\n   " + "Combat. The familiar is an ally to you and your allies. It rolls its own Initiative and acts on its own turn. A familiar can't attack, but it can take other actions as normal." + "\n   " + "Disappearance of the Familiar. When the familiar drops to 0 Hit Points, it disappears. It reappears after you cast this spell again. As a Magic action, you can temporarily dismiss the familiar to a pocket dimension. Alternatively, you can dismiss it forever. As a Magic action while it is temporarily dismissed, you can cause it to reappear in an unoccupied space within 30 feet of you. Whenever the familiar drops to 0 Hit Points or disappears into the pocket dimension, it leaves behind in its space anything it was wearing or carrying." + "\n   " + "One Familiar Only. You can't have more than one familiar at a time. If you cast this spell while you have a familiar, you instead cause it to adopt a new eligible form."
});
legacySpellRefactor("find steed", {
    name: "Find Steed",
    classes: ["paladin"],
    source: [
        ["P24", 272]
    ],
    level: 2,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Gain otherworldly steed; telepathic bond; share initiative \u0026 healing spells; controlled if mount; see B",
    descriptionFull: "You summon an otherworldly being that appears as a loyal steed in an unoccupied space of your choice within range. This creature uses the Otherworldly Steed stat block. If you already have a steed from this spell, the steed is replaced by the new one." + "\n   " + "The steed resembles a Large, rideable animal of your choice, such as a horse, a camel, a dire wolf, or an elk. Whenever you cast the spell, choose the steed's creature type ‚Äî Celestial, Fey, or Fiend ‚Äî which determines certain traits in the stat block." + "\n   " + "Combat. The steed is an ally to you and your allies. In combat, it shares your Initiative count, and it functions as a controlled mount while you ride it (as defined in the rules on mounted combat). If you have the Incapacitated condition, the steed takes its turn immediately after yours and acts independently, focusing on protecting you." + "\n   " + "Disappearance of the Steed. The steed disappears if it drops to 0 Hit Points or if you die. When it disappears, it leaves behind anything it was wearing or carrying, if you cast this spell again, you decide whether you summon the steed that disappeared or a different one." + "\n   " + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("find the path", {
    name: "Find the Path",
    classes: ["bard", "cleric", "druid"],
    source: [
        ["P24", 273]
    ],
    level: 6,
    school: "Div",
    time: "1 min",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "A set of divination tools - such as cards or runes - worth 100+ gp",
    duration: "Conc, 1 day",
    description: "I know the direction, distance \u0026 shortest route to familiar immobile location on same plane (100gp)",
    descriptionFull: "You magically sense the most direct physical route to a location you name. You must be familiar with the location, and the spell fails if you name a destination on another plane of existence, a moving destination (such as a mobile fortress), or an unspecific destination (such as \"a green dragon's lair\")." + "\n   " + "For the duration, as long as you are on the same plane of existence as the destination, you know how far it is and in what direction it lies. Whenever you face a choice of paths along the way there, you know which path is the most direct."
});
legacySpellRefactor("find traps", {
    name: "Find Traps",
    classes: ["cleric", "druid", "ranger"],
    source: [
        ["P24", 273]
    ],
    level: 2,
    school: "Div",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Sense presence of any trap in line of sight; not exact location, but general nature of trap",
    descriptionFull: "You sense any trap within range that is within line of sight. A trap, for the purpose of this spell, includes any object or mechanism that was created to cause damage or other danger. Thus, the spell would sense the Alarm or Glyph of Warding spell or a mechanical pit trap, but it wouldn't reveal a natural weakness in the floor, an unstable ceiling, or a hidden sinkhole." + "\n   " + "This spell reveals that a trap is present but not its location. You do learn the general nature of the danger posed by a trap you sense."
});
legacySpellRefactor("finger of death", {
    name: "Finger of Death",
    nameShort: "Finger of Death*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 273]
    ],
    level: 7,
    school: "Necro",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Con",
    description: "1 crea 7d8+30 Necrotic dmg; save halves; humanoid killed becomes zombie under my command",
    descriptionFull: "You unleash negative energy toward a creature you can see within range. The target makes a Constitution saving throw, taking 7d8 + 30 Necrotic damage on a failed save or half as much damage on a successful one." + "\n   " + "A Humanoid killed by this spell rises at the start of your next turn as a Zombie (see appendix B) that follows your verbal orders."
});
legacySpellRefactor("fireball", {
    name: "Fireball",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 274]
    ],
    level: 3,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A ball of bat guano and sulfur",
    duration: "Instantaneous",
    save: "Dex",
    description: "20-ft rad all crea 8d6+1d6/SL Fire dmg; save halves; unattended flammable objects ignite",
    descriptionFull: "A bright streak flashes from you to a point you choose within range and then blossoms with a low roar into a fiery explosion. Each creature in a 20-foot-radius Sphere centered on that point makes a Dexterity saving throw, taking 8d6 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "Flammable objects in the area that aren't being worn or carried start burning." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 3."
});
legacySpellRefactor("fire bolt", {
    name: "Fire Bolt",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 274]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Spell attack for 1d10 Fire dmg; unattended flammable objects ignite; +1d10 at CL 5, 11, and 17",
    descriptionCantripDie: "Spell attack for `CD`d10 Fire dmg; unattended flammable objects ignite",
    descriptionFull: "You hurl a mote of fire at a creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 fire damage. A flammable object hit by this spell starts burning if it isn't being worn or carried." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d10 when you reach levels 5 (2d10), 11 (3d10), and 17 (4d10)."
});
legacySpellRefactor("fire shield", {
    name: "Fire Shield",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 274]
    ],
    level: 4,
    school: "Evoc",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A bit of phosphorous or a firefly",
    duration: "10 min",
    description: "Resist Fire or Cold; 2d8 of other dmg type to melee atkers if hit in 5ft; 10-ft rad bright/10-ft dim light",
    descriptionShorter: "Fiery shield; Fire or Cold resist; 2d8 of other dmg to melee atkers in 5ft; 10ft bright/10ft dim",
    descriptionFull: "Wispy flames wreathe your body for the duration, shedding Bright Light in a 10-foot radius and Dim Light for an additional 10 feet." + "\n   " + "The flames provide you with a warm shield or a chill shield, as you choose. The warm shield grants you Resistance to Cold damage, and the chill shield grants you Resistance to Fire damage." + "\n   " + "In addition, whenever a creature within 5 feet of you hits you with a melee attack roll, the shield erupts with flame. The attacker takes 2d8 Fire damage from a warm shield, or 2d8 Cold damage from a cold shield.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["cold", "fire"],
            inDescriptionAs: "of other|of the other"
        }
    }
});
legacySpellRefactor("fire storm", {
    name: "Fire Storm",
    classes: ["cleric", "druid", "sorcerer"],
    source: [
        ["P24", 275]
    ],
    level: 7,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "10 connected 10-ft cubes all crea 7d10 Fire dmg; save halves; unattended flammable objects ignite",
    descriptionFull: "A storm of fire appears within range. The area of the storm consists of up to ten 10-foot Cubes, which you arrange as you like. Each Cube must be contiguous with at least one other Cube. Each creature in the area makes a Dexterity saving throw, taking 7d10 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "Flammable objects in the area that aren't being worn or carried start burning."
});
legacySpellRefactor("flame blade", {
    name: "Flame Blade",
    classes: ["druid", "sorcerer"],
    source: [
        ["P24", 275]
    ],
    level: 2,
    school: "Evoc",
    time: "1 bns",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Leaf of sumac",
    duration: "Conc, 10 min",
    description: "Summon blade; 1 a melee spell atk for 3d6+1d6/2SL+spell mod Fire; 10ft rad bright/10ft dim light",
    descriptionShorter: "Summon fiery blade; 1 a melee spell atk 3d6+1d6/2SL+mod Fire; 10ft bright/10ft dim",
    descriptionFull: "You evoke a fiery blade in your free hand. The blade is similar in size and shape to a scimitar, and it lasts for the duration. If you let go of the blade, it disappears, but you can evoke it again as a Bonus Action." + "\n   " + "As a Magic action, you can make a melee spell attack with the fiery blade. On a hit, the target takes Fire damage equal to 3d6 plus your spellcasting ability modifier." + "\n   " + "The flaming blade sheds Bright Light in a 10-foot radius and Dim Light for an additional 10 feet." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 2."
});
legacySpellRefactor("flame strike", {
    name: "Flame Strike",
    classes: ["cleric"],
    source: [
        ["P24", 275]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "Pinch of sulfur",
    duration: "Instantaneous",
    save: "Dex",
    description: "10-ft rad 40-ft high cyl. all crea 5d6 Fire and 5d6 Radiant; save halves; +1d6/SL Fire and Radiant",
    descriptionShorter: "10ft rad 40ft high all crea 5d6 Fire and 5d6 Radiant; save half; +1d6/SL both",
    descriptionFull: "A vertical column of brilliant fire roars down from above. Each creature in a 10-foot-radius, 40-foot-high Cylinder centered on a point within range makes a Dexterity saving throw, taking 5d6 Fire damage and 5d6 Radiant damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The Fire damage and the Radiant damage increase by 1d6 for each spell slot level above 5.",
    dynamicDamageBonus: {
        allDmgTypesSingleMoment: true
    }
});
legacySpellRefactor("flaming sphere", {
    name: "Flaming Sphere",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 275]
    ],
    level: 2,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A ball of wax",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "5ft dia fiery sphere; 20ft bright/20ft dim; bns move 30ft; if crea hit/end in 5ft 2d6+1d6/SL Fire; save 1/2",
    descriptionShorter: "5ft dia fiery sphere; bns move 30 ft; if hit/end in 5ft 2d6+1d6/SL Fire; save 1/2",
    descriptionFull: "You create a 5-foot-diameter sphere of fire in an unoccupied space on the ground within range. It lasts for the duration. Any creature that ends its turn within 5 feet of the sphere makes a Dexterity saving throw, taking 2d6 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "As a Bonus Action, you can move the sphere up to 30 feet, rolling it along the ground. If you move the sphere into a creature's space, that creature makes the save against the sphere, and the sphere stops moving for the turn." + "\n   " + "When you move the sphere, you can direct it over barriers up to 5 feet tall and jump it across pits up to 10 feet wide. Flammable objects that aren't being worn or carried start burning if touched by the sphere, and it sheds Bright Light in a 20-foot radius and Dim Light for an additional 20 feet." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 2."
});
legacySpellRefactor("flesh to stone", {
    name: "Flesh to Stone",
    nameShort: "Flesh to Stone*",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 275]
    ],
    level: 6,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A cockatrice feather",
    duration: "Conc, 1 min",
    save: "Con",
    description: "1 crea save or Restrained; EoT save until 3 fails: Petrified, or 3 successes: free; if full duration perm.",
    descriptionFull: "You attempt to turn one creature that you can see within range into stone. The target makes a Constitution saving throw. On a failed save, it has the Restrained condition for the duration. On a successful save, its Speed is 0 until the start of your next turn. Constructs automatically succeed on the save." + "\n   " + "A Restrained target makes another Constitution saving throw at the end of each of its turns. If it successfully saves against this spell three times, the spell ends. If it fails its saves three times, it is turned to stone and has the Petrified condition for the duration. The successes and failures needn't be consecutive; keep track of both until the target collects three of a kind." + "\n   " + "If you maintain your Concentration on this spell for the entire possible duration, the target is Petrified until the condition is ended by Greater Restoration or similar magic."
});
legacySpellRefactor("fly", {
    name: "Fly",
    classes: ["artificer", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 276]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A feather",
    duration: "Conc, 10 min",
    description: "1+1/SL willing creatures gain 60 feet fly speed and hover",
    descriptionFull: "You touch a willing creature. For the duration, the target gains a Fly Speed of 60 feet and can hover. When the spell ends, the target falls if it is still aloft unless it can stop the fall." + AtHigherLevels + "You can target one additional creature for each spell slot level above 3."
});
legacySpellRefactor("fog cloud", {
    name: "Fog Cloud",
    classes: ["druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 276]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 1 h",
    description: "20ft + 20ft/SL radius fog that heavily obscures area; dispersed by strong wind",
    descriptionFull: "You create a 20-foot-radius Sphere of fog centered on a point within range. The Sphere is Heavily Obscured. It lasts for the duration or until a strong wind (such as one created by Gust of Wind) disperses it." + AtHigherLevels + "The fog's radius increases by 20 feet for each spell slot level above 1."
});
legacySpellRefactor("forbiddance", {
    name: "Forbiddance",
    classes: ["cleric"],
    source: [
        ["P24", 276]
    ],
    ritual: true,
    level: 6,
    school: "Abjur",
    time: "10 min",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "ruby dust worth 1000+ gp",
    duration: "1 day",
    description: "40k sq ft 30ft high no extraplanar travel; 1 crea type 5d10 Radiant/Necrotic enters/ends (1000gp)",
    descriptionMetric: "3,7k m2 9-m high no extraplanar travel; 1 crea type 5d10 Radiant or Necrotic enters/ends turn (1000gp)",
    descriptionShorter: "40k sq ft 30ft high no planar travel; 1 crea type 5d10 Radiant/Necro. enters/end (1k gp)",
    descriptionShorterMetric: "3,6k m2 9-m high no planar travel; 1 crea type 5d10 Radiant/Necro. enters/end (1k gp)",
    descriptionFull: "You create a ward against magical travel that protects up to 40,000 square feet of floor space to a height of 30 feet above the floor. For the duration, creatures can't teleport into the area or use portals, such as those created by the gate spell, to enter the area. The spell proofs the area against planar travel, and therefore prevents creatures from accessing the area by way of the Astral Plane, the Ethereal Plane, the Feywild, the Shadowfell, or the Plane Shift spell." + "\n   " + "In addition, the spell damages types of creatures that you choose when you cast it. Choose one or more of the following: Aberrations, Celestials, Elementals, Fey, Fiends, and Undead. When a creature of a chosen type enters the spell's area for the first time on a turn or ends its turn there, the creature takes 5d10 Radiant or Necrotic damage (your choice when you cast this spell)." + "\n   " + "You can designate a password when you cast the spell. A creature that speaks the password as it enters the area takes no damage from the spell." + "\n   " + "The spell's area can't overlap with the area of another forbiddance spell. If you cast forbiddance every day for 30 days in the same location, the spell lasts until it is dispelled, and the material components are consumed on the last casting.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["radiant", "necrotic"],
            inDescriptionAs: "Radiant/Necrotic|Radiant/Necro\\.|Radiant or Necrotic"
        }
    }
});
legacySpellRefactor("forcecage", {
    name: "Forcecage",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 276]
    ],
    level: 7,
    school: "Evoc",
    time: "1 a",
    range: "100 ft",
    components: "V,S,M\u0192",
    compMaterial: "Ruby dust worth 1,500+ gp, which the spell consumes",
    duration: "Conc, 1 h",
    save: "Cha",
    description: "20-ft cu cage or 10-ft cu solid box; blocks spells; teleport or extraplanar travel in/out if save (1500gp)",
    descriptionFull: "An immobile, invisible, cube-shaped prison composed of magical force springs into existence around an area you choose within range. The prison can be a cage or a solid box, as you choose." + "\n   " + "A prison in the shape of a cage can be up to 20 feet on a side and is made from 1/2-inch diameter bars spaced 1/2 inch apart." + "\n   " + "A prison in the shape of a box can be up to 10 feet on a side, creating a solid barrier that prevents any matter from passing through it and blocking any spells cast into or out from the area." + "\n   " + "When you cast the spell, any creature that is completely inside the cage's area is trapped. Creatures only partially within the area, or those too large to fit inside it, are pushed away from the center of the area until they are completely outside it." + "\n   " + "A creature inside the cage can't leave it by nonmagical means. If the creature tries to use teleportation or interplanar travel to leave, it must first make a Charisma saving throw. On a successful save, the creature can use that magic to exit the cage. On a failed save, the creature doesn't exit the cage and wastes the spell or effect. The cage also extends into the Ethereal Plane, blocking ethereal travel." + "\n   " + "This spell can't be dispelled by dispel magic."
});
legacySpellRefactor("foresight", {
    name: "Foresight",
    classes: ["bard", "druid", "warlock", "wizard"],
    source: [
        ["P24", 276]
    ],
    level: 9,
    school: "Div",
    time: "1 min",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A hummingbird feather",
    duration: "8 h",
    description: "1 willing creature adv. on attacks, checks and saves; attackers dis. vs. them; ends if cast again",
    descriptionFull: "You touch a willing creature and bestow a limited ability to see into the immediate future. For the duration, the target has Advantage on d20 Tests, and other creatures have Disadvantage on attack rolls against it. The spell ends early if you cast it again."
});
legacySpellRefactor("fount of moonlight", {
    name: "Fount of Moonlight",
    classes: ["bard", "druid"],
    source: [
        ["P24", 277]
    ],
    level: 4,
    school: "Evoc",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 10 mins",
    save: "Con",
    description: "20/20 light; resist Rad.; melee atk +2d6 Rad.; 60ft rea if vis. crea dmgs me, save or Blind to my next EoT",
    descriptionFull: "A cool light wreathes your body for the duration, emitting Bright Light in a 20-foot radius and Dim Light for an additional 20 feet." + "\n   " + "Until the spell ends, you have Resistance to Radiant damage, and your melee attacks deal an extra 2d6 Radiant damage on a hit." + "\n   " + "In addition, immediately after you take damage from a creature you can see within 60 feet of yourself, you can take a Reaction to force the creature to make a Constitution saving throw. On a failed save, the creature has the Blinded condition until the end of your turn."
});
legacySpellRefactor("freedom of movement", {
    name: "Freedom of Movement",
    classes: ["artificer", "bard", "cleric", "druid", "ranger"],
    source: [
        ["P24", 277]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A leather strap",
    duration: "1 h",
    description: "1+1/SL crea; swim spd; magic can't lower spd, paralyze, restrain; 5ft to leave nonmagic restraints",
    descriptionFull: "You touch a willing creature. For the duration, the target's movement is unaffected by Difficult Terrain, and spells and other magical effects can neither reduce the target's speed nor cause the target to have the Paralyzed or Restrained conditions. The target also has a Swim Speed equal to its Speed." + "\n   " + "In addition, the target can spend 5 feet of movement to automatically escape from nonmagical restraints, such as manacles or a creature imposing the Grappled condition on it." + AtHigherLevels + "You can target one additional creature for each spell slot level above 4."
});
legacySpellRefactor("friends", {
    name: "Friends",
    nameShort: "Friends*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 277]
    ],
    level: 0,
    school: "Ench",
    time: "1 a",
    range: "10 feet",
    components: "S,M",
    compMaterial: "some makeup",
    duration: "Conc, 1 min",
    description: "1 non-hostile humanoid save or Charmed (once/day); ends if dmged/I atk, dmg, force save; knows after",
    descriptionFull: "You magically emanate a sense of friendship toward one creature you can see within range. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target succeeds automatically if it isn't a Humanoid, if you're fighting it, or if you have cast this spell on it within the past 24 hours." + "\n   " + "The spell ends early if the target takes damage or if you make an attack roll, deal damage, or force anyone to make a saving throw. When the spell ends, the target knows it was Charmed by you."
});
legacySpellRefactor("gaseous form", {
    name: "Gaseous Form",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 277]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A bit of gauze",
    duration: "Conc, 1 h",
    description: "1+1/SL willing crea into mist; fly 10ft, resist. physical dmg, adv. on Str/Dex/Con saves; 1 a/0 hp revert",
    descriptionFull: "A willing creature you touch shape-shifts, along with everything it's wearing and carrying, into a misty cloud for the duration. The spell ends on the target if it drops to 0 Hit Points or if it takes a Magic action to end the spell on itself." + "\n   " + "While in this form, the target's only method of movement is a Fly Speed of 10 feet, and it can hover. The target can enter and occupy the space of another creature. The target has Resistance to Bludgeoning, Piercing, and Slashing damage; it has Immunity to the Prone condition; and it has Advantage on Strength, Dexterity, and Constitution saving throws. The target can pass through narrow openings, but it treats liquids as though they were solid surfaces." + "\n   " + "The target can't talk or manipulate objects, and any objects it was carrying or holding can't be dropped, used, or otherwise interacted with. Finally, the target can't attack or cast spells." + AtHigherLevels + "You can target one additional creature for each spell slot level above 3."
});
legacySpellRefactor("gate", {
    name: "Gate",
    nameShort: "Gate*",
    classes: ["cleric", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 277]
    ],
    level: 9,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M\u0192",
    compMaterial: "A diamond worth 5,000+ gp",
    duration: "Conc, 1 min",
    description: "Create a 5ft-20ft portal to precise location on other plane; can transport named crea to me (5000gp)",
    descriptionFull: "You conjure a portal linking an unoccupied space you can see within range to a precise location on a different plane of existence. The portal is a circular opening, which you can make 5 to 20 feet in diameter. You can orient the portal in any direction you choose. The portal lasts for the duration, and the portal's destination is visible through it." + "\n   " + "The portal has a front and a back on each plane where it appears. Travel through the portal is possible only by moving through its front. Anything that does so is instantly transported to the other plane, appearing in the unoccupied space nearest to the portal." + "\n   " + "Deities and other planar rulers can prevent portals created by this spell from opening in their presence or anywhere within their domains." + "\n   " + "When you cast this spell, you can speak the name of a specific creature (a pseudonym, title, or nickname doesn't work). If that creature is on a plane other than the one you are on, the portal opens next to the named creature and transports it to the nearest unoccupied space on your side of the portal. You gain no special power over the creature, and it is free to act as the DM deems appropriate. It might leave, attack you, or help you."
});
legacySpellRefactor("geas", {
    name: "Geas",
    nameShort: "Geas*",
    classes: ["bard", "cleric", "druid", "paladin", "wizard"],
    source: [
        ["P24", 278]
    ],
    level: 5,
    school: "Ench",
    time: "1 min",
    range: "60 ft",
    components: "V",
    duration: "30 days",
    save: "Wis",
    description: "1 crea save or Charmed; obey nonlethal commands or 5d10 Psychic (1/day); SL7: 1 year, SL9: until disp.",
    descriptionShorter: "1 crea save or charmed, obey nonlethal order or 5d10 Psychic; SL7: 1 year, SL9: 'til disp.",
    descriptionFull: "You give a verbal command to a creature that you can see within range, ordering it to carry out some service or refrain from an action or a course of activity as you decide. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target automatically succeeds if it can't understand your command." + "\n   " + "While Charmed, the creature takes 5d10 Psychic damage if it acts in a manner directly counter to your command. It takes this damage no more than once each day." + "\n   " + "You can issue any command you choose, short of an activity that would result in certain death. Should you issue a suicidal command, the spell ends." + "\n   " + "A Remove Curse, Greater Restoration, or Wish spell ends this spell." + AtHigherLevels + "If you use a level 7 or 8 spell slot, the duration is 365 days. If you use a level 9 spell slot, the spell lasts until it is ended by one of the spells mentioned above."
});
legacySpellRefactor("gentle repose", {
    name: "Gentle Repose",
    classes: ["cleric", "paladin", "wizard"],
    source: [
        ["P24", 278]
    ],
    ritual: true,
    level: 2,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "2 copper pieces, which the spell consumes",
    duration: "10 days",
    description: "1 corpse protected from decay and becoming undead; add duration to time limit for raising dead",
    descriptionFull: "You touch a corpse or other remains. For the duration, the target is protected from decay and can't become Undead." + "\n   " + "The spell also effectively extends the time limit on raising the target from the dead, since days spent under the influence of this spell don't count against the time limit of spells such as Raise Dead."
});
legacySpellRefactor("giant insect", {
    name: "Giant Insect",
    nameShort: "Giant Insect*",
    classes: ["druid"],
    source: [
        ["P24", 279]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "Summon Giant Insect (centipede, spider, or wasp); obeys my verbal commands; acts after me; see B",
    descriptionFull: "You summon a giant centipede, spider, or wasp (chosen when you cast the spell). It manifests in an unoccupied space you can see within range and uses the Giant Insect stat block. The form you choose determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("glibness", {
    name: "Glibness",
    classes: ["bard", "warlock"],
    source: [
        ["P24", 279]
    ],
    level: 8,
    school: "Ench",
    time: "1 a",
    range: "Self",
    components: "V",
    duration: "1 h",
    description: "I can choose to replace roll with 15 on any Charisma check; magic cannot detect if I am lying",
    descriptionFull: "Until the spell ends, when you make a Charisma check, you can replace the number you roll with a 15. Additionally, no matter what you say, magic that would determine if you are telling the truth indicates that you are being truthful."
});
legacySpellRefactor("globe of invulnerability", {
    name: "Globe of Invulnerability",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 279]
    ],
    level: 6,
    school: "Abjur",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S,M",
    compMaterial: "A glass bead",
    duration: "Conc, 1 min",
    description: "Immobile barrier surrounds me for duration. SL<(6+1/SL) cast outside area can't affect inside area",
    descriptionFull: "An immobile, faintly shimmering barrier springs into existence in a 10-foot radius around you and remains for the duration." + "\n   " + "Any spell of level 5 or lower cast from outside the barrier can't affect anything within it. Such a spell can target creatures and objects within the barrier, but the spell has no effect on them. Similarly, the area within the barrier is excluded from areas of effect created by such spells." + AtHigherLevels + "The barrier blocks spells of 1 level higher for each spell slot level above 6."
});
legacySpellRefactor("glyph of warding", {
    name: "Glyph of Warding",
    classes: ["artificer", "bard", "cleric", "wizard"],
    source: [
        ["P24", 279]
    ],
    level: 3,
    school: "Abjur",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Powdered diamond worth 200+ gp, which the spell consumes",
    duration: "Till triggered",
    description: "Create glyph that triggers on set condition; Wis(Perception) vs spell DC to notice; see B (200gp cons.)",
    descriptionFull: "You inscribe a glyph that later unleashes a magical effect. You inscribe it either on a surface (such as a table or a section of floor) or within an object that can be closed (such as a book or chest) to conceal the glyph. The glyph can cover an area no larger than 10 feet in diameter. If the surface or object is moved more than 10 feet from where you cast this spell, the glyph is broken, and the spell ends without being triggered." + "\n   " + "The glyph is nearly imperceptible and requires a successful Wisdom (Perception) check against your spell save DC to notice." + "\n   " + "When you inscribe the glyph, you set its trigger and choose whether it's an explosive rune or a spell glyph, as explained below." + "\n   " + "Set the Trigger. You decide what triggers the glyph when you cast the spell. For glyphs inscribed on a surface, common triggers include touching or stepping on the glyph, removing another object covering it, or approaching within a certain distance of it. For glyphs inscribed within an object, common triggers include opening that object or seeing the glyph. Once a glyph is triggered, this spell ends." + "\n   " + "You can refine the trigger so that only creatures of certain types activate it (for example, the glyph could be set to affect Aberrations). You can also set conditions for creatures that don't trigger the glyph, such as those who say a certain password." + "\n   " + toUni("Explosive Rune") + ": When triggered, the glyph erupts with magical energy in a 20-foot-radius Sphere centered on the glyph. Each creature in the area makes a Dexterity saving throw. A creature takes 5d8 Acid, Cold, Fire, Lightning, or Thunder damage (your choice when you create the glyph) on a failed save or half as much damage on a successful one." + "\n   " + toUni("Spell Glyph") + ": You can store a prepared spell of level 3 or lower in the glyph by casting it as part of creating the glyph. The spell must target a single creature or an area. The spell being stored has no immediate effect when cast in this way." + "\n   " + "When the glyph is triggered, the stored spell takes effect. If the spell has a target, it targets the creature that triggered the glyph. If the spell affects an area, the area is centered on that creature. If the spell summons Hostile creatures or creates harmful objects or traps, they appear as close as possible to the intruder and attack it. If the spell requires Concentration, it lasts until the end of its full duration." + AtHigherLevels + "The damage of an explosive rune increases by 1d8 for each spell slot level above 3. If you create a spell glyph, you can store any spell of up to the same level as the spell slot you use for the Glyph of Warding."
});
legacySpellRefactor("goodberry", {
    name: "Goodberry",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 280]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A sprig of mistletoe",
    duration: "24 h",
    description: "Create 10 berries; bns to eat 1 berry: heal 1 HP, nourishment for 1 day; berries disappear after 24h",
    descriptionShorter: "Make 10 berries; bns to eat 1 berry: heal 1 HP, nourishment for 1 day; disappear after 24h",
    descriptionFull: "Ten berries appear in your hand and are infused with magic for the duration. A creature can take a Bonus Action to eat one berry. Eating a berry restores 1 Hit Point, and the berry provides enough nourishment to sustain a creature for one day." + "\n   " + "Uneaten berries disappear when the spell ends."
});
legacySpellRefactor("grasping vine", {
    name: "Grasping Vine",
    nameShort: "Grasping Vine*",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 280]
    ],
    level: 4,
    school: "Conj",
    time: "1 bns",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Make vine: melee spell atk any 1 in 30ft; 4d8 Blud. \u0026 pull \u226430ft; \u2264Huge Grappled (1+1/SL); bns new atk",
    descriptionFull: "You conjure a vine that sprouts from a surface in an unoccupied space that you can see within range. The vine lasts for the duration." + "\n   " + "Make a melee spell attack against a creature within 30 feet of the vine. On a hit, the target takes 4d8 Bludgeoning damage and is pulled up to 30 feet toward the vine; if the target is Huge or smaller, it has the Grappled condition (escape DC equal to your spell save DC). The vine can grapple only one creature at a time, and you can cause the vine to release a Grappled creature (no action required)." + "\n   " + "As a Bonus Action on your later turns, yo can repeat the attack against a creature with 30 feet of the vine." + AtHigherLevels + "The number of creatures the vine can grapple increases by one for each spell slot level above 4."
});
legacySpellRefactor("grease", {
    name: "Grease",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 280]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A bit of pork rind or butter",
    duration: "1 min",
    save: "Dex",
    description: "10-ft square difficult terrain; all entering, in area at casting or at end of turn save or fall prone",
    descriptionFull: "Nonflammable grease covers the ground in a 10-foot square centered on a point within range and turns it into Difficult Terrain for the duration." + "\n   " + "When the grease appears, each creature standing in its area must succeed on a Dexterity saving throw or have the Prone condition. A creature that enters the area or ends its turn there must also succeed on that save or fall Prone."
});
legacySpellRefactor("greater invisibility", {
    name: "Greater Invisibility",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 281]
    ],
    level: 4,
    school: "Illus",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "1 creature becomes Invisible until the spell ends",
    descriptionFull: "A creature you touch has the Invisible condition until the spell ends."
});
legacySpellRefactor("greater restoration", {
    name: "Greater Restoration",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 281]
    ],
    level: 5,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Diamond dust worth 100+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Remove 1 lvl Exhaustion, Charmed, Petrified, curse, stat or max HP reduction (100gp cons.)",
    descriptionFull: "You touch a creature and magically remove one of the following effects from it:" + "\n " + "\u2022 1 Exhaustion level" + "\n " + "\u2022 The Charmed or Petrified condition" + "\n " + "\u2022 A curse, including the target's Attunement to a cursed magic item" + "\n " + "\u2022 Any reduction to one of the target's ability scores" + "\n " + "\u2022 Any reduction to the target's Hit Point maximum"
});
legacySpellRefactor("guardian of faith", {
    name: "Guardian of Faith",
    nameShort: "Guardian of Faith*",
    classes: ["cleric"],
    source: [
        ["P24", 281]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V",
    duration: "8 h",
    save: "Dex",
    description: "Place Lg spectre; all enemies that enter/start in 10ft take 20 Radiant; save 1/2; vanishes after 60 dmg",
    descriptionShorter: "Place Lg spectre; enemies that enter/start in 10ft 20 Radiant; save 1/2; vanishes after 60 dmg",
    descriptionFull: "A Large spectral guardian appears and hovers for the duration in an unoccupied space that you can see within range. The guardian occupies that space and is invulnerable, and it appears in a form appropriate for your deity or pantheon." + "\n   " + "Any enemy that moves to a space within 10 feet of the guardian for the first time on a turn or starts its turn there makes a Dexterity saving throw, taking 20 Radiant damage on a failed save or half as much damage on a successful one. The guardian vanishes when it has dealt a total of 60 damage."
});
legacySpellRefactor("guards and wards", {
    name: "Guards and Wards",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 282]
    ],
    level: 6,
    school: "Abjur",
    time: "10 h",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A silver rod worth 10+ gp",
    duration: "24 h",
    description: "Protect an area with multiple effects including fog, webs, illusions and locks; see book (10gp)",
    descriptionFull: "You create a ward that protects up to 2,500 square feet of floor space. The warded area can be up to 20 feet tall, and you shape it as one 50-foot square, one hundred 5-foot squares that are contiguous, or twenty-five 10-foot squares that are contiguous." + "\n   " + "When you cast this spell, you can specify individuals that are unaffected by the spell's effects. You can also specify a password that, when spoken aloud within 5 feet of the warded area, makes the speaker immune to its effects." + "\n   " + "The spell creates the effects below within the warded area. Dispel Magic has no effect on Guards and Wards itself, but each of the following effects can be dispelled. If all four are dispelled, Guards and Wards ends. If you cast the spell every day for 365 days on the same area, the spell thereafter lasts until all its effects are dispelled." + "\n   " + toUni("Corridors") + ": Fog fills all the warded corridors, making them Heavily Obscured. In addition, at each intersection or branching passage offering a choice of direction, there is a 50 percent chance that a creature other than you believes it is going in the opposite direction from the one it chooses." + "\n   " + toUni("Doors") + ": All doors in the warded area are magically locked, as if sealed by the Arcane Lock spell. In addition, you can cover up to ten doors with an illusion to make them appear as plain sections of wall." + "\n   " + toUni("Stairs") + ": Webs fill all stairs in the warded area from top to bottom, as in the Web spell. These strands regrow in 10 minutes if they are destroyed while Guards and Wards lasts." + "\n   " + toUni("Other Spell Effect") + ": Place one of the following magical effects within the warded area:" + "\n " + "\u2022 Dancing Lights in four corridors, with a simple program that the lights repeat as long as Guards and Wards lasts" + "\n " + "\u2022 Magic Mouth in two locations" + "\n " + "\u2022 Stinking Cloud in two locations (the vapors return within 10 minutes if dispersed while Guards and Wards lasts)" + "\n " + "\u2022 Gust of Wind in one corridor or room (the wind blows continuously while the spell lasts)" + "\n " + "\u2022 Suggestion in one 5-foot square; any creature that enters that square receives the suggestion mentally"
});
legacySpellRefactor("guidance", {
    name: "Guidance",
    classes: ["artificer", "cleric", "druid"],
    source: [
        ["P24", 282]
    ],
    level: 0,
    school: "Div",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Touch willing creature and choose skill; target adds 1d4 to ability chks with chosen skill for duration",
    descriptionFull: "You touch a willing creature and choose a skill. Until the spell ends, the creature adds 1d4 to any ability check using the chosen skill."
});
legacySpellRefactor("guiding bolt", {
    name: "Guiding Bolt",
    classes: ["cleric"],
    source: [
        ["P24", 282]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "1 round",
    description: "Spell attack for 4d6+1d6/SL Radiant dmg and next attack against target has advantage",
    descriptionFull: "You hurl a bolt of light toward a creature within range. Make a ranged spell attack against the target. On a hit, it takes 4d6 Radiant damage, and the next attack roll made against it before the end of your next turn has Advantage." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("gust of wind", {
    name: "Gust of Wind",
    classes: ["druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 282]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A legume seed",
    duration: "Conc, 1 min",
    save: "Str",
    description: "60ft\xD710ft (l\xD7w) wind; all in wind now/end save or pushed 15 ft; bns change direction; see book",
    descriptionFull: "A Line of strong wind 60 feet long and 10 feet wide blasts from you in a direction you choose for the duration. Each creature in the Line must succeed on a Strength saving throw or be pushed 15 feet away from you in a direction following the Line. A creature that ends its turn in the Line must make the same save." + "\n   " + "Any creature in the line must spend 2 feet of movement for every 1 foot it moves when moving closer to you." + "\n   " + "The gust disperses gas or vapor, and it extinguishes candles and similar unprotected flames in the area. It causes protected flames, such as those of lanterns, to dance wildly and has a 50 percent chance to extinguish them." + "\n   " + "As a Bonus Action on your later turns, you can change the direction in which the Line blasts from you."
});
legacySpellRefactor("hail of thorns", {
    name: "Hail of Thorns",
    classes: ["ranger"],
    source: [
        ["P24", 283]
    ],
    level: 1,
    school: "Conj",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a creature with a Ranged weapon",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    save: "Dex",
    description: "On ranged weapon hit, target and all in 5 ft take 1d10+1d10/SL Piercing dmg; save halves",
    descriptionFull: "As you hit the creature, this spell creates a rain of thorns that sprouts from your Ranged weapon or ammunition. The target of the attack and each creature within 5 feet of it make a Dexterity saving throw, taking 1d10 Piercing damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 1.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("hallow", {
    name: "Hallow",
    classes: ["cleric"],
    source: [
        ["P24", 283]
    ],
    level: 5,
    school: "Abjur",
    time: "24 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Incense worth 1000+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "Up to 60-ft rad; chosen creature types can't enter/possess/charm/frighten in area; 1 extra effect; see B",
    descriptionFull: "You touch a point and infuse an area around it with holy or unholy power. The area can have a radius up to 60 feet, and the spell fails if the radius includes an area already under the effect of Hallow. The affected area has the following effects." + "\n   " + "Hallowed Ward. Choose any of these creature types: Aberration, Celestial, Elemental, Fey, Fiend, or Undead. Creatures of the chosen types can't willingly enter the area, and any creature that is possessed by or that has the Charmed or Frightened condition from such creatures isn't possessed, Charmed, or Frightened by them while in the area." + "\n   " + "Extra Effect. You bind an extra effect to the area from the list below:" + "\n   " + toUni("Courage") + ": Creatures of any types you choose can't gain the Frightened condition while in the area." + "\n   " + toUni("Darkness") + ": Darkness fills the area. Normal light, as well as magical light created by spells of a level lower than this spell, can't illuminate the area." + "\n   " + toUni("Daylight") + ": Bright light fills the area. Magical Darkness created by spells of a level lower than this spell can't extinguish the light." + "\n   " + toUni("Peaceful Rest") + ": Dead bodies interred in the area can't be turned into undead." + "\n   " + toUni("Extradimensional Interference") + ": Creatures of any types you choose can't enter or exit the area using teleportation or interplanar travel." + "\n   " + toUni("Fear") + ": Creatures of any types you choose have the Frightened condition while in the area." + "\n   " + toUni("Resistance") + ": Creatures of any types you choose have Resistance to one damage type of your choice while in the area." + "\n   " + toUni("Silence") + ": No sound can emanate from within the area, and no sound can reach into it." + "\n   " + toUni("Tongues") + ": Creatures of any types you choose can communicate with any other creature in the area even if they don't share a common language." + "\n   " + toUni("Vulnerability") + ": Creatures of any types you choose have Vulnerability to one damage type of your choice while in the area."
});
legacySpellRefactor("hallucinatory terrain", {
    name: "Hallucinatory Terrain",
    classes: ["bard", "druid", "warlock", "wizard"],
    source: [
        ["P24", 283]
    ],
    level: 4,
    school: "Illus",
    time: "10 min",
    range: "300 ft",
    components: "V,S,M",
    compMaterial: "A mushroom",
    duration: "24 h",
    description: "150-ft cube of terrain resembles another sort of terrain; Int (Investigation) vs spell DC; see book",
    descriptionFull: "You make natural terrain in a 150-foot Cube in range look, sound, and smell like another sort of natural terrain. Thus, open fields or a road can be made to resemble a swamp, hill, crevasse, or some other difficult or impassable terrain. A pond can be made to seem like a grassy meadow, a precipice like a gentle slope, or a rock-strewn gully like a wide and smooth road. Manufactured structures, equipment, and creatures within the area aren't changed." + "\n   " + "The tactile characteristics of the terrain are unchanged, so creatures entering the area are likely to notice the illusion. If the difference isn't obvious by touch, a creature examining the illusion can take the Study action to make an Intelligence (Investigation) check against your spell save DC to disbelieve it. If a creature discerns that the terrain is illusory, the creature sees a vague image superimposed on the real terrain."
});
legacySpellRefactor("harm", {
    name: "Harm",
    nameShort: "Harm*",
    classes: ["cleric"],
    source: [
        ["P24", 283]
    ],
    level: 6,
    school: "Necro",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Con",
    description: "1 creature 14d6 Necrotic, reduce max HP by same; not <1 max HP; save half and not reduced",
    descriptionFull: "You unleash virulent magic on a creature you can see within range. The target makes a Constitution saving throw. On a failed save, it takes 14d6 Necrotic damage, and its Hit Point maximum is reduced by an amount equal to the Necrotic damage it took. On a successful save, it takes half as much damage only. This spell can't reduce a target's Hit Point maximum below 1."
});
legacySpellRefactor("haste", {
    name: "Haste",
    nameShort: "Haste*",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 284]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A shaving of licorice root",
    duration: "Conc, 1 min",
    description: "1 crea +2 AC, speed \xD72, adv. on Dex saves, extra action: Atk (1 only), Dash, Diseng., Hide, or Utilize",
    descriptionFull: "Choose a willing creature that you can see within range. Until the spell ends, the target's speed is doubled, it gains a +2 bonus to Armor Class, it has advantage on Dexterity saving throws, and it gains an additional action on each of its turns. That action can be used to take only the Attack (one attack only), Dash, Disengage, Hide, or Utilize action." + "\n   " + "When the spell ends, the target is Incapacitated and has a Speed of 0 until the end of its next turn, as a wave of lethargy washes over it."
});
legacySpellRefactor("heal", {
    name: "Heal",
    nameShort: "Heal*",
    classes: ["cleric", "druid"],
    source: [
        ["P24", 284]
    ],
    level: 6,
    school: "Abjur",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "1 creature heals 70+10/SL HP and is cured of all Blinded, Deafened and Poisoned conditions",
    descriptionShorter: "1 creature heals 70+10/SL HP and is cured of blinded, deafened, poisoned",
    descriptionFull: "Choose a creature that you can see within range. Positive energy washes through the target, restoring 70 Hit Points. This spell also ends the Blinded, Deafened, and Poisoned conditions on the target." + AtHigherLevels + "The healing increases by 10 for each spell slot level above 6."
});
legacySpellRefactor("healing word", {
    name: "Healing Word",
    nameShort: "Healing Word*",
    classes: ["bard", "cleric", "druid"],
    source: [
        ["P24", 284]
    ],
    level: 1,
    school: "Abjur",
    time: "1 bns",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    description: "1 creature heals 2d4+2d4/SL+spellcasting ability modifier HP",
    descriptionFull: "A creature of your choice that you can see within range regains Hit Points equal to 2d4 plus your spellcasting ability modifier." + AtHigherLevels + "The healing increases by 2d4 for each spell slot level above 1."
});
legacySpellRefactor("heat metal", {
    name: "Heat Metal",
    nameShort: "Heat Metal*",
    classes: ["artificer", "bard", "druid"],
    source: [
        ["P24", 284]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A piece of iron and a flame",
    duration: "Conc, 1 min",
    save: "Con",
    description: "1 metal object on touch 2d8+1d8/SL Fire dmg; save or drop obj; if held: dis. atk/chk; bns reheat obj",
    descriptionShorter: "1 metal obj, touch it 2d8+1d8/SL Fire; save or drop; if held: dis. atk/chk; bns redo",
    descriptionFull: "Choose a manufactured metal object, such as a metal weapon or a suit of Heavy or Medium metal armor, that you can see within range. You cause the object to glow red-hot. Any creature in physical contact with the object takes 2d8 Fire damage when you cast the spell. Until the spell ends, you can take a Bonus Action on each of your later turns to deal this damage again if the object is within range." + "\n   " + "If a creature is holding or wearing the object and takes the damage from it, the creature must succeed on a Constitution saving throw or drop the object if it can. If it doesn't drop the object, it has Disadvantage on attack rolls and ability checks until the start of your next turn." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 2."
});
legacySpellRefactor("hellish rebuke", {
    name: "Hellish Rebuke",
    nameShort: "Hellish Rebuke*",
    classes: ["warlock"],
    source: [
        ["P24", 284]
    ],
    level: 1,
    school: "Evoc",
    time: "1 rea",
    timeFull: "Reaction, which you take in response to taking damage from a creature that you can see within 60 feet of yourself",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "Cast on taking damage; creature that dealt damage takes 2d10+1d10/SL Fire; save halves",
    descriptionFull: "The creature that damaged you is momentarily surrounded by green flames. It makes a Dexterity saving throw, taking 2d10 Fire damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 1."
});
legacySpellRefactor("heroes' feast", {
    name: "Heroes' Feast",
    classes: ["bard", "cleric", "druid"],
    source: [
        ["P24", 284]
    ],
    level: 6,
    school: "Conj",
    time: "10 min",
    range: "Self",
    components: "V,S,M\u2020",
    compMaterial: "A gem-encrusted bowl worth 1,000+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "12 crea eat in 1h; 24h: resist Poison, immune Fright. \u0026 Poisoned, +2d10 max+current HP (1000gp cons.)",
    descriptionFull: "You conjure a feast that appears on a surface in an unoccupied 10-foot Cube next to you. The feast takes 1 hour to consume and disappears at the end of that time, and the beneficial effects don't set in until this hour is over. Up to twelve creatures can partake of the feast." + "\n   " + "A creature that partakes gains several benefits, which last for 24 hours. The creature has Resistance to Poison damage, and it has Immunity to the Frightened and Poisoned conditions. Its Hit Point maximum also increases by 2d10, and it gains the same number of Hit Points."
});
legacySpellRefactor("heroism", {
    name: "Heroism",
    classes: ["bard", "paladin"],
    source: [
        ["P24", 285]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "1+1/SL willing crea immune to Frightened, gain spellcasting ability modifier temp. HP start of each turn",
    descriptionFull: "A willing creature you touch is imbued with bravery. Until the spell ends, the creature is immune to the Frightened condition and gains Temporary Hit Points equal to your spellcasting ability modifier at the start of each of its turns." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("hex", {
    name: "Hex",
    nameShort: "Hex*",
    classes: ["warlock"],
    source: [
        ["P24", 285]
    ],
    level: 1,
    school: "Ench",
    time: "1 bns",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "The petrified eye of a newt",
    duration: "Conc, 1 h",
    description: "1 crea +1d6 Necrotic my atks; dis. 1 stat chks; if 0HP bns move next rnd; SL2: 4h, SL3/4: 8h; SL5+: 24h",
    descriptionShorter: "1 crea +1d6 Necrotic from my atks; dis. 1 stat chks; SL2: 4h, SL3/4: 8h; SL5+: 24h",
    descriptionFull: "You place a curse on a creature that you can see within range. Until the spell ends, you deal an extra 1d6 Necrotic damage to the target whenever you hit it with an attack roll. Also, choose one ability when you cast the spell. The target has Disadvantage on ability checks made with the chosen ability." + "\n   " + "If the target drops to 0 hit points before this spell ends, you can take a Bonus Action on a later turn to curse a new creature." + AtHigherLevels + "Your Concentration can last longer with a spell slot of level 2 (up to 4 hours), 3‚Äì4 (up to 8 hours), or 5+ (24 hours)."
});
legacySpellRefactor("hold monster", {
    name: "Hold Monster",
    nameShort: "Hold Monster*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 285]
    ],
    level: 5,
    school: "Ench",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "A straight piece of iron",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1+1/SL visible creature, save or Paralyzed; extra save at end of each turn",
    descriptionFull: "Choose a creature that you can see within range. The target must succeed on a Wisdom saving throw or have the Paralyzed condition for the duration. At the end of each of its turns, the target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "You can target one additional creature for each spell slot level above 5."
});
legacySpellRefactor("hold person", {
    name: "Hold Person",
    nameShort: "Hold Person*",
    classes: ["bard", "cleric", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 286]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A straight piece of iron",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1+1/SL visible humanoids save or Paralyzed; extra save at end of each turn",
    descriptionFull: "Choose a Humanoid that you can see within range. The target must succeed on a Wisdom saving throw or have the Paralyzed condition for the duration. At the end of each of its turns, the target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "You can target one additional Humanoid for each spell slot level above 2."
});
legacySpellRefactor("holy aura", {
    name: "Holy Aura",
    classes: ["cleric"],
    source: [
        ["P24", 286]
    ],
    level: 8,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S,M\u0192",
    compMaterial: "A reliquary worth 1000+ gp",
    duration: "Conc, 1 min",
    save: "Con",
    description: "Any crea adv. saves; dis. atks vs them; if fiend/undead hit melee atk, save or Blind to next EoT (1000gp)",
    descriptionFull: "For the duration, you emit an aura in a 30-foot Emanation. While in the aura, creatures of your choice have Advantage on all saving throws, and other creatures have Disadvantage on attack rolls against them. In addition, when a Fiend or an Undead hits an affected creature with a melee attack roll, the attacker must succeed on a Constitution saving throw or have the Blinded condition until the end of its next turn."
});
legacySpellRefactor("hunger of hadar", {
    name: "Hunger of Hadar",
    classes: ["warlock"],
    source: [
        ["P24", 286]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A pickled tentacle",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "20-ft rad all in area: Blinded, start turn 2d6 Cold, end turn save or 2d6 Acid; 1 dmg type +1d6/SL",
    descriptionFull: "You open a gateway to the Far Realm, a region infested with unspeakable horrors. A 20-foot-radius Sphere of Darkness appears, centered on a point with range and lasting for the duration. The Sphere is Difficult Terrain, and it is filled with strange whispers and slurping noises, which can be heard up to 30 feet away. No light, magical or otherwise, can illuminate the area, and creatures fully within it have the Blinded condition." + "\n   " + "Any creature that starts its turn in the area takes 2d6 Cold damage. Any creature that ends its turn there must succeed on a Dexterity saving throw or take 2d6 Acid damage from otherworldly tentacles." + AtHigherLevels + "The Cold or Acid damage (your choice) increases by 1d6 for each spell slot level above 3."
});
legacySpellRefactor("hunter's mark", {
    name: "Hunter's Mark",
    nameShort: "Hunter's Mark*",
    classes: ["ranger"],
    source: [
        ["P24", 287]
    ],
    level: 1,
    school: "Div",
    time: "1 bns",
    range: "90 ft",
    components: "V",
    duration: "Conc, 1 h",
    description: "1 crea +1d6 Force my atks; adv. Wis (Percep./Survival) vs crea; bns move if 0HP; SL3/4: 8h; SL5+: 24h",
    descriptionFull: "You magically mark one creature you can see within range as your quarry. Until the spell ends, you deal an extra 1d6 Force damage to the target whenever you hit it with an attack roll. You also have Advantage on any Wisdom (Perception or Survival) check you make to find it." + "\n   " + "If the target drops to 0 Hit Points before this spell ends, you can take a Bonus Action to move the mark to a new creature you can see within range." + AtHigherLevels + "Your Concentration can last longer with a spell slot of level 3‚Äì4 (up to 8 hours) or 5+ (up to 24 hours)."
});
legacySpellRefactor("hypnotic pattern", {
    name: "Hypnotic Pattern",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 287]
    ],
    level: 3,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "S,M",
    compMaterial: "A pinch of confetti",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "30-ft cube all sighted crea save or Charmed; for dur. Incapacitated, speed 0; 1 a or dmg to end for crea",
    descriptionFull: "You create a twisting pattern of colors in a 30-foot Cube within range. The pattern appears for a moment and vanishes. Each creature in the area who can see the pattern must succeed on a Wisdom saving throw or have the Charmed condition for the duration. While Charmed, the creature has the Incapacitated condition and a Speed of 0." + "\n   " + "The spell ends for an affected creature if it takes any damage or if someone else uses an action to shake the creature out of its stupor."
});
legacySpellRefactor("ice knife", {
    name: "Ice Knife",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 287]
    ],
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "S,M",
    compMaterial: "A drop of water or piece of ice",
    duration: "Instantaneous",
    save: "Dex",
    description: "Ranged atk for 1d10 Piercing dmg; hit/miss 5-ft rad on target all crea save or 2d6+1d6/SL Cold dmg",
    descriptionShorter: "Ranged atk 1d10 Piercing dmg; on target 5-ft rad all crea save or 2d6+1d6/SL Cold dmg",
    descriptionFull: "You create a shard of ice and fling it at one creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 Piercing damage. Hit or miss, the shard then explodes. The target and each creature within 5 feet of it must succeed on a Dexterity saving throw or take 2d6 Cold damage." + AtHigherLevels + "The Cold damage increases by 1d6 for each spell slot level above 1.",
    dynamicDamageBonus: {
        skipDmgGroupIfNotMultiple: /(atk .*piercing dmg.*?)/i
    }
});
legacySpellRefactor("ice storm", {
    name: "Ice Storm",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 287]
    ],
    level: 4,
    school: "Evoc",
    time: "1 a",
    range: "300 ft",
    components: "V,S,M",
    compMaterial: "A mitten",
    duration: "Instantaneous",
    save: "Dex",
    description: "20ft rad 40ft high cylin. all 2d10+1d10/SL Bludg. \u0026 4d6 Cold; save half; dif. ter. to my next EoT",
    descriptionFull: "Hail falls in a 20-foot-radius, 40-foot-high Cylinder centered on a point within range. Each creature in the Cylinder makes a Dexterity saving throw. A creature takes 2d10 Bludgeoning damage and 4d6 Cold damage on a failed save or half as much damage on a successful one." + "\n   " + "Hailstones turn ground in the Cylinder into Difficult Terrain until the end of your next turn." + AtHigherLevels + "The Bludgeoning damage increases by 1d10 for each spell slot level above 4.",
    dynamicDamageBonus: {
        allDmgTypesSingleMoment: true
    }
});
legacySpellRefactor("identify", {
    name: "Identify",
    classes: ["artificer", "bard", "wizard"],
    source: [
        ["P24", 287]
    ],
    ritual: true,
    level: 1,
    school: "Div",
    time: "1 min",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A pearl worth 100+ gp",
    duration: "Instantaneous",
    description: "1 crea/obj; if magic or magic-imbued, learn properties, how to use, spells affecting it, see B (100gp)",
    descriptionFull: "You touch an object throughout the spell's casting. If the object is a magic item or some other magical object, you learn its properties and how to use them, whether it requires Attunement, and how many charges it has, if any. You learn whether any ongoing spells are affecting the item and what they are. If the item was created by a spell, you learn that spell's name." + "\n   " + "If you instead touch a creature throughout the casting, you learn which ongoing spells, if any, are currently affecting it."
});
legacySpellRefactor("illusory script", {
    name: "Illusory Script",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 288]
    ],
    ritual: true,
    level: 1,
    school: "Illus",
    time: "1 min",
    range: "Touch",
    components: "S,M\u2020",
    compMaterial: "Ink worth 10+ gp, which the spell consumes",
    duration: "10 days",
    description: "Write a message that only I, designated crea, and any with Truesight can understand (10gp cons.)",
    descriptionFull: "You write on parchment, paper, or another suitable material and imbue it with an illusion that lasts for the duration." + "\n   " + "To you and any creatures you designate when you cast the spell, the writing appears normal, seems to be written in your hand, and conveys whatever meaning you intended when you wrote the text. To all others, the writing appears as if it were written in an unknown or magical script that is unintelligible. Alternatively, the illusion can alter the meaning, handwriting, and language of the text, though the language must be one you know." + "\n   " + "If the spell is dispelled, the original script and the illusion both disappear." + "\n   " + "A creature that has Truesight can read the hidden message."
});
legacySpellRefactor("imprisonment", {
    name: "Imprisonment",
    nameShort: "Imprisonment*",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 288]
    ],
    level: 9,
    school: "Abjur",
    time: "1 min",
    range: "30 ft",
    components: "V,S,M\u0192",
    compMaterial: "A statuette of the target worth 5000+ gp",
    duration: "Till dispelled",
    save: "Wis",
    description: "1 crea save or trapped via chosen method; only specific trigger or lvl 9 Dispel to end; see B (5000gp)",
    descriptionFull: "You create a magical restraint to hold a creature that you can see within range. The target must make a Wisdom saving throw. On a successful save, the target is unaffected, and it is immune to this spell for the next 24 hours. On a failed save, the target is imprisoned. While imprisoned, the target doesn't need to breathe, eat, or drink, and it doesn't age. Divination spells can't locate or perceive the imprisoned target, and the target can't teleport." + "\n   " + "Until the spell ends, the target is also affected by one of the following effects of your choice:" + "\n   " + toUni("Burial") + ": The target is entombed beneath the earth in a hollow globe of magical force that is just large enough to contain the target. Nothing can pass into or out of the globe." + "\n   " + toUni("Chaining") + ": Chains firmly rooted in the ground hold the target in place. The target has the Restrained condition and can't be moved by any means." + "\n   " + toUni("Hedged Prison") + ": The target is trapped in a demiplane that is warded against teleportation and planar travel. The demiplane is your choice of a labyrinth, a cage, a tower, or the like." + "\n   " + toUni("Minimus Containment") + ": The target becomes 1 inch tall and is trapped inside an indestructible gemstone or a similar object. Light can pass through the gemstone (allowing the target to see out and other creatures to see in), but nothing else can pass through by any means." + "\n   " + toUni("Slumber") + ": The target has the Unconscious condition and can't be awoken." + "\n   " + toUni("Ending the Spell") + ": When you cast the spell, specify a trigger that will end it. The trigger can be as simple or as elaborate as you choose, but the DM must agree that it has a high likelihood of happening within the next decade. The trigger must be an observable action, such as someone making a particular offering at the temple of your god, saving your true love, or defeating a specific monster." + "\n   " + "A Dispel Magic spell can end the spell only if it is cast with a level 9 spell slot, targeting either the prison or the component used to create it."
});
legacySpellRefactor("incendiary cloud", {
    name: "Incendiary Cloud",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 288]
    ],
    level: 8,
    school: "Conj",
    time: "1 a",
    range: "150 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "20ft rad all now/cover/enter/end 10d8 Fire; save 1/2; heavily obscures; move 10ft/rnd away chosen dir.",
    descriptionShorter: "20ft rad all now/cover/enter/end 10d8 Fire; save half; heavy obsc.; moves 10 ft/rnd",
    descriptionFull: "A swirling cloud of embers and smoke fills a 20-foot-radius Sphere centered on a point within range. The cloud's area is Heavily Obscured. It lasts for the duration or until a strong wind (like that created by Gust of Wind) disperses it." + "\n   " + "When the cloud appears, each creature in it makes a Dexterity saving throw, taking 10d8 Fire damage on a failed save or half as much damage on a successful one. A creature must also make this save when the Sphere moves into its space and when it enters the Sphere or ends its turn there. A creature makes this save only once per turn." + "\n   " + "The cloud moves 10 feet away from you in a direction you choose at the start of each of your turns."
});
legacySpellRefactor("inflict wounds", {
    name: "Inflict Wounds",
    classes: ["cleric"],
    source: [
        ["P24", 288]
    ],
    level: 1,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    save: "Con",
    duration: "Instantaneous",
    description: "1 creature 2d10+1d10/SL Necrotic damage; save halves",
    descriptionFull: "A creature you touch makes a Constitution saving throw, taking 2d10 Necrotic damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 1."
});
legacySpellRefactor("insect plague", {
    name: "Insect Plague",
    classes: ["cleric", "druid", "sorcerer"],
    source: [
        ["P24", 289]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "300 ft",
    components: "V,S,M",
    compMaterial: "A locust",
    duration: "Conc, 10 min",
    save: "Con",
    description: "20-ft rad all now/enter/end 4d10+1d10/SL Piercing (1/turn/crea); save half; light obsc.; dif. ter.",
    descriptionShorter: "20-ft rad all now/enter/end 4d10+1d10/SL Piercing (1/t/c); save half; light obscures; dif. ter",
    descriptionFull: "Swarming locusts fill a 20-foot-radius Sphere centered on a point you choose within range. The Sphere remains for the duration, and its area is Lightly Obscured and Difficult Terrain." + "\n   " + "When the swarm appears, each creature in it makes a Constitution saving throw, taking 4d10 Piercing damage on a failed save or half as much damage on a successful one. A creature also makes this save when it enters the spell's area for the first time on a turn or ends its turn there. A creature makes this save only once per turn." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 5."
});
legacySpellRefactor("invisibility", {
    name: "Invisibility",
    classes: ["artificer", "bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 289]
    ],
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "An eyelash in gum arabic",
    duration: "Conc, 1 h",
    description: "1+1/SL creatures become Invisible; attacking, casting, or dealing damage ends the spell",
    descriptionFull: "A creature you touch has the Invisible condition until the spell ends. The spell ends early immediately after the target makes an attack roll, deals damage, or casts a spell." + AtHigherLevels + "You can target one additional creature for each spell slot level above 2."
});
legacySpellRefactor("jallarzi's storm of radiance", {
    name: "Jallarzi's Storm of Radiance",
    nameShort: "Jal.'s Storm of Radiance*",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 289]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A pinch of phosphorus",
    save: "Con",
    duration: "Conc, 1 min",
    description: "20\xD740ft cyl. crea Blind/Deaf/no V spells; all now/enter/end (1/t/c) 2d10+1d10/SL Rad. \u0026 Thdr; save 1/2",
    descriptionFull: "You unleash a storm of flashing light and raging thunder in a 10-foot-radius, 40-foot-high Cylinder centered on a point you can see within range. While in this area, creatures have the Blinded and Deafened conditions, and they can't cast spells with a Verbal component." + "\n   " + "When the storm appears, each creature in it makes a Constitution saving throw, taking 2d10 Radiant damage and 2d10 Thunder damage on a failed save or half as much damage on a successful one. A creature also makes this save when it enters the spell's area for the first time on a turn or ends its turn there. A creature makes this save only once per turn." + AtHigherLevels + "The Radiant and Thunder damage increase by 1d10 for each spell slot level above 5."
});
legacySpellRefactor("jump", {
    name: "Jump",
    classes: ["artificer", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 290]
    ],
    level: 1,
    school: "Trans",
    time: "1 bns",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A grasshopper's hind leg",
    duration: "1 min",
    description: "1+1/SL creature can spend 10 ft movement to jump 30 ft once per turn",
    descriptionFull: "You touch a willing creature. Once on each of its turns until the spell ends, that creature can jump up to 30 feet by spending 10 feet of movement." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("knock", {
    name: "Knock",
    nameShort: "Knock*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 290]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    description: "1 object unlocked (1 lock), unstuck, unbarred, Arcane Lock suppressed for 10 min; audible 300 ft",
    descriptionFull: "Choose an object that you can see within range. The object can be a door, a box, a chest, a set of manacles, a padlock, or another object that contains a mundane or magical means that prevents access." + "\n   " + "A target that is held shut by a mundane lock or that is stuck or barred becomes unlocked, unstuck, or unbarred. If the object has multiple locks, only one of them is unlocked." + "\n   " + "If the target is held shut by Arcane Lock, that spell is suppressed for 10 minutes, during which time the target can be opened and closed." + "\n   " + "When you cast the spell, a loud knock, audible up to 300 feet away, emanates from the target object."
});
legacySpellRefactor("legend lore", {
    name: "Legend Lore",
    classes: ["bard", "cleric", "wizard"],
    source: [
        ["P24", 290]
    ],
    level: 5,
    school: "Div",
    time: "10 min",
    range: "Self",
    components: "V,S,M\u2020",
    compMaterial: "Incense worth 250+ gp, which the spell consumes, and four ivory strips worth 50+ gp each",
    duration: "Instantaneous",
    description: "Receive lore summary of famous person, place, or object; spell fails if not famous (200gp; 250gp cons.)",
    descriptionFull: "Name or describe a famous person, place, or object. The spell brings to your mind a brief summary of the significant lore about that famous thing, as described by the DM." + "\n   " + "The lore might consist of important details, amusing revelations, or even secret lore that has never been widely known. The more information you already know about the thing, the more precise and detailed the information you receive is. That information is accurate but might be couched in figurative language or poetry, as determined by the DM." + "\n   " + "If the famous thing you chose isn't actually famous, you hear sad musical notes played on a trombone, and the spell fails."
});
legacySpellRefactor("leomund's secret chest", {
    name: "Leomund's Secret Chest",
    nameAlt: "Secret Chest",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 290]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A chest, 3 feet by 2 feet by 2 feet, constructed from rare materials worth 5,000+ gp, and a Tiny replica of the chest made from the same materials worth 50+ gp",
    duration: "Till dispelled",
    description: "Hide chest with contents in Ethereal Plane for 60 days, after that chance of loss; 1 a to recall (5050gp)",
    descriptionFull: "You hide a chest and all its contents on the Ethereal Plane. You must touch the chest and the miniature replica that serve as Material components for the spell. The chest can contain up to 12 cubic feet of nonliving material (3 feet by 2 feet by 2 feet)." + "\n   " + "While the chest remains on the Ethereal Plane, you can take a Magic action and touch the replica to recall the chest. It appears in an unoccupied space on the ground within 5 feet of you. You can send the chest back to the Ethereal Plane by taking a Magic action to touch the chest and the replica." + "\n   " + "After 60 days, there is a cumulative 5 percent chance at the end of each day that the spell ends. The spell also ends if you cast this spell again or if the Tiny replica chest is destroyed. If the spell ends and the larger chest is on the Ethereal Plane, the chest remains there for you or someone else to find."
});
legacySpellRefactor("leomund's tiny hut", {
    name: "Leomund's Tiny Hut",
    nameAlt: "Tiny Hut",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 291]
    ],
    ritual: true,
    level: 3,
    school: "Evoc",
    time: "1 min",
    range: "S:10-ft rad",
    components: "V,S,M",
    compMaterial: "A crystal bead",
    duration: "8 h",
    description: "Immobile barrier; blocks magic \u0026 crea/obj not in area when cast; ends if I leave/recast; see B",
    descriptionFull: "A 10-foot Emanation springs into existence around you and remains stationary for the duration. The spell fails when you cast it if the Emanation isn't big enough to fully encapsulate all creatures in its area." + "\n   " + "Creatures and objects within the Emanation when you cast the spell can move through it freely. All other creatures and objects are barred from passing through it. Spells of level 3 or lower can't be cast through it, and the effects of such spells can't extend into it." + "\n   " + "The atmosphere inside the Emanation is comfortable and dry, regardless of the weather outside. Until the spell ends, you can command the interior to have Dim Light or Darkness (no action required). The Emanation is opaque from the outside and of any color you choose, but it's transparent from the inside." + "\n   " + "The spell ends early if you leave the Emanation or if you cast it again."
});
legacySpellRefactor("lesser restoration", {
    name: "Lesser Restoration",
    classes: ["artificer", "bard", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 291]
    ],
    level: 2,
    school: "Abjur",
    time: "1 bns",
    range: "Touch",
    components: "V,S",
    duration: "Instantaneous",
    description: "1 creature cured of Blinded, Deafened, Paralyzed, or Poisoned",
    descriptionFull: "You touch a creature and end one condition on it: Blinded, Deafened, Paralyzed, or Poisoned."
});
legacySpellRefactor("levitate", {
    name: "Levitate",
    nameShort: "Levitate*",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 291]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A metal spring",
    duration: "Conc, 10 min",
    save: "Con",
    description: "1 crea/\u2264500 lb object save or rise vertically, up to 20 ft; 1 a move target up/down 20 ft (move a if me)",
    descriptionFull: "One creature or loose object of your choice that you can see within range rises vertically up to 20 feet and remains suspended there for the duration. The spell can levitate an object that weighs up to 500 pounds. An unwilling creature that succeeds on a Constitution saving throw is unaffected." + "\n   " + "The target can move only by pushing or pulling against a fixed object or surface within reach (such as a wall or a ceiling), which allows it to move as if it were climbing. You can change the target's altitude by up to 20 feet in either direction on your turn. If you are the target, you can move up or down as part of your move. Otherwise, you can take a Magic action to move the target, which must remain within the spell's range." + "\n   " + "When the spell ends, the target floats gently to the ground if it is still aloft"
});
legacySpellRefactor("light", {
    name: "Light",
    classes: ["artificer", "bard", "cleric", "sorcerer", "wizard"],
    source: [
        ["P24", 292]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "Touch",
    components: "V,M",
    compMaterial: "A firefly or phosphorescent moss",
    duration: "1 h",
    description: "1 unattended obj \u2264Large emits 20-ft rad bright light and 20-ft rad dim light; 1 instance only",
    descriptionFull: "You touch one Large or smaller object that isn't being worn or carried by someone else. Until the spell ends, the object sheds Bright Light in a 20-foot radius and Dim Light for an additional 20 feet. The light can be colored as you like." + "\n   " + "Covering the object with something opaque blocks the light. The spell ends if you cast it again."
});
legacySpellRefactor("lightning arrow", {
    name: "Lightning Arrow",
    classes: ["ranger"],
    source: [
        ["P24", 292]
    ],
    level: 3,
    school: "Trans",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting or missing a target with a ranged attack using a weapon",
    range: "Self",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "After rngd wea atk: hit 4d8+1d8/SL Lightn., half on miss; all in 10ft save or 2d8+1d8/SL Lightn., save 1/2",
    descriptionShorter: "Rngd wea atk 4d8+1d8/SL Lightn., miss h" + (typePF ? "a" : "") + "lf; 10ft all 2d8+1d8/SL Lightn., save half",
    descriptionFull: "As your attack hits or misses the target, the weapon or ammunition you're using transforms into a lightning bolt. Instead of taking any damage or other effects from the attack, the target takes 4d8 Lightning damage on a hit or half as much damage on a miss. Each creature within 10 feet of the target then makes a Dexterity saving throw, taking 2d8 Lightning damage on a failed save or half as much damage on a successful one." + "\n   " + "The weapon or ammunition then returns to its normal form." + AtHigherLevels + "The damage for both effects of the spell increases by 1d8 for each spell slot level above 3.",
    dynamicDamageBonus: {
        multipleDmgMoments: false,
        skipDmgGroupIfNotMultiple: /(atk .*?lightn\. dmg.*?)/i
    }
});
legacySpellRefactor("lightning bolt", {
    name: "Lightning Bolt",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 292]
    ],
    level: 3,
    school: "Evoc",
    time: "1 a",
    range: "S:100" + (typePF ? "-" : "") + "ft line",
    components: "V,S,M",
    compMaterial: "A bit of fur and a crystal rod",
    duration: "Instantaneous",
    save: "Dex",
    description: "100-ft long 5-ft wide line all creatures 8d6+1d6/SL Lightning damage; save halves",
    descriptionFull: "A stroke of lightning forming a 100-foot-long, 5-foot-wide Line blasts out from you in a direction you choose. Each creature in the Line makes a Dexterity saving throw, taking 8d6 Lightning damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 3."
});
legacySpellRefactor("locate animals or plants", {
    name: "Locate Animals or Plants",
    nameShort: "Locate Animal/Plants",
    classes: ["bard", "druid", "ranger"],
    source: [
        ["P24", 292]
    ],
    ritual: true,
    level: 2,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Fur from a bloodhound",
    duration: "Instantaneous",
    description: "Learn direction and distance to closest named or described kind of beast or plant within 5 miles",
    descriptionFull: "Describe or name a specific kind of Beast, Plant creature, or nonmagical plant. You learn the direction and distance to the closest creature or plant of that kind within 5 miles, if any are present."
});
legacySpellRefactor("locate creature", {
    name: "Locate Creature",
    classes: ["bard", "cleric", "druid", "paladin", "ranger", "wizard"],
    source: [
        ["P24", 292]
    ],
    level: 4,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Fur from a bloodhound",
    duration: "Conc, 1 h",
    description: "Learn direction to closest named or described familiar creature (specific or kind) in 1000 ft; see book",
    descriptionFull: "Describe or name a creature that is familiar to you. You sense the direction to the creature's location if that creature is within 1,000 feet of you. If the creature is moving, you know the direction of its movement." + "\n   " + "The spell can locate a specific creature known to you or the nearest creature of a specific kind (such as a human or a unicorn) if you have seen such a creature up close ‚Äî within 30 feet ‚Äî at least once. If the creature you described or named is in a different form, such as under the effects of a Flesh to Stone or Polymorph spell, this spell doesn't locate the creature." + "\n   " + "This spell can't locate a creature if any thickness of lead blocks a direct path between you and the creature."
});
legacySpellRefactor("locate object", {
    name: "Locate Object",
    classes: ["bard", "cleric", "druid", "paladin", "ranger", "wizard"],
    source: [
        ["P24", 293]
    ],
    level: 2,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A forked twig",
    duration: "Conc, 10 min",
    description: "Learn direction to closest named or described familiar object (specific or kind) in 1000 ft; see book",
    descriptionFull: "Describe or name an object that is familiar to you. You sense the direction to the object's location if that object is within 1,000 feet of you. If the object is in motion, you know the direction of its movement." + "\n   " + "The spell can locate a specific object known to you if you have seen it up close ‚Äî within 30 feet ‚Äî at least once. Alternatively, the spell can locate the nearest object of a particular kind, such as a certain kind of apparel, jewelry, furniture, tool, or weapon." + "\n   " + "This spell can't locate an object if any thickness of lead blocks a direct path between you and the object."
});
legacySpellRefactor("longstrider", {
    name: "Longstrider",
    classes: ["artificer", "bard", "druid", "ranger", "wizard"],
    source: [
        ["P24", 293]
    ],
    level: 1,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A pinch of dirt",
    duration: "1 h",
    description: "1+1/SL creature's speed increases by 10 ft for the duration",
    descriptionFull: "You touch a creature. The target's Speed increases by 10 feet until the spell ends." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("mage armor", {
    name: "Mage Armor",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 293]
    ],
    level: 1,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A piece of cured leather",
    duration: "8 h",
    description: "1 creature that isn't wearing armor has AC 13 + Dex modifier; spell ends if it dons armor",
    descriptionFull: "You touch a willing creature who isn't wearing armor. Until the spell ends, the target's base AC becomes 13 plus its Dexterity modifier. The spell ends early if the target dons armor."
});
legacySpellRefactor("mage hand", {
    name: "Mage Hand",
    classes: ["artificer", "bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 293]
    ],
    level: 0,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "1 min",
    description: "Spectral hand does simple task in 30ft; carries up to 10 lb; 1 a to control again; only 1 instance ",
    descriptionFull: "A spectral, floating hand appears at a point you choose within range. The hand lasts for the duration. The hand vanishes if it is ever more than 30 feet away from you or if you cast this spell again." + "\n   " + "When you cast the spell, you can use the hand to manipulate an object, open an unlocked door or container, stow or retrieve an item from an open container, or pour the contents out of a vial." + "\n   " + "As a Magic action on your later turns, you can control the hand thus again. As part of that action, you can move the hand up to 30 feet.." + "\n   " + "The hand can't attack, activate magic items, or carry more than 10 pounds."
});
legacySpellRefactor("magic circle", {
    name: "Magic Circle",
    nameShort: "Magic Circle*",
    classes: ["cleric", "paladin", "warlock", "wizard"],
    source: [
        ["P24", 293]
    ],
    level: 3,
    school: "Abjur",
    time: "1 min",
    range: "10 ft",
    components: "V,S,M\u2020",
    compMaterial: "Salt and powdered silver worth 100+ gp, which the spell consumes",
    duration: "1 h",
    description: "20\xD720ft cyl.; celes, elem, fey, fiends, undead can't go in/out; dis on atk; +1h/SL dur.; see B (100gp cons.)",
    descriptionFull: "You create a 10-foot-radius, 20-foot-tall cylinder of magical energy centered on a point on the ground that you can see within range. Glowing runes appear wherever the cylinder intersects with the floor or other surface." + "\n   " + "Choose one or more of the following types of creatures: Celestials, Elementals, Fey, Fiends, or Undead. The circle affects a creature of the chosen type in the following ways:" + "\n " + "\u2022 The creature can't willingly enter the cylinder by nonmagical means. If the creature tries to use teleportation or interplanar travel to do so, it must first succeed on a Charisma saving throw." + "\n " + "\u2022 The creature has Disadvantage on attack rolls against targets within the Cylinder." + "\n " + "\u2022 Targets within the Cylinder can't be possessed by or gain the Charmed or Frightened condition from the creature." + "\n\n" + "Each time you cast this spell, you can cause its magic to operate in the reverse direction, preventing a creature of the specified type from leaving the Cylinder and protecting targets outside it." + AtHigherLevels + "The duration increases by 1 hour for each spell slot level above 3."
});
legacySpellRefactor("magic jar", {
    name: "Magic Jar",
    nameShort: "Magic Jar*",
    classes: ["wizard"],
    source: [
        ["P24", 294]
    ],
    level: 6,
    school: "Necro",
    time: "1 min",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "A gem, crystal, reliquary worth 500+ gp",
    duration: "Till dispelled",
    description: "Transport my soul into container from which I can attempt to possess humanoids; see book (500gp)",
    descriptionFull: "Your body falls into a catatonic state as your soul leaves it and enters the container you used for the spell's Material component. While your soul inhabits the container, you are aware of your surroundings as if you were in the container's space. You can't move or take Reactions. The only action you can take is to project your soul up to 100 feet out of the container, either returning to your living body (and ending the spell) or attempting to possess a Humanoid's body." + "\n   " + "You can attempt to possess any Humanoid within 100 feet of you that you can see (creatures warded by a Protection from Evil and Good or Magic Circle spell can't be possessed). The target makes a Charisma saving throw. On a failed save, your soul enters the target's body, and the target's soul becomes trapped in the container. On a successful save, the target resists your efforts to possess it, and you can't attempt to possess it again for 24 hours." + "\n   " + "Once you possess a creature's body, you control it. Your Hit Points, Hit Point Dice, Strength, Dexterity, Constitution, Speed, and senses are replaced by the creature's. You otherwise keep your game statistics." + "\n   " + "Meanwhile, the possessed creature's soul can perceive from the container using its own senses, but it can't move and it is Incapacitated." + "\n   " + "While possessing a body, you can take a Magic action to return from the host body to the container if it is within 100 feet of you, returning the host creature's soul to its body. If the host body dies while you're in it, the creature dies, and you make a Charisma saving throw against your own spellcasting DC. On a success, you return to the container if it is within 100 feet of you. Otherwise, you die." + "\n   " + "If the container is destroyed or the spell ends, your soul returns to your body. If your body is more than 100 feet away from you or if your body is dead, you die. If another creature's soul is in the container when it is destroyed, the creature's soul returns to its body if the body is alive and within 100 feet. Otherwise, that creature dies." + "\n   " + "When the spell ends, the container is destroyed."
});
legacySpellRefactor("magic missile", {
    name: "Magic Missile",
    nameShort: "Magic Missile*",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 295]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "3+1/SL darts hit same or different creatures for 1d4+1 Force dmg per dart",
    descriptionFull: "You create three glowing darts of magical force. Each dart strikes a creature of your choice that you can see within range. A dart deals 1d4 + 1 Force damage to its target. The darts all strike simultaneously, and you can direct them to hit one creature or several." + AtHigherLevels + "The spell creates one more dart for each spell slot level above 1.",
    dynamicDamageBonus: {
        multipleDmgMoments: true
    }
});
legacySpellRefactor("magic mouth", {
    name: "Magic Mouth",
    nameShort: "Magic Mouth*",
    classes: ["artificer", "bard", "wizard"],
    source: [
        ["P24", 295]
    ],
    ritual: true,
    level: 2,
    school: "Illus",
    time: "1 min",
    range: "30 ft",
    components: "V,S,M\u2020",
    compMaterial: "Jade dust worth 10+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "Implant message into object (up to 25 words \u0026 10 min) that is uttered on chosen trigger (10gp cons.)",
    descriptionFull: "You implant a message within an object in range ‚Äî a message that is uttered when a trigger condition is met. Choose an object that you can see and that isn't being worn or carried by another creature. Then speak the message, which must be 25 words or fewer, though it can be delivered over as long as 10 minutes. Finally, determine the circumstance that will trigger the spell to deliver your message." + "\n   " + "When that trigger occurs, a magical mouth appears on the object and recites the message in your voice and at the same volume you spoke. If the object you chose has a mouth or something that looks like a mouth (for example, the mouth of a statue), the magical mouth appears there, so the words appear to come from the object's mouth. When you cast this spell, you can have the spell end after it delivers its message, or it can remain and repeat its message whenever the trigger occurs." + "\n   " + "The trigger can be as general or as detailed as you like, though it must be based on visual or audible conditions that occur within 30 feet of the object. For example, you could instruct the mouth to speak when any creature moves within 30 feet of the object or when a silver bell rings within 30 feet of it."
});
legacySpellRefactor("magic weapon", {
    name: "Magic Weapon",
    classes: ["artificer", "paladin", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 295]
    ],
    level: 2,
    school: "Trans",
    time: "1 bns",
    range: "Touch",
    components: "V,S",
    duration: "1 h",
    description: "1 nonmagical weapon becomes magical with +1 to atk \u0026 dmg; 1 instance only; SL3+: +2, SL6+: +3",
    descriptionFull: "You touch a nonmagical weapon. Until the spell ends, that weapon becomes a magic weapon with a +1 bonus to attack rolls and damage rolls. The spell ends early if you cast it again." + AtHigherLevels + "The bonus increases to +2 with a level 3‚Äì5 spell slot. The bonus increases to +3 with a level 6+ spell slot."
});
legacySpellRefactor("major image", {
    name: "Major Image",
    nameShort: "Major Image*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 295]
    ],
    level: 3,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A bit of fleece",
    duration: "Conc, 10 min",
    description: "20-ft cube illusion includes sight, sounds, smells, temperature; 1 a move; SL4+: no conc; see book",
    descriptionFull: "You create the image of an object, a creature, or some other visible phenomenon that is no larger than a 20-foot Cube. The image appears at a spot that you can see within range and lasts for the duration. It seems real, including sounds, smells, and temperature appropriate to the thing depicted, but it can't deal damage or cause conditions." + "\n   " + "If you are within range of the illusion, you can take a Magic action to cause the image to move to any other spot within range. As the image changes location, you can alter its appearance so that its movements appear natural for the image. For example, if you create an image of a creature and move it, you can alter the image so that it appears to be walking. Similarly, you can cause the illusion to make different sounds at different times, even making it carry on a conversation, for example." + "\n   " + "Physical interaction with the image reveals it to be an illusion, for things can pass through it. A creature that takes a Study action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and its other sensory qualities become faint to the creature." + AtHigherLevels + "The spell lasts until dispelled, without requiring Concentration, if cast with a level 4+ spell slot."
});
legacySpellRefactor("mass cure wounds", {
    name: "Mass Cure Wounds",
    nameShort: "Mass Cure Wounds*",
    classes: ["bard", "cleric", "druid"],
    source: [
        ["P24", 296]
    ],
    level: 5,
    school: "Abjur",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "6 creatures within 30-ft rad of visible point heal 5d8+1d8/SL+spellcasting ability modifier HP",
    descriptionFull: "A wave of healing energy washes out from a point you can see within range. Choose up to six creatures in a 30-foot-radius Sphere centered on that point. Each target regains Hit Points equal to 5d8 plus your spellcasting ability modifier." + AtHigherLevels + "The healing increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("mass heal", {
    name: "Mass Heal",
    nameShort: "Mass Heal*",
    classes: ["cleric"],
    source: [
        ["P24", 296]
    ],
    level: 9,
    school: "Abjur",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Heal 700 HP split among any creatures; each healed also cured of Blinded, Deafened, and Poisoned",
    descriptionShorter: "Heal 700 HP split over any crea in range; each healed cured of blindness, deafness, poison",
    descriptionFull: "A flood of healing energy flows from you into creatures around you. You restore up to 700 Hit Points, divided as you choose among any number of creatures that you can see within range. Creatures healed by this spell also have the Blinded, Deafened, and Poisoned conditions removed from them."
});
legacySpellRefactor("mass healing word", {
    name: "Mass Healing Word",
    nameShort: "Mass Healing Word*",
    classes: ["bard", "cleric"],
    source: [
        ["P24", 296]
    ],
    level: 3,
    school: "Abjur",
    time: "1 bns",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    description: "6 creatures heal 2d4+1d4/SL+spellcasting ability modifier HP",
    descriptionFull: "Up to six creatures of your choice that you can see within range regain Hit Points equal to 2d4 plus your spellcasting ability modifier." + AtHigherLevels + "The healing increases by 1d4 for each spell slot level above 3."
});
legacySpellRefactor("mass suggestion", {
    name: "Mass Suggestion",
    nameShort: "Mass Suggestion*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 296]
    ],
    level: 6,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,M",
    compMaterial: "A snake's tongue",
    duration: "24 h",
    save: "Wis",
    description: "12 crea save or Charmed; do action said in 25 wrds; SL7: 10 days; SL8: 30 days; SL9: 366 days; see B",
    descriptionFull: "You suggest a course of activity ‚Äî described in no more than 25 words ‚Äî to twelve or fewer creatures you can see within range that can hear and understand you. The suggestion must sound achievable and not involve anything that would obviously deal damage to any of the targets or their allies. For example, you could say, \"Walk to the village down that road, and help the villagers there harvest crops until sunset.\" Or you could say, \"Now is not the time for violence. Drop your weapons, and dance! Stop in an hour.\"" + "\n   " + "Each target must succeed on a Wisdom saving throw or have the Charmed condition for the duration or until you or your allies deal damage to the target. Each Charmed target pursues the suggestion to the best of its ability. The suggested activity can continue for the entire duration, but if the suggested activity can be completed in a shorter time, the spell ends for a target upon completing it." + AtHigherLevels + "The duration is longer with a spell slot of level 7 (10 days), 8 (30 days), or 9 (366 days)."
});
legacySpellRefactor("maze", {
    name: "Maze",
    nameShort: "Maze*",
    classes: ["wizard"],
    source: [
        ["P24", 296]
    ],
    level: 8,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "1 creature banished to demiplane; DC 20 Int (Investigation) check to escape; appears in same spot",
    descriptionFull: "You banish a creature that you can see within range into a labyrinthine demiplane. The target remains there for the duration or until it escapes the maze." + "\n   " + "The target can take a Study action to try to escape. When it does so, it makes a DC 20 Intelligence (Investigation) check. If it succeeds, it escapes, and the spell ends." + "\n   " + "When the spell ends, the target reappears in the space it left or, if that space is occupied, in the nearest unoccupied space."
});
legacySpellRefactor("meld into stone", {
    name: "Meld into Stone",
    classes: ["cleric", "druid", "ranger"],
    source: [
        ["P24", 296]
    ],
    ritual: true,
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "8 h",
    description: "I merge into stone object large enough to contain me; can't see through stone; 1 a leave; see book",
    descriptionFull: "You step into a stone object or surface large enough to fully contain your body, merging yourself and your equipment with the stone for the duration. You must touch the stone to do so. Nothing of your presence remains visible or otherwise detectable by nonmagical senses." + "\n   " + "While merged with the stone, you can't see what occurs outside it, and any Wisdom (Perception) checks you make to hear sounds outside it are made with Disadvantage. You remain aware of the passage of time and can cast spells on yourself while merged in the stone. You can use 5 feet of movement to leave the stone where you entered it, which ends the spell. You otherwise can't move." + "\n   " + "Minor physical damage to the stone doesn't harm you, but its partial destruction or a change in its shape (to the extent that you no longer fit within it) expels you and deals 6d6 Force damage to you. The stone's complete destruction (or transmutation into a different substance) expels you and deals 50 Force damage to you. If expelled, you move into an unoccupied space closest to where you first entered and have the Prone condition."
});
legacySpellRefactor("melf's acid arrow", {
    name: "Melf's Acid Arrow",
    nameAlt: "Acid Arrow",
    classes: ["wizard"],
    source: [
        ["P24", 297]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "Powdered rhubarb leaf",
    duration: "Instantaneous",
    description: "Spell attack for 4d4+1d4/SL Acid and 2d4+1d4/SL next turn end; on miss only take half initial dmg",
    descriptionShorter: "Spell atk for 4d4+1d4/SL Acid dmg \u0026 2d4+1d4/SL next EoT; miss: half 1st dmg only",
    descriptionFull: "A shimmering green arrow streaks toward a target within range and bursts in a spray of acid. Make a ranged spell attack against the target. On a hit, the target takes 4d4 Acid damage and 2d4 Acid damage at the end of its next turn. On a miss, the arrow splashes the target with acid for half as much of the initial damage only." + AtHigherLevels + "The damage (both initial and later) increases by 1d4 for each spell slot level above 2.",
    dynamicDamageBonus: {
        extraDmgGroupsSameType: /(and |\u0026 )((?:\+?\d+d?\d*)+)(\+1d4\/SL)/i
    }
});
legacySpellRefactor("mending", {
    name: "Mending",
    classes: ["artificer", "bard", "cleric", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 297]
    ],
    level: 0,
    school: "Trans",
    time: "1 min",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "Two lodestones",
    duration: "Instantaneous",
    description: "Repair a single broken object no larger than 1 cu ft; can't restore magic to broken magic item",
    descriptionFull: "This spell repairs a single break or tear in an object you touch, such as a broken chain link, two halves of a broken key, a torn clack, or a leaking wineskin. As long as the break or tear is no larger than 1 foot in any dimension, you mend it, leaving no trace of the former damage." + "\n   " + "This spell can physically repair a magic item, but the spell can't restore magic to such an object."
});
legacySpellRefactor("message", {
    name: "Message",
    classes: ["artificer", "bard", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "120 ft",
    components: "S,M",
    compMaterial: "A copper wire",
    duration: "1 round",
    description: "1 crea I point toward hears whispered message and can reply with a whisper; nobody can overhear",
    descriptionFull: "You point toward a creature within range and whisper a message. The target (and only the target) hears the message and can reply in a whisper that only you can hear." + "\n   " + "You can cast this spell through solid objects if you are familiar with the target and know it is beyond the barrier. Magical silence; 1 foot of stone, metal, or wood; or a thin sheet of lead blocks the spell."
});
legacySpellRefactor("meteor swarm", {
    name: "Meteor Swarm",
    nameShort: "Meteor Swarm*",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 9,
    school: "Evoc",
    time: "1 a",
    range: "1 mile",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "4x 40-ft rad all 20d6 Bludgeoning and 20d6 Fire; save 1/2; areas don't stack; unattended obj ignite",
    descriptionFull: "Blazing orbs of fire plummet to the ground at four different points you can see within range. Each creature in a 40-foot-radius Sphere centered on each of those points makes a Dexterity saving throw. A creature takes 20d6 Fire damage and 20d6 Bludgeoning damage on a failed save or half as much damage on a successful one. A creature in the area of more than one fiery Sphere is affected only once." + "\n   " + "A nonmagical object that isn't being worn or carried also takes the damage if it's in the spell's area, and the object starts burning if it's flammable."
});
legacySpellRefactor("mind blank", {
    name: "Mind Blank",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 8,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "24 h",
    description: "1 crea immune to Psychic, Charmed, mind reading, magical observation, mind control, divination",
    descriptionFull: "Until the spell ends, one willing creature you touch has Immunity to Psychic damage and the Charmed condition. The target is also unaffected by anything that would sense its emotions or alignment, read its thoughts, or magically detect its location, and no spell‚Äînot even Wish‚Äîcan gather information about the target, observe it remotely, or control its mind."
});
legacySpellRefactor("mind sliver", {
    name: "Mind Sliver",
    nameShort: "Mind Sliver*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 0,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "1 round",
    save: "Int",
    description: "1 crea save or 1d6 Psychic, -1d4 on first save before my next turn ends; +1d6 at CL 5, 11, and 17",
    descriptionShort: "1 crea save or 1d6 Psychic, -1d4 on 1st save before my next turn ends; +1d6 at CL 5/11/17",
    descriptionCantripDie: "1 crea save or `CD`d6 Psychic and -1d4 from first saving throw before my next turn ends",
    descriptionFull: "You try to temporarily sliver the mind of one creature you can see within range. The target must succeed on an Intelligence saving throw or take 1d6 Psychic damage and subtract 1d4 from the next saving throw it makes before the end of your next turn." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d6 when you reach levels 5 (2d6), 11 (3d6), and 17 (4d6)."
});
legacySpellRefactor("mind spike", {
    name: "Mind Spike",
    nameShort: "Mind Spike*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 2,
    school: "Div",
    time: "1 a",
    range: "120 ft",
    components: "S",
    duration: "Conc, 1 h",
    save: "Wis",
    description: "1 creature 3d8+1d8/SL Psychic, know location on plane, not Invisible for me; save half dmg only",
    descriptionShorter: "1 crea 3d8+1d8/SL Psychic dmg, know its location, can't be invis for me; save half, not rest",
    descriptionFull: "You drive a spike of psionic energy into the mind of one creature you can see within range. The target makes a Wisdom saving throw, taking 3d8 Psychic damage on a failed save or half as much damage on a successful one. On a failed save, you also always know the target's location until the spell ends, but only while the two of you are on the same plane of existence. While you have this knowledge, the target can't become hidden from you, and if it has the Invisible condition, it gains no benefit from that condition against you." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 2.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("minor illusion", {
    name: "Minor Illusion",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 298]
    ],
    level: 0,
    school: "Illus",
    time: "1 a",
    range: "30 ft",
    components: "S,M",
    compMaterial: "A bit of fleece",
    duration: "1 min",
    description: "5-ft cube illusion includes visual or sound; Int(Investigation) check vs spell DC; see book",
    descriptionFull: "You create a sound or an image of an object within range that lasts for the duration. See the descriptions below for the effects of each. The illusion ends if you cast this spell again." + "\n   " + "If a creature takes a Study action to examine the sound or image, the creature can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the illusion becomes faint to the creature." + "\n   " + "Sound. If you create a sound, its volume can range from a whisper to a scream. It can be your voice, someone else's voice, a lion's roar, a beating of drums, or any other sound you choose. The sound continues unabated throughout the duration, or you can make discrete sounds at different times before the spell ends." + "\n   " + "Image. If you create an image of an object‚Äîsuch as a chair, muddy footprints, or a small chest‚Äîit must be no larger than a 5-foot Cube. The image can't create sound, light, smell, or any other sensory effect. Physical interaction with the image reveals it to be an illusion, since things can pass through it."
});
legacySpellRefactor("mirage arcane", {
    name: "Mirage Arcane",
    classes: ["bard", "druid", "wizard"],
    source: [
        ["P24", 299]
    ],
    level: 7,
    school: "Illus",
    time: "10 min",
    range: "Sight",
    components: "V,S",
    duration: "10 days",
    description: "1 sq mile terrain illusion includes visual, audible, olfactory, tactile; add/remove difficult terrain.; see B",
    descriptionMetric: "260 ha alter terrain illusion includes visible, audible, olfactory, tactile; can make difficult ter.; see B",
    descriptionFull: "You make terrain in an area up to 1 mile square look, sound, smell, and even feel like some other sort of terrain. Open fields or a road could be made to resemble a swamp, hill, crevasse, or some other rough or impassable terrain. A pond can be made to seem like a grassy meadow, a precipice like a gentle slope, or a rock-strewn gully like a wide and smooth road." + "\n   " + "Similarly, you can alter the appearance of structures, or add them where none are present. The spell doesn't disguise, conceal or add creatures." + "\n   " + "The illusion includes audible, visual, tactile, and olfactory elements, so it can turn clear ground into difficult terrain (or vice versa) or otherwise impede movement through the area. Any piece of the illusory terrain (such as a rock or stick) that is removed from the spell's area disappears immediately." + "\n   " + "Creatures with Truesight can see through the illusion to the terrain's true form, however, all other elements of the illusion remain, so while the creature is aware of the illusion's presence, the creature can still physically interact with the illusion."
});
legacySpellRefactor("mirror image", {
    name: "Mirror Image",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 299]
    ],
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "1 min",
    description: "3 illusory duplicates; if hit \u0026 atker not Blind/Blindsight/Truesight roll 1d6 per; >2 any d6, destroys dup",
    descriptionFull: "Three illusory duplicates of yourself appear in your space. Until the spell ends, the duplicates move with you and mimic your actions, shifting position so it's impossible to track which image is real." + "\n   " + "Each time a creature hits you with an attack roll during the spell's duration, roll a d6 for each of your remaining duplicates. If any of the d6s rolls a 3 or higher, one of the duplicates is hit instead of you, and the duplicate is destroyed. The duplicates otherwise ignore all other damage and effects. The spell ends when all three duplicates are destroyed." + "\n   " + "A creature is unaffected by this spell if it has the Blinded condition, Blindsight, or Truesight."
});
legacySpellRefactor("mislead", {
    name: "Mislead",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 299]
    ],
    level: 5,
    school: "Illus",
    time: "1 a",
    range: "Self",
    components: "S",
    duration: "Conc, 1 h",
    description: "I go Invisible (till atk/dmg/cast) \u0026 create illusory duplicate; see/hear through it; 1 a manipulate",
    descriptionFull: "You gain the Invisible condition at the same time that an illusory double of you appears where you are standing. The double lasts for the duration, but the invisibility ends immediately after you make an attack roll, deal damage, or cast a spell." + "\n   " + "As a Magic action, you can move the illusory double up to twice your Speed and make it gesture, speak, and behave in whatever way you choose. It is intangible and invulnerable." + "\n   " + "You can see through its eyes and hear through its ears as if you were located where it is."
});
legacySpellRefactor("misty step", {
    name: "Misty Step",
    nameShort: "Misty Step*",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 299]
    ],
    level: 2,
    school: "Conj",
    time: "1 bns",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    description: "I teleport up to 30 feet to an unoccupied space I can see",
    descriptionFull: "Briefly surrounded by silvery mist, you teleport up to 30 feet to an unoccupied space you can see."
});
legacySpellRefactor("modify memory", {
    name: "Modify Memory",
    nameShort: "Modify Memory*",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 299]
    ],
    level: 5,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 creature save or Charmed; alter 1 memory in last (SL6: 7, SL7: 30, SL8: 365, SL9: any) day; see B",
    descriptionFull: "You attempt to reshape another creature's memories. One creature that you can see within range makes a Wisdom saving throw. If you are fighting the creature, it has Advantage on the save. On a failed save, the target has the Charmed condition for the duration. While Charmed in this way, the target also has the Incapacitated condition and is unaware of its surroundings, though it can hear you. If it takes any damage or is targeted by another spell, this spell ends, and no memories are modified." + "\n   " + "While this charm lasts, you can affect the target's memory of an event that it experienced within the last 24 hours and that lasted no more than 10 minutes. You can permanently eliminate all memory of the event, allow the target to recall the event with perfect clarity, change its memory of the event's details, or create a memory of some other event." + "\n   " + "You must speak to the target to describe how its memories are affected, and it must be able to understand your language for the modified memories to take root. Its mind fills in any gaps in the details of your description. If the spell ends before you finish describing the modified memories, the creature's memory isn't altered. Otherwise, the modified memories take hold when the spell ends." + "\n   " + "A modified memory doesn't necessarily affect how a creature behaves, particularly if the memory contradicts the creature's natural inclinations, alignment, or beliefs. An illogical modified memory, such as a false memory of how much the creature enjoyed swimming in acid, is dismissed as a bad dream. The DM might deem a modified memory too nonsensical to affect a creature." + "\n   " + "A Remove Curse or Greater Restoration spell cast on the target restores the creature's true memory." + AtHigherLevels + "You can alter the target's memories of an event that took place up to 7 days ago (level 6 spell slot), 30 days ago (level 7 spell slot), 365 days ago (level 8 spell slot), or any time in the creature's past (level 9 spell slot)."
});
legacySpellRefactor("moonbeam", {
    name: "Moonbeam",
    classes: ["druid"],
    source: [
        ["P24", 300]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A moonseed leaf",
    duration: "Conc, 1 min",
    save: "Con",
    description: "10\xD740ft cyl.; all now/cover/enter/end 2d10+1d10/SL Radiant (1/t/c); save 1/2; 1 a move 60ft; see B",
    descriptionShorter: "10\xD740ft cyl. all now/cover/enter/end 2d10+1d10/SL Rad.; save 1/2; 1 a move 60ft; see B",
    descriptionFull: "A silvery beam of pale light shines down in a 5-foot-radius, 40-foot-high Cylinder centered on a point within range. Until the spell ends, Dim Light fills the Cylinder, and you can take a Magic action on later turns to move the Cylinder up to 60 feet." + "\n   " + "When the Cylinder appears, each creature in it makes a Constitution saving throw. On a failed save, a creature takes 2d10 Radiant damage, and if the creature is shape-shifted (as a result of the Polymorph spell, for example), it reverts to its true form and can't shape-shift until it leaves the Cylinder. On a successful save, a creature takes half as much damage only. A creature also makes this save when the spell's area moves into its space and when it enters the spell's area or ends its turn there. A creature makes this save only once per turn." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 2."
});
legacySpellRefactor("mordenkainen's faithful hound", {
    name: "Mordenkainen's Faithful Hound",
    nameShort: "Mor. Faithful Hound*",
    nameAlt: "Faithful Hound",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 300]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A silver whistle",
    duration: "8 h",
    save: "Dex",
    description: "Invisible dog: Truesight, barks at crea in 30ft; my turn 1 crea in 5ft save or 4d8 Force; 1 a move 30ft",
    descriptionShorter: "Invisible dog barks at crea in 30ft; 1/rnd save or 4d8 Force; Truesight; see B",
    descriptionFull: "You conjure a phantom watchdog in an unoccupied space that you can see within range. The hound remains for the duration or until the two of you are more than 300 feet apart from each other." + "\n   " + "No one but you can see the hound, and it is intangible and invulnerable. When a Small or larger creature comes within 30 feet of it without first speaking the password that you specify when you cast this spell, the hound starts barking loudly. The hound has Truesight with a range of 30 feet." + "\n   " + "At the start of each of your turns, the hound attempts to bite one enemy within 5 feet of it. That enemy must succeed on a Dexterity saving throw or take 4d8 Force damage." + "\n   " + "On your later turns, you can take a Magic action to move the hound up to 30 feet."
});
legacySpellRefactor("mordenkainen's magnificent mansion", {
    name: "Mordenkainen's Magnificent Mansion",
    nameShort: "Mor. Magni. Mansion",
    nameAlt: "Magnificent Mansion",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 300]
    ],
    level: 7,
    school: "Conj",
    time: "1 min",
    range: "300 ft",
    components: "V,S,M\u0192",
    compMaterial: "A miniature door worth 15+ gp",
    duration: "24 h",
    description: "Create extradimensional mansion with rooms, food and servants to serve 100 people; see book (15gp)",
    descriptionFull: "You conjure a shimmering door in range that lasts for the duration. The door leads to an extradimensional dwelling and is 5 feet wide and 10 feet tall. You and any creature you designate when you cast the spell can enter the extradimensional dwelling as long as the door remains open. You can open or close it (no action required) if you are within 30 feet of it. While closed, the door is imperceptible." + "\n   " + "Beyond the door is a magnificent foyer with numerous chambers beyond. The dwelling's atmosphere is clean, fresh, and warm." + "\n   " + "You can create any floor plan you like for the dwelling, but it can't exceed 50 contiguous 10-foot Cubes. The place is furnished and decorated as you choose. It contains sufficient food to serve a nine-course banquet for up to 100 people. Furnishings and other objects created by this spell dissipate into smoke if removed from it." + "\n   " + "A staff of 100 near-transparent servants attends all who enter. You determine the appearance of these servants and their attire. They are invulnerable and obey your commands. Each servant can perform tasks that a human could perform, but they can't attack or take any action that would directly harm another creature. Thus the servants can fetch things, clean, mend, fold clothes, light fires, serve food, pour wine, and so on. The servants can't leave the dwelling." + "\n   " + "When the spell ends, any creatures or objects left inside the extradimensional space are expelled into the unoccupied spaces nearest to the entrance."
});
legacySpellRefactor("mordenkainen's private sanctum", {
    name: "Mordenkainen's Private Sanctum",
    nameShort: "Mor. Private Sanctum",
    nameAlt: "Private Sanctum",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 301]
    ],
    level: 4,
    school: "Abjur",
    time: "10 min",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A thin sheet of lead",
    duration: "24 h",
    description: "Up to 100+100/SL sq ft cube is magically secured in chosen way; see book",
    descriptionFull: "You make an area within range magically secure. The area is a Cube that can be as small as 5 feet to as large as 100 feet on each side. The spell lasts for the duration." + "\n   " + "When you cast the spell, you decide what sort of security the spell provides, choosing any of the following properties." + "\n " + "\u2022 Sound can't pass through the barrier at the edge of the warded area." + "\n " + "\u2022 The barrier of the warded area appears dark and foggy, preventing vision (including Darkvision) through it." + "\n " + "\u2022 Sensors created by Divination spells can't appear inside the protected area or pass through the barrier at its perimeter." + "\n " + "\u2022 Creatures in the area can't be targeted by Divination spells." + "\n " + "\u2022 Nothing can teleport into or out of the warded area." + "\n " + "\u2022 Planar travel is blocked within the warded area." + "\n\n" + "Casting this spell on the same spot every day for 365 days makes the spell last until dispelled." + AtHigherLevels + "You can increase the size of the Cube by 100 feet for each spell slot level above 4."
});
legacySpellRefactor("mordenkainen's sword", {
    name: "Mordenkainen's Sword",
    nameAlt: "Arcane Sword",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 302]
    ],
    level: 7,
    school: "Evoc",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A miniature sword worth 250+ gp",
    duration: "Conc, 1 min",
    description: "Hovering sword makes melee spell attack for 4d12 Force; bns to move 30 ft and attack again",
    descriptionShorter: "Hovering sword makes melee spell atk 4d12 Force; bns to move 30 ft and attack",
    descriptionFull: "You create a spectral sword that hovers within range. It lasts for the duration." + "\n   " + "When the sword appears, you make a melee spell attack against a target within 5 feet of the sword. On a hit, the target takes Force damage equal to 4d12 plus your spellcasting ability modifier." + "\n   " + "On your later turns, you can take a Bonus Action to move the sword up to 30 feet to a spot you can see and repeat the attack against the same target or a different one."
});
legacySpellRefactor("move earth", {
    name: "Move Earth",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 302]
    ],
    level: 6,
    school: "Trans",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A miniature shovel",
    duration: "Conc, 2 h",
    description: "Every 10 min of concentration, gradually reshape 40 cu ft of dirt, sand, or clay; see book",
    descriptionFull: "Choose an area of terrain no larger than 40 feet on a side within range. You can reshape dirt, sand, or clay in the area in any manner you choose for the duration. You can raise or lower the area's elevation, create or fill in a trench, erect or flatten a wall, or form a pillar. The extent of any such changes can't exceed half the area's largest dimension. For example, if you affect a 40-foot square, you can create a pillar up to 20 feet high, raise or lower the square's elevation by up to 20 feet, dig a trench up to 20 feet deep, and so on. It takes 10 minutes for these changes to complete. Because the terrain's transformation occurs slowly, creatures in the area can't usually be trapped or injured by the ground's movement." + "\n   " + "At the end of every 10 minutes you spend concentrating on the spell, you can choose a new area of terrain to affect within range." + "\n   " + "This spell can't manipulate natural stone or stone construction. Rocks and structures shift to accommodate the new terrain. If the way you shape the terrain would make a structure unstable, it might collapse." + "\n   " + "Similarly, this spell doesn't directly affect plant growth. The moved earth carries any plants along with it."
});
legacySpellRefactor("nondetection", {
    name: "Nondetection",
    classes: ["bard", "ranger", "wizard"],
    source: [
        ["P24", 302]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A pinch of diamond dust worth 25+ gp, which the spell consumes",
    duration: "8 h",
    description: "1 willing creature or object up to 10 cu ft hidden from all Divination spells (25gp cons.)",
    descriptionFull: "For the duration, you hide a target that you touch from Divination spells. The target can be a willing creature, or it can be a place or an object no larger than 10 feet in any dimension. The target can't be targeted by any Divination spell or perceived through magical scrying sensors."
});
legacySpellRefactor("nystul's magic aura", {
    name: "Nystul's Magic Aura",
    nameAlt: "Arcanist's Magic Aura",
    classes: ["wizard"],
    source: [
        ["P24", 302]
    ],
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A small square of silk",
    duration: "24 h",
    description: "1 willing crea is dif. type for spells/magic effects or 1 obj hides/adds/changes magic aura; see B",
    descriptionFull: "With a touch, you place an illusion on a willing creature or an object that isn't being worn or carried. A creature gains the Mask effect below, and an object gains the False Aura effect below. The effect lasts for the duration. If you cast the spell on the same target every day for 30 days, the illusion lasts until dispelled." + "\n   " + toUni("False Aura (Object).") + ": You change the way the target appears to spells and magical effects that detect magical auras, such as Detect Magic. You can make a nonmagical object appear magical, make a magic item appear nonmagical, or change the object's aura so that it appears to belong to a school of magic you choose." + "\n   " + toUni("Mask (Creature).") + ": Choose a creature type other than the target's actual type. Spells and other magical effects treat the target as if it were a creature of the chosen type."
});
legacySpellRefactor("otiluke's freezing sphere", {
    name: "Otiluke's Freezing Sphere",
    nameAlt: "Freezing Sphere",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 302]
    ],
    level: 6,
    school: "Evoc",
    time: "1 a",
    range: "300 ft",
    components: "V,S,M",
    compMaterial: "A miniature crystal sphere",
    duration: "Instantaneous",
    save: "Con",
    description: "60ft rad all 10d6+1d6/SL Cold; save 1/2; freeze 30ft sq water \u0026 restrain crea; save up to 1 min then use",
    descriptionFull: "A frigid globe streaks from you to a point of your choice within range, where it explodes in a 60-foot-radius Sphere. Each creature in that area makes a Constitution saving throw, taking 10d6 Cold damage on failed save or half as much damage on a successful one." + "\n   " + "If the globe strikes a body of water, it freezes the water to a depth of 6 inches over an area 30 feet square. This ice lasts for 1 minute. Creatures that were swimming on the surface of frozen water are trapped in the ice and have the Restrained condition. A trapped creature can take an action to make a Strength (Athletics) check against your spell save DC to break free." + "\n   " + "You can refrain from firing the globe after completing the spell's casting. If you do so, a globe about the size of a sling bullet, cool to the touch, appears in your hand. At any time, you or a creature you give the globe to can throw the globe (to a range of 40 feet) or hurl it with a sling (to the sling's normal range). It shatters on impact, with the same effect as a normal casting of the spell. You can also set the globe down without shattering it. After 1 minute, if the globe hasn't already shattered, it explodes." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 6."
});
legacySpellRefactor("otiluke's resilient sphere", {
    name: "Otiluke's Resilient Sphere",
    nameAlt: "Resilient Sphere",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 303]
    ],
    level: 4,
    school: "Abjur",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A glass sphere",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "1 \u2264Large crea/obj save or enclosed in impenetrable sphere; can move as hamster ball at half speed",
    descriptionFull: "A shimmering sphere encloses a Large or smaller creature or object within range. An unwilling creature must succeed on a Dexterity saving throw or be enclosed for the duration." + "\n   " + "Nothing‚Äînot physical objects, energy, or other spell effects‚Äîcan pass through the barrier, in or out, though a creature in the sphere can breathe there. The sphere is immune to all damage, and a creature or object inside can't be damaged by attacks or effects originating from outside, nor can a creature inside the sphere damage anything outside it." + "\n   " + "The sphere is weightless and just large enough to contain the creature or object inside. An enclosed creature can use its action to push against the sphere's walls and thus roll the sphere at up to half the creature's speed. Similarly, the globe can be picked up and moved by other creatures." + "\n   " + "A Disintegrate spell targeting the globe destroys it without harming anything inside."
});
legacySpellRefactor("otto's irresistible dance", {
    name: "Otto's Irresistible Dance",
    nameShort: "Otto's Irresistible Dance*",
    nameAlt: "Irresistible Dance",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 303]
    ],
    level: 6,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V",
    duration: "Conc, 1 min",
    description: "1 crea pass: dance to next EoT; fail: Charmed, no move, dis. atk/Dex saves, adv. atk vs it; 1 a save to end",
    descriptionFull: "One creature that you can see within range must make a Wisdom saving throw. On a successful save, The target dances comically until the end of its next turn, during which it must spend all its movement to dance in place." + "\n   " + "On a failed save, the target has the Charmed condition for the duration. While Charmed, the target dances comically, must use all its movement to dance in place, and has Disadvantage on Dexterity saving throws and attack rolls, and other creatures have Advantage on attack rolls against it. On each of its turns, the target can take an action to collect itself and repeat the save, ending the spell on itself on a success."
});
legacySpellRefactor("passwall", {
    name: "Passwall",
    nameShort: "Passwall*",
    classes: ["wizard"],
    source: [
        ["P24", 303]
    ],
    level: 5,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A pinch of sesame seeds",
    duration: "1 h",
    description: "Create a passage (max 5 ft wide, 8 ft tall, 20 ft deep) in a wooden, plaster or stone surface for 1 h",
    descriptionFull: "A passage appears at a point that you can see on a wooden, plaster, or stone surface (such as a wall, ceiling, or floor) within range and lasts for the duration. You choose the opening's dimensions: up to 5 feet wide, 8 feet tall, and 20 feet deep. The passage creates no instability in a structure surrounding it." + "\n   " + "When the opening disappears, any creatures or objects still in the passage created by the spell are safely ejected to an unoccupied space nearest to the surface on which you cast the spell."
});
legacySpellRefactor("pass without trace", {
    name: "Pass Without Trace",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 303]
    ],
    level: 2,
    school: "Abjur",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S,M",
    compMaterial: "Ashes from burned mistletoe",
    duration: "Conc, 1 h",
    description: "For duration, me and any in area have +10 Dexterity (Stealth) checks and leave no tracks",
    descriptionFull: "You radiate a concealing aura in a 30-foot Emanation for the duration. While in the aura, you and each creature you choose have a +10 bonus to Dexterity (Stealth) checks and leave no tracks."
});
legacySpellRefactor("phantasmal force", {
    name: "Phantasmal Force",
    nameShort: "Phantasmal Force*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 304]
    ],
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A bit of fleece",
    duration: "Conc, 1 min",
    save: "Int",
    description: "1 crea save or see 10ft cu illusion; if harmful \u0026 in 5ft 2d8 Psychic/rnd; Int(Invest.) vs spell DC ends",
    descriptionShorter: "1 crea save or sees 10 ft cu illusion; 2d8 Psychic dmg/rnd; Investigation vs DC",
    descriptionFull: "You attempt to craft an illusion in the mind of a creature you can see within range. The target makes an Intelligence saving throw. On a failed save, you create a phantasmal object, creature, or other phenomenon that is no larger than a 10-foot Cube and that is perceivable only to the target for the duration. The phantasm includes sound, temperature, and other stimuli." + "\n   " + "The target can take a Study action to examine the phantasm with an Intelligence (Investigation) check against your spell save DC. If the check succeeds, the target realizes that the phantasm is an illusion, and the spell ends." + "\n   " + "While affected by the spell, the target treats the phantasm as if it were real and rationalizes any illogical outcomes from interacting with it. For example, if the target steps through a phantasmal bridge and survives the fall, it believes the bridge exists and something else caused it to fall." + "\n   " + "An affected target can even take damage from the illusion if the phantasm represents a dangerous creature or hazard. On each of your turns, such a phantasm can deal 2d8 Psychic damage to the target if it is in the phantasm's area or within 5 feet of the phantasm. The target perceives the damage as a type appropriate to the illusion."
});
legacySpellRefactor("phantasmal killer", {
    name: "Phantasmal Killer",
    nameShort: "Phantasmal Killer*",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 304]
    ],
    level: 4,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1 crea 4d10+1d10/SL Psychic; dis. on chks \u0026 atks; save 1/2 dmg only; EoT save, same dmg or end",
    descriptionFull: "You tap into the nightmares of a creature you can see within range and create an illusion of its deepest fears, visible only to that creature. The target makes a Wisdom saving throw. On a failed save, the target takes 4d10 Psychic damage and has Disadvantage on ability checks and attack rolls for the duration. On a successful save, the target takes half as much damage, and the spell ends." + "\n   " + "For the duration, the target makes a Wisdom saving throw at the end of each of its turns. On a failed save, it takes the Psychic damage again. On a successful save, the spell ends." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 4."
});
legacySpellRefactor("phantom steed", {
    name: "Phantom Steed",
    classes: ["wizard"],
    source: [
        ["P24", 304]
    ],
    ritual: true,
    level: 3,
    school: "Illus",
    time: "1 min",
    range: "30 ft",
    components: "V,S",
    duration: "1 h",
    description: "Summon Large quasi-real steed with 100 ft speed (13 mph); I designate rider; spell ends if takes dmg",
    descriptionFull: "A Large, quasi-real, horselike creature appears on the ground in an unoccupied space of your choice within range. You decide the creature's appearance, but it is equipped with a saddle, bit, and bridle. Any of the equipment created by the spell vanishes in a puff of smoke if it is carried more than 10 feet away from the steed." + "\n   " + "For the duration, you or a creature you choose can ride the steed. The steed uses the Riding Horse stat block (see appendix B), except it has a Speed of 100 feet and can travel 13 miles in an hour. When the spell ends, the steed gradually fades, giving the rider 1 minute to dismount. The spell ends early if the steed takes any damage."
});
legacySpellRefactor("planar ally", {
    name: "Planar Ally",
    classes: ["cleric"],
    source: [
        ["P24", 304]
    ],
    level: 6,
    school: "Conj",
    time: "10 min",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Celestial, elemental or fiend appears in location near me; can negotiate for service; see book",
    descriptionFull: "You beseech an otherworldly entity for aid. The being must be known to you: a god, a demon prince, or some other being of cosmic power. That entity sends a Celestial, an Elemental, or a Fiend loyal to it to aid you, making the creature appear in an unoccupied space within range. If you know a specific creature's name, you can speak that name when you cast this spell to request that creature, though you might get a different creature anyway (DM's choice)." + "\n   " + "When the creature appears, it is under no compulsion to behave a particular way. You can ask it to perform a service in exchange for payment, but it isn't obliged to do so. The requested task could range from simple (fly us across the chasm, or help us fight a battle) to complex (spy on our enemies, or protect us during our foray into the dungeon). You must be able to communicate with the creature to bargain for its services." + "\n   " + "Payment can take a variety of forms. A Celestial might require a sizable donation of gold or magic items to an allied temple, while a Fiend might demand a living sacrifice or a gift of treasure. Some creatures might exchange their service for a quest undertaken by you." + "\n   " + "A task that can be measured in minutes requires a payment worth 100 GP per minute. A task measured in hours requires 1,000 GP per hour. And a task measured in days (up to 10 days) requires 10,000 GP per day. The DM can adjust these payments based on the circumstances under which you cast the spell. If the task is aligned with the creature's ethos, the payment might be halved or even waived. Nonhazardous tasks typically require only half the suggested payment, while especially dangerous tasks might require a greater gift Creatures rarely accept tasks that seem suicidal." + "\n   " + "After the creature completes the task, or when the agreed-upon duration of service expires, the creature returns to its home plane after reporting back to you if possible. If you are unable to agree on a price for the creature's service, the creature immediately returns to its home plane."
});
legacySpellRefactor("planar binding", {
    name: "Planar Binding",
    classes: ["bard", "cleric", "druid", "warlock", "wizard"],
    source: [
        ["P24", 305]
    ],
    level: 5,
    school: "Abjur",
    time: "1 h",
    range: "60 ft",
    components: "V,S,M\u2020",
    compMaterial: "A jewel worth 1,000+ gp, which the spell consumes",
    duration: "24 h",
    save: "Cha",
    description: "1 celes./elem./fey/fiend save or bound; SL6: 10, SL7: 30, SL8: 180, SL9: 366 days (1000gp cons.); see B",
    descriptionFull: "You attempt to bind a Celestial, an Elemental, a Fey, or a Fiend to your service. The creature must be within range for the entire casting of the spell. (Typically, the creature is first summoned into the center of the inverted version of the Magic Circle spell to trap it while this spell is cast.) At the completion of the casting, the target must succeed on a Charisma saving throw or be bound to serve you for the duration. If the creature was summoned or created by another spell, that spell's duration is extended to match the duration of this spell." + "\n   " + "A bound creature must follow your commands to the best of its ability. You might command the creature to accompany you on an adventure, to guard a location, or to deliver a message. If the creature is Hostile, it strives to twist your commands to achieve its own objectives. If the creature carries out your commands completely before the spell ends, it travels to you to report this fact if you are on the same plane of existence. If you are on a different plane, it returns to the place where you bound it and remains there until the spell ends." + AtHigherLevels + "The duration increases with a spell slot of level 6 (10 days), 7 (30 days), 8 (180 days), and 9 (366 days)."
});
legacySpellRefactor("plane shift", {
    name: "Plane Shift",
    classes: ["cleric", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 305]
    ],
    level: 7,
    school: "Conj",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A forked, metal rod worth 250+ gp and attuned to a plane of existence",
    duration: "Instantaneous",
    description: "Me + 8 willing crea teleport to general location on different plane or teleportation circle I know",
    descriptionFull: "You and up to eight willing creatures who link hands in a circle are transported to a different plane of existence. You can specify a target destination in general terms, such as the City of Brass on the Elemental Plane of Fire or the palace of Dispater on the second level of the Nine Hells, and you appear in or near that destination, as determined by the DM." + "\n   " + "Alternatively, if you know the sigil sequence of a teleportation circle on another plane of existence, this spell can take you to that circle. If the teleportation circle is too small to hold all the creatures you transported, they appear in the closest unoccupied spaces next to the circle."
});
legacySpellRefactor("plant growth", {
    name: "Plant Growth",
    classes: ["bard", "druid", "ranger"],
    source: [
        ["P24", 305]
    ],
    level: 3,
    school: "Trans",
    time: "1 a/8h",
    timeFull: "1 action or 8 hours",
    range: "150 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "1 a: 100ft rad plants overgrow, cause 1/4 move; 8h: 1 mile dia. plants yield double food at harvest",
    descriptionFull: "This spell channels vitality into plants. The casting time you use determines whether the spell has the Overgrowth or the Enrichment effect below." + "\n   " + "Overgrowth. Choose a point within range. All normal plants in a 100-foot-radius Sphere centered on that point become thick and overgrown. A creature moving through that area must spend 4 feet of movement for every 1 foot it moves. You can exclude one or more areas of any size within the spell's area from being affected." + "\n   " + "Enrichment. All plants in a half-mile radius centered on a point within range become enriched for 365 days. The plants yield twice the normal amount of food when harvested. They can benefit from only one Plant Growth per year."
});
legacySpellRefactor("poison spray", {
    name: "Poison Spray",
    classes: ["artificer", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 306]
    ],
    level: 0,
    school: "Necro",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Ranged spell attack for 1d12 Poison damage; +1d12 at CL 5, 11, and 17",
    descriptionCantripDie: "Ranged spell attack for `CD`d12 Poison damage",
    descriptionFull: "You spray toxic mist at a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d12 Poison damage." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d12 when you reach levels 5 (2d12), 11 (3d12), and 17 (4d12)."
});
legacySpellRefactor("polymorph", {
    name: "Polymorph",
    nameShort: "Polymorph*",
    classes: ["bard", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 306]
    ],
    level: 4,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A caterpillar cocoon",
    duration: "Conc, 1 h",
    save: "Wis",
    description: "1 crea save or turned into chosen beast of same CR (or lvl) or lower; gain beast HP as THP; see book",
    descriptionFull: "You attempt to transform a creature that you can see within range into a Beast. The target must succeed on a Wisdom saving throw or shape-shift into Beast form for the duration. That form can be any Beast you choose that has a Challenge Rating equal to or less than the target's (or the target's level if it doesn't have a Challenge Rating). The target's game statistics are replaced by the stat block of the chosen Beast, but the target retains its alignment, personality, creature type, Hit Points, and Hit Point Dice." + "\n   " + "The target gains a number of Temporary Hit Points equal to the Hit Points of the Beast form. These Temporary Hit Points vanish if any remain when the spell ends. The spell ends early on the target if it has no Temporary Hit Points left" + "\n   " + "The target is limited in the actions it can perform by the anatomy of its new form, and it cant speak or cast spells." + "\n   " + "\n   " + "The target's gear melds into the new form. The creature can't use or otherwise benefit from any of that equipment."
});
legacySpellRefactor("power word fortify", {
    name: "Power Word Fortify",
    nameShort: "Power Word Fortify*",
    classes: ["bard", "cleric"],
    source: [
        ["P24", 306]
    ],
    level: 7,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "instantaneous",
    description: "Divide 120 Temporary HP equally among up to 6 visible creatures in range",
    descriptionFull: "You fortify up to six creatures you can see within range. The spell bestows 120 Temporary Hit Points, which you divide among the spell's recipients."
});
legacySpellRefactor("power word heal", {
    name: "Power Word Heal",
    nameShort: "Power Word Heal*",
    classes: ["bard", "cleric"],
    source: [
        ["P24", 306]
    ],
    level: 9,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    description: "1 crea heals all HP & cured of Charmed, Frightened, Paralyzed, Poisoned, Stunned; can use rea to stand",
    descriptionShorter: "1 crea heals all HP, not charmed, frightened, paralyzed, poisoned, stunned; rea to stand up",
    descriptionFull: "A wave of healing energy washes over one creature you can see within range. The target regains all its Hit Points. If the creature has the Charmed, Frightened, Paralyzed, Poisoned, or Stunned condition, the condition ends. If the creature has the Prone condition, it can use its Reaction to stand up."
});
legacySpellRefactor("power word kill", {
    name: "Power Word Kill",
    nameShort: "Power Word Kill*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 306]
    ],
    level: 9,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    description: "1 creature dies if it has 100 or less current HP, else takes 12d12 Psychic damage",
    descriptionFull: "You compel one creature you can see within range to die. If the target has 100 Hit Points or fewer, it dies. Otherwise, it takes 12d12 Psychic damage."
});
legacySpellRefactor("power word stun", {
    name: "Power Word Stun",
    nameShort: "Power Word Stun*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 306]
    ],
    level: 8,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    save: "Con",
    description: "1 crea Stunned if 150 or less current HP, else Speed is 0 until my next turn; repeat save at end of turn",
    descriptionFull: "You overwhelm the mind of one creature you can see within range. If the target has 150 Hit Points or fewer, it has the Stunned condition. Otherwise, its Speed is 0 until the start of your next turn." + "\n   " + "The Stunned target makes a Constitution saving throw at the end of each of its turns, ending the condition on itself on a success."
});
legacySpellRefactor("prayer of healing", {
    name: "Prayer of Healing",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 307]
    ],
    level: 2,
    school: "Abjur",
    time: "10 min",
    range: "30 ft",
    components: "V",
    duration: "Instantaneous",
    description: "5 crea in range while cast heal 2d8+1d8/SL HP and gain short rest benefits (once per LR)",
    descriptionFull: "Up to five creatures of your choice who remain within range for the spell's entire casting gain the benefits of a Short Rest and also regain 2d8 Hit Points. A creature can't be affected by this spell again until that creature finishes a Long Rest." + AtHigherLevels + "The healing increases by 1d8 for each spell slot level above 2."
});
legacySpellRefactor("prestidigitation", {
    name: "Prestidigitation",
    classes: ["artificer", "bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 307]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "10 ft",
    components: "V,S",
    duration: "1 h",
    description: "Harmless sensory effect, snuff/light fire, clean/soil, chill/warm/flavor, small mark, illusion/trinket; up to 3",
    descriptionFull: "You create a magical effect within range. Choose the effect from the options below. If you cast this spell multiple times, you can have up to three of its non-instantaneous effects active at a time." + "\n " + "\u2022 Sensory Effect. You create an instantaneous, harmless sensory effect, such as a shower of sparks, a puff of wind, faint musical notes, or an odd odor." + "\n " + "\u2022 Fire Play. You instantaneously light or snuff out a candle, a torch, or a small campfire." + "\n " + "\u2022 Clean or Soil. You instantaneously clean or soil an object no larger than 1 cubic foot." + "\n " + "\u2022 Minor Sensation. You chill, warm, or flavor up to 1 cubic foot of nonliving material for 1 hour." + "\n " + "\u2022 Magic Mark. You make a color, a small mark, or a symbol appear on an object or a surface for 1 hour." + "\n " + "\u2022 Minor Creation. You create a nonmagical trinket or an illusory image that can fit in your hand. It lasts until the end of your next turn. A trinket can deal no damage and has no monetary worth."
});
legacySpellRefactor("prismatic spray", {
    name: "Prismatic Spray",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 307]
    ],
    level: 7,
    school: "Evoc",
    time: "1 a",
    range: "S:60ft cone",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "All creatures random effect each: 12d6 damage, Restrained, or Blinded; save halves/negates; see B",
    descriptionFull: "Eight rays of light flash from you in a 60-foot Cone. Each creature in the Cone makes a Dexterity saving throw. For each target, roll 1d8 to determine which color ray affects it, consulting the Prismatic Rays table." +
        "\n   " + toUni("1-Red") + ": Failed Save: 12d6 Fire damage. Successful Save: Half as much damage." +
        "\n   " + toUni("2-Orange") + ": Failed Save: 12d6 Acid damage. Successful Save: Half as much damage." +
        "\n   " + toUni("3-Yellow") + ": Failed Save: 12d6 Lightning damage. Successful Save: Half as much damage." +
        "\n   " + toUni("4-Green") + ": Failed Save: 12d6 Poison damage. Successful Save: Half as much damage." +
        "\n   " + toUni("5-Blue") + ": Failed Save: 12d6 Cold damage. Successful Save: Half as much damage." +
        "\n   " + toUni("6-Indigo") + ": Failed Save: The target has the Restrained condition and makes a Constitution saving throw at the end of each of its turns. If it successfully saves three times, the condition ends. If it fails three times, it has the Petrified condition until it is freed by an effect like the Greater Restoration spell. The successes and failures needn't be consecutive; keep track of both until the target collects three of a kind." +
        "\n   " + toUni("7-Violet") + ": Violet. Failed Save: The target has the Blinded condition and makes a Wisdom saving throw at the start of your next turn. On a successful save, the condition ends. On a failed save, the condition ends, and the creature teleports to another plane of existence (DM's choice)." +
        "\n   " + toUni("8-Special") + ": The target is struck by two rays. Roll twice, rerolling any 8.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["acid", "cold", "fire", "lightning", "poison"],
            inDescriptionAs: ""
        }
    }
});
legacySpellRefactor("prismatic wall", {
    name: "Prismatic Wall",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 308]
    ],
    level: 9,
    school: "Abjur",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "10 min",
    save: "Con",
    description: "Up to 90 ft long 30 ft high 5 inch thick; all in 20 ft save or Blinded; 7 layers with dif. effects, see book",
    descriptionFull: "A shimmering, multicolored plane of light forms a vertical opaque wall‚Äîup to 90 feet long, 30 feet high, and 1 inch thick‚Äîcentered on a point within range. Alternatively, you shape the wall into a globe up to 30 feet in diameter centered on a point within range. The wall lasts for the duration. If you position the wall in a space occupied by a creature, the spell ends instantly without effect." +
        "\n The wall sheds Bright Light within 100 feet and Dim Light for an additional 100 feet. You and creatures you designate when you cast the spell can pass through and be near the wall without harm. If another creature that can see the wall moves within 20 feet of it or starts its turn there, the creature must succeed on a Constitution saving throw or have the Blinded condition for 1 minute." +
        "\n The wall consists of seven layers, each with a different color. When a creature reaches into or passes through the wall, it does so one layer at a time through all the layers. Each layer forces the creature to make a Dexterity saving throw or be affected by that layer's properties as described in the Prismatic Layers table." +
        "\n The wall, which has AC 10, can be destroyed one layer at a time, in order from red to violet, by means specific to each layer. If a layer is destroyed, it is gone for the duration. Antimagic Field has no effect on the wall, and Dispel Magic can affect only the violet layer." +
        "\n   " + toUni("Red") + ": Failed Save: 12d6 Fire damage. Successful Save: Half as much damage. Additional Effects: Nonmagical ranged attacks can't pass through this layer, which is destroyed if it takes at least 25 Cold damage." +
        "\n   " + toUni("Orange") + ": Failed Save: 12d6 Acid damage. Successful Save: Half as much damage. Additional Effects: Magical ranged attacks can't pass through this layer, which is destroyed by a strong wind (such as the one created by Gust of Wind)." +
        "\n   " + toUni("Yellow") + ": Failed Save: 12d6 Lightning damage. Successful Save: Half as much damage. Additional Effects: The layer is destroyed if it takes at least 60 Force damage." +
        "\n   " + toUni("Green") + ": Failed Save: 12d6 Poison damage. Successful Save: Half as much damage. Additional Effects: A Passwall spell, or another spell of equal or greater level that can open a portal on a solid surface, destroys this layer." +
        "\n   " + toUni("Blue") + ": Failed Save: 12d6 Cold damage. Successful Save: Half as much damage. Additional Effects: The layer is destroyed if it takes at least 25 Fire damage." +
        "\n   " + toUni("Indigo") + ": Failed Save: The target has the Restrained condition and makes a Constitution saving throw at the end of each of its turns. If it successfully saves three times, the condition ends. If it fails three times, it has the Petrified condition until it is freed by an effect like the Greater Restoration spell. The successes and failures needn't be consecutive; keep track of both until the target collects three of a kind. Additional Effects: Spells can't be cast through this layer, which is destroyed by Bright Light shed by the Daylight spell." +
        "\n   " + toUni("Violet") + ": Failed Save: The target has the Blinded condition and makes a Wisdom saving throw at the start of your next turn. On a successful save, the condition ends. On a failed save, the condition ends, and the creature teleports to another plane of existence (DM's choice). Additional Effects: This layer is destroyed by Dispel Magic."
});
legacySpellRefactor("produce flame", {
    name: "Produce Flame",
    classes: ["druid"],
    source: [
        ["P24", 308]
    ],
    level: 0,
    school: "Conj",
    time: "1 bns",
    range: "Self",
    components: "V,S",
    duration: "10 min",
    description: "Flame emits 20ft rad bright light/20ft dim; 1 a 60ft ranged spell atk for 1d8 Fire; +1d8 at CL 5, 11, \u0026 17",
    descriptionCantripDie: "Flame emits 20ft rad bright light/20ft dim; 1 a 60ft ranged spell atk for `CD`d8 Fire dmg",
    descriptionFull: "A flickering flame appears in your hand and remains there for the duration. While there, the flame emits no heat and ignites nothing, and it sheds Bright Light in a 20-foot radius and Dim Light for an additional 20 feet. The spell ends if you cast it again." + "\n   " + "Until the spell ends, you can take a Magic action to hurl fire at a creature or an object within 60 feet of you. Make a ranged spell attack. On a hit, the target takes 1d8 Fire damage." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8).",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("programmed illusion", {
    name: "Programmed Illusion",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 309]
    ],
    level: 6,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M\u0192",
    compMaterial: "Jade dust worth 25+ gp",
    duration: "Till dispelled",
    description: "30-ft cube illusion includes visual, audible; activates on set trigger; Int(Invest.) vs spell DC; see B (25gp)",
    descriptionFull: "You create an illusion of an object, a creature, or some other visible phenomenon within range that activates when a specific trigger occurs. The illusion is imperceptible until then. It must be no larger than a 30-foot cube, and you decide when you cast the spell how the illusion behaves and what sounds it makes. This scripted performance can last up to 5 minutes." + "\n   " + "When the trigger you specify occurs, the illusion springs into existence and performs in the manner you described. Once the illusion finishes performing, it disappears and remains dormant for 10 minutes, after which the illusion can be activated again." + "\n   " + "The trigger can be as general or as detailed as you like, though it must be based on visual or audible phenomena that occur within 30 feet of the area. For example, you could create an illusion of yourself to appear and warn off others who attempt to open a trapped door." + "\n   " + "Physical interaction with the image reveals it to be illusory, since things can pass through it. A creature that takes the Study action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and any noise it makes sounds hollow to the creature."
});
legacySpellRefactor("project image", {
    name: "Project Image",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 309]
    ],
    level: 7,
    school: "Illus",
    time: "1 a",
    range: "500 miles",
    components: "V,S,M\u0192",
    compMaterial: "A statuette of yourself worth 5+ gp",
    duration: "Conc, 1 day",
    description: "Project image of me to familiar place; see/hear through it; 1 a manipulate; Int(Invest.) vs spell DC (5gp)",
    descriptionFull: "You create an illusory copy of yourself that lasts for the duration. The copy can appear at any location within range that you have seen before, regardless of intervening obstacles. The illusion looks and sounds like you, but it is intangible. If the illusion takes any damage, it disappears, and the spell ends." + "\n   " + "You can see through the illusion's eyes and hear through its ears as if you were in its space. As a Magic action, you can move it up to 60 feet and make it gesture, speak, and behave in whatever way you choose. It mimics your mannerisms perfectly." + "\n   " + "Physical interaction with the image reveals it to be illusory, since things can pass through it. A creature that takes the Study action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and any noise it makes sounds hollow to the creature."
});
legacySpellRefactor("protection from energy", {
    name: "Protection from Energy",
    classes: ["artificer", "cleric", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 309]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 h",
    description: "1 willing creature gains resistance to Acid, Cold, Fire, Lightning, or Thunder damage",
    descriptionFull: "For the duration, the willing creature you touch has Resistance to one damage type of your choice: Acid, Cold, Fire, Lightning, or Thunder."
});
legacySpellRefactor("protection from evil and good", {
    name: "Protection from Evil and Good",
    nameShort: "Prot. from Evil/Good",
    classes: ["cleric", "druid", "paladin", "warlock", "wizard"],
    source: [
        ["P24", 309]
    ],
    level: 1,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A flask of Holy Water worth 25+ gp, which the spell consumes",
    duration: "Conc, 10 min",
    description: "1 crea no fear/charm/possess and atks dis. from  abber./celes./elem./fey/fiends/undead (25gp cons.)",
    descriptionFull: "Until the spell ends, one willing creature you touch is protected against creatures that are Aberrations, Celestials, Elementals, Fey, Fiends, or Undead. The protection grants several benefits. Creatures of those types have Disadvantage on attack rolls against the target. The target also can't be possessed by or gain the Charmed or Frightened conditions from them. If the target is already possessed, Charmed, or Frightened by such a creature, the target has Advantage on any new saving throw against the relevant effect."
});
legacySpellRefactor("protection from poison", {
    name: "Protection from Poison",
    classes: ["artificer", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 310]
    ],
    level: 2,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "1 h",
    description: "1 creature cured of Poisoned, gains resistance to Poison damage, and adv on saves vs Poisoned",
    descriptionFull: "You touch a creature and end the Poisoned condition on it. For the duration, the target has Advantage on saving throws to avoid or end the Poisoned condition, and it has Resistance to Poison damage."
});
legacySpellRefactor("purify food and drink", {
    name: "Purify Food and Drink",
    classes: ["artificer", "cleric", "druid", "paladin"],
    source: [
        ["P24", 310]
    ],
    ritual: true,
    level: 1,
    school: "Trans",
    time: "1 a",
    range: "10 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "5-ft radius of food and drink is rendered free from all poison and rot",
    descriptionFull: "You remove poison and rot from nonmagical food and drink in a 5-foot-radius Sphere centered on a point within range."
});
legacySpellRefactor("raise dead", {
    name: "Raise Dead",
    classes: ["bard", "cleric", "paladin"],
    source: [
        ["P24", 310]
    ],
    level: 5,
    school: "Necro",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A diamond worth 500+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Restores corpse that died within the last 10 days to life with 1 HP; see book (500gp cons.)",
    descriptionFull: "With a touch, you revive a dead creature if it has been dead no longer than 10 days and it wasn't Undead when it died." + "\n   " + "The creature returns to life with 1 Hit Point. This spell also neutralizes any poisons that affected the creature at the time of death." + "\n   " + "This spell closes all mortal wounds, but it doesn't restore missing body parts. If the creature is lacking body parts or organs integral for its survival‚Äîits head, for instance‚Äîthe spell automatically fails." + "\n   " + "Coming back from the dead is an ordeal. The target takes a -4 penalty to d20 Tests. Every time the target finishes a Long Rest, the penalty is reduced by 1 until it becomes 0."
});
legacySpellRefactor("rary's telepathic bond", {
    name: "Rary's Telepathic Bond",
    nameShort: "Rary's Telepath. Bond",
    nameAlt: "Telepathic Bond",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 311]
    ],
    ritual: true,
    level: 5,
    school: "Div",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "two eggs",
    duration: "1 h",
    description: "8 willing crea gain a telepathic bond across any distance on same plane; must know a language",
    descriptionFull: "You forge a telepathic link among up to eight willing creatures of your choice within range, psychically linking each creature to all the others for the duration. Creatures that can't communicate in any languages aren't affected by this spell." + "\n   " + "Until the spell ends, the targets can communicate telepathically through the bond whether or not they share a language. The communication is possible over any distance, though it can't extend to other planes of existence."
});
legacySpellRefactor("ray of enfeeblement", {
    name: "Ray of Enfeeblement",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 311]
    ],
    level: 2,
    school: "Necro",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Con",
    description: "1 crea save or dis. on Str d20 tests \u0026 -1d8 from dmg; pass: dis. on 1st atk before my turn; redo save EoT",
    descriptionFull: "A beam of enervating energy shoots from you toward a creature within range. The target must make a Constitution saving throw. On a successful save, the target has Disadvantage on the next attack roll it makes until the start of your next turn." + "\n   " + "On a failed save, the target has Disadvantage on Strength-based d20 Tests for the duration. During that time, it also subtracts 1d8 from all its damage rolls. The target repeats the save at the end of each of its turns, ending the spell on a success."
});
legacySpellRefactor("ray of frost", {
    name: "Ray of Frost",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 311]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Ranged spell atk for 1d8 Cold dmg and -10 ft speed until start of my next turn; +1d8 at CL 5, 11, \u0026 17",
    descriptionCantripDie: "Ranged spell attack for `CD`d8 Cold dmg and -10 ft speed until start of my next turn",
    descriptionFull: "A frigid beam of blue-white light streaks toward a creature within range. Make a ranged spell attack against the target. On a hit, it takes 1d8 cold damage, and its speed is reduced by 10 feet until the start of your next turn." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8)."
});
legacySpellRefactor("ray of sickness", {
    name: "Ray of Sickness",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 311]
    ],
    level: 1,
    school: "Necro",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Ranged spell attack for 2d8+1d8/SL Poison damage and Poisoned until my next turn ends",
    descriptionFull: "You shoot a greenish ray at a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 2d8 Poison damage and has the Poisoned condition until the end of your next turn." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 1."
});
legacySpellRefactor("regenerate", {
    name: "Regenerate",
    classes: ["bard", "cleric", "druid"],
    source: [
        ["P24", 311]
    ],
    level: 7,
    school: "Trans",
    time: "1 min",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A prayer wheel",
    duration: "1 h",
    description: "1 crea heals 4d8+15 HP now and gains 1 HP each turn for duration; restores lost body parts in 2 min",
    descriptionShorter: "1 crea heals 4d8+15 HP and 1 HP/rnd for duration; restores lost body parts in 2 min",
    descriptionFull: "A creature you touch regains 4d8 + 15 Hit Points. For the duration, the target regains 1 Hit Point at the start of each of its turns, and any severed body parts regrow after 2 minutes.",
    dynamicDamageBonus: {
        multipleDmgMoments: false,
        extraDmgGroupsSameType: /(and |\u0026 )((?:\+?\d+d?\d*)+)( HP\/rnd)/i
    }
});
legacySpellRefactor("reincarnate", {
    name: "Reincarnate",
    classes: ["druid"],
    source: [
        ["P24", 311]
    ],
    level: 5,
    school: "Necro",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Rare oils worth 1,000+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Bring humanoid that died in last 10 days to life in a new random adult body, see book (1000gp cons.)",
    descriptionFull: "You touch a dead Humanoid or a piece of one. If the creature has been dead no longer than 10 days, the spell forms a new body for it and calls the soul to enter that body. Roll 1d10 and consult the table below to determine the body's species, or the DM chooses another playable species." + "\n\n   " + toUni("d10") + "\t" + toUni("Race") + "\n   " + "1\tAasimar" + "\n   " + "2\tDragonborn" + "\n   " + "3\tDwarf" + "\n   " + "4\tElf" + "\n   " + "5\tGnome" + "\n   " + "6\tGoliath" + "\n   " + "7\tHalfling" + "\n   " + "8\tHuman" + "\n   " + "9\tOrc" + "\n   " + "10\tTiefling" + "\n\n" + "The reincarnated creature makes any choices that a species' description offers, and the creature recalls its former life. It retains the capabilities it had in its original form, except it loses the traits of its previous species and gains the traits of its new one."
});
legacySpellRefactor("remove curse", {
    name: "Remove Curse",
    classes: ["cleric", "paladin", "warlock", "wizard"],
    source: [
        ["P24", 312]
    ],
    level: 3,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Instantaneous",
    description: "All curses end for 1 creature or object; magic items retain curses but break attunement",
    descriptionFull: "At your touch, all curses affecting one creature or object end. If the object is a cursed magic item, its curse remains, but the spell breaks its owner's Attunement to the object so it can be removed or discarded."
});
legacySpellRefactor("resistance", {
    name: "Resistance",
    classes: ["artificer", "cleric", "druid"],
    source: [
        ["P24", 312]
    ],
    level: 0,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Choose 1 dmg type (except Force or Psychic); 1 crea takes -1d4 dmg of that type for duration (1/turn)",
    descriptionFull: "You touch a willing creature and choose a damage type: Acid, Bludgeoning, Cold, Fire, Lightning, Necrotic, Piercing, Poison, Radiant, Slashing, or Thunder. When the creature takes damage of the chosen type before the spell ends, the creature reduces the total damage taken by 1d4. A creature can benefit from this spell only once per turn."
});
legacySpellRefactor("resurrection", {
    name: "Resurrection",
    classes: ["bard", "cleric"],
    source: [
        ["P24", 312]
    ],
    level: 7,
    school: "Necro",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A diamond worth 1,000+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Bring corpse that died in the last century to life with whole body and full HP; see B (1000gp cons.)",
    descriptionFull: "With a touch, you revive a dead creature that has been dead for no more than a century, didn't die of old age, and wasn't Undead when it died." + "\n   " + "The creature returns to life with all its Hit Points. This spell also neutralizes any poisons that affected the creature at the time of death. This spell closes all mortal wounds and restores any missing body parts." + "\n   " + "Coming back from the dead is an ordeal. The target takes a -4 penalty to d20 Tests. Every time the target finishes a Long Rest, the penalty is reduced by 1 until it becomes 0." + "\n   " + "Casting this spell to revive a creature that has been dead for 365 days or longer taxes you. Until you finish a Long Rest, you can't cast spells again, and you have Disadvantage on d20 Tests."
});
legacySpellRefactor("reverse gravity", {
    name: "Reverse Gravity",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 312]
    ],
    level: 7,
    school: "Trans",
    time: "1 a",
    range: "100 ft",
    components: "V,S,M",
    compMaterial: "A lodestone and iron filings",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "50-ft rad 100-ft high cyl. everything falls upward; save to grab nearby object; fall when ends",
    descriptionFull: "This spell reverses gravity in a 50-foot-radius, 100-foot high Cylinder centered on a point within range. All creatures and objects in that area that aren't anchored to the ground fall upward and reach the top of the Cylinder. A creature can make a Dexterity saving throw to grab a fixed object it can reach, thus avoiding the fall upward." + "\n   " + "If a ceiling or an anchored object is encountered in this upward fall, creatures and objects strike it just as they would during a downward fall. If an affected creature or object reaches the Cylinder's top without striking anything, it hovers there for the duration. When the spell ends, affected objects and creatures fall downward."
});
legacySpellRefactor("revivify", {
    name: "Revivify",
    classes: ["artificer", "cleric", "druid", "paladin", "ranger"],
    source: [
        ["P24", 312]
    ],
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "A diamond worth 300+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Restore a corpse that died within the last minute to life with 1 HP (300gp cons.)",
    descriptionFull: "You touch a creature that has died within the last minute. That creature revives with 1 Hit Point. This spell can't revive a creature that has died of old age, nor does it restore any missing body parts."
});
legacySpellRefactor("rope trick", {
    name: "Rope Trick",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 312]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A segment of rope",
    duration: "1 h",
    description: "Rope stands vertical; at top extradimens. space with invisible 3\xD75 ft entrance, holds 8 Medium crea",
    descriptionFull: "You touch a rope. One end of it hovers upward until the rope hangs perpendicular to the ground or the rope reaches a ceiling. At the rope's upper end, an Invisible 3-foot-by-5-foot portal opens to an extradimensional space that lasts until the spell ends. That space can be reached by climbing the rope, which can be pulled into or dropped out of it." + "\n   " + "The space can hold up to eight Medium or smaller creatures. Attacks, spells, and other effects can't pass into or out of the space, but creatures inside it can see through the portal. Anything inside the space drops out when the spell ends."
});
legacySpellRefactor("sacred flame", {
    name: "Sacred Flame",
    nameShort: "Sacred Flame*",
    classes: ["cleric"],
    source: [
        ["P24", 313]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Dex",
    description: "1 visible creature save or 1d8 Radiant; no save bonus for 1/2 or 3/4 cover; +1d8 at CL 5, 11, and 17",
    descriptionShorter: "1 visible crea save or 1d8 Radiant dmg; no bonus for 1/2 or 3/4 cover; +1d8 at CL 5/11/17",
    descriptionCantripDie: "1 visible creature save or `CD`d8 Radiant dmg; no bonus for 1/2 or 3/4 cover on save",
    descriptionFull: "Flame-like radiance descends on a creature that you can see within range. The target must succeed on a Dexterity saving throw or take 1d8 Radiant damage. The target gains no benefit from Half Cover or Three-Quarters Cover for this save." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8)."
});
legacySpellRefactor("sanctuary", {
    name: "Sanctuary",
    classes: ["artificer", "cleric"],
    source: [
        ["P24", 313]
    ],
    level: 1,
    school: "Abjur",
    time: "1 bns",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A shard of glass from a mirror",
    duration: "1 min",
    save: "Wis",
    description: "1 crea warded until atk/cast/do dmg; pass save to atk or target them; no protection vs area spells",
    descriptionFull: "You ward a creature within range. Until the spell ends, any creature who targets the warded creature with an attack roll or a damaging spell must succeed on a Wisdom saving throw or either choose a new target or lose the attack or spell. This spell doesn't protect the warded creature from areas of effect." + "\n   " + "The spell ends if the warded creature makes an attack roll, casts a spell, or deals damage."
});
legacySpellRefactor("scorching ray", {
    name: "Scorching Ray",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 313]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "3+1/SL rays target 1 or more creatures; each ray ranged spell attack for 2d6 Fire dmg",
    descriptionFull: "You hurl three fiery rays. You can hurl them at one target within range or at several. Make a ranged spell attack for each ray. On a hit, the target takes 2d6 Fire damage." + AtHigherLevels + "You create one additional ray for each spell slot level above 2.",
    dynamicDamageBonus: {
        multipleDmgMoments: true
    }
});
legacySpellRefactor("scrying", {
    name: "Scrying",
    classes: ["bard", "cleric", "druid", "warlock", "wizard"],
    source: [
        ["P24", 313 - 14]
    ],
    level: 5,
    school: "Div",
    time: "10 min",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "A focus worth 1,000+ gp, such as a crystal ball, mirror, or water filled font",
    duration: "Conc, 10 min",
    save: "Wis",
    description: "1 creature save or followed by sensor; or create immobile sensor in familiar location; see B (1000gp)",
    descriptionFull: "You can see and hear a creature you choose that is on the same plane of existence as you. The target makes a Wisdom saving throw, which is modified (see the tables below) by how well you know the target and the sort of physical connection you have to it. The target doesn't know what it is making the save against, only that it feels uneasy." + "\n\n" + toUni("Knowledge") + "\t\t\t   " + toUni("Save Modifier") + "\n" + "Secondhand (heard of the target)\t+5" + "\n" + "Firsthand (met the target)\t\t+0" + "\n" + "Familiar (know the target well)\t\t-5" + "\n\n" + toUni("Connection") + "\t\t\t   " + toUni("Save Modifier") + "\n" + "Picture or other likeness\t\t\t\t-2" + "\n" + "Garment or other possession\t\t\t-4" + "\n" + "Body part, lock of hair, or bit of nail\t-10" + "\n\n" + "On a successful save, the target isn't affected, and you can't use this spell on it again for 24 hours." + "\n   " + "On a failed save, the spell creates an Invisible, intangible sensor within 10 feet of the target. You can see and hear through the sensor as if you were there. The sensor moves with the target, remaining within 10 feet of it for the duration. If something can see the sensor, it appears as a luminous orb about the size of your fist." + "\n   " + "Instead of targeting a creature, you can target a location you have seen. When you do so, the sensor appears at that location and doesn't move."
});
legacySpellRefactor("searing smite", {
    name: "Searing Smite",
    classes: ["paladin"],
    source: [
        ["P24", 314]
    ],
    level: 1,
    school: "Evoc",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or an Unarmed Strike",
    range: "Self",
    components: "V",
    duration: "1 min",
    save: "Con",
    description: "Melee wea/unarmed hit +1d6+1d6/SL Fire \u0026 ignites; each turn 1d6+1d6/SL Fire then save to end",
    descriptionShorter: "On melee wea hit +1d6+1d6/SL Fire dmg \u0026 ignites: start of turn save to end or 1d6 dmg",
    descriptionFull: "As you hit the target, it takes an extra 1d6 Fire damage from the attack. At the start of each of its turns until the spell ends, the target takes 1d6 Fire damage and then makes a Constitution saving throw. On a failed save, the spell continues. On a successful save, the spell ends." + AtHigherLevels + "All the damage increases by 1d6 for each spell slot level above 1.",
    dynamicDamageBonus: {
        extraDmgGroupsSameType: /(end or )((?:\+?\d+d?\d*)+)/i
    }
});
legacySpellRefactor("see invisibility", {
    name: "See Invisibility",
    classes: ["artificer", "bard", "sorcerer", "wizard"],
    source: [
        ["P24", 314]
    ],
    level: 2,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A pinch of talc",
    duration: "1 h",
    description: "See Invisible/ethereal creatures and objects as if they were visible; ethereals appear ghostly",
    descriptionFull: "For the duration, you see creatures and objects that have the Invisible condition as if they were visible, and you can see into the Ethereal Plane. Creatures and objects there appear ghostly."
});
legacySpellRefactor("seeming", {
    name: "Seeming",
    nameShort: "Seeming*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 314]
    ],
    level: 5,
    school: "Illus",
    time: "1 a",
    range: "30 ft",
    components: "V,S",
    duration: "8 h",
    save: "Cha",
    description: "Any crea save or disguised by illusory appearance; Int(Investigation) check vs spell DC; see book",
    descriptionFull: "You give an illusory appearance to each creature of your choice that you can see within range. An unwilling target can make a Charisma saving throw, and if it succeeds, it is unaffected by this spell." + "\n   " + "You can give the same appearance or different ones to the targets. The spell can change the appearance of the targets' bodies and equipment. You can make each creature seem 1 foot shorter or taller and appear heavier or lighter. A target's new appearance must have the same basic arrangement of limbs as the target, but the extent of the illusion is otherwise up to you. The spell lasts for the duration." + "\n   " + "The changes wrought by this spell fail to hold up to physical inspection. For example, if you use this spell to add a hat to a creature's outfit, objects pass through the hat." + "\n   " + "A creature that takes the Study action to examine a target can make an Intelligence (Investigation) check against your spell save DC. If it succeeds, it becomes aware that the target is disguised."
});
legacySpellRefactor("sending", {
    name: "Sending",
    classes: ["bard", "cleric", "wizard"],
    source: [
        ["P24", 314]
    ],
    level: 3,
    school: "Div",
    time: "1 a",
    range: "Unlimited",
    components: "V,S,M",
    compMaterial: "A copper wire",
    duration: "Instantaneous",
    description: "Send 25 words to familiar crea; it recognizes me and can respond with 25 words and/or block for 8 hrs",
    descriptionFull: "You send a short message of 25 words of fewer to a creature you have met or a creature described to you by someone who has bet it. The target hears the message in its mind, recognizes you as the sender if it knows you, and can answer in a like manner immediately. The spell enables targets to understand the meaning of your message." + "\n   " + "You can send the message across any distance and even to other planes of existence, but if the target is on a different plane than you, there is a 5 percent chance that the message doesn't arrive. You know if the delivery fails." + "\n   " + "Upon receiving your message, a creature can block your ability to reach it again with this spell for 8 hours. If you try to send another message during that time, you learn that you are blocked, and the spell fails."
});
legacySpellRefactor("sequester", {
    name: "Sequester",
    classes: ["wizard"],
    source: [
        ["P24", 315]
    ],
    level: 7,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Gem dust worth 5000+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "1 willing crea/object in suspended animation, Invisible, hidden from Divination; see B (5000gp cons.)",
    descriptionFull: "With a touch, you magically sequester an object or a willing creature. For the duration, the target has the Invisible condition and can't be targeted by Divination spells, detected by magic, or viewed remotely with magic." + "\n   " + "If the target is a creature, it enters a state of suspended animation; it has the Unconscious condition, doesn't age, and doesn't need food, water, or air." + "\n   " + "You can set a condition for the spell to end early. The condition can be anything you choose, but it must occur or be visible within 1 mile of the target. Examples include \"after 1,000 years\" or \"when the tarrasque awakens.\" This spell also ends if the target takes any damage."
});
legacySpellRefactor("shapechange", {
    name: "Shapechange",
    classes: ["druid", "wizard"],
    source: [
        ["P24", 315]
    ],
    level: 9,
    school: "Trans",
    time: "1 a",
    range: "Self",
    components: "V,S,M\u0192",
    compMaterial: "A jade circlet worth 1,500+ gp",
    duration: "Conc, 1 h",
    description: "Turn into crea with CR of \u2264CL; 1 a new form; crea HP as THP; ends at 0 THP; see book (1500gp)",
    descriptionFull: "You shape-shift into another creature for the duration or until you take a Magic action to shape-shift into a different eligible form. The new form must be of a creature that has a Challenge Rating no higher than your level or Challenge Rating. You must have seen the sort of creature before, and it can't be a Construct or an Undead." + "\n   " + "When you cast the spell, you gain a number of Temporary Hit Points equal to the Hit Points of the first form into which you shape-shift. These Temporary Hit Points vanish if any remain when the spell ends." + "\n   " + "Your game statistics are replaced by the stat block of the chosen form, but you retain your creature type; alignment; personality; Intelligence, Wisdom, and Charisma scores; Hit Points; Hit Point Dice; proficiencies; and ability to communicate. If you have the Spellcasting feature, you retain it too." + "\n   " + "Upon shape-shifting, you determine whether your equipment drops to the ground or changes in size and shape to fit the new form while you're in it."
});
legacySpellRefactor("shatter", {
    name: "Shatter",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 316]
    ],
    level: 2,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A chip of mica",
    duration: "Instantaneous",
    save: "Con",
    description: "10ft rad all crea and nonmagical unattended obj 3d8+1d8/SL Thunder; save halves; constructs dis.",
    descriptionFull: "A loud noise erupts from a point of your choice within range. Each creature in a 10-foot-radius Sphere centered there makes a Constitution saving throw, taking 3d8 Thunder damage on a failed save or half as much damage on a successful one. A Construct has Disadvantage on the save." + "\n   " + "A nonmagical object that isn't being worn or carried also takes the damage if it's in the spell's area." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 2."
});
legacySpellRefactor("shield", {
    name: "Shield",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 316]
    ],
    level: 1,
    school: "Abjur",
    time: "1 rea",
    timeFull: "Reaction, which you take when you are hit by an attack roll or targeted by the Magic Missile spell",
    range: "Self",
    components: "V,S",
    duration: "1 round",
    description: "If hit by atk +5 AC until start of next turn, may cause to miss; or stop Magic Missile from damaging me",
    descriptionFull: "An imperceptible barrier of magical force protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from Magic Missile."
});
legacySpellRefactor("shield of faith", {
    name: "Shield of Faith",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 316]
    ],
    level: 1,
    school: "Abjur",
    time: "1 bns",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A prayer scroll",
    duration: "Conc, 10 min",
    description: "1 creature gains +2 AC for the duration",
    descriptionFull: "A shimmering field surrounds a creature of your choice within range, granting it a +2 bonus to AC for the duration."
});
legacySpellRefactor("shillelagh", {
    name: "Shillelagh",
    classes: ["druid"],
    source: [
        ["P24", 316]
    ],
    level: 0,
    school: "Trans",
    time: "1 bns",
    range: "Self",
    components: "V,S,M",
    compMaterial: "Mistletoe",
    duration: "1 min",
    description: "Club/qtrstaff I hold does 1d8 (CL5:1d10, CL11:1d12, CL17:2d6) Force/wea dmg & uses my spell ability",
    descriptionShorter: "Club/staff I hold does 1d8 (CL5:1d10, CL11:1d12, CL17:2d6) Force or wea dmg & uses my spell ability",
    descriptionFull: "A Club or Quarterstaff you are holding is imbued with nature's power. For the duration, you can use your spellcasting ability instead of Strength for the attack and damage rolls of melee attacks using that weapon, and the weapon's damage die becomes a d8. If the attack deals damage, it can be Force damage or the weapon's normal damage type (your choice).." + "\n   " + "The spell ends if you cast it again or if you let go of the weapon." + "\n   " + toUni("Cantrip Upgrade") + ". The damage die changes when you reach levels 5 (d10), 11 (d12), and 17 (2d6)."
});
legacySpellRefactor("shining smite", {
    name: "Shining Smite",
    replaces: "branding smite",
    classes: ["paladin"],
    source: [
        ["P24", 316]
    ],
    level: 2,
    school: "Trans",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or an Unarmed Strike",
    range: "Self",
    components: "V",
    duration: "Conc, 1 min",
    description: "Melee wea/unarmed hit +2d6+1d6/SL Rad.; emit bright light 5ft rad; no Invisible; adv atks vs that crea",
    descriptionFull: "The target hit by the strike takes an extra 2d6 Radiant damage from the attack. Until the spell ends, the target sheds Bright Light in a 5-foot radius, attack rolls against it have Advantage, and it can't benefit from the Invisible condition." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 2"
});
legacySpellRefactor("shocking grasp", {
    name: "Shocking Grasp",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 316]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "Touch",
    components: "V,S",
    duration: "Instantaneous",
    description: "Melee spell attack for 1d8 Lightning; no opportunity atks until its next turn; +1d8 at CL 5, 11, and 17",
    descriptionCantripDie: "Melee spell attack for  `CD`d8 Lightning, no opportunity atks until its next turn",
    descriptionFull: "Lightning springs from you to a creature that you try to touch. Make a melee spell attack against the target. On a hit, the target takes 1d8 Lightning damage, and it can't make Opportunity Attacks until the start of its next turn." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8)."
});
legacySpellRefactor("silence", {
    name: "Silence",
    classes: ["bard", "cleric", "ranger"],
    source: [
        ["P24", 316]
    ],
    ritual: true,
    level: 2,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    description: "20-ft radius no sound; all within Deafened, immune to Thunder dmg, can't use Verbal components",
    descriptionFull: "For the duration, no sound can be created within or pass through a 20-foot-radius Sphere centered on a point you choose within range. Any creature or object entirely inside the Sphere has Immunity to Thunder damage, and creatures have the Deafened condition while entirely inside it. Casting a spell that includes a Verbal component is impossible there."
});
legacySpellRefactor("silent image", {
    name: "Silent Image",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 317]
    ],
    level: 1,
    school: "Illus",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A bit of fleece",
    duration: "Conc, 10 min",
    description: "15-ft cube visual illusion; 1 a to move, can appear natural; Int(Investigation) check vs spell DC; see book",
    descriptionFull: "You create the image of an object, a creature, or some other visible phenomenon that is no larger than a 15-foot cube. The image appears at a spot within range and lasts for the duration. The image is purely visual, it isn't accompanied by sound, smell, or other sensory effects." + "\n   " + "As a Magic action, you can cause the image to move to any spot within range. As the image changes location, you can alter its appearance so that its movements appear natural for the image. For example, if you create an image of a creature and move it, you can alter the image so that it appears to be walking." + "\n   " + "Physical interaction with the image reveals it to be an illusion, since things can pass through it. A creature that takes a Study action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image."
});
legacySpellRefactor("simulacrum", {
    name: "Simulacrum",
    classes: ["wizard"],
    source: [
        ["P24", 317]
    ],
    level: 7,
    school: "Illus",
    time: "12 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Powdered ruby worth 1500+ gp, which the spell consumes",
    duration: "Till dispelled",
    description: "Create snow/ice duplicate of humanoid/beast; follows commands \u0026 acts on turn; see B (1500gp cons.)",
    descriptionFull: "You create a simulacrum of one Beast or Humanoid that is within 10 feet of you for the entire casting of the spell. You finish the casting by touching both the creature and a pile of ice or snow that is the same size as that creature, and the pile turns into the simulacrum, which is a creature. It uses the game statistics of the original creature at the time of casting, except it is a Construct, its Hit Point maximum is half as much, and it can't cast this spell." + "\n   " + "The simulacrum is Friendly to you and creatures you designate. It obeys your commands and acts on your turn in combat. The simulacrum can't gain levels, and it can't take Short or Long Rests." + "\n   " + "If the simulacrum takes damage, the only way to restore its Hit Points is to repair it as you take a Long Rest, during which you expend components worth 100 GP per Hit Point restored. The simulacrum must stay within 5 feet of you for the repair." + "\n   " + "The simulacrum lasts until it drops to 0 Hit Points, at which point it reverts to snow and melts away. If you cast this spell again, any simulacrum you created with this spell is instantly destroyed."
});
legacySpellRefactor("sleep", {
    name: "Sleep",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 317]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A pinch of sand or rose petals",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "Any 5-ft radius save or Incapacitated; if fail, save or Unconscious at next EoT. 1 a or dmg to wake",
    descriptionFull: "Each creature of your choice in a 5-foot-radius Sphere centered on a point within range must succeed on a Wisdom saving throw or have the Incapacitated condition until the end of its next turn, at which point it must repeat the save. If the target fails the second save, the target has the Unconscious condition for the duration. The spell ends on a target if it takes damage or someone within 5 feet of it takes an action to shake it out of the spell's effect." + "\n   " + "Creatures that don't sleep, such as elves, or that have Immunity to the Exhaustion condition automatically succeed on saves against this spell."
});
legacySpellRefactor("sleet storm", {
    name: "Sleet Storm",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 317]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A miniature umbrella",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "40ft \xD7 40ft cyl.; heavily obsc.; douses flames; dif. ter.; enter/start turn save or Prone \u0026 lose conc.",
    descriptionFull: "Until the spell ends, sleet falls in a 40-foot-tall, 20-foot-radius Cylinder centered on a point you choose within range. The area is Heavily Obscured, and exposed flames in the area are doused." + "\n   " + "Ground in the Cylinder is Difficult Terrain. When a creature enters the Cylinder for the first time on a turn or starts its turn there, it must succeed on a Dexterity saving throw or have the Prone condition and lose Concentration."
});
legacySpellRefactor("slow", {
    name: "Slow",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 318]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A drop of molasses",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "40ft cu 6 crea save or 1/2 spd, -2 AC & Dex save, no rea, only a or bns, 1 atk; 25% S spell fails; EoT save",
    descriptionFull: "You alter time around up to six creatures of your choice in a 40-foot cube within range. Each target must succeed on a Wisdom saving throw or be affected by this spell for the duration." + "\n   " + "An affected target's Speed is halved, it takes a -2 penalty to AC and Dexterity saving throws, and it can't take Reactions. On its turns, it can take either an action or a Bonus Action, not both, and it can make only one attack if it takes the Attack action. If it casts a spell with a Somatic component, there is a 25 percent chance the spell fails as a result of the target making the spell's gestures too slowly." + "\n   " + "An affected target repeats the save at the end of each of its turns, ending the spell on itself on a success."
});
legacySpellRefactor("sorcerous burst", {
    name: "Sorcerous Burst",
    classes: ["sorcerer"],
    source: [
        ["P24", 318]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Spell atk 1d8 Acid/Cold/Fire/Lightn./Poison/Psych/Thndr; +1d8 per 8 (max = spell mod) +1d8 CL 5/11/17.",
    descriptionCantripDie: "Spell atk 1 crea `CD`d8 (Acid/Cold/Fire/Lightn./Poison/Psych/Thndr); +1d8 per 8 (max spell mod)",
    descriptionFull: "You cast sorcerous energy at one creature or object within range. Make a ranged attack roll against the target. On a hit, the target takes 1d8 damage of a type you choose: Acid, Cold, Fire, Lightning, Poison, Psychic, or Thunder." + "\n   " + "If you roll an 8 on a d8 for this spell, you can roll another d8, and add it to the damage. When you cast this spell, the maximum number of these d8s you can add to the spell's damage equals your spellcasting ability modifier." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8)."
});
legacySpellRefactor("spare the dying", {
    name: "Spare the Dying",
    classes: ["artificer", "cleric", "druid"],
    source: [
        ["P24", 318]
    ],
    level: 0,
    school: "Necro",
    time: "1 a",
    range: "15 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "1 living creature with 0 current HP becomes stable; range doubles at CL 5, 11, and 17",
    descriptionFull: "Choose a creature within range that has 0 Hit Points and isn't dead. The creature becomes Stable." + "\n   " + toUni("Cantrip Upgrade") + ". The range doubles when you reach levels 5 (30 feet), 11 (60 feet), and 17 (120 feet)."
});
legacySpellRefactor("speak with animals", {
    name: "Speak with Animals",
    classes: ["bard", "druid", "ranger", "warlock"],
    source: [
        ["P24", 318]
    ],
    ritual: true,
    level: 1,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "10 min",
    description: "Speak with and understand beasts; gain info on nearby locations/monsters/recent sights; can Influence",
    descriptionFull: "For the duration, you can comprehend and verbally communicate with Beasts, and you can use any of the Influence action's skill options with them." + "\n   " + "Most Beasts have little to say about topics that don't pertain to survival or companionship, but at minimum, a Beast can give you information about nearby locations and monsters, including whatever it has perceived within the past day."
});
legacySpellRefactor("speak with dead", {
    name: "Speak with Dead",
    classes: ["bard", "cleric", "wizard"],
    source: [
        ["P24", 318]
    ],
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "10 ft",
    components: "V,S,M",
    compMaterial: "Burning incense",
    duration: "10 min",
    description: "1 corpse with mouth answers 5 questions with what it knew in life; can cast on same every 10 days",
    descriptionFull: "You grant the semblance of life to a corpse of your choice within range, allowing it to answer questions you pose. The corpse must have a mouth, and this spell fails if the deceased creature was Undead when it died. The spell also fails if the corpse was the target of this spell within the past 10 days." + "\n   " + "Until the spell ends, you can ask the corpse up to five questions. The corpse knows only what it knew in life, including the languages it knew. Answers are usually brief, cryptic, or repetitive, and the corpse is under no compulsion to offer a truthful answer if you are antagonistic toward it or it recognizes you as an enemy. This spell doesn't return the creature's soul to its body, only its animating spirit. Thus, the corpse can't learn new information, doesn't comprehend anything that has happened since it died, and can't speculate about future events."
});
legacySpellRefactor("speak with plants", {
    name: "Speak with Plants",
    classes: ["bard", "druid", "ranger"],
    source: [
        ["P24", 319]
    ],
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "S:30-ft rad",
    components: "V,S",
    duration: "10 min",
    description: "Speak with plants \u0026 plant crea in fixed 30ft rad about last 24h; dif. plant ter. to normal or vice versa",
    descriptionFull: "You imbue plants in an immobile 30-foot Emanation with limited sentience and animation, giving them the ability to communicate with you and follow your simple commands. You can question plants about events in the spell's area within the past day, gaining information about creatures that have passed, weather, and other circumstances." + "\n   " + "You can also turn Difficult Terrain caused by plant growth (such as thickets and undergrowth) into ordinary terrain that lasts for the duration. Or you can turn ordinary terrain where plants are present into Difficult Terrain that lasts for the duration." + "\n   " + "The spell doesn't enable plants to uproot themselves and move about, but they can move their branches, tendrils, and stalks for you." + "\n   " + "If a Plant creature is in the area, you can communicate with it as if you shared a common language."
});
legacySpellRefactor("spider climb", {
    name: "Spider Climb",
    classes: ["artificer", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 319]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "A drop of bitumen and a spider",
    duration: "Conc, 1 h",
    description: "1+1/SL crea gains climb speed equal to speed; can move on walls and ceilings without using hands",
    descriptionFull: "Until the spell ends, one willing creature you touch gains the ability to move up, down, and across vertical surfaces and along ceilings, while leaving its hands free. The target also gains a Climb Speed equal to its Speed." + AtHigherLevels + "You can target one additional creature for each spell slot above 2"
});
legacySpellRefactor("spike growth", {
    name: "Spike Growth",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 319]
    ],
    level: 2,
    school: "Trans",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "Seven thorns",
    duration: "Conc, 10 min",
    description: "20-ft rad difficult terrain; all 2d4 Piercing per 5ft moved; Wis(Percep. or Survival) vs spell DC to notice",
    descriptionShorter: "20ft rad dif. ter.; all 2d4 Piercing per 5ft moved; Wis(Percep or Surv) vs spell DC to notice",
    descriptionFull: "The ground in a 20-foot-radius Sphere centered on a point within range sprouts hard spikes and thorns. The area becomes Difficult Terrain for the duration. When a creature moves into or within the area, it takes 2d4 Piercing damage for every 5 feet it travels." + "\n   " + "The transformation of the ground is camouflaged to look natural. Any creature that can't see the area when the spell is cast must take a Search action and succeed on a Wisdom (Perception or Survival) check against your spell save DC to recognize the terrain as hazardous before entering it."
});
legacySpellRefactor("spirit guardians", {
    name: "Spirit Guardians",
    classes: ["cleric"],
    source: [
        ["P24", 319]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "S:15-ft rad",
    components: "V,S,M",
    compMaterial: "A prayer scroll",
    duration: "Conc, 10 min",
    save: "Wis",
    description: "Undesignated crea half speed in area, cover/enter/end 3d8+1d8/SL Radiant/Necrotic (1/t/c); save half",
    descriptionShorter: "Any crea 1/2 speed, cover/enter/end 3d8+1d8/SL Radiant/Necrotic; save half",
    descriptionFull: "Protective spirits flit around you in a 15-foot Emanation for the duration. If you are good or neutral, their spectral form appears angelic or fey (your choice). If you are evil, they appear fiendish." + "\n   " + "When you cast this spell, you can designate creatures to be unaffected by it. Any other creature's Speed is halved in the Emanation, and whenever the Emanation enters a creature's space and whenever a creature enters the Emanation or ends its turn there, the creature must make a Wisdom saving throw. On a failed save, the creature takes 3d8 Radiant damage (if you are good or neutral) or 3d8 Necrotic damage (if you are evil). On a successful save, the creature takes half as much damage. A creature makes this save only once per turn." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 3.",
    dynamicDamageBonus: {
        multipleDmgTypes: {
            dmgTypes: ["radiant", "necrotic"],
            inDescriptionAs: "Radiant/Necrotic"
        }
    }
});
legacySpellRefactor("spiritual weapon", {
    name: "Spiritual Weapon",
    classes: ["cleric"],
    source: [
        ["P24", 319]
    ],
    level: 2,
    school: "Evoc",
    time: "1 bns",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Create spectral weapon; melee spell atk 1d8+1d8/SL+spell mod Force; bns to move 20 ft and atk",
    descriptionShorter: "Create wea; spell atk 1d8+1d8/SL+spell mod Force dmg; bns move 20 ft and atk",
    descriptionFull: "You create a floating, spectral force that resembles a weapon of your choice and lasts for the duration. The force appears within range in a space of your choice, and you can immediately make one melee spell attack against one creature within 5 feet of the force. On a hit, the target takes Force damage equal to 1d8 plus your spellcasting ability modifier." + "\n   " + "As a Bonus Action on your later turns, you can move the force up to 20 feet and repeat the attack against a creature within 5 feet of it." + AtHigherLevels + "Using a Higher-Level Spell Slot. The damage increases by 1d8 for every slot level above 2."
});
legacySpellRefactor("staggering smite", {
    name: "Staggering Smite",
    classes: ["paladin"],
    source: [
        ["P24", 320]
    ],
    level: 4,
    school: "Ench",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or an Unarmed Strike.",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    save: "Wis",
    description: "Melee wea/unarmed hit +4d6+1d6/SL Psychic; target save or Stunned until my next turn ends",
    descriptionFull: "The target takes an extra 4d6 Psychic damage from the attack, and the target must succeed on a Wisdom saving throw or have the Stunned condition until the end of your next turn." + AtHigherLevels + "The extra damage increases by 1d6 for each spell slot level above 4."
});
legacySpellRefactor("starry wisp", {
    name: "Starry Wisp",
    classes: ["bard", "druid"],
    source: [
        ["P24", 320]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    description: "Spell atk crea/obj; 1d8 Radiant; emit 10ft rad dim light \u0026 no Invisible to my next EoT; +1d8 CL 5/11/17",
    descriptionCantripDie: "Spell atk crea/obj, `CD`d8 Radiant; target emits 10ft rad dim light \u0026 not Invisible to my next EoT",
    descriptionFull: "You launch a mote of light at one creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d8 Radiant damage, and until the end of your next turn, it emits Dim light in a 10-foot radius and can't benefit from the Invisible condition." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("steel wind strike", {
    name: "Steel Wind Strike",
    nameShort: "Steel Wind Strike*",
    classes: ["ranger", "wizard"],
    source: [
        ["P24", 320]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "S,M\u0192",
    compMaterial: "A Melee weapon worth 1+ sp",
    duration: "Instantaneous",
    description: "Melee spell atk vs 5 visible creatures; 6d10 Force dmg on each hit; after, I teleport next to 1 target",
    descriptionFull: "You flourish the weapon used in the casting and then vanish to strike like the wind. Choose up to five creatures you can see within range. Make a melee spell attack against each target. On a hit, a target takes 6d10 force damage." + "\n   " + "You then teleport to an unoccupied space you can see within 5 feet of one of the targets."
});
legacySpellRefactor("stinking cloud", {
    name: "Stinking Cloud",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 321]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M",
    compMaterial: "A rotten egg",
    duration: "Conc, 1 min",
    save: "Con",
    description: "20-ft radius; heavily obscures; all in area at start of turn save vs Poisoned or can't act that turn",
    descriptionFull: "You create a 20-foot-radius Sphere of yellow, nauseating gas centered on a point within range. The cloud is Heavily Obscured. The cloud lingers in the air for the duration or until a strong wind (such as the one created by Gust of Wind) disperses it." + "\n   " + "Each creature that starts its turn in the Sphere must succeed on a Constitution saving throw or have the Poisoned condition until the end of the current turn. While Poisoned in this way, the creature can't take an action or a Bonus Action."
});
legacySpellRefactor("stone shape", {
    name: "Stone Shape",
    classes: ["artificer", "cleric", "druid", "wizard"],
    source: [
        ["P24", 321]
    ],
    level: 4,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M",
    compMaterial: "Soft clay",
    duration: "Instantaneous",
    description: "Form 5 cu ft of stone into any shape; can have up to two hinges and a latch, but no finer mechanisms",
    descriptionFull: "You touch a stone object of Medium size or smaller or a section of stone no more than 5 feet in any dimension and form it into any shape you like. For example, you could shape a large rock into a weapon, statue, or coffer, or you could make a small passage through a wall that is 5 feet thick. You could also shape a stone door or its frame to seal the door shut. The object you create can have up to two hinges and a latch, but finer mechanical detail isn't possible."
});
legacySpellRefactor("stoneskin", {
    name: "Stoneskin",
    classes: ["artificer", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 321]
    ],
    level: 4,
    school: "Trans",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Diamond dust worth 100+ gp, which the spell consumes",
    duration: "Conc, 1 h",
    description: "1 willing crea has resistance to Bludgeoning, Piercing, and Slashing damage (100gp cons.)",
    descriptionFull: "Until the spell ends, one willing creature you touch has Resistance to Bludgeoning, Piercing, and Slashing damage."
});
legacySpellRefactor("storm of vengeance", {
    name: "Storm of Vengeance",
    classes: ["druid"],
    source: [
        ["P24", 321]
    ],
    level: 9,
    school: "Conj",
    time: "1 a",
    range: "1 mile",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Con",
    description: "300-ft rad all save or 2d6 Thunder dmg and Deafened; new effect every round; see book",
    descriptionFull: "A churning storm cloud forms for the duration, centered on a point within range and spreading to a radius of 300 feet. Each creature under the cloud when it appears must succeed on a Constitution saving throw or take 2d6 Thunder damage and have the Deafened condition for the duration." + "\n   " + "At the start of each of your later turns, the storm produces different effects, as detailed below." + "\n   " + toUni("Turn 2") + ": Acidic rain falls. Each creature and object under the cloud takes 4d6 Acid damage." + "\n   " + toUni("Turn 3") + ": You call six bolts of lightning from the cloud to strike six different creatures or objects beneath it. Each target makes a Dexterity saving throw, taking 10d6 Lightning damage on a failed save or half as much damage on a successful one." + "\n   " + toUni("Turn 4") + ": Hailstones rain down. Each creature under the cloud takes 2d6 Bludgeoning damage." + "\n   " + toUni("Turn 5-10") + ": Gusts and freezing rain assail the area under the cloud. Each creature there takes 1d6 Cold damage. Until the spell ends, the area is Difficult Terrain and Heavily Obscured, ranged attacks with weapons are impossible there, and strong wind blows through the area.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("suggestion", {
    name: "Suggestion",
    nameShort: "Suggestion*",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 321]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,M",
    compMaterial: "A drop of honey",
    duration: "Conc, 8 h",
    save: "Wis",
    description: "1 crea save or Charmed; attempts achievable action stated in 25 words; ends if done or I/allies dmg it",
    descriptionFull: "You suggest a course of activity ‚Äî described in no more than 25 words ‚Äî to one creature you can see within range that can hear and understand you. The suggestion must sound achievable and not involve anything that would obviously deal damage to the target or its allies. For example, you could say, \"Fetch the key to the cult's treasure vault, and give the key to me.\" Or you could say, \"Stop fighting, leave this library peacefully, and don't return.\"" + "\n   " + "The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration or until you or your allies deal damage to the target. The Charmed target pursues the suggestion to the best of its ability. The suggested activity can continue for the entire duration, but if the suggested activity can be completed in a shorter time, the spell ends for the target upon completing it."
});
legacySpellRefactor("summon aberration", {
    name: "Summon Aberration",
    nameShort: "Summon Aberration*",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 322]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A pickled tentacle and an eyeball in a platinum-inlaid vial worth 400+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Abberant Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
    descriptionFull: "You call forth an aberrant spirit. It manifests in an unoccupied space that you can see within range and uses the Aberrant Spirit stat block. When you cast the spell, choose Beholderkin, Mind Flayer, or Slaad." + "\n   " + "The creature is an ally to you and your allies. In combat, it shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon beast", {
    name: "Summon Beast",
    nameShort: "Summon Beast*",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 322]
    ],
    level: 2,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A feather, tuft of fur, and fish tail inside a gilded acorn worth 200+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Bestial Spirit; obeys commands; takes turn after mine; disappears at 0 hp (200gp)",
    descriptionFull: "You call forth a bestial spirit. It manifests in an unoccupied space that you can see within range and uses the Bestial Spirit stat block. When you cast the spell, choose an environment: Air, Land, or Water. The creature resembles an animal of your choice that is native to the chosen environment, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon celestial", {
    name: "Summon Celestial",
    nameShort: "Summon Celestial*",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 323]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A golden reliquary worth 500+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Celestial Spirit; obeys commands; takes turn after mine; disappears at 0 hp (500gp)",
    descriptionFull: "You call forth a Celestial spirit. It manifests in an angelic form in an unoccupied space that you can see within range and uses the Celestial Spirit stat block. When you cast the spell, choose Avenger or Defender. Your choice determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon construct", {
    name: "Summon Construct",
    nameShort: "Summon Construct*",
    classes: ["artificer", "wizard"],
    source: [
        ["P24", 324]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A lockbox worth 400+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Construct Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
    descriptionFull: "You call forth the spirit of a Construct. It manifests in an unoccupied space that you can see within range and uses the Construct Spirit stat block. When you cast the spell, choose a material: Clay, Metal, or Stone. The creature resembles an animate statue (you determine the appearance) made of the chosen material, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon dragon", {
    name: "Summon Dragon",
    nameShort: "Summon Dragon*",
    classes: ["wizard"],
    source: [
        ["P24", 324]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M\u0192",
    compMaterial: "an object with the image of a dragon engraved on it, worth 500+ gp",
    duration: "Conc, 1 h",
    description: "Summon Dragonic Spirit; obeys commands; share resist; takes turn after mine; vanishes at 0 hp (500gp)",
    descriptionFull: "You call forth a Dragon spirit. It manifests in an unoccupied space that you can see within range and uses the Draconic Spirit stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block.",
});
legacySpellRefactor("summon elemental", {
    name: "Summon Elemental",
    nameShort: "Summon Elemental*",
    classes: ["druid", "ranger", "wizard"],
    source: [
        ["P24", 325]
    ],
    level: 4,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "Air, a pebble, ash, and water inside a gold-inlaid vial worth 400+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Elemental Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
    descriptionFull: "You call forth an Elemental spirit. It manifests in an unoccupied space that you can see within range and uses the Elemental Spirit stat block. When you cast the spell, choose an element: Air, Earth, Fire, or Water. The creature resembles a bipedal form wreathed in the chosen element, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon fey", {
    name: "Summon Fey",
    nameShort: "Summon Fey*",
    classes: ["druid", "ranger", "warlock", "wizard"],
    source: [
        ["P24", 326]
    ],
    level: 3,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A gilded flower worth 300+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Fey Spirit; obeys commands; takes turn after mine; disappears at 0 hp (300gp)",
    descriptionFull: "You call forth a Fey spirit. It manifests in an unoccupied space that you can see within range and uses the Fey Spirit stat block. When you cast the spell, choose a mood: Fuming, Mirthful, or Tricksy. The creature resembles a Fey creature of your choice marked by the chosen mood, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon fiend", {
    name: "Summon Fiend",
    nameShort: "Summon Fiend*",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 326]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A bloody vial worth 600+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Fiendish Spirit; obeys commands; takes turn after mine; disappears at 0 hp (600gp)",
    descriptionFull: "You call forth a fiendish spirit. It manifests in an unoccupied space that you can see within range and uses the Fiendish Spirit stat block. When you cast the spell, choose Demon, Devil, or Yugoloth. The creature resembles a Fiend of the chosen type, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("summon undead", {
    name: "Summon Undead",
    nameShort: "Summon Undead*",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 328]
    ],
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "90 ft",
    components: "V,S,M\u0192",
    compMaterial: "A gilded skull worth 300+ gp",
    duration: "Conc, 1 h",
    description: "Summon choice of Undead Spirit; obeys commands; takes turn after mine; disappears at 0 hp (300gp)",
    descriptionFull: "You call forth an Undead spirit. It manifests in an unoccupied space that you can see within range and uses the Undead Spirit stat block. When you cast the spell, choose the creature's form: Ghostly, Putrid, or Skeletal. The spirit resembles an Undead creature with the chosen form, which determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("sunbeam", {
    name: "Sunbeam",
    classes: ["cleric", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 329]
    ],
    level: 6,
    school: "Evoc",
    time: "1 a",
    range: "S:60" + (typePF ? "-" : "") + "ft line",
    components: "V,S,M",
    compMaterial: "A magnifying glass",
    duration: "Conc, 1 min",
    save: "Con",
    description: "60\xD75ft line all 6d8 Radiant, 1 rnd Blind; save 1/2 only; 1 a for new line; 30ft rad bright sunlight/30ft dim",
    descriptionShorter: "60-ft long 5-ft wide all 6d8 Radiant, 1 rnd Blind; save half, not Blind; 1 a for new line",
    descriptionFull: "You launch a sunbeam in a 5-foot-wide, 60-foot-long Line. Each creature in the Line makes a Constitution saving throw. On a failed save, a creature takes 6d8 Radiant damage and has the Blinded condition until the start of your next turn. On a successful save, it takes half as much damage only." + "\n   " + "Until the spell ends, you can take a Magic action to create a new Line of radiance." + "\n   " + "For the duration, a mote of brilliant radiance shines above you. It sheds Bright Light in a 30-foot radius and Dim Light for an additional 30 feet. This light is sunlight.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("sunburst", {
    name: "Sunburst",
    classes: ["cleric", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 329]
    ],
    level: 8,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A piece of sunstone",
    duration: "Instantaneous",
    save: "Con",
    description: "60-ft rad sunlight all 12d6 Radiant dmg, 1 min Blind; save halves and not Blinded; repeat save EoT",
    descriptionFull: "Brilliant sunlight flashes in a 60-foot-radius Sphere centered on a point you choose within range. Each creature in the Sphere makes a Constitution saving throw. On a failed save, a creature takes 12d6 Radiant damage and has the Blinded condition for 1 minute. On a successful save, it takes half as much damage only." + "\n   " + "A creature Blinded by this spell makes another Constitution saving throw at the end of each of its turns, ending the effect on itself on a success." + "\n   " + "This spell dispels Darkness in its area that was created by any spell."
});
legacySpellRefactor("swift quiver", {
    name: "Swift Quiver",
    classes: ["ranger"],
    source: [
        ["P24", 329]
    ],
    level: 5,
    school: "Trans",
    time: "1 bns",
    range: "Self",
    components: "V,S,M",
    compMaterial: "A quiver worth 1+ gp",
    duration: "Conc, 1 min",
    description: "Atk twice with weapon that uses arrows or bolts; spell makes nonmagical ammo; bns to repeat atks",
    descriptionFull: "When you cast the spell and as a Bonus Action until it ends, you can make two attacks with a weapon that fires Arrows or Bolts, such as a Longbow or a Light Crossbow. The spell magically creates the ammunition needed for each attack. Each Arrow or Bolt created by the spell deals damage like a nonmagical piece of ammunition of its kind and disintegrates immediately after it hits or misses."
});
legacySpellRefactor("symbol", {
    name: "Symbol",
    classes: ["bard", "cleric", "druid", "wizard"],
    source: [
        ["P24", 329]
    ],
    level: 7,
    school: "Abjur",
    time: "1 min",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Powdered diamond worth 1,000+ gp, which the spell consumes",
    duration: "Till triggered",
    description: "Inscribe a glyph to activate for chosen effect on set trigger; see book (1000gp cons.)",
    descriptionFull: "You inscribe a harmful glyph either on a surface (such as a section of floor or wall) or within an object that can be closed (such as a book or chest). The glyph can cover an area no larger than 10 feet in diameter. If you choose an object, it must remain in place; if it is moved more than 10 feet from where you cast this spell, the glyph is broken, and the spell ends without being triggered." + "\n   " + "The glyph is nearly imperceptible and requires a successful Wisdom (Perception) check against your spell save DC to notice." + "\n   " + "When you inscribe the glyph, you set its trigger and choose which effect the symbol bears: Death, Discord, Fear, Pain, Sleep, or Stunning. Each one is explained below." + "\n   " + toUni("Set the Trigger.") + " You decide what triggers the glyph when you cast the spell. For glyphs inscribed on a surface, common triggers include touching or stepping on the glyph, removing another object covering it, or approaching within a certain distance of it. For glyphs inscribed within an object, common triggers include opening that object or seeing the glyph." + "\n   " + "You can refine the trigger so that only creatures of certain types activate it (for example, the glyph could be set to affect Aberrations). You can also set conditions for creatures that don't trigger the glyph, such as those who say a certain password." + "\n   " + "Once triggered, the glyph glows, filling a 60-foot-radius Sphere with Dim Light for 10 minutes, after which time the spell ends. Each creature in the Sphere when the glyph activates is targeted by its effect, as is a creature that enters the Sphere for the first time on a turn or ends its turn there. A creature is targeted only once per turn." + "\n   " + toUni("Death") + ": Each target makes a Constitution saving throw, taking 10d10 Necrotic damage on a failed save or half as much damage on a successful save." + "\n   " + toUni("Discord") + ": Discord. Each target makes a Wisdom saving throw. On a failed save, a target argues with other creatures for 1 minute. During this time, it is incapable of meaningful communication and has Disadvantage on attack rolls and ability checks." + "\n   " + toUni("Fear") + ": Each target must succeed on a Wisdom saving throw or have the Frightened condition for 1 minute. While Frightened, the target must move at least 30 feet away from the glyph on each of its turns, if able." + "\n   " + toUni("Pain") + ": Each target must succeed on a Constitution saving throw or have the Incapacitated condition for 1 minute." + "\n   " + toUni("Sleep") + ": Each target must succeed on a Wisdom saving throw or have the Unconscious condition for 10 minutes. A creature awakens if it takes damage or if someone takes an action to shake it awake." + "\n   " + toUni("Stunning") + ": Each target must succeed on a Wisdom saving throw or have the Stunned condition for 1 minute."
});
legacySpellRefactor("synaptic static", {
    name: "Synaptic Static",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 330]
    ],
    level: 5,
    school: "Ench",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Int",
    description: "20-ft rad all save or 8d6 Psychic, 1 min -1d6 on atk/chk/conc. save; save 1/2, no -1d6; redo save EoT",
    descriptionShorter: "20ft rad all save or 8d6 Psychic, 1 min -1d6 on atks/check/conc. save; save 1/2, no -1d6; EoT save",
    descriptionFull: "You cause psychic energy to erupt at a point within range. Each creature in a 20-foot-radius Sphere centered on that point makes an Intelligence saving throw, taking 8d6 Psychic damage on a failed save or half as much damage on a successful one." + "\n   " + "On a failed save, a target also has muddled thoughts for 1 minute. During that time, it subtracts 1d6 from all its attack rolls and ability checks, as well as any Constitution saving throws to maintain Concentration. The target makes an Intelligence saving throw at the end of each of its turns, ending the effect on itself on a success."
});
legacySpellRefactor("tasha's bubbling cauldron", {
    name: "Tasha's Bubbling Cauldron",
    nameAlt: "Bubbling Cauldron",
    nameShort: "T's Bubbling Cauldron",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 330]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "5 ft",
    components: "V,S,M",
    compMaterial: "A gilded ladle worth 500+ gp",
    duration: "10 min",
    description: "Immobile cauldron of Common/Uncom. potion; max spell mod, min 1; bns take 1; disappear on recast",
    descriptionFull: "You conjure a claw-footed cauldron filled with bubbling liquid. The cauldron appears in an unoccupied space on the ground within 5 feet of you and lasts for the duration. The cauldron can't be moved and disappears when the spell ends, along with the bubbling liquid inside it." + "\n   " + "The liquid in the cauldron duplicates the properties of a Common or an Uncommon potion of your choice (such as a Potion of Healing). As a Bonus Action, you or an ally can reach into the cauldron and withdraw one potion of that kind. The potion is contained in a vial that disappears when the potion is consumed. The cauldron can produce a number of these potions equal to your spellcasting ability modifier (minimum 1). When the last of these potions is withdrawn from the cauldron, the cauldron disappears, and the spell ends." + "\n   " + "Potions obtained from the cauldron that aren't consumed disappear when you cast this spell again."
});
legacySpellRefactor("tasha's hideous laughter", {
    name: "Tasha's Hideous Laughter",
    nameShort: "T's Hideous Laughter*",
    nameAlt: "Hideous Laughter",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 331]
    ],
    level: 1,
    school: "Ench",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A tart and a feather",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "1+1/SL crea save or Prone, Incapacitated, can't stand; save at EoT \u0026 on dmg; adv if dmg",
    descriptionFull: "One creature of your choice that you can see within range makes a Wisdom saving throw. On a failed save, it has the Prone and Incapacitated conditions for the duration. During that time, it laughs uncontrollably if it's capable of laughter, and it can't end the Prone condition on itself." + "\n   " + "At the end of each of its turns and each time it takes damage, it makes another Wisdom saving throw. The target has Advantage on the save if the save is triggered by damage. On a successful save, the spell ends." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("telekinesis", {
    name: "Telekinesis",
    nameShort: "Telekinesis*",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 331]
    ],
    level: 5,
    school: "Trans",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Conc, 10 min",
    save: "Str",
    description: "1 \u2264Huge crea/held obj save or move 30ft \u0026 Restrain to my next EoT; unattended obj no save; 1 a redo",
    descriptionFull: "You gain the ability to move or manipulate creatures or objects by thought. When you cast the spell and as a Magic action on your later turns before the spell ends, you can exert your will on one creature or object that you can see within range, causing the appropriate effect below. You can affect the same target round after round or choose a new one at any time. If you switch targets, the prior target is no longer affected by the spell." + "\n   " + toUni("Creature") + ": You can try to move a Huge or smaller creature. The target must succeed on a Strength saving throw, or you move it up to 30 feet in any direction within the spell's range. Until the end of your next turn, the creature has the Restrained condition, and if you lift it into the air, it is suspended there. It falls at the end of your next turn unless you use this option on it again and it fails the save." + "\n   " + toUni("Object") + ": You can try to move a Huge or smaller object. If the object isn't being worn or carried, you automatically move it up to 30 feet in any direction within the spell's range." + "\n   " + "If the object is worn or carried by a creature, that creature must succeed on a Strength saving throw, or you pull the object away and move it up to 30 feet in any direction within the spell's range." + "\n   " + "You can exert fine control on objects with your telekinetic grip, such as manipulating a simple tool, opening a door or a container, stowing or retrieving an item from an open container, or pouring the contents from a vial."
});
legacySpellRefactor("telepathy", {
    name: "Telepathy",
    classes: ["wizard"],
    source: [
        ["P24", 331]
    ],
    level: 8,
    school: "Div",
    time: "1 a",
    range: "Unlimited",
    components: "V,S,M",
    compMaterial: "A pair of linked silver rings",
    duration: "24 h",
    description: "1 familiar willing crea \u0026 I telepathic link on same plane; share words, sensory info; understand meaning",
    descriptionFull: "You create a telepathic link between yourself and a willing creature with which you are familiar. The creature can be anywhere on the same plane of existence as you. The spell ends if you or the target are no longer on the same plane." + "\n   " + "Until the spell ends, you and the target can instantly share words, images, sounds, and other sensory messages with each other through the link, and the target recognizes you as the creature it is communicating with. The spell enables a creature to understand the meaning of your words and any sensory messages you send to it."
});
legacySpellRefactor("teleport", {
    name: "Teleport",
    nameShort: "Teleport*",
    classes: ["bard", "sorcerer", "wizard"],
    source: [
        ["P24", 331]
    ],
    level: 7,
    school: "Conj",
    time: "1 a",
    range: "10 ft",
    components: "V",
    duration: "Instantaneous",
    description: "Me + 8 willing crea, or 1 unattended obj teleport to a place I know, have seen, or can describe; see B",
    descriptionFull: [
        "This spell instantly transports you and up to eight willing creatures that you can see within range, or a single object that you can see within range, to a destination you select. If you target an object, it must be Large or smaller, and it can't be held or carried by an unwilling creature." + "\n   " + "The destination you choose must be known to you, and it must be on the same plane of existence as you. Your familiarity with the destination determines whether you arrive there successfully. The DM rolls 1d100 and consults the Teleportation Outcome table and the explanations after it.\n",
        toUni("Familiarity\tMishap\tSimilar\t  Off\t   On"),
        "\t\t\t  " + toUni("Area\tTarget\tTarget"),
        "Permanent circle\t    -\t    -\t    -\t01-100",
        "Linked object\t    -\t    -\t    -\t01-100",
        "Very familiar\t01-05\t06-13\t14-24\t25-100",
        "Seen casually\t01-33\t34-43\t44-53\t54-100",
        "Seen 1/described\t01-43\t44-53\t54-73\t74-100",
        "False destination\t01-50\t51-100\t    -\t    -\n"
    ].join("\n") + desc([
        toUni("Familiarity") + ": \"Permanent circle\" means a permanent teleportation circle whose sigil sequence you know.",
        "\"Linked object\" means you possess an object taken from the desired destination within the last six months, such as a book from a wizard's library.",
        "\"Very familiar\" is a place you have been very often, a place you have carefully studied, or a place you can see when you cast the spell.",
        "\"Seen casually\" is a place you have seen more than once but with which you aren't very familiar.",
        "\"Seen 1/described\" is a place whose location and appearance you know through someone else's description, perhaps from a map.",
        "\"False destination\" is a place that doesn't exist. Perhaps you tried to scry an enemy's sanctum but instead viewed an illusion, or you are attempting to teleport to a location that no longer exists.",
        toUni("On Target") + ": You and your group (or the target object) appear where you intended.",
        toUni("Off Target") + ": You and your group (or the target object) appear 2d12 miles away from the destination in a random direction. Roll 1d8 for the direction: 1, east; 2, southeast; 3, south; 4, southwest; 5, west; 6, northwest; 7, north; or 8, northeast.",
        toUni("Similar Area") + ": You and your group (or the target object) appear in a different area that's visually or thematically similar to the target area. You appear in the closest similar place. If you are heading for your home laboratory, for example, you might appear in another person's laboratory in the same city.",
        toUni("Mishap") + ": The spell's unpredictable magic results in a difficult journey. Each teleporting creature (or the target object) takes 3d10 Force damage, and the DM rerolls on the table to see where you wind up (multiple mishaps can occur, dealing damage each time)."
    ])
});
legacySpellRefactor("teleportation circle", {
    name: "Teleportation Circle",
    classes: ["bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 332]
    ],
    level: 5,
    school: "Conj",
    time: "1 min",
    range: "10 ft",
    components: "V,M\u2020",
    compMaterial: "Rare inks worth 50+ gp, which the spell consumes",
    duration: "1 round",
    description: "Create a circle to teleport to another teleportation circle on same plane; see book (50gp cons.)",
    descriptionFull: "As you cast the spell, you draw a 5-foot-radius circle on the ground inscribed with sigils that link your location to a permanent teleportation circle of your choice whose sigil sequence you know and that is on the same plane of existence as you. A shimmering portal opens within the circle you drew and remains open until the end of your next turn. Any creature that enters the portal instantly appears within 5 feet of the destination circle or in the nearest unoccupied space if that space is occupied." + "\n   " + "Many major temples, guildhalls, and other important places have permanent teleportation circles. Each circle includes a unique sigil sequence‚Äîa string of runes arranged in a particular pattern." + "\n   " + "When you first gain the ability to cast this spell, you learn the sigil sequences for two destinations on the Material Plane, determined by the DM. You might learn additional sigil sequences during your adventures. You can commit a new sigil sequence to memory after studying it for 1 minute." + "\n   " + "You can create a permanent teleportation circle by casting this spell in the same location every day for 365 days."
});
legacySpellRefactor("tenser's floating disk", {
    name: "Tenser's Floating Disk",
    nameShort: "Tenser's Floating Disk*",
    nameAlt: "Floating Disk",
    classes: ["wizard"],
    source: [
        ["P24", 332]
    ],
    ritual: true,
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A drop of mercury",
    duration: "1 h",
    description: "Create a 3 ft diameter disk that carries 500 lb and follows me if I move more than 20 ft away",
    descriptionFull: "This spell creates a circular, horizontal plane of force, 3 feet in diameter and 1 inch thick, that floats 3 feet above the ground in an unoccupied space of your choice that you can see within range. The disk remains for the duration and can hold up to 500 pounds. If more weight is placed on it, the spell ends, and everything on the disk falls to the ground." + "\n   " + "The disk is immobile while you are within 20 feet of it. If you move more than 20 feet away from it, the disk follows you so that it remains within 20 feet of you. It can move across uneven terrain, up or down stairs, slopes and the like, but it can't cross an elevation change of 10 feet or more. For example, the disk can't move across a 10-foot-deep pit, nor could it leave such a pit if it was created at the bottom." + "\n   " + "If you move more than 100 feet from the disk (typically because it can't move around an obstacle to follow you), the spell ends."
});
legacySpellRefactor("thaumaturgy", {
    name: "Thaumaturgy",
    classes: ["cleric"],
    source: [
        ["P24", 333]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V",
    duration: "1 min",
    description: "Alter eyes, voice booms, flames flicker, door/window open/close; ominous sound, tremors; up to 3",
    descriptionFull: "You manifest a minor wonder within range. You create one of the effects below within range. If you cast this spell multiple times, you can have up to three of its 1-minute effects active at a time." + "\n " + "\u2022 " + toUni("Altered Eyes.") + " You alter the appearance of your eyes for 1 minute." + "\n " + "\u2022 " + toUni("Booming Voice.") + " Your voice booms up to three times as loud as normal for 1 minute." + "\n " + "\u2022 " + toUni("Fire Play.") + " You cause flames to flicker, brighten, dim, or change color for 1 minute." + "\n " + "\u2022 " + toUni("Invisible Hand.") + " You instantaneously cause an unlocked door or window to fly open or slam shut." + "\n " + "\u2022 " + toUni("Phantom Sound.") + " You create an instantaneous sound that originates from a point of your choice within range, such as a rumble of thunder, the cry of a raven, or ominous whispers." + "\n " + "\u2022 " + toUni("Tremors.") + " You cause harmless tremors in the ground for 1 minute."
});
legacySpellRefactor("thorn whip", {
    name: "Thorn Whip",
    classes: ["artificer", "druid"],
    source: [
        ["P24", 333]
    ],
    level: 0,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "The stem of a thorny plant",
    duration: "Instantaneous",
    description: "Melee spell atk for 1d6 Piercing \u0026 can pull \u2264Large crea up to 10 ft closer; +1d6 at CL 5, 11, \u0026 17",
    descriptionCantripDie: "Melee spell atk for `CD`d6 Piercing and can pull up to Large crea up to 10 ft closer",
    descriptionFull: "You create a vine-like whip covered in thorns that lashes out at your command toward a creature in range. Make a melee spell attack against the target. On a hit, the target takes 1d6 Piercing damage, and if it is Large or smaller, you can pull it up to 10 feet closer to you." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d6 when you reach levels 5 (2d6), 11 (3d6), and 17 (4d6)."
});
legacySpellRefactor("thunderclap", {
    name: "Thunderclap",
    classes: ["artificer", "bard", "druid", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 333]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "S:5-ft rad",
    components: "S",
    duration: "Instantaneous",
    save: "Con",
    description: "100-ft rad audible; all creatures but me save or 1d6 Thunder; +1d6 at CL 5, 11, and 17",
    descriptionCantripDie: "100-ft rad audible; all creatures but me save or `CD`d6 Thunder",
    descriptionFull: "Each creature in a 5-foot Emanation originating from you must succeed on a Constitution saving throw or take 1d6 Thunder damage. The spell's thunderous sound can be heard up to 100 feet away." + "\n   " + toUni("Cantrip Upgrade") + ". The spell's damage increases by 1d6 when you reach 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
});
legacySpellRefactor("thunderous smite", {
    name: "Thunderous Smite",
    classes: ["paladin"],
    source: [
        ["P24", 334]
    ],
    level: 1,
    school: "Evoc",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or an Unarmed Strike",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    save: "Str",
    description: "Melee wea/unarmed hit +2d6+1d6/SL Thunder; save or 10 ft push \u0026 Prone; audible in 300 ft",
    descriptionFull: "Your strike rings with thunder that is audible within 300 feet of you, and the target takes an extra 2d6 Thunder damage from the attack. Additionally, if the target is a creature, it must succeed on a Strength saving throw or be pushed 10 feet away from you and have the Prone condition." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("thunderwave", {
    name: "Thunderwave",
    classes: ["bard", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 334]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "S:15ft cube",
    components: "V,S",
    duration: "Instantaneous",
    save: "Con",
    description: "All crea/unsecured obj 2d8+1d8/SL Thunder, pushed 10 ft away; save 1/2 dmg only; audible 300ft",
    descriptionFull: "You unleash a wave of thunderous energy. Each creature in a 15-foot Cube originating from you makes a Constitution saving throw. On a failed save, a creature takes 2d8 Thunder damage and is pushed 10 feet away from you. On a successful save, a creature takes half as much damage only." + "\n   " + "In addition, unsecured objects that are entirely within the Cube are pushed 10 feet away from you, and a thunderous boom is audible within 300 feet." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 1."
});
legacySpellRefactor("time stop", {
    name: "Time Stop",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 334]
    ],
    level: 9,
    school: "Trans",
    time: "1 a",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    description: "I instantly take 1d4+1 turns; spell ends if affect other crea or worn/carried obj, or move over 1000ft ",
    descriptionFull: "You briefly stop the flow of time for everyone but yourself. No time passes for other creatures, while you take 1d4 + 1 turns in a row, during which you can use actions and move as normal." + "\n   " + "This spell ends if one of the actions you use during this period, or any effects that you create during it, affects a creature other than you or an object being worn or carried by someone other than you. In addition, the spell ends if you move to a place more than 1,000 feet from the location where you cast it."
});
legacySpellRefactor("toll the dead", {
    name: "Toll the Dead",
    nameShort: "Toll the Dead*",
    classes: ["cleric", "warlock", "wizard"],
    source: [
        ["P24", 334]
    ],
    level: 0,
    school: "Necro",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "Instantaneous",
    save: "Wis",
    description: "1 crea save or 1d12 Necrotic dmg (d8 if full HP); +1d12/1d8 at CL 5, 11, \u0026 17; bell audible in 10ft",
    descriptionCantripDie: "1 crea save or `CD`d12 Necrotic damage (d8 if at full HP); bell audible in 10ft",
    descriptionFull: "You point at one creature you can see within range, and the single chime of a dolorous bell is audible within 10 feet of the target. The target must succeed on a Wisdom saving throw or take 1d8 Necrotic damage. If the target is missing any of its Hit Points, it instead takes 1d12 Necrotic damage" + toUni("Cantrip Upgrade") + ". The damage increases by one die when you reach levels 5 (2d8 or 2d12), 11 (3d8 or 3d12), and 17 (4d8 or 4d12)."
});
legacySpellRefactor("tongues", {
    name: "Tongues",
    classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 334]
    ],
    level: 3,
    school: "Div",
    time: "1 a",
    range: "Touch",
    components: "V,M",
    compMaterial: "A miniature ziggurat",
    duration: "1 h",
    description: "1 crea understands all spoken and signed languages, all creatures with a language understand it",
    descriptionFull: "This spell grants the creature you touch the ability to understand any spoken or signed language that it hears or sees. Moreover, when the target communicates by speaking or signing, any creature that knows at least one language can understand it if that creature can hear the speech or see the signing."
});
legacySpellRefactor("transport via plants", {
    name: "Transport via Plants",
    classes: ["druid"],
    source: [
        ["P24", 334]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "10 ft",
    components: "V,S",
    duration: "1 min",
    description: "For duration all can move from a Large plant to another plant on the same plane that I have touched",
    descriptionFull: "This spell creates a magical link between a Large or larger inanimate plant within range and another plant, at any distance, on the same plane of existence. You must have seen or touched the destination plant at least once before. For the duration, any creature can step into the target plant and exit from the destination plant by using 5 feet of movement."
});
legacySpellRefactor("tree stride", {
    name: "Tree Stride",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 335]
    ],
    level: 5,
    school: "Conj",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "1/turn can move through tree to other tree of same kind in 500ft; takes 5ft enter/5ft exit other tree",
    descriptionFull: "You gain the ability to enter a tree and move from inside it to inside another tree of the same kind within 500 feet. Both trees must be living and at least the same size as you. You must use 5 feet of movement to enter a tree. You instantly know the location of all other trees of the same kind within 500 feet and, as part of the move used to enter the tree, can either pass into one of those trees or step out of the tree you're in. You appear in a spot of your choice within 5 feet of the destination tree, using another 5 feet of movement. If you have no movement left, you appear within 5 feet of the tree you entered." + "\n   " + "You can use this transportation ability only once on each of your turns. You must end each turn outside a tree."
});
legacySpellRefactor("true polymorph", {
    name: "True Polymorph",
    nameShort: "True Polymorph*",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 335]
    ],
    level: 9,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A drop of mercury, a dollop of gum arabic, and a wisp of smoke",
    duration: "Conc, 1 h",
    save: "Wis",
    description: "1 crea save or becomes other crea/obj of \u2264CR/CL; or obj turned into crea (CR\u22649); see B",
    descriptionFull: "Choose one creature or nonmagical object that you can see within range. The creature shape-shifts into a different creature or a nonmagical object, or the object shape-shifts into a creature (the object must be neither worn nor carried). The transformation lasts for the duration or until the target dies or is destroyed, but if you maintain Concentration on this spell for the full duration, the spell lasts until dispelled." + "\n   " + "An unwilling creature can make a Wisdom saving throw, and if it succeeds, it isn't affected by this spell." + "\n   " + toUni("Creature into Creature") + ": If you turn a creature into another kind of creature, the new form can be any kind you choose that has a Challenge Rating equal to or less than the target's Challenge Rating or level. The target's game statistics are replaced by the stat block of the new form, but it retains its Hit Points, Hit Point Dice, alignment, and personality." + "\n   " + "The target gains a number of Temporary Hit Points equal to the Hit Points of the new form. These Temporary Hit Points vanish if any remain when the spell ends." + "\n   " + "The target is limited in the actions it can perform by the anatomy of its new form, and it can't speak or cast spells." + "\n   " + "The target's gear melds into the new form. The creature can't use or otherwise benefit from any of that equipment." + "\n   " + toUni("Object into Creature") + ": You can turn an object into any kind of creature, as long as the creature's size is no larger than the object's size and the creature has a Challenge Rating of 9 or lower. The creature is Friendly to you and your allies. In combat, it takes its turns immediately after yours, and it obeys your commands." + "\n   " + "If the spell lasts more than an hour, you no longer control the creature. It might remain Friendly to you, depending on how you have treated it." + "\n   " + toUni("Creature into Object") + ": If you turn a creature into an object, it transforms along with whatever it is wearing and carrying into that form, as long as the object's size is no larger than the creature's size. The creature's statistics become those of the object, and the creature has no memory of time spent in this form after the spell ends and it returns to normal."
});
legacySpellRefactor("true resurrection", {
    name: "True Resurrection",
    classes: ["cleric", "druid"],
    source: [
        ["P24", 336]
    ],
    level: 9,
    school: "Necro",
    time: "1 h",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "diamonds worth 25,000+ gp, which the spell consumes",
    duration: "Instantaneous",
    description: "Return crea that died in the last 200 years to life with new body \u0026 full HP; see B (25k gp cons.)",
    descriptionFull: "You touch a creature that has been dead for no longer than 200 years and that died for any reason except old age. The creature is revived with all its Hit Points." + "\n   " + "This spell closes all wounds, neutralizes any poison, cures all magical contagions, and lifts any curses affecting the creature when it died. The spell replaces damaged or missing organs and limbs. If the creature was Undead, it is restored to its non-Undead form." + "\n   " + "The spell can provide a new body if the original no longer exists, in which case you must speak the creature's name. The creature then appears in an unoccupied space you choose within 10 feet of you."
});
legacySpellRefactor("true seeing", {
    name: "True Seeing",
    classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 336]
    ],
    level: 6,
    school: "Div",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u2020",
    compMaterial: "Mushroom powder worth 25+ gp, which the spell consumes",
    duration: "1 h",
    description: "1 crea gains Truesight 120 ft; pierces darkness, illusions, invisible, ethereal, magic trans. (25gp cons.)",
    descriptionFull: "For the duration, the willing creature you touch has Truesight with a range of 120 feet." + "\n   " + "If you have Truesight, your vision is enhanced within a specified range. Within that range, your vision pierces through normal and magical Darkness, Invisibility, Visual Illusions (appear transparent and save automatically against them), Transformations (see true form of creature or object transformed by magic, and the Ethereal Plane."
});
legacySpellRefactor("true strike", {
    name: "True Strike",
    classes: ["artificer", "bard", "sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 336]
    ],
    level: 0,
    school: "Div",
    time: "1 a",
    range: "Self",
    components: "S,M",
    compMaterial: "A weapon with which you have proficiency and that is worth 1+ cp",
    duration: "Instantaneous",
    description: "Atk with prof. weapon using spell ability; deal weapon or Radiant dmg; +1d6 Radiant at CL 5, 11 \u0026 17",
    descriptionFull: "Guided by a flash of magical insight, you make one attack with the weapon used in the spell's casting. The attack uses your spellcasting ability for the attack and damage rolls instead of using Strength or Dexterity. If the attack deals damage, it can be Radiant damage or the weapon's normal damage type (your choice)." + "\n   " + toUni("Cantrip Upgrade") + ". Whether you deal Radiant damage or the weapon's normal damage type, the attack deals extra Radiant damage when you reach levels 5 (1d6), 11 (2d6), and 17 (3d6).",
    descriptionCantripDie: "Atk with prof. weapon using spell ability; deal weapon or Radiant dmg, +`CD-1`d6 Radiant.",
});
legacySpellRefactor("tsunami", {
    name: "Tsunami",
    classes: ["druid"],
    source: [
        ["P24", 336]
    ],
    level: 8,
    school: "Conj",
    time: "1 min",
    range: "1 mile",
    components: "V,S",
    duration: "Conc, 6 rnds",
    save: "Str",
    description: "300\xD750\xD7300ft (l\xD7w\xD7h) wall of water moves away at 50ft/rnd; 6d10 Bludg. -1d10/rnd; save 1/2; see B",
    descriptionShorter: "300\xD750\xD7300ft (l\xD7w\xD7h) wave moves away at 50ft/rnd; 6d10 Bludg. -1d10/rnd; save 1/2; see B",
    descriptionMetric: "90\xD715\xD790m (l\xD7w\xD7h) wall of water moves away at 15 m/rnd; 6d10 Bludg. -1d10/rnd; save 1/2; see B",
    descriptionShorterMetric: "90\xD715\xD790m (l\xD7w\xD7h) wave moves away at 15 m/rnd; 6d10 Bludg. -1d10/rnd; save 1/2; see B",
    descriptionFull: "A wall of water springs into existence at a point you choose within range. You can make the wall up to 300 feet long, 300 feet high, and 50 feet thick. The wall lasts for the duration." + "\n   " + "When the wall appears, each creature in its area makes a Strength saving throw, taking 6d10 Bludgeoning damage on a failed save or half as much damage on a successful one." + "\n   " + "At the start of each of your turns after the wall appears, the wall, along with any creatures in it, moves 50 feet away from you. Any Huge or smaller creature inside the wall or whose space the wall enters when it moves must succeed on a Strength saving throw or take 5d10 Bludgeoning damage. A creature can take this damage only once per round. At the end of the turn, the wall's height is reduced by 50 feet, and the damage the wall deals on later rounds is reduced by 1d10. When the wall reaches 0 feet in height, the spell ends." + "\n   " + "A creature caught in the wall can move by swimming. Because of the wave's force, though, the creature must succeed on a Strength (Athletics) check against your spell save DC to move at all. If it fails the check, it can't move. A creature that moves out of the wall falls to the ground."
});
legacySpellRefactor("unseen servant", {
    name: "Unseen Servant",
    classes: ["bard", "warlock", "wizard"],
    source: [
        ["P24", 336]
    ],
    ritual: true,
    level: 1,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A piece of string and a bit of wood",
    duration: "1 h",
    description: "Make Invisible, mindless, shapeless, Med. servant for simple tasks; AC 10, 1 HP; bns mentally command ",
    descriptionFull: "This spell creates an Invisible, mindless, shapeless, Medium force that performs simple tasks at your command until the spell ends. The servant springs into existence in an unoccupied space on the ground within range. It has AC 10, 1 Hit Point, and a Strength of 2, and it can't attack. If it drops to 0 Hit Points, the spell ends." + "\n   " + "Once on each of your turns as a Bonus Action, you can mentally command the servant to move up to 15 feet and interact with an object. The servant can perform simple tasks that a human could do, such as fetching things, cleaning, mending, folding clothes, lighting fires, serving food, and pouring drinks. Once you give the command, the servant performs the task to the best of its ability until it completes the task, then waits for your next command." + "\n   " + "If you command the servant to perform a task that would move it more than 60 feet away from you, the spell ends."
});
legacySpellRefactor("vampiric touch", {
    name: "Vampiric Touch",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 337]
    ],
    level: 3,
    school: "Necro",
    time: "1 a",
    range: "Self",
    components: "V,S",
    duration: "Conc, 1 min",
    description: "Melee spell attack for 3d6+1d6/SL Necrotic dmg; I heal half the damage dealt; repeat as a",
    descriptionFull: "The touch of your shadow-wreathed hand can siphon life force from others to heal your wounds. Make a melee spell attack against one creature within reach. On a hit, the target takes 3d6 Necrotic damage, and you regain Hit Points equal to half the amount of Necrotic damage dealt." + "\n   " + "Until the spell ends, you can make the attack again on each of your turns as a Magic action, targeting the same creature or a different one." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot level above 3rd."
});
legacySpellRefactor("vicious mockery", {
    name: "Vicious Mockery",
    classes: ["bard"],
    source: [
        ["P24", 337]
    ],
    level: 0,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V",
    duration: "Instantaneous",
    save: "Wis",
    description: "1 visible/audible crea save or 1d6 Psychic dmg and disadv. on next attack roll; +1d6 at CL 5, 11, and 17",
    descriptionCantripDie: "1 visible/audible creature save or `CD`d6 Psychic dmg and disadv. on next attack roll",
    descriptionFull: "You unleash a string of insults laced with subtle enchantments at one creature you can see or hear within range. The target must succeed on a Wisdom saving throw or take 1d6 Psychic damage and have Disadvantage on the next attack roll it makes before the end of its next turn." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d6 when you reach levels 5 (2d6), 11 (3d6), and 17 (4d6)."
});
legacySpellRefactor("vitriolic sphere", {
    name: "Vitriolic Sphere",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 337]
    ],
    level: 4,
    school: "Evoc",
    time: "1 a",
    range: "150 ft",
    components: "V,S,M",
    compMaterial: "A drop of bile",
    duration: "Instantaneous",
    save: "Dex",
    description: "20-ft rad all crea 10d4+2d4/SL Acid dmg, 5d4 Acid next turn end; save half \u0026 no dmg next turn",
    descriptionShorter: "20-ft rad all crea 10d4+2d4/SL Acid dmg, +5d4 dmg next turn; save half \u0026 no next turn",
    descriptionFull: "You point at a location within range, and a glowing, 1-foot-diameter ball of acid streaks there and explodes in a 20-foot-radius Sphere. Each creature in that area makes a Dexterity saving throw. On a failed save, a creature takes 10d4 Acid damage and another 5d4 Acid damage at the end of its next turn. On a successful save, a creature takes half the initial damage only." + AtHigherLevels + "The initial damage increases by 2d4 for each spell slot level above 4.",
    dynamicDamageBonus: {
        multipleDmgMoments: false,
        extraDmgGroupsSameType: /((?:\+?\d+d?\d*)+)( dmg next turn)/i
    }
});
legacySpellRefactor("wall of fire", {
    name: "Wall of Fire",
    classes: ["druid", "sorcerer", "wizard"],
    source: [
        ["P24", 338]
    ],
    level: 4,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A piece of charcoal",
    duration: "Conc, 1 min",
    save: "Dex",
    description: "60|1|20ft (l|w|h) or 10-ft rad wall; all in 5d8+1d8/SL Fire; save 1/2; enter/end in 10ft hot side same dmg",
    descriptionMetric: "18|0,3|6m (l|w|h) or 3-m rad wall; all in 5d8+1d8/SL Fire; save 1/2; enter/end in 10ft hot side same dmg",
    descriptionShorter: "60|1|20ft (l|w|h) or 10-ft rad all + 10 ft on 1 side 5d8+1d8/SL Fire; save half on cast; see B",
    descriptionShorterMetric: "18|0,3|6m (l|w|h) or 3-m rad all + 3 m on 1 side 5d8+1d8/SL Fire; save half on cast; see B",
    descriptionFull: "You create a wall of fire on a solid surface within range. You can make the wall up to 60 feet long, 20 feet high, and 1 foot thick, or a ringed wall up to 20 feet in diameter, 20 feet high, and 1 foot thick. The wall is opaque and lasts for the duration." + "\n   " + "When the wall appears, each creature in its area makes a Dexterity saving throw, taking 5d8 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "One side of the wall, selected by you when you cast this spell, deals 5d8 Fire damage to each creature that ends its turn within 10 feet of that side or inside the wall. A creature takes the same damage when it enters the wall for the first time on a turn or ends its turn there. The other side of the wall deals no damage." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 4."
});
legacySpellRefactor("wall of force", {
    name: "Wall of Force",
    classes: ["wizard"],
    source: [
        ["P24", 338]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A shard of glass",
    duration: "Conc, 10 min",
    description: "10 10\xD710-ft panels or 10-ft rad (hemi)sphere invisible, impenetrable wall; can float in air; see book",
    descriptionFull: "An Invisible wall of force springs into existence at a point you choose within range. The wall appears in any orientation you choose, as a horizontal or vertical barrier or at an angle. It can be free floating or resting on a solid surface. You can form it into a hemispherical dome or a globe with a radius of up to 10 feet, or you can shape a flat surface made up of ten 10-foot-by-10-foot panels. Each panel must be contiguous with another panel. In any form, the wall is 1/4 inch thick and lasts for the duration. If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (you choose which side)." + "\n   " + "Nothing can physically pass through the wall. It is immune to all damage and can't be dispelled by Dispel Magic. A Disintegrate spell destroys the wall instantly, however. The wall also extends into the Ethereal Plane and blocks ethereal travel through the wall."
});
legacySpellRefactor("wall of ice", {
    name: "Wall of Ice",
    classes: ["wizard"],
    source: [
        ["P24", 339]
    ],
    level: 6,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A piece of quartz",
    duration: "Conc, 10 min",
    save: "Dex",
    description: "10 10\xD710ft panels 1ft thick wall; now 10d6+2/SL Cold; if cut 5d6+1d6/SL Cold in space; save 1/2; see B",
    descriptionFull: "You create a wall of ice on a solid surface within range. You can form it into a hemispherical dome or a globe with a radius of up to 10 feet, or you can shape a flat surface made up of ten 10-foot-square panels. Each panel must be contiguous with another panel. In any form, the wall is 1 foot thick and lasts for the duration." + "\n   " + "If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (you choose which side) and makes a Dexterity saving throw, taking 10d6 Cold damage on a failed save or half as much damage on a successful one." + "\n   " + "The wall is an object that can be damaged and thus breached. It has AC 12 and 30 Hit Points per 10-foot section, and it has Immunity to Cold, Poison, and Psychic damage and Vulnerability to Fire damage. Reducing a 10-foot section of wall to 0 Hit Points destroys it and leaves behind a sheet of frigid air in the space the wall occupied." + "\n   " + "A creature moving through the sheet of frigid air for the first time on a turn makes a Constitution saving throw, taking 5d6 Cold damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage the wall deals when it appears increases by 2d6 and the damage from passing through the sheet of frigid air increases by 1d6 for each spell slot level above 6.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("wall of stone", {
    name: "Wall of Stone",
    classes: ["artificer", "druid", "sorcerer", "wizard"],
    source: [
        ["P24", 339]
    ],
    level: 5,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A cube of granite",
    duration: "Conc, 10 min",
    description: "10 10\xD710-ft panels 6\" thick wall connected with existing stone; half thickness, double surface; see B",
    descriptionMetric: "10 10\xD73m panels 15cm thick wall connected with existing stone; half thickness, double surface; see B",
    descriptionFull: "A nonmagical wall of solid stone springs into existence at a point you choose within range. The wall is 6 inches thick and is composed of ten 10-foot-by-10-foot panels. Each panel must be contiguous with another panel. Alternatively, you can create 10-foot-by-20-foot panels that are only 3 inches thick." + "\n   " + "If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (you choose which side). If a creature would be surrounded on all sides by the wall (or the wall and another solid surface), that creature can make a Dexterity saving throw. On a success, it can use its Reaction to move up to its Speed so that it is no longer enclosed by the wall." + "\n   " + "The wall can have any shape you desire, though it can't occupy the same space as a creature or object. The wall doesn't need to be vertical or rest on a firm foundation. It must, however, merge with and be solidly supported by existing stone. Thus, you can use this spell to bridge a chasm or create a ramp." + "\n   " + "If you create a span greater than 20 feet in length, you must halve the size of each panel to create supports. You can crudely shape the wall to create battlements and the like." + "\n   " + "The wall is an object made of stone that can be damaged and thus breached. Each panel has AC 15 and 30 Hit Points per inch of thickness, and it has Immunity to Poison and Psychic damage. Reducing a panel to 0 Hit Points destroys it and might cause connected panels to collapse at the DM's discretion." + "\n   " + "If you maintain your Concentration on this spell for its full duration, the wall becomes permanent and can't be dispelled. Otherwise, the wall disappears when the spell ends."
});
legacySpellRefactor("wall of thorns", {
    name: "Wall of Thorns",
    classes: ["druid"],
    source: [
        ["P24", 339]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A handful of thorns",
    duration: "Conc, 10 min",
    save: "Dex",
    description: "60|5|20ft (l|w|h) or 10-ft rad; all in wall now/enter/end 7d8+1d8/SL Piercing (1/t/c); save 1/2; 1/4 move",
    descriptionMetric: "18\xD71,5\xD76m (l\xD7w\xD7h) or 3-m rad all in wall now/enter/end 7d8+1d8/SL Piercing (1/t/c); save 1/2; 1/4 move",
    descriptionShorter: "60|5|20ft (l|w|h) or 10-ft rad; all in now/enter/end 7d8+1d8/SL Pierc. (1/t/c); save 1/2; 1/4 move",
    descriptionFull: "You create a wall of tangled brush bristling with needle-sharp thorns. The wall appears within range on a solid surface and lasts for the duration. You choose to make the wall up to 60 feet long, 10 feet high, and 5 feet thick or a circle that has a 20-foot diameter and is up to 20 feet high and 5 feet thick. The wall blocks line of sight." + "\n   " + "When the wall appears, each creature in its area makes a Dexterity saving throw, taking 7d8 Piercing damage on a failed save or half as much damage on a successful one." + "\n   " + "A creature can move through the wall, albeit slowly and painfully. For every 1 foot a creature moves through the wall, it must spend 4 feet of movement. Furthermore, the first time a creature enters a space in the wall on a turn or ends its turn there, the creature makes a Dexterity saving throw, taking 7d8 Slashing damage on a failed save or half as much damage on a successful one. A creature makes this save only once per turn." + AtHigherLevels + "Both types of damage increase by 1d8 for each spell slot level above 6."
});
legacySpellRefactor("warding bond", {
    name: "Warding Bond",
    classes: ["cleric", "paladin"],
    source: [
        ["P24", 340]
    ],
    level: 2,
    school: "Abjur",
    time: "1 a",
    range: "Touch",
    components: "V,S,M\u0192",
    compMaterial: "A pair of platinum rings worth 50+ gp each, which you and the target must wear for the duration",
    duration: "1 h",
    description: "1 crea +1 AC, +1 saves, resist all dmg; if takes dmg I take same; ends if >60 ft away/recast (100gp)",
    descriptionFull: "You touch another creature that is willing and create a mystic connection between you and the target until the spell ends. While the target is within 60 feet of you, it gains a +1 bonus to AC and saving throws, and it has Resistance to all damage. Also, each time it takes damage, you take the same amount of damage." + "\n   " + "The spell ends if you drop to 0 Hit Points or if you and the target become separated by more than 60 feet. It also ends if the spell is cast again on either of the connected creatures."
});
legacySpellRefactor("water breathing", {
    name: "Water Breathing",
    classes: ["artificer", "druid", "ranger", "sorcerer", "wizard"],
    source: [
        ["P24", 340]
    ],
    ritual: true,
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A short reed",
    duration: "24 h",
    description: "10 willing creatures can breathe underwater for the duration",
    descriptionFull: "This spell grants up to ten willing creatures of your choice within range the ability to breathe underwater until the spell ends. Affected creatures also retain their normal mode of respiration."
});
legacySpellRefactor("water walk", {
    name: "Water Walk",
    classes: ["artificer", "cleric", "druid", "ranger", "sorcerer"],
    source: [
        ["P24", 340]
    ],
    ritual: true,
    level: 3,
    school: "Trans",
    time: "1 a",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "A piece of cork",
    duration: "1 h",
    description: "10 crea can move across any liquid for duration; bns move between liquid/surface; if fall enter liquid",
    descriptionFull: "This spell grants the ability to move across any liquid surface‚Äîsuch as water, acid, mud, snow, quicksand, or lava‚Äîas if it were harmless solid ground (creatures crossing molten lava can still take damage from the heat). Up to ten willing creatures of your choice within range gain this ability for the duration." + "\n   " + "An affected target must take a Bonus Action to pass from the liquid's surface into the liquid itself and vice versa, but if the target falls into the liquid, the target passes through the surface into the liquid below."
});
legacySpellRefactor("web", {
    name: "Web",
    classes: ["artificer", "sorcerer", "wizard"],
    source: [
        ["P24", 340]
    ],
    level: 2,
    school: "Conj",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A bit of spiderweb",
    duration: "Conc, 1 h",
    save: "Dex",
    description: "20ft cu flammable web; enter/start save or Restr.; dif. ter.; lightly obsc.; Str(Ath.) chk vs DC to free",
    descriptionFull: "You conjure a mass of sticky webbing at a point within range. The webs fill a 20-foot Cube there for the duration. The webs are Difficult Terrain, and the area within them is Lightly Obscured." + "\n   " + "If the webs aren't anchored between two solid masses (such as walls or trees) or layered across a floor, wall, or ceiling, the web collapses on itself, and the spell ends at the start of your next turn. Webs layered over a flat surface have a depth of 5 feet." + "\n   " + "The first time a creature enters the webs on a turn or starts its turn there, it must succeed on a Dexterity saving throw or have the Restrained condition while in the webs or until it breaks free." + "\n   " + "A creature Restrained by the webs can take an action to make a Strength (Athletics) check against your spell save DC. If it succeeds, it is no longer Restrained." + "\n   " + "The webs are flammable. Any 5-foot Cube of webs exposed to fire burns away in 1 round, dealing 2d4 Fire damage to any creature that starts its turn in the fire."
});
legacySpellRefactor("weird", {
    name: "Weird",
    classes: ["warlock", "wizard"],
    source: [
        ["P24", 341]
    ],
    level: 9,
    school: "Illus",
    time: "1 a",
    range: "120 ft",
    components: "V,S",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "30-ft rad all crea 10d10 Psychic \u0026 Frightened; save half no fear; if fail, EoT save or 5d10 Psychic til pass",
    descriptionShorter: "30-ft rad all 10d10 Psychic \u0026 Frightened; save 1/2 no fear; if fail, EoT save or 5d10 Psychic",
    descriptionFull: "You try to create illusory terrors in others' minds. Each creature of your choice in a 30-foot-radius Sphere centered on a point within range makes a Wisdom saving throw. On a failed save, a target takes 10d10 Psychic damage and has the Frightened condition for the duration. On a successful save, a target takes half as much damage only." + "\n   " + "A Frightened target makes a Wisdom saving throw at the end of each of its turns. On a failed save, it takes 5d10 Psychic damage. On a successful save, the spell ends on that target."
});
legacySpellRefactor("wind walk", {
    name: "Wind Walk",
    classes: ["druid"],
    source: [
        ["P24", 341]
    ],
    level: 6,
    school: "Trans",
    time: "1 min",
    range: "30 ft",
    components: "V,S,M",
    compMaterial: "a candle",
    duration: "8 h",
    description: "Me + 10 willing creatures assume gaseous form with 300 ft fly, hover, resist. physical dmg; see book",
    descriptionFull: "You and up to ten willing creatures of your choice within range assume gaseous forms for the duration, appearing as wisps of cloud. While in this cloud form, a target has a Fly Speed of 300 feet and can hover; it has Immunity to the Prone condition; and it has Resistance to Bludgeoning, Piercing, and Slashing damage. The only actions a target can take in this form are the Dash action or a Magic action to begin reverting to its normal form. Reverting takes 1 minute, during which the target has the Stunned condition. Until the spell ends, the target can revert to cloud form, which also requires a Magic action followed by a 1-minute transformation." + "\n   " + "If a target is in cloud form and flying when the effect ends, the target descends 60 feet per round for 1 minute until it lands, which it does safely. If it can't land after 1 minute, it falls the remaining distance."
});
legacySpellRefactor("wind wall", {
    name: "Wind Wall",
    classes: ["druid", "ranger"],
    source: [
        ["P24", 341]
    ],
    level: 3,
    school: "Evoc",
    time: "1 a",
    range: "120 ft",
    components: "V,S,M",
    compMaterial: "A fan and a feather",
    duration: "Conc, 1 min",
    save: "Str",
    description: "50\xD71\xD715ft (l\xD7w\xD7h) wall, any line-shape, at cast all in wall 3d8 Bludg.; save 1/2; blocks small projectiles",
    descriptionMetric: "15\xD70,3\xD74,5m (l\xD7w\xD7h) wall, any line-shape, at cast all in 3d8 Bludg.; save halves; blocks small projectiles",
    descriptionShorterMetric: "15|0,3|4,5m (l|w|h) wall, any line-shape, at cast all in 3d8 Bludg.; save halves; blocks projectiles",
    descriptionFull: "A wall of strong wind rises from the ground at a point you choose within range. You can make the wall up to 50 feet long, 15 feet high, and 1 foot thick. You can shape the wall in any way you choose so long as it makes one continuous path along the ground. The wall lasts for the duration." + "\n   " + "When the wall appears, each creature in its area makes a Strength saving throw, taking 4d8 Bludgeoning damage on a failed save or half as much damage on a successful one." + "\n   " + "The strong wind keeps fog, smoke, and other gases at bay. Small or smaller flying creatures or objects can't pass through the wall. Loose, lightweight materials brought into the wall fly upward. Arrows, bolts, and other ordinary projectiles launched at targets behind the wall are deflected upward and miss automatically. Boulders hurled by Giants or siege engines, and similar projectiles, are unaffected. Creatures in gaseous form can't pass through it.",
    dynamicDamageBonus: {
        multipleDmgMoments: false
    }
});
legacySpellRefactor("wish", {
    name: "Wish",
    classes: ["sorcerer", "wizard"],
    source: [
        ["P24", 341]
    ],
    level: 9,
    school: "Conj",
    time: "1 a",
    range: "Self",
    components: "V",
    duration: "Instantaneous",
    description: "Duplicate any 8th lvl or lower spell as 1 a, create objects, heal, grant resist., alter time, etc.; see book",
    descriptionFull: "Wish is the mightiest spell a mortal can cast. By simply speaking aloud, you can alter reality itself." + "\n   " + "The basic use of this spell is to duplicate any other spell of level 8 or lower. If you use it this way, you don't need to meet any requirements to cast that spell, including costly components. The spell simply takes effect." + "\n   " + "Alternatively, you can create one of the following effects of your choice:" + "\n " + "\u2022 " + toUni("Object creation") + ". You create one object of up to 25,000 GP in value that isn't a magic item. The object can be no more than 300 feet in any dimension, and it appears in an unoccupied space that you can see on the ground." + "\n " + "\u2022 " + toUni("Instant Health") + ". You allow yourself and up to twenty creatures that you can see to regain all Hit Points, and you end all effects on them listed in the Greater Restoration spell." + "\n " + "\u2022 " + toUni("Resistance") + ". You grant up to ten creatures that you see Resistance to one damage type that you choose. This Resistance is permanent." + "\n " + "\u2022 " + toUni("Spell Immunity") + ". You grant up to ten creatures you can see immunity to a single spell or other magical effect for 8 hours." + "\n " + "\u2022 " + toUni("Sudden Learning") + ". You replace one of your feats with another feat for which you are eligible. You lose all the benefits of the old feat and gain the benefits of the new one. You can't replace a feat that is a prerequisite for any of your other feats or features." + "\n " + "\u2022 " + toUni("Roll Redo") + ". You undo a single recent event by forcing a reroll of any die roll made within the last round (including your last turn). Reality reshapes itself to accommodate the new result. For example, a Wish spell could undo an ally's failed saving throw or a foe's Critical Hit. You can force the reroll to be made with Advantage or Disadvantage, and you choose whether to use the reroll or the original roll." + "\n " + "\u2022 " + toUni("Reshape Reality") + ". You may wish for something not included in any of the other effects. To do so, state your wish to the DM as precisely as possible. The DM has great latitude in ruling what occurs in such an instance; the greater the wish, the greater the likelihood that something goes wrong. This spell might simply fail, the effect you desire might be achieved only in part, or you might suffer an unforeseen consequence as a result of how you worded the wish. For example, wishing that a villain were dead might propel you forward in time to a period when that villain is no longer alive, effectively removing you from the game. Similarly, wishing for a Legendary magic item or an Artifact might instantly transport you to the presence of the item's current owner. If your wish is granted and its effects have consequences for a whole community, region, or world, you are likely to attract powerful foes. If your wish would affect a god, the god's divine servants might instantly intervene to prevent it or to encourage you to craft the wish in a particular way. If your wish would undo the multiverse itself, threaten the City of Sigil, or affect the Lady of Pain in any way, you see an image of her in your mind for a moment; she shakes her head, and your wish fails." + "The stress of casting Wish to produce any effect other than duplicating another spell weakens you. After enduring that stress, each time you cast a spell until you finish a Long Rest, you take 1d10 Necrotic damage per level of that spell. This damage can't be reduced or prevented in any way. In addition, your Strength score becomes 3 for 2d4 days. For each of those days that you spend resting and doing nothing more than light activity, your remaining recovery time decreases by 2 days. Finally there is a 33 percent chance that you are unable to cast Wish ever again if you suffer this stress."
});
legacySpellRefactor("witch bolt", {
    name: "Witch Bolt",
    classes: ["sorcerer", "warlock", "wizard"],
    source: [
        ["P24", 343]
    ],
    level: 1,
    school: "Evoc",
    time: "1 a",
    range: "60 ft",
    components: "V,S,M",
    compMaterial: "A twig struck by lightning",
    duration: "Conc, 1 min",
    description: "Rngd spell atk 2d12+1d12/SL Lightn.; miss/hit bns 1d12 Lightn. per rnd; ends if out of range/total cover",
    descriptionShorter: "Rngd atk 2d12+1d12/SL Lightn.; 1 bns 1d12 Lightn.; end: out of range/total cover",
    descriptionFull: "A beam of crackling energy lances toward a creature within range, forming a sustained arc of lightning between you and the target. Make a ranged spell attack against it. On a hit, the target takes 2d12 Lightning damage." + "\n   " + "On each of your subsequent turns, you can take a Bonus Action to deal 1d12 Lightning damage to the target automatically, even if the first attack missed." + "\n   " + "The spell ends if the target is ever outside the spell's range or if it has Total Cover from you." + AtHigherLevels + "The initial damage increases by 1d12 for each spell slot level above 1.",
    dynamicDamageBonus: {
        multipleDmgMoments: false,
        extraDmgGroupsSameType: /(1 a )(.*?)( Lightn. dmg)/i
    }
});
legacySpellRefactor("word of radiance", {
    name: "Word of Radiance",
    nameShort: "Word of Radiance*",
    classes: ["cleric"],
    source: [
        ["P24", 343]
    ],
    level: 0,
    school: "Evoc",
    time: "1 a",
    range: "S:5-ft rad",
    components: "V,M",
    compMaterial: "A sunburst token",
    duration: "Instantaneous",
    save: "Con",
    description: "Any creature save or 1d6 Radiant damage; +1d6 at CL 5, 11, and 17",
    descriptionCantripDie: "Any creature save or `CD`d6 Radiant damage",
    descriptionFull: "Burning radiance erupts from you in a 5-foot Emanation. Each creature of your choice that you can see in it must succeed on a Constitution saving throw or take 1d6 Radiant damage." + "\n   " + toUni("Cantrip Upgrade") + ". The damage increases by 1d6 when you reach levels 5 (2d6), 11 (3d6), and 17 (4d6)."
});
legacySpellRefactor("word of recall", {
    name: "Word of Recall",
    classes: ["cleric"],
    source: [
        ["P24", 343]
    ],
    level: 6,
    school: "Conj",
    time: "1 a",
    range: "5 ft",
    components: "V",
    duration: "Instantaneous",
    description: "Me \u0026 5 willing creatures in 5ft teleport to prepared sanctuary, designated by casting this spell there ",
    descriptionFull: "You and up to five willing creatures within 5 feet of you instantly teleport to a previously designated sanctuary. You and any creatures that teleport with you appear in the nearest unoccupied space to the spot you designated when you prepared your sanctuary (see below). If you cast this spell without first preparing a sanctuary, the spell has no effect." + "\n   " + "You must designate a location, such as a temple, as a sanctuary by casting this spell there."
});
legacySpellRefactor("wrathful smite", {
    name: "Wrathful Smite",
    classes: ["paladin"],
    source: [
        ["P24", 343]
    ],
    level: 1,
    school: "Necro",
    time: "1 bns*",
    timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or Unarmed strike",
    range: "Self",
    components: "V",
    duration: "1 min",
    save: "Wis",
    description: "Melee weapon/unarmed hit +1d6 Necrotic dmg and save or Frightened; EoT save to end",
    descriptionFull: "The target takes an extra 1d6 Necrotic damage from the attack, and it must succeed on a Wisdom saving throw or have the Frightened condition until the spell ends. At the end of each of its turns, the Frightened target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("yolande's regal presence", {
    name: "Yolande's Regal Presence",
    nameShort: "Yolande's Regal Presence*",
    classes: ["bard", "wizard"],
    source: [
        ["P24", 343]
    ],
    level: 5,
    school: "Ench",
    time: "1 a",
    range: "S:10-ft rad",
    components: "V,S,M",
    duration: "Conc, 1 min",
    save: "Wis",
    description: "Any crea covers/enter/end (1/turn/crea) 4d6 Psychic \u0026 Prone, can push to 10ft; save 1/2 dmg only",
    descriptionFull: "You surround yourself with unearthly majesty in a 10-foot Emanation. Whenever the Emanation enters the space of a creature you can see and whenever a creature you can see enters the Emanation or ends its turn there, you can force that creature to make a Wisdom saving throw. On a failed save, the target takes 4d6 Psychic damage and has the Prone condition, and you can push it up to 10 feet away. On a successful save, the target takes half as much damage only. A creature makes this save only once per turn."
});
legacySpellRefactor("zone of truth", {
    name: "Zone of Truth",
    classes: ["bard", "cleric", "paladin"],
    source: [
        ["P24", 343]
    ],
    level: 2,
    school: "Ench",
    time: "1 a",
    range: "60 ft",
    components: "V,S",
    duration: "10 min",
    save: "Cha",
    description: "15-ft rad all crea enter/start in area save or can't lie; I'm aware if saved; crea knows it can't lie",
    descriptionFull: "You create a magical zone that guards against deception in a 15-foot-radius Sphere centered on a point within range. Until the spell ends, a creature that enters the spell's area for the first time on a turn or starts its turn there makes a Charisma saving throw. On a failed save, a creature can't speak a deliberate lie while in the radius. You know whether a creature succeeds or fails on this save." + "\n   " + "An affected creature is aware of the spell and can avoid answering questions to which it would normally respond with a lie. Such a creature can be evasive yet must be truthful."
});
//Creatures
CompanionList["familiar"] = {
    name: "Find Familiar",
    nameTooltip: "the Find Familiar spell",
    nameOrigin: "1st-level conjuration [ritual] spell",
    nameMenu: "Familiar (Find Familiar spell)",
    source: [
        ["P24", 272]
    ],
    includeCheck: function(sCrea, objCrea, iCreaCR) {
        return objCrea.type.toLowerCase() === "beast" && objCrea.isSummon !== true && iCreaCR == 0 ? true : false;
    },
    action: [
        ["action", "Familiar (dismiss/reappear)"],
        ["bonus action", "Use familiar's senses"]
    ],
    notes: [{
        name: "Summon a spirit that serves as a familiar",
        description: [
            "appearing in an unoccupied space within 10 ft",
            "It assumes a chosen form (can change at every casting): Bat, Cat, Frog, Hawk, Lizard, Octopus, Owl, Rat, Raven, Spider, Weasel, or another Beast that has a Challenge Rating of 0.",
            "It has the chosen form's statistics, but its type changes from beast to celestial, fey, or fiend",
            "When the familiar drops to 0 hit points, it disappears, leaving behind no physical form",
            "It reappears when I cast this spell again (in a new form if so desired)"
        ].join("\n   "),
        joinString: ", "
    }, {
        name: "The familiar acts independently of me",
        description: [
            "but it always obeys my commands",
            "In combat, it rolls its own initiative and acts on its own turn, but it can't attack"
        ].join("\n   "),
        joinString: ", "
    }, {
        name: "While it is within 100 ft of me",
        description: "I can communicate with it telepathically",
        joinString: ", "
    }, {
        name: "As a bonus action, I see/hear what it does",
        description: " (but not with my senses) until the start of my next turn",
        joinString: ""
    }, {
        name: "As a magic action, I can temporarily dismiss it",
        description: "having it disappear into a pocket dimension",
        joinString: ", "
    }, {
        name: "As a magic action, while it is temporarily dismissed",
        description: "I can cause it to reappear within 30 ft",
        joinString: ", "
    }, {
        name: "I can't have more than one familiar bonded at a time",
        description: "As a magic action, I can dismiss it forever",
        joinString: "; "
    }, {
        name: "When I cast a spell with a range of touch",
        description: [
            "my familiar can deliver the spell",
            "It must be within 100 ft of me and it must use its reaction to deliver the spell when I cast it",
            "It acts as if it cast the spell, but it can use my modifiers for any attack rolls the spell requires"
        ].join("\n   "),
        joinString: ", "
    }],
    attributesAdd: {
        header: "Familiar",
        features: [{
            name: "Find Familiar",
            description: "If dropped to 0 HP, the familiar disappears, leaving behind no physical form. The familiar must obey all commands of its master."
        }]
    },
};
CompanionList["pact_of_the_chain"] = {
    name: "Pact of the Chain",
    nameTooltip: "Warlock (Pact of the Chain)",
    nameOrigin: "variant of the Find Familiar 1st-level conjuration [ritual] spell",
    nameMenu: "Pact of the Chain familiar (Warlock feature)",
    source: [
        ["P24", 157]
    ],
    includeCheck: function(sCrea, objCrea, iCreaCR, bIsAL) {
        // return true if to be included, or a string to add a note to the menu option
        return !objCrea.companion ? false : objCrea.companion.indexOf("familiar") !== -1 ? true : bIsAL && objCrea.companion.indexOf("familiar_not_al") !== -1 ? " (if DM approves)" : false;
    },
    action: [
        ["action", "Familiar (dismiss/reappear)"],
        ["bonus action", "Use familiar's senses"]
    ],
    attributesAdd: {
        header: "Familiar",
        features: [{
            name: "Pact of the Chain",
            description: "If dropped to 0 HP, the familiar disappears, leaving behind no physical form. The familiar must obey all commands of its master."
        }]
    },
    attributesChange: function(sCrea, objCrea) {
        if (objCrea.type.toLowerCase() === "beast") {
            objCrea.type = ["Celestial", "Fey", "Fiend"];
            objCrea.subtype = "";
        }
    }
};
CompanionList["mount"] = {
    name: "Find Steed",
    nameTooltip: "the Find Steed spell",
    nameOrigin: "2nd-level conjuration spell",
    nameMenu: "Steed (Find Steed spell)",
    source: [
        ["P24", 272]
    ],
    action: [
        ["action", "Find Steed (dismiss)"]
    ],
    notes: [{
        name: "Summon an otherworldly being that appears as a loyal steed",
        description: [
            "appearing in an unoccupied space within 30 ft",
            "The steed resembles a Large, ridable animal of my choice, such as a horse, a camel, a dire wolf, or an elk",
            "The steed has the statistics of the otherworldly steed, choose its type celestial, fey, or fiend",
            "When the steed drops to 0 hit points, it disappears, leaving behind no physical form"
        ].join("\n   "),
        joinString: ", "
    }, {
        name: "The steed serves me as a mount",
        description: "I have a bond with it that allows us to fight as a seamless unit",
        joinString: ". "
    }, {
        name: "While my steed is within 1 mile of me",
        description: "I can communicate with it telepathically",
        joinString: ", "
    }, {
        name: "Casting this spell again",
        description: "can summon the same steed, or a different one",
        joinString: " "
    }, {
        name: "I can't have more than one steed bonded at a time",
        description: "As an action, I can release it from its bond",
        joinString: "; "
    }],
    attributesAdd: {
        header: "Mount",
        features: [{
            name: "Find Steed",
            description: "If dropped to 0 HP, the steed disappears, leaving behind no physical form."
        }],
    },
};
CompanionList["companion"] = {
    name: "Ranger's Companion",
    nameTooltip: "Beast Master: Ranger's Companion",
    nameOrigin: "Beast Master 3",
    nameMenu: "Ranger's Companion (Beast Master feature)",
    source: [
        ["P24", 122]
    ],
    action: [
        ["bonus action", "Ranger's Companion (command)"]
    ],
    notes: [{
        name: "If the beast has died within the **last**hour,",
        description: [
            "I can take a Magic action to touch it and expend a spell slot.",
            "The beast returns to life after 1 minute with all its Hit Points restored."
        ].join("\n   "),
        joinString: ", "
    }, {
        name: "The beast adds my Proficiency Bonus",
        description: "any ability check or saving throw the beast makes",
        joinString: " "
    }, {
        name: "The beast's hit point maximum equals",
        description: "five times my ranger level",
        joinString: " "
    }, {
        name: "In Combat",
        description: [
            "The beast acts during my turn. It can move and use its Reaction on its own.",
            "As a Bonus Action, I can command the beast to use an action in its statblock or another standard action ",
            "I can sacrifice one of my attacks when I take the Attack action to command the beast to take the Beast's Strike action.",
            "If I don't command it to take another action, it takes the Dodge action instead.",
            "If I'm Incapacitated, the beast acts on its own without limits.",
        ].join("\n   "),
        joinString: typePF ? ": " : ":\n   "
    }, {
        name: "Exceptional Training (Beast Master 7, P24 123)",
        description: [
            "The beast's attacks can deal Force damage or its normal damage type",
            "When I command my beast to take an action, I can also have it Dash/Disengage/Dodge/Help as a bonus action.",
        ].join("\n   "),
        joinString: "\n   ",
        minlevel: 7,
        eval: function(prefix, lvl) {
            for (var i = 1; i <= 3; i++) {
                if (!What(prefix + "Comp.Use.Attack." + i + ".Weapon Selection")) continue;
                var sDescrFld = prefix + "Comp.Use.Attack." + i + ".Description";
                if (!/(,|;)? ?can deal force damage or its normal damage type/i.test(What(sDescrFld))) {
                    AddString(sDescrFld, "Can deal Force damage or its normal damage type", "; ");
                }
            }
        },
        removeeval: function(prefix, lvl) {
            for (var i = 1; i <= 3; i++) {
                var sDescrFld = prefix + "Comp.Use.Attack." + i + ".Description";
                var sDescr = What(sDescrFld);
                var rCaM = /(,|;)? ?counts as magical/i;
                if (rCaM.test(sDescr)) Value(sDescrFld, sDescr.replace(rCaM, ''));
            }
        }
    }, {
        name: "Bestial Fury (Beast Master 11, P24 123)",
        description: "The beast can make two attacks (or multiattack) when I command it to take an Attack action, In addition, the first time each turn it hits a creature affected by my Hunter's Mark spell, it deals extra Force damage equal to the bonus damage of that spell.",
        joinString: "\n   ",
        minlevel: 11,
        eval: function(prefix, lvl) {
            Value(prefix + "Comp.Use.Attack.perAction", 2);
        },
        removeeval: function(prefix, lvl) {
            Value(prefix + "Comp.Use.Attack.perAction", 1);
        }
    }, {
        name: "Share Spells (Beast Master 15, P24 123)",
        description: "When I cast a spell on myself, I can have it also affect my primal companion if it is within 30 ft of me",
        joinString: "\n   ",
        minlevel: 15
    }],
    attributesAdd: {
        header: "Companion",
        minlevelLinked: ["ranger"],
        attacksAction: 1
    },
    attributesChange: function(sCrea, objCrea) {
        // Change multiattack trait/feature/action to level 11 feature
        ["traits", "features", "actions"].forEach(function(n) {
            if (!objCrea[n]) return;
            for (var i = 0; i < objCrea[n].length; i++) {
                var oN = objCrea[n][i];
                if (oN.name && /multiattack/i.test(oN.name)) {
                    objCrea[n][i].minlevel = 11;
                }
            }
        });
    },
};
CreatureList["ape"] = {
    name: "Ape",
    regExpSearch: /ape/i,
    source: [
        ["P24", 346]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 19,
    hd: [3, 8],
    speed: "30 ft, Climb 30 ft",
    scores: [16, 14, 14, 6, 12, 7],
    skills: {
        "athletics": 5,
        "perception": 3,
    },
    senses: "",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 2,
    actions: [{
        name: "Multiattack",
        description: "The ape makes two Fist attacks.",
    }],
    attacks: [{
        name: "Fist",
        ability: 1,
        damage: [1, 4, "Bludgeoning"],
        description: "Two fist attacks as an Attack action",
        range: "Melee (5 ft)",
    }, {
        name: "Rock (Recharge 6)",
        ability: 1,
        damage: [2, 6, "Bludgeoning"],
        range: "25/50 ft",
    }],
};
CreatureList["badger"] = {
    name: "Badger",
    regExpSearch: /badger/i,
    source: [
        ["P24", 346]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 5,
    hd: [1, 4],
    speed: "20 ft, Burrow 5 ft",
    scores: [10, 11, 16, 2, 12, 5],
    skills: {
        "perception": 3,
    },
    damage_resistances: "Poison",
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["bat"] = {
    name: "Bat",
    regExpSearch: /bat/i,
    source: [
        ["P24", 346]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 12,
    hp: 1,
    hd: [1, 4],
    speed: "5 ft, Fly 30 ft",
    scores: [2, 15, 8, 2, 12, 4],
    senses: "Blindsight 60 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["black bear"] = {
    name: "Black Bear",
    regExpSearch: /^(?=.*(black))(?=.*(bear)).*$/i,
    source: [
        ["P24", 346]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 19,
    hd: [3, 8],
    speed: "30 ft, Climb 30 ft, Swim 30 ft",
    scores: [15, 12, 14, 2, 12, 7],
    skills: {
        "perception": 5,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 2,
    actions: [{
        name: "Multiattack",
        description: "The black bear makes two Rend attacks.",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Slashing"],
        description: "Two Rend attacks as an Attack action",
        range: "Melee (5 ft)",
    }],
};
CreatureList["boar"] = {
    name: "Boar",
    regExpSearch: /boar/i,
    source: [
        ["P24", 347]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 13,
    hd: [2, 8],
    speed: "40 ft",
    scores: [13, 11, 14, 2, 9, 5],
    senses: "",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Bloodied Fury",
        description: "While Bloodied, the boar has Advantage on attack rolls.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Gore",
        ability: 1,
        damage: [1, 6, "Piercing"],
        description: "If moves 20 ft in straight line before hit, +3 (1d6) Pierc. dmg. If target is Large or smaller, it falls Prone",
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Bloodied Fury: While Bloodied, the boar has Advantage on attack rolls.",
};
CreatureList["brown bear"] = {
    name: "Brown Bear",
    regExpSearch: /^(?=.*(brown))(?=.*(bear)).*$/i,
    source: [
        ["P24", 347]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 22,
    hd: [3, 10],
    speed: "40 ft, Climb 30 ft",
    scores: [17, 12, 15, 2, 13, 7],
    skills: {
        "perception": 3,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 2,
    actions: [{
        name: "Multiattack",
        description: "The brown bear makes one Bite attack and one Claw attack.",
    }],
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 8, "Piercing"],
        description: "One Bite attack and One Claw attack as an Attack action",
        range: "Melee (5 ft)",
    }, {
        name: "Claw",
        ability: 1,
        damage: [1, 4, "Slashing"],
        description: "On a hit, a Huge or smaller target has the Prone condition.",
        range: "Melee (5 ft)",
    }],
};
CreatureList["camel"] = {
    name: "Camel",
    regExpSearch: /camel/i,
    source: [
        ["P24", 347]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 10,
    hp: 17,
    hd: [2, 10],
    speed: "50 ft",
    scores: [15, 8, 17, 2, 11, 5],
    saves: ["", 5, "", "", "", ""],
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 4, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["cat"] = {
    name: "Cat",
    regExpSearch: /cat/i,
    source: [
        ["P24", 347]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 12,
    hp: 2,
    hd: [1, 4],
    speed: "40 ft, Climb 40 ft",
    scores: [3, 15, 10, 3, 12, 7],
    saves: ["", 4, "", "", "", ""],
    skills: {
        "perception": 3,
        "stealth": 4,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Jumper",
        description: "The cat's jump distance is determined using its Dexterity rather than its Strength.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Scratch",
        ability: 2,
        damage: [1, "", "Slashing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Jumper: The cat's jump distance is determined using its Dexterity rather than its Strength.",
};
CreatureList["constrictor snake"] = {
    name: "Constrictor Snake",
    regExpSearch: /^(?=.*(constrictor))(?=.*(snake)).*$/i,
    source: [
        ["P24", 348]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 13,
    hp: 13,
    hd: [2, 10],
    speed: "30 ft, Swim 30 ft",
    scores: [15, 14, 12, 1, 10, 3],
    skills: {
        "perception": 2,
        "stealth": 4,
    },
    senses: "Blindsight 10 ft",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
    }, {
        name: "Constrict",
        ability: 1,
        damage: [3, 4, "Bludgeoning"],
        range: "Melee (5 ft)",
        dc: true,
        description: "Visible Medium or smaller creature in 5 ft, Str save. Fail: Damage + Grappled, Escape DC 12.",
    }],
};
CreatureList["crab"] = {
    name: "Crab",
    regExpSearch: /crab/i,
    source: [
        ["P24", 348]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 3,
    hd: [1, 4],
    speed: "20 ft, Swim 20 ft",
    scores: [6, 11, 12, 1, 8, 2],
    skills: {
        "stealth": 2,
    },
    senses: "Blindsight 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Amphibious",
        description: "The crab can breathe air and water.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Claw",
        ability: 2,
        damage: [1, "", "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Amphibious: The crab can breathe air and water.",
};
CreatureList["crocodile"] = {
    name: "Crocodile",
    regExpSearch: /crocodile/i,
    source: [
        ["P24", 348]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 13,
    hd: [2, 10],
    speed: "20 ft, Swim 30 ft",
    scores: [15, 10, 13, 2, 10, 5],
    saves: ["", "", 3, "", "", ""],
    skills: {
        "stealth": 2,
    },
    senses: "",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Hold Breath",
        description: "The crocodile can hold its breath for 1 hour.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        description: "If target Medium or smaller, it's Grappled & Restrained. End condition with DC 12 Athletics check as Action.",
    }],
    wildshapeString: "Hold Breath: The crocodile can hold its breath for 1 hour.",
};
CreatureList["dire wolf"] = {
    name: "Dire Wolf",
    regExpSearch: /^(?=.*(dire))(?=.*(wolf)).*$/i,
    source: [
        ["P24", 348]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 14,
    hp: 22,
    hd: [3, 10],
    speed: "50 ft",
    scores: [17, 15, 15, 3, 12, 7],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 5,
        "stealth": 4,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Pack Tactics",
        description: "The wolf has Advantage on an attack roll against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 10, "Piercing"],
        range: "Melee (5 ft)",
        description: "On a hit, a Huge or smaller target has the Prone condition.",
    }],
    wildshapeString: "Pack Tactics: The wolf has Advantage on an attack roll against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
};
CreatureList["draft horse"] = {
    name: "Draft Horse",
    regExpSearch: /^(?=.*(draft))(?=.*(horse)).*$/i,
    source: [
        ["P24", 349]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 10,
    hp: 15,
    hd: [2, 10],
    speed: "40 ft",
    scores: [18, 10, 15, 2, 11, 7],
    saves: ["", "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Hooves",
        ability: 1,
        damage: [1, 4, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["elephant"] = {
    name: "Elephant",
    regExpSearch: /elephant/i,
    source: [
        ["P24", 349]
    ],
    size: 1,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 12,
    hp: 76,
    hd: [8, 12],
    speed: "40 ft",
    scores: [22, 9, 17, 3, 11, 6],
    saves: ["", "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: 4,
    proficiencyBonus: 2,
    attacksAction: 2,
    actions: [{
        name: "Multiattack",
        description: "The elephant makes two Gore attacks.",
    }],
    attacks: [{
        name: "Gore",
        ability: 1,
        damage: [2, 8, "Piercing"],
        range: "Melee (5 ft)",
        description: "If moved 20 ft straight toward target before hit, target falls Prone.",
    }, {
        name: "Trample",
        ability: 1,
        damage: [2, 10, "Bludgeoning"],
        range: "Melee (5 ft)",
        dc: true,
        description: "Bonus Action against Prone creature in 5 feet. Target makes Dex save, half damage on success.",
    }],
};
CreatureList["elk"] = {
    name: "Elk",
    regExpSearch: /elk/i,
    source: [
        ["P24", 349]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 10,
    hp: 11,
    hd: [2, 10],
    speed: "50 ft",
    scores: [16, 10, 11, 2, 10, 6],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 2,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Ram",
        ability: 1,
        damage: [1, 6, "Bludgeoning"],
        range: "Melee (5 ft)",
        description: "If moved 20 ft straight toward target before hit, +3 (1d6) Bludgeoning. If Huge or smaller, target falls Prone.",
    }],
};
CreatureList["frog"] = {
    name: "Frog",
    regExpSearch: /frog/i,
    source: [
        ["P24", 349]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 11,
    hp: 1,
    hd: [1, 4],
    speed: "20 ft, Swim 20 ft",
    scores: [1, 13, 8, 1, 8, 3],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 1,
        "stealth": 3,
    },
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Amphibious",
        description: "The frog can breathe air and water.",
        joinString: "\n   "
    }, {
        name: "Standing Leap",
        description: "The Frog's Long Jump is up to 10 feet and its High Jump is up to 5 feet with or without a running start.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Amphibious: The frog can breathe air and water| Standing Leap: The Frog's Long Jump is up to 10 feet and its High Jump is up to 5 feet with or without a running start.",
};
CreatureList["giant badger"] = {
    name: "Giant Badger",
    regExpSearch: /^(?=.*(giant))(?=.*(badger)).*$/i,
    source: [
        ["P24", 350]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 13,
    hp: 15,
    hd: [2, 8],
    speed: "30 ft, Burrow 10 ft",
    scores: [13, 10, 17, 2, 12, 5],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 3,
    },
    damage_resistances: "Poison",
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [2, 4, "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["giant crab"] = {
    name: "Giant Crab",
    regExpSearch: /^(?=.*(giant))(?=.*(crab)).*$/i,
    source: [
        ["P24", 350]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 15,
    hp: 13,
    hd: [3, 8],
    speed: "30 ft, Swim 30 ft",
    scores: [13, 13, 11, 1, 9, 3],
    saves: ["", "", "", "", "", ""],
    skills: {
        "stealth": 3,
    },
    senses: "Blindsight 30 ft",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Amphibious",
        description: "The giant crab can breathe air and water.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Claw",
        ability: 1,
        damage: [1, 6, "Bludgeoning"],
        range: "Melee (5 ft)",
        description: "Medium or smaller target is Grappled. Each of two claws can grapple one target. DC 11 Athletics check to escape.",
    }],
    wildshapeString: "Amphibious: The giant crab can breathe air and water.",
};
CreatureList["giant goat"] = {
    name: "Giant Goat",
    regExpSearch: /^(?=.*(giant))(?=.*(goat)).*$/i,
    source: [
        ["P24", 350]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 19,
    hd: [3, 10],
    speed: "40 ft, Climb 30 ft",
    scores: [17, 13, 12, 3, 12, 6],
    saves: [5, "", "", "", "", ""],
    skills: {
        "perception": 3,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Ram",
        ability: 1,
        damage: [1, 6, "Bludgeoning"],
        range: "Melee (5 ft)",
        description: "If moves 20+ ft in straight line before hit, +5 (2d4) Blud. dmg. If target is Huge or smaller, it falls Prone.",
    }],
};
CreatureList["giant seahorse"] = {
    name: "Giant Seahorse",
    regExpSearch: /^(?=.*(giant))(?=.*(seahorse)).*$/i,
    source: [
        ["P24", 350]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 14,
    hp: 16,
    hd: [3, 10],
    speed: "5 ft, Swim 40 ft",
    scores: [15, 12, 11, 2, 12, 5],
    saves: ["", "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Water Breathing",
        description: "The giant seahorse can breathe only underwater.",
        joinString: "\n   "
    }],
    action: [{
        name: "Bubble Dash",
        description: "As a Bonus Action, while underwater, the giant seahorse moves up to half its Swim Speed without provoking Opportunity Attacks.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Ram",
        ability: 1,
        damage: [2, 6, "Bludgeoning"],
        range: "Melee (5 ft)",
        description: "If moved at least 20 ft straight toward target before hit, 11 (2d8 + 2) Bludgeoning damage instead.",
    }],
    wildshapeString: "Water Breathing: The giant seahorse can breathe only underwater| Bubble Dash: As a Bonus Action, while underwater, the giant seahorse moves up to half its Swim Speed without provoking Opportunity Attacks.",
};
CreatureList["giant spider"] = {
    name: "Giant Spider",
    regExpSearch: /^(?=.*(giant))(?=.*(spider)).*$/i,
    source: [
        ["P24", 351]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 14,
    hp: 26,
    hd: [4, 10],
    speed: "30 ft, Climb 30 ft",
    scores: [14, 16, 12, 2, 11, 4],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 4,
        "stealth": 7,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Spider Climb",
        description: "The spider can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   "
    }, {
        name: "Web Walker",
        description: "The spider ignores movement restrictions caused by webs, and it knows the location of any other creature in contact with the same web.",
        joinString: "\n   "
    }],
    action: [{
        name: "Web (Recharge 5-6)",
        description: "Dexterity Saving Throw: DC 13, one creature the spider can see within 60 feet. Failure: The target has the Restrained condition condition until the web is destroyed (AC 10; HP 5; Vulnerability to Fire damage; Immunity to Poison and Psychic damage).",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        description: "On a hit, this attack deals an additional 7 (2d6) Poison damage.",
    }],
    wildshapeString: "Spider Climb: The spider can climb difficult surfaces, including along ceilings, without needing to make an ability check| Web Walker: The spider ignores movement restrictions caused by webs, and it knows the location of any other creature in contact with the same web| Web (Recharge 5-6): Dexterity Saving Throw: DC 13, one creature the spider can see within 60 feet. Failure: The target has the Restrained condition condition until the web is destroyed (AC 10; HP 5; Vulnerability to Fire damage; Immunity to Poison and Psychic damage).",
};
CreatureList["giant weasel"] = {
    name: "Giant Weasel",
    regExpSearch: /^(?=.*(giant))(?=.*(weasel)).*$/i,
    source: [
        ["P24", 351]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 13,
    hp: 9,
    hd: [2, 8],
    speed: "40 ft, Climb 30 ft",
    scores: [11, 17, 10, 4, 12, 5],
    saves: ["", "", "", "", "", ""],
    skills: {
        "acrobatics": 5,
        "perception": 3,
        "stealth": 5,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 4, "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["goat"] = {
    name: "Goat",
    regExpSearch: /goat/i,
    source: [
        ["P24", 351]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 10,
    hp: 4,
    hd: [1, 8],
    speed: "40 ft, Climb 30 ft",
    scores: [11, 10, 11, 2, 10, 5],
    saves: [2, "", "", "", "", ""],
    skills: {
        "perception": 2,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Ram",
        ability: 1,
        damage: [1, "", "Bludgeoning"],
        range: "Melee (5 ft)",
        description: "If the goat moved at least 20 feet straight toward the target immediately before the hit, the target takes an extra 2 (1d4) Bludgeoning damage.",
    }],
};
CreatureList["hawk"] = {
    name: "Hawk",
    regExpSearch: /hawk/i,
    source: [
        ["P24", 352]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 13,
    hp: 1,
    hd: [1, 4],
    speed: "10 ft, Fly 60 ft",
    scores: [5, 16, 8, 2, 14, 6],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 6,
    },
    senses: "",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Talons",
        ability: 2,
        damage: [1, "", "Slashing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["imp"] = {
    name: "Imp",
    regExpSearch: /imp/i,
    source: [
        ["P24", 352]
    ],
    size: 5,
    type: "Fiend",
    subtype: "devil",
    alignment: "Lawful Evil",
    companion: "pact_of_the_chain",
    ac: 13,
    hp: 21,
    hd: [6, 4],
    speed: "20 ft, Fly 40 ft",
    scores: [6, 17, 13, 11, 12, 14],
    saves: ["", "", "", "", "", ""],
    skills: {
        "Deception": 4,
        "Insight": 3,
        "stealth": 5,
    },
    damage_resistances: "Cold",
    damage_immunities: "Fire; Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 120 ft",
    languages: "Common, Infernal",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Devil's Sight",
        description: "Magical Darkness doesn't impede the imp's Darkvision",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The imp has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Invisibility",
        description: "The imp casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
        joinString: "\n   ",
    }, {
        name: "Shape-Shift",
        description: "The imp shape-shifts to resemble a rat (Speed 20 ft.), a raven (20ft, Fly 60ft), or a spider (20ft, Climb 20 ft.), or it returns to its true form. Its statistics are the same in each form, except for its Speed changes noted. Any equipment it is wearing or carrying isn't transformed. It reverts to its true form if it dies.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Sting",
        ability: 2,
        damage: [1, 6, "Piercing"],
        description: "On a hit this attack deals an additional 2d6 Poison damage",
        range: "Melee (5 ft)",
    }],
};
CreatureList["lion"] = {
    name: "Lion",
    regExpSearch: /lion/i,
    source: [
        ["P24", 352]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 22,
    hd: [4, 10],
    speed: "50 ft",
    scores: [17, 15, 11, 3, 12, 8],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 3,
        "stealth": 4,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 2,
    actions: [{
        name: "Multiattack",
        description: "The lion makes two Rend attacks. It can replace one of these attacks with a use of Roar.",
    }],
    features: [{
        name: "Pack Tactics",
        description: "The lion has Advantage on an attack roll against a creature if at least one of the lion's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   "
    }, {
        name: "Running Leap",
        description: "With a 10-foot running start, the lion can Long Jump up to 25 feet.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Slashing"],
        range: "Melee (5 ft)",
        description: "Two Rend attacks as an Attack action. Can replace one of these attacks with a use of Roar.",
    }, {
        name: "Roar",
        ability: 5,
        damage: ["", "", "Frightened"],
        range: "15 ft",
        dc: true,
        description: "Fail: Frightened until start of lion's next turn",
    }],
    wildshapeString: "Pack Tactics: The lion has Advantage on an attack roll against a creature if at least one of the lion's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition| Running Leap: With a 10-foot running start, the lion can Long Jump up to 25 feet.",
};
CreatureList["lizard"] = {
    name: "Lizard",
    regExpSearch: /lizard/i,
    source: [
        ["P24", 353]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 10,
    hp: 2,
    hd: [1, 4],
    speed: "20 ft, Climb 20 ft",
    scores: [2, 11, 10, 1, 8, 3],
    saves: ["", "", "", "", "", ""],
    skills: {},
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Spider Climb",
        description: "The lizard can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Spider Climb: The lizard can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
};
CreatureList["mastiff"] = {
    name: "Mastiff",
    regExpSearch: /mastiff/i,
    source: [
        ["P24", 353]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 12,
    hp: 5,
    hd: [1, 8],
    speed: "40 ft",
    scores: [13, 14, 12, 3, 12, 7],
    saves: ["", "", "", "", 3, ""],
    skills: {
        "perception": 5,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (5 ft)",
        description: "On a hit, a Large or smaller target has the Prone condition.",
    }],
};
CreatureList["mule"] = {
    name: "Mule",
    regExpSearch: /mule/i,
    source: [
        ["P24", 353]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 10,
    hp: 11,
    hd: [2, 8],
    speed: "40 ft",
    scores: [14, 10, 13, 3, 10, 5],
    saves: [4, "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Beast of Burden",
        description: "The mule counts as one size larger for the purpose of determining its carrying capacity.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Hooves",
        ability: 1,
        damage: [1, 4, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Beast of Burden: The mule counts as one size larger for the purpose of determining its carrying capacity.",
};
CreatureList["octopus"] = {
    name: "Octopus",
    regExpSearch: /octopus/i,
    source: [
        ["P24", 353]
    ],
    size: 4,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 12,
    hp: 3,
    hd: [1, 6],
    speed: "5 ft, Swim 30 ft",
    scores: [4, 15, 11, 3, 10, 4],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 2,
        "stealth": 6,
    },
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Compression",
        description: "The octopus can move through a space as narrow as 1 inch without squeezing.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing",
        description: "The octopus can breathe only underwater.",
        joinString: "\n   ",
    }],
    traits: [{
        name: "Ink Cloud (1/Day)",
        description: "As a Reaction, Trigger: A creature ends its turn within 5 feet of the octopus while underwater. Response: The octopus releases ink that fills a 5-foot Cube centered on itself, and the octopus moves up to its Swim Speed away from the triggering creature.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Tentacles",
        ability: 2,
        damage: [1, "", "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Compression: The octopus can move through a space as narrow as 1 inch without squeezing| Water Breathing: The octopus can breathe only underwater.",
};
CreatureList["owl"] = {
    name: "Owl",
    regExpSearch: /owl/i,
    source: [
        ["P24", 354]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 11,
    hp: 1,
    hd: [1, 4],
    speed: "5 ft, Fly 60 ft",
    scores: [3, 13, 8, 2, 12, 7],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 5,
        "stealth": 5,
    },
    senses: "Darkvision 120 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Flyby",
        description: "The owl doesn't provoke Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Talons",
        ability: 2,
        damage: [1, "", "Slashing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Flyby: The owl doesn't provoke Opportunity Attacks when it flies out of an enemy's reach.",
};
CreatureList["panther"] = {
    name: "Panther",
    regExpSearch: /panther/i,
    source: [
        ["P24", 354]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 13,
    hd: [3, 8],
    speed: "50 ft, Climb 40 ft",
    scores: [14, 15, 10, 3, 14, 7],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 4,
        "stealth": 6,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    actions: [{
        name: "Prowl",
        description: "The panther moves up to half its Speed without provoking Opportunity Attacks. At the end of this movement, the panther can take the Hide action.",
        joinString: "\n   ",
    }, {
        name: "Multiattack",
        description: "The panther makes one Pounce attack and uses Prowl.",
    }],
    attacks: [{
        name: "Pounce",
        ability: 1,
        damage: [1, 4, "Slashing"],
        range: "Melee (5 ft)",
        description: "Deals 7 (2d4 +2) Slashing damage instead if Advantage on the attack. It makes one Pounce attack and uses Prowl.",
    }],
};
CreatureList["pony"] = {
    name: "Pony",
    regExpSearch: /pony/i,
    source: [
        ["P24", 354]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 10,
    hp: 11,
    hd: [2, 8],
    speed: "40 ft",
    scores: [15, 10, 13, 2, 11, 7],
    saves: [4, "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Hooves",
        ability: 1,
        damage: [1, 4, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["pseudodragon"] = {
    name: "Pseudodragon",
    regExpSearch: /pseudodragon/i,
    source: [
        ["P24", 354]
    ],
    size: 5,
    type: "Dragon",
    alignment: "Neutral Good",
    companion: "pact_of_the_chain",
    ac: 14,
    hp: 10,
    hd: [3, 4],
    speed: "15 ft, Fly 60 ft",
    scores: [6, 15, 13, 10, 12, 10],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 5,
        "stealth": 4,
    },
    senses: "Blindsight 10ft, Darkvision 60 ft",
    languages: "Understands Common and Draconic but can't speak",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 2,
    features: [{
        name: "Magic Resistance",
        description: "The pseudodragon has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Multiattack",
        description: "The pseudodragon makes two Bite attacks.",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 4, "Piercing"],
        description: "Two Bite attacks as an Attack action.",
        range: "Melee (5 ft)",
    }, {
        name: "Sting",
        ability: 2,
        damage: [2, 4, "poison"],
        range: "Melee (5 ft)",
        dc: true,
        description: "Con save, Fail: Dmg + Poisoned 1 hour, Fail by 5+, Dmg + Poisoned + Unconscious(Until shaken awake)",
    }],
};
CreatureList["quasit"] = {
    name: "Quasit",
    regExpSearch: /quasit/i,
    source: [
        ["P24", 355]
    ],
    size: 5,
    type: "Fiend",
    subtype: "demon",
    alignment: "Chaotic Evil",
    companion: "pact_of_the_chain",
    ac: 13,
    hp: 25,
    hd: [10, 4],
    speed: "40 ft",
    scores: [5, 17, 10, 7, 10, 10],
    saves: ["", "", "", "", "", ""],
    skills: {
        "stealth": 5,
    },
    damage_resistances: "Cold; Fire; Lightning",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 120 ft",
    languages: "Abyssal, Common",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Magic Resistance",
        description: "The quasit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Invisibility",
        description: "The quasit casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
        joinString: "\n   ",
    }, {
        name: "Scare (1/Day)",
        description: "Wisdom Saving Throw: DC 10, one creature within 20 feet. Failure: The target has the Frightened condition. At the end of each of its turns, the target repeats the save, ending the effect on itself on a success. After 1 minute, it succeeds automatically.",
        joinString: "\n   ",
    }, {
        name: "Shape-Shift",
        description: "The quasit shape-shifts to resemble a bat (Speed 10 ft., Fly 40 ft.), a centipede (40 ft., Climb 40 ft.), or a toad (40 ft., Swim 40 ft.), or it returns to its true form. Its statistics are the same in each form, except for its Speed changes noted. Any equipment it is wearing or carrying isn't transformed. It reverts to its true form if it dies.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 2,
        damage: [1, 4, "Slashing"],
        description: "Target also has the Poisoned condition until the start of the quasit's next turn.",
        range: "Melee (5 ft)",
    }],
};
CreatureList["rat"] = {
    name: "Rat",
    regExpSearch: /rat/i,
    source: [
        ["P24", 355]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 10,
    hp: 1,
    hd: [1, 4],
    speed: "20 ft, Climb 20 ft",
    scores: [2, 11, 9, 2, 10, 4],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 2,
    },
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Agile",
        description: "The rat doesn't provoke Opportunity Attacks when it moves out of an enemy's reach.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Agile: The rat doesn't provoke Opportunity Attacks when it moves out of an enemy's reach.",
};
CreatureList["raven"] = {
    name: "Raven",
    regExpSearch: /raven/i,
    source: [
        ["P24", 355]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 12,
    hp: 2,
    hd: [1, 4],
    speed: "10 ft, Fly 50 ft",
    scores: [2, 14, 10, 5, 13, 6],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 3,
    },
    senses: "",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Mimicry",
        description: "The raven can mimic simple sounds it has heard, such as a whisper or chitter. A hearer can discern the sounds are imitations with a successful DC 10 Wisdom (Insight) check.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Beak",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Mimicry: The raven can mimic simple sounds it has heard, such as a whisper or chitter. A hearer can discern the sounds are imitations with a successful DC 10 Wisdom (Insight) check.",
};
CreatureList["reef shark"] = {
    name: "Reef Shark",
    regExpSearch: /^(?=.*(reef))(?=.*(shark)).*$/i,
    source: [
        ["P24", 356]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 22,
    hd: [4, 8],
    speed: "5 ft, Swim 30 ft",
    scores: [14, 15, 13, 1, 10, 4],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 2,
    },
    senses: "Blindsight 30 ft",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Pack Tactics",
        description: "The shark has Advantage on an attack roll against a creature if at least one of the shark's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   "
    }, {
        name: "Water Breathing",
        description: "The shark can breathe only underwater.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [2, 4, "Piercing"],
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Pack Tactics: The shark has Advantage on an attack roll against a creature if at least one of the shark's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition| Water Breathing: The shark can breathe only underwater.",
};
CreatureList["riding horse"] = {
    name: "Riding Horse",
    regExpSearch: /^(?=.*(riding))(?=.*(horse)).*$/i,
    source: [
        ["P24", 356]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 11,
    hp: 13,
    hd: [2, 10],
    speed: "60 ft",
    scores: [16, 13, 12, 2, 11, 7],
    saves: ["", "", "", "", "", ""],
    senses: "",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Hooves",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["scorpion"] = {
    name: "Scorpion",
    regExpSearch: /scorpion/i,
    source: [
        ["P24", 356]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    ac: 11,
    hp: 1,
    hd: [1, 4],
    speed: "10 ft",
    scores: [2, 11, 8, 1, 8, 2],
    saves: ["", "", "", "", "", ""],
    senses: "Blindsight 10 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Sting",
        ability: 1,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
        description: "On a hit, target takes an additional 3 (1d6) Poison damage.",
    }],
};
CreatureList["skeleton"] = {
    name: "Skeleton",
    regExpSearch: /skeleton/i,
    source: [
        ["P24", 355]
    ],
    size: 3,
    type: "Undead",
    alignment: "Lawful Evil",
    companion: "pact_of_the_chain",
    ac: 13,
    hp: 13,
    hd: [2, 8],
    speed: "30 ft",
    scores: [10, 16, 15, 6, 8, 5],
    saves: ["", "", "", "", "", ""],
    skills: {
        "stealth": 5,
    },
    damage_vulnerabilities: "Bludgeoning",
    damage_immunities: "Poison",
    condition_immunities: "Exhausted; Poisoned",
    senses: "Darkvision 60 ft",
    languages: "Understands the languages it knew in life but can't speak",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Shortsword",
        ability: 2,
        damage: [1, 6, "Piercing"],
        range: "Melee (5 ft)",
    }, {
        name: "Shortbow",
        ability: 2,
        damage: [1, 6, "Piercing"],
        range: "80/320",
    }],
};
CreatureList["slaad Tadpole"] = {
    name: "Slaad Tadpole",
    regExpSearch: /^(?=.*(slaad))(?=.*(tadpole)).*$/i,
    source: [
        ["P24", 357]
    ],
    size: 5,
    type: "Aberration",
    alignment: "Chaotic Neutral",
    companion: "pact_of_the_chain",
    ac: 12,
    hp: 7,
    hd: [3, 4],
    speed: "30 ft, Burrow 10 ft",
    scores: [7, 15, 10, 3, 5, 3],
    saves: ["", "", "", "", "", ""],
    skills: {
        "stealth": 4,
    },
    damage_immunities: "Acid; Cold; Fire; Lightning; Thunder",
    senses: "Darkvision 60 ft",
    languages: "Understands Slaad but can't speak",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Magic Resistance",
        description: "The slaad has Advantage on saving throws against spells and other magical effects",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 6, "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["sphinx of wonder"] = {
    name: "Sphinx of Wonder",
    regExpSearch: /^(?=.*(sphinx))(?=.*(wonder)).*$/i,
    source: [
        ["P24", 357]
    ],
    size: 5,
    type: "Celestial",
    alignment: "Lawful Good",
    companion: "pact_of_the_chain",
    ac: 13,
    hp: 24,
    hd: [7, 4],
    speed: "20 ft, Fly 40 ft",
    scores: [6, 17, 13, 15, 12, 11],
    saves: ["", "", "", "", "", ""],
    skills: {
        "Arcana": 4,
        "Religion": 4,
        "stealth": 5,
    },
    damage_resistances: "Necrotic; Psychic; Radiant",
    senses: "Darkvision 60 ft",
    languages: "Celestial, Common",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Magic Resistance",
        description: "The sphinx has Advantage on saving throws against spells and other magical effects",
        joinString: "\n   ",
    }, {
        name: "Burst of Ingenuity (2/Day)",
        description: "Reaction. Trigger: The sphinx or another creature within 30 feet makes an ability check or a saving throw. Response: The sphinx adds 2 to the roll.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 2,
        damage: [1, 4, "Slashing"],
        description: "plus 2d6 Radiant damage",
        range: "Melee (5 ft)",
    }],
};
CreatureList["spider"] = {
    name: "Spider",
    regExpSearch: /spider/i,
    source: [
        ["P24", 357]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 12,
    hp: 1,
    hd: [1, 4],
    speed: "20 ft, Climb 20 ft",
    scores: [2, 14, 8, 1, 10, 2],
    saves: ["", "", "", "", "", ""],
    skills: {
        "stealth": 4,
    },
    senses: "Darkvision 30 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Spider Climb",
        description: "The spider can climb difficult surfaces including ceilings, without needing to make an ability check.",
        joinString: "\n   "
    }, {
        name: "Web Walker",
        description: "The spider ignores movement restrictions caused by webs, and the spider knows the location of any other creature in contact with the same web.",
        joinString: "\n   "
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        description: "Plus 2 (1d4) Poison damage",
        range: "Melee (5 ft)",
    }],
    wildshapeString: "Spider Climb: The spider can climb difficult surfaces including ceilings, without needing to make an ability check| Web Walker: The spider ignores movement restrictions caused by webs, and the spider knows the location of any other creature in contact with the same web.",
};
CreatureList["sprite"] = {
    name: "Sprite",
    regExpSearch: /sprite/i,
    source: [
        ["P24", 358]
    ],
    size: 5,
    type: "Fey",
    alignment: "Neutral Good",
    companion: "pact_of_the_chain",
    ac: 15,
    hp: 10,
    hd: [4, 4],
    speed: "10 ft, Fly 40 ft",
    scores: [3, 18, 10, 14, 13, 11],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 3,
        "stealth": 8,
    },
    senses: "",
    languages: "Common, Elvish, Sylvan",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Heart Sight",
        description: "Charisma Saving Throw: DC 10, one creature within 5 feet the sprite can see. Celestials, Fiends, and Undead automatically fail the save. Failure: The sprite knows the target's emotions and alignment.",
        joinString: "\n   ",
    }, {
        name: "Invisibility",
        description: "The Sprite casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Needle Sword",
        ability: 2,
        damage: [1, 4, "Piercing"],
        range: "Melee (5 ft)",
    }, {
        name: "Enchanting Bow",
        ability: 2,
        damage: [1, "", "Piercing"],
        description: "Target also has the Charmed condition until the start of the sprite's next turn.",
        range: "40/60 ft",
    }],
};
CreatureList["tiger"] = {
    name: "Tiger",
    regExpSearch: /tiger/i,
    source: [
        ["P24", 358]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    ac: 13,
    hp: 22,
    hd: [3, 10],
    speed: "40 ft",
    scores: [17, 16, 14, 3, 12, 8],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 3,
        "stealth": 7,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 1,
    proficiencyBonus: 2,
    attacksAction: 1,
    actions: [{
        name: "Prowl",
        description: "The tiger moves up to half its Speed without provoking Opportunity Attacks. At the end of this movement, the tiger can take the Hide action.",
        joinString: "\n   ",
    }, {
        name: "Multiattack",
        description: "The tiger makes one Pounce attack and uses Prowl.",
    }],
    attacks: [{
        name: "Pounce",
        ability: 1,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        description: "Deals an extra 3 (1d6) Slashing damage if Advantage on the attack. If the target is Huge or smaller, it falls Prone. Also uses Prowl.",
    }],
};
CreatureList["venomous snake"] = {
    name: "Venomous Snake",
    regExpSearch: /^(?=.*(venomous))(?=.*(snake)).*$/i,
    source: [
        ["P24", 358]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "pact_of_the_chain",
    ac: 12,
    hp: 5,
    hd: [2, 4],
    speed: "30 ft, Swim 30 ft",
    scores: [2, 15, 11, 1, 10, 3],
    saves: ["", "", "", "", "", ""],
    skills: {},
    senses: "Blindsight 10 ft",
    languages: "",
    challengeRating: "1/8",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        description: "Plus 3 (1d6) Poison damage",
        range: "Melee (5 ft)",
    }],
};
CreatureList["warhorse"] = {
    name: "Warhorse",
    regExpSearch: /warhorse/i,
    source: [
        ["P24", 359]
    ],
    size: 2,
    type: "Beast",
    alignment: "Unaligned",
    companion: "mount",
    ac: 11,
    hp: 19,
    hd: [3, 10],
    speed: "60 ft",
    scores: [18, 12, 13, 2, 12, 7],
    saves: ["", "", "", "", 3, ""],
    senses: "",
    languages: "",
    challengeRating: "1/2",
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Hooves",
        ability: 1,
        damage: [2, 4, "Bludgeoning"],
        description: "If moved at least 20 ft straight toward target before hit, +5 (2d4) Bludgeoning damage. If target is Huge or smaller, falls Prone.",
    }],
};
CreatureList["weasel"] = {
    name: "Weasel",
    regExpSearch: /weasel/i,
    source: [
        ["P24", 359]
    ],
    size: 5,
    type: "Beast",
    alignment: "Unaligned",
    companion: "familiar",
    ac: 13,
    hp: 1,
    hd: [1, 4],
    speed: "30 ft, Climb 30 ft",
    scores: [3, 16, 8, 2, 12, 3],
    saves: ["", "", "", "", "", ""],
    skills: {
        "acrobatics": 5,
        "perception": 3,
        "stealth": 5,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: 0,
    proficiencyBonus: 2,
    attacksAction: 1,
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, "", "Piercing"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["wolf"] = {
    name: "Wolf",
    regExpSearch: /wolf/i,
    source: [
        ["P24", 359]
    ],
    size: 3,
    type: "Beast",
    alignment: "Unaligned",
    ac: 12,
    hp: 11,
    hd: [2, 8],
    speed: "40 ft",
    scores: [14, 15, 12, 3, 12, 6],
    saves: ["", "", "", "", "", ""],
    skills: {
        "perception": 5,
        "stealth": 4,
    },
    senses: "Darkvision 60 ft",
    languages: "",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Pack Tactics",
        description: "The wolf has Advantage on attack rolls against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (5 ft)",
        description: "If the target is Medium or smaller, it has the Prone condition.",
    }],
    wildshapeString: "Pack Tactics: The wolf has Advantage on attack rolls against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
};
CreatureList["zombie"] = {
    name: "Zombie",
    regExpSearch: /zombie/i,
    source: [
        ["P24", 359]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral Evil",
    ac: 8,
    hp: 15,
    hd: [2, 8],
    speed: "20 ft",
    scores: [13, 6, 16, 3, 6, 5],
    saves: ["", "", "", "", 0, ""],
    damage_immunities: "Poison",
    condition_immunities: "Exhausted; Poisoned",
    senses: "Darkvision 60 ft",
    languages: "Understands the languages it knew in life but can't speak",
    challengeRating: "1/4",
    proficiencyBonus: 2,
    attacksAction: 1,
    features: [{
        name: "Undead Fortitude",
        description: "If damage reduces the zombie to 0 Hit Points, it must make a Constitution saving throw with a DC of 5 plus the damage taken unless the damage is Radiant or from a Critical Hit. On a successful save, the zombie drops to 1 Hit Point instead.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 6, "Bludgeoning"],
        range: "Melee (5 ft)",
    }],
};
CreatureList["beast of the land"] = {
    name: "Beast of the Land",
    source: [
        ["P24", 123]
    ],
    regExpSearch: /^(?=.*beast)(?=.*of)(?=.*the)(?=.*land).*$/i,
    size: 3,
    type: ["Beast"],
    companion: ["companion"],
    companionApply: "companion",
    isSummon: true,
    alignment: "Neutral",
    ac: "13+oWis",
    hp: 10,
    hd: [1, 8],
    hdLinked: ["ranger"],
    speed: "40 ft, climb 40 ft",
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    challengeRating: 0,
    scores: [14, 14, 15, 8, 14, 11],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    attacksAction: 1,
    addMod: [{
            type: "skill",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "skill",
            field: "Init",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "save",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        }
    ],
    calcChanges: {
        hp: function(totalHD, HDobj, prefix) {
            if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
            var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
            HDobj.alt.push(5 + 5 * rgrLvl);
            HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
        },
        setAltHp: true,
        hpForceRecalc: true,
    },
    attacks: [{
        name: "Beast's Strike",
        ability: 1,
        abilitytodamage: true,
        damage: [1, 8, "Bludg./Pierc./Slash."],
        modifiers: ["", "oWis"],
        range: "Melee (5 ft)",
        description: "+1d6 dmg if hits after moving 20 ft straight in same rough. Large or smaller target falls Prone.",
        tooltip: "If the beast moved at least 20 feet straight toward the target before the hit, the target takes an extra 1d6 damageof the same type, and the target has the Prone condition if it is a Large or smaller creature.",
    }],
    languages: "understands the languages I speak",
    traits: [{
        name: "Beast's Strike",
        description: "The Primal Companion's Beast's Strike attack deals Bludgeoning, Pircing, or Slashing, which you choose when you summon the companion.",
        joinString: "\n   ",
    }],
    features: [{
        name: "Primal Bond",
        description: "The primal companion adds my proficiency bonus to all its ability check and saving throws.",
        joinString: "\n   ",
    }],
    header: "Companion",
};
CreatureList["beast of the sea"] = {
    name: "Beast of the Sea",
    source: [
        ["P24", 124]
    ],
    regExpSearch: /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sea).*$/i,
    size: 3,
    type: ["Beast"],
    companion: ["companion"],
    companionApply: "companion",
    isSummon: true,
    alignment: "Neutral",
    ac: "13+oWis",
    hp: 10,
    hd: [1, 8],
    hdLinked: ["ranger", "ranger_ua23pt6"],
    speed: "5 ft, swim 60 ft",
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    challengeRating: 0,
    scores: [14, 14, 15, 8, 14, 11],
    attacksAction: 1,
    senses: "",
    addMod: [{
            type: "skill",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "skill",
            field: "Init",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "save",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        }
    ],
    calcChanges: {
        hp: function(totalHD, HDobj, prefix) {
            if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
            var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
            HDobj.alt.push(5 + 5 * rgrLvl);
            HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
        },
        setAltHp: true,
        hpForceRecalc: true,
    },
    attacks: [{
        name: "Beast's Strike",
        ability: 1,
        abilitytodamage: true,
        damage: [1, 6, "Bludg./Slash."],
        modifiers: ["", "oWis"],
        range: "Melee (5 ft)",
        description: "Target has the Grappled condition (escape DC = my Spell Save DC)",
    }],
    languages: "understands the languages I speak",
    traits: [{
        name: "Amphibious",
        description: "The beast can breathe air and water.",
        joinString: "\n   ",
    }, {
        name: "Beast's Strike",
        description: "The Primal Companion's Beast's Strike attack deals Bludgeoning or Slashing, which you choose when you summon the companion.",
        joinString: "\n   ",
    }],
    features: [{
        name: "Primal Bond",
        description: "The primal companion adds my proficiency bonus to all its ability check and saving throws.",
        joinString: "\n   ",
    }],
    header: "Companion",
};
CreatureList["beast of the sky"] = {
    name: "Beast of the Sky",
    source: [
        ["P24", 124]
    ],
    regExpSearch: /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sky).*$/i,
    size: 4,
    type: ["Beast"],
    companion: ["companion"],
    companionApply: "companion",
    isSummon: true,
    alignment: "Neutral",
    ac: "13+oWis",
    hp: 8,
    hd: [1, 6],
    hdLinked: ["ranger", "ranger_ua23pt6"],
    speed: "10 ft, fly 60 ft",
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    challengeRating: 0,
    scores: [6, 16, 13, 8, 14, 11],
    attacksAction: 1,
    senses: "",
    addMod: [{
            type: "skill",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "skill",
            field: "Init",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        },
        {
            type: "save",
            field: "all",
            mod: "Prof",
            text: "The primal companion adds it proficiency bonus to all its ability check and saving throws."
        }
    ],
    calcChanges: {
        hp: function(totalHD, HDobj, prefix) {
            if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
            var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
            HDobj.alt.push(4 + 4 * rgrLvl);
            HDobj.altStr.push(" = 4 as a base\n + " + "4 \xD7" + rgrLvl + " from its master's Ranger level");
        },
        setAltHp: true,
        hpForceRecalc: true,
    },
    attacks: [{
        name: "Beast's Strike",
        ability: 2,
        abilitytodamage: true,
        damage: [1, 4, "Slashing"],
        modifiers: ["", "oWis"],
        range: "Melee (5 ft)",
        description: "",
        tooltip: "",
    }],
    languages: "understands the languages I speak",
    traits: [{
        name: "Flyby",
        description: "The beast doesn‚Äôt provoke Opportunity Attacks when it flies out of an enemy‚Äôs reach.",
        joinString: "\n   ",
    }],
    features: [{
        name: "Primal Bond",
        description: "The primal companion adds my proficiency bonus to all its ability check and saving throws.",
        joinString: "\n   ",
    }],
    header: "Companion",
};
//Animated Object Stat Blocks
CompanionList["spell_creatures"] = {
    name: "Spell Creatures",
    nameMenu: "Spell Creatures (Creatures Created/Summoned by a Spell)",
    nameOrigin: "Spell Creatures Created by spell effects of conjuration or transmutation spells",
    source: [
        ["P24", 234]
    ],
    attributesChange: function(sCrea, objCrea) {
        // Check for spell attribute before attempting to access it.
        if (!CreatureList[sCrea].spell) return;
        // Access the spell attribute holding the spell name from the original CreatureOptions object
        // Find all casters of that spell
        var casters = isSpellUsed(CreatureList[sCrea].spell);
        // Used to store an array where oScore[0] is the class and oScore[1] is the attack modifier w/ bonuses
        var oScore = undefined;

        // Loop through all casters
        for (var caster of casters) {
            // Ensure it's from a class and calcSpellScores is present.
            if (CurrentSpells[caster].refType !== "class" || !CurrentSpells[caster].calcSpellScores) continue;

            // The total attack modifier w/ bonuses if any
            var oAtkMod = CurrentSpells[caster].calcSpellScores.attack;

            // Check if oScore is empty or if the current attack modifier is higher
            if (oScore === undefined || oAtkMod > oScore[1]) {
                oScore = [caster, oAtkMod]; // Store the class and ability
            }
        }

        if (oScore === undefined) return; // Return if no score found

        // Update attacks with the highest class ability
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0]; // Set the highest class
        }
    },
    notes: [{
        name: "Creature Recalculation",
        description: [
            "If I update my spellcasting mod, or are multiclassing, and my secondary class has a higher spellcasting mod, I will need to reselect this companion to update its attack to hit."
        ].join("\n   "),
        joinString: ", "
    }],
};
CreatureList["animated object (tsm)"] = {
    name: "Animated Object (Tiny/Small/Medium)",
    regExpSearch: /^(?=.*animated)(?=.*object)(?=.*tsm).*$/i,
    source: [
        ["P24", 241]
    ],
    size: [3, 4, 5],
    type: "Construct",
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "animate object",
    ac: 15,
    hp: 10,
    hd: [2, 8],
    speed: "30 ft",
    scores: [16, 10, 10, 3, 3, 1],
    damage_immunities: "Poison, Psychic",
    condition_immunities: "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Blindsight 30 ft",
    passivePerception: 6,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 4, "Force"],
        range: "Melee (5 ft)",
        useSpellMod: ["bard", "sorcerer", "wizard"]
    }],
};
CreatureList["animated object (l)"] = {
    name: "Animated Object (Large)",
    regExpSearch: /^(?=.*animated)(?=.*object)(?=.*l).*$/i,
    source: [
        ["P24", 241]
    ],
    size: 2,
    type: "Construct",
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "animate object",
    ac: 15,
    hp: 20,
    hd: [4, 8],
    speed: "30 ft",
    scores: [16, 10, 10, 3, 3, 1],
    damage_immunities: "Poison, Psychic",
    condition_immunities: "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Blindsight 30 ft",
    passivePerception: 6,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        useSpellMod: ["bard", "sorcerer", "wizard"]
    }],
};
CreatureList["animated object (h)"] = {
    name: "Animated Object (Huge)",
    regExpSearch: /^(?=.*animated)(?=.*object)(?=.*h).*$/i,
    source: [
        ["P24", 241]
    ],
    size: 1,
    type: "Construct",
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "animate objects",
    ac: 15,
    hp: 40,
    hd: [8, 8],
    speed: "30 ft",
    scores: [16, 10, 10, 3, 3, 1],
    damage_immunities: "Poison, Psychic",
    condition_immunities: "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Blindsight 30 ft",
    passivePerception: 6,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [2, 12, "Force"],
        range: "Melee (5 ft)",
        useSpellMod: ["bard", "sorcerer", "wizard"]
    }],
};
//Otherworldly Steed Stat Blocks
CreatureList["otherworldly steed (2)"] = {
    name: "Otherworldly Steed (lvl 2)",
    regExpSearch: /^(?=.*otherworldly)(?=.*steed)(?=.*2).*$/i,
    source: [
        ["P24", 273]
    ],
    size: 2,
    type: ["Celestial", "Fey", "Fiend"],
    alignment: "Neutral",
    companion: "mount",
    companionApply: "mount",
    ac: 12,
    hp: 25,
    hd: [2, 10],
    speed: "60 ft",
    scores: [18, 12, 14, 6, 12, 8],
    senses: "",
    passivePerception: 11,
    languages: "Telepathy 1 mile (works only with I)",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Life Bond",
        description: "When I regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if I'm within 5 feet of it.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Fell Glare 1/LR (Fiend Only)",
        description: "As a Bonus Action, Wisdom Saving Throw: DC equals my spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of my next turn.",
        joinString: "\n   ",
    }, {
        name: "Fey Step 1/LR (Fey Only)",
        description: "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of my choice up to 60 feet away from itself.",
        joinString: "\n   ",
    }, {
        name: "Healing Touch 1/LR (Celestial Only)",
        description: "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+2",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Otherworldly Slam",
        ability: 1,
        damage: [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
        modifiers: ["", 2],
        modToDmg: false,
        range: "Melee (5 ft)",
    }],
};
CreatureList["otherworldly steed (3)"] = {
    name: "Otherworldly Steed (lvl 3)",
    regExpSearch: /^(?=.*otherworldly)(?=.*steed)(?=.*3).*$/i,
    source: [
        ["P24", 273]
    ],
    size: 2,
    type: ["Celestial", "Fey", "Fiend"],
    alignment: "Neutral",
    companion: "mount",
    companionApply: "mount",
    ac: 12,
    hp: 35,
    hd: [3, 10],
    speed: "60 ft",
    scores: [18, 12, 14, 6, 12, 8],
    senses: "",
    passivePerception: 11,
    languages: "Telepathy 1 mile (works only with I)",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Life Bond",
        description: "When I regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if I'm within 5 feet of it.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Fell Glare 1/LR (Fiend Only)",
        description: "As a Bonus Action, Wisdom Saving Throw: DC equals my spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of my next turn.",
        joinString: "\n   ",
    }, {
        name: "Fey Step 1/LR (Fey Only)",
        description: "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of my choice up to 60 feet away from itself.",
        joinString: "\n   ",
    }, {
        name: "Healing Touch 1/LR (Celestial Only)",
        description: "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+3",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Otherworldly Slam",
        ability: 1,
        damage: [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
        modifiers: ["", 3],
        modToDmg: false,
        range: "Melee (5 ft)",
    }],
};
CreatureList["otherworldly steed (4)"] = {
    name: "Otherworldly Steed (lvl 4)",
    regExpSearch: /^(?=.*otherworldly)(?=.*steed)(?=.*4).*$/i,
    source: [
        ["P24", 273]
    ],
    size: 2,
    type: ["Celestial", "Fey", "Fiend"],
    alignment: "Neutral",
    companion: "mount",
    companionApply: "mount",
    ac: 12,
    hp: 45,
    hd: [4, 10],
    speed: "60 ft, Fly 60 ft",
    scores: [18, 12, 14, 6, 12, 8],
    senses: "",
    passivePerception: 11,
    languages: "Telepathy 1 mile (works only with I)",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Life Bond",
        description: "When I regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if I'm within 5 feet of it.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Fell Glare 1/LR (Fiend Only)",
        description: "As a Bonus Action, Wisdom Saving Throw: DC equals my spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of my next turn.",
        joinString: "\n   ",
    }, {
        name: "Fey Step 1/LR (Fey Only)",
        description: "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of my choice up to 60 feet away from itself.",
        joinString: "\n   ",
    }, {
        name: "Healing Touch 1/LR (Celestial Only)",
        description: "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+4",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Otherworldly Slam",
        ability: 1,
        damage: [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
        modifiers: ["", 4],
        modToDmg: false,
        range: "Melee (5 ft)",
    }],
};
CreatureList["otherworldly steed (5)"] = {
    name: "Otherworldly Steed (lvl 5)",
    regExpSearch: /^(?=.*otherworldly)(?=.*steed)(?=.*5).*$/i,
    source: [
        ["P24", 273]
    ],
    size: 2,
    type: ["Celestial", "Fey", "Fiend"],
    alignment: "Neutral",
    companion: "mount",
    companionApply: "mount",
    ac: 12,
    hp: 55,
    hd: [5, 10],
    speed: "60 ft, Fly 60 ft",
    scores: [18, 12, 14, 6, 12, 8],
    senses: "",
    passivePerception: 11,
    languages: "Telepathy 1 mile (works only with I)",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Life Bond",
        description: "When I regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if I'm within 5 feet of it.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Fell Glare 1/LR (Fiend Only)",
        description: "As a Bonus Action, Wisdom Saving Throw: DC equals my spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of my next turn.",
        joinString: "\n   ",
    }, {
        name: "Fey Step 1/LR (Fey Only)",
        description: "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of my choice up to 60 feet away from itself.",
        joinString: "\n   ",
    }, {
        name: "Healing Touch 1/LR (Celestial Only)",
        description: "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+5",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Otherworldly Slam",
        ability: 1,
        damage: [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
        modifiers: ["", 5],
        modToDmg: false,
        range: "Melee (5 ft)",
    }],
};
//Giant Insect Stat Blocks
CreatureList["giant insect (4)"] = {
    name: "Giant Insect (lvl 4)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*4).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 15,
    hp: 30,
    hd: [5, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 4],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 4],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
CreatureList["giant insect (5)"] = {
    name: "Giant Insect (lvl 5)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*5).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 16,
    hp: 40,
    hd: [7, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 5],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 5],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
CreatureList["giant insect (6)"] = {
    name: "Giant Insect (lvl 6)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*6).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 17,
    hp: 50,
    hd: [8, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 6],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 6],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
CreatureList["giant insect (7)"] = {
    name: "Giant Insect (lvl 7)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*7).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 18,
    hp: 60,
    hd: [10, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 7],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 7],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
CreatureList["giant insect (8)"] = {
    name: "Giant Insect (lvl 8)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*8).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 19,
    hp: 70,
    hd: [12, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 8],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 8],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
CreatureList["giant insect (9)"] = {
    name: "Giant Insect (lvl 9)",
    regExpSearch: /^(?=.*giant)(?=.*insect)(?=.*9).*$/i,
    source: [
        ["P24", 379]
    ],
    size: 2,
    type: ["Beast"],
    alignment: "Unaligned",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "giant insect",
    isSummon: true,
    ac: 20,
    hp: 80,
    hd: [13, 10],
    speed: "40 ft, Climb 40 ft, Fly 40 ft(Wasp Only)",
    scores: [17, 13, 15, 4, 14, 3],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the langages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 8,
    features: [{
        name: "Spider Climb",
        description: "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
        joinString: "\n   ",
    }],
    actions: [{
        name: "Venomous Spew (Centipede Only)",
        description: "As a Bonus Action, Constitution Saving Throw: my spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Poison Jab",
        ability: 1,
        damage: [1, 6, "Piercing"],
        modifiers: ["", 9],
        range: "Melee (10 ft)",
        description: "+1d4 Poison damage",
        useSpellMod: ["druid"]
    }, {
        name: "Web Bolt (Spider Only)",
        ability: 1,
        damage: [1, 10, "Bludgeoning"],
        modifiers: ["", 9],
        range: "Ranged (60 ft)",
        description: "The target's Speed is reduced to 0 until the start of the insect's next turn",
        useSpellMod: ["druid"]
    }],
};
//Aberrant Spirit Stat Blocks
CreatureList["aberrant spirit (4)"] = {
    name: "Aberrant Spirit (lvl 4)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*4).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 15,
    hp: 40,
    hd: [8, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 4],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["aberrant spirit (5)"] = {
    name: "Aberrant Spirit (lvl 5)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*5).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 16,
    hp: 50,
    hd: [10, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 5],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["aberrant spirit (6)"] = {
    name: "Aberrant Spirit (lvl 6)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*6).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 17,
    hp: 60,
    hd: [12, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 6],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["aberrant spirit (7)"] = {
    name: "Aberrant Spirit (lvl 7)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*7).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 18,
    hp: 70,
    hd: [14, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 7],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["aberrant spirit (8)"] = {
    name: "Aberrant Spirit (lvl 8)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*8).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 19,
    hp: 80,
    hd: [16, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 8],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["aberrant spirit (9)"] = {
    name: "Aberrant Spirit (lvl 9)",
    regExpSearch: /^(?=.*aberrant)(?=.*spirit)(?=.*9).*$/i,
    source: [
        ["P24", 322]
    ],
    size: 3,
    type: "Aberration",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon aberration",
    ac: 20,
    hp: 90,
    hd: [18, 8],
    speed: "30 ft/Fly 30 ft (Beholderkin)",
    scores: [16, 10, 15, 16, 10, 6],
    damage_immunities: "Psychic",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Deep Speech, understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Regeneration (Slaad Only)",
        description: "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
        joinString: "\n   ",
    }, {
        name: "Whispering Aura (Mind Flayer Only)",
        description: "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals my spell save DC, each ceature (other than I) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claw (Slaad Only)",
        ability: 1,
        damage: [1, 10, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Eye Ray (Beholderkin Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "150 ft",
        modifiers: ["", 9],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }, {
        name: "Psychic Slam (Mind Flayer Only)",
        ability: 4,
        damage: [1, 8, "Psychic"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "",
        useSpellMod: ["warlock", "wizard"]
    }],
};
//Beast Spirit Stat Blocks
CreatureList["bestial spirit (lw)(2)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 2)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*2).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 13,
    hp: 30,
    hd: [8, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 2],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(3)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 3)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*3).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 14,
    hp: 35,
    hd: [9, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 3],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(4)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 4)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*4).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 15,
    hp: 40,
    hd: [10, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(5)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 5)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*5).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 16,
    hp: 45,
    hd: [11, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(6)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 6)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*6).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 17,
    hp: 50,
    hd: [12, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(7)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 7)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*7).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 18,
    hp: 55,
    hd: [14, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(8)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 8)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*8).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 19,
    hp: 60,
    hd: [15, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (lw)(9)"] = {
    name: "Bestial Spirit (Land/Water)(lvl 9)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*9).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 20,
    hp: 65,
    hd: [16, 6],
    speed: "30 ft/Climb 30 ft (Land), Swim 30 ft (Water)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Pack Tactics (Land and Water Only)",
        description: "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
        joinString: "\n   ",
    }, {
        name: "Water Breathing (Water Only)",
        description: "The spirit can breath only underwater.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(2)"] = {
    name: "Bestial Spirit (Air)(lvl 2)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*2).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 13,
    hp: 20,
    hd: [5, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+2"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"],
    }],
};
CreatureList["bestial spirit (a)(3)"] = {
    name: "Bestial Spirit (Air)(lvl 3)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*3).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 14,
    hp: 25,
    hd: [6, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+3"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(4)"] = {
    name: "Bestial Spirit (Air)(lvl 4)",
    regExpSearch: /^(?=.*bestial)(?=.*air)(?=.*spirit)(?=.*4).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 15,
    hp: 30,
    hd: [7, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+4"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(5)"] = {
    name: "Bestial Spirit (Air)(lvl 5)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*5).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 16,
    hp: 35,
    hd: [9, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+5"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(6)"] = {
    name: "Bestial Spirit (Air)(lvl 6)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*6).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 17,
    hp: 40,
    hd: [10, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+6"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(7)"] = {
    name: "Bestial Spirit (Air)(lvl 7)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*7).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 18,
    hp: 45,
    hd: [11, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+7"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(8)"] = {
    name: "Bestial Spirit (Air)(lvl 8)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*8).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 19,
    hp: 50,
    hd: [12, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+8"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
CreatureList["bestial spirit (a)(9)"] = {
    name: "Bestial Spirit (Air)(lvl 9)",
    regExpSearch: /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*9).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 4,
    type: "Beast",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon beast",
    isSummon: true,
    ac: 20,
    hp: 55,
    hd: [14, 6],
    speed: "30 ft, Fly 60 ft (Air)",
    scores: [18, 11, 16, 4, 14, 5],
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Flyby (Air Only)",
        description: "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 8, "Piercing"],
        range: "Melee (5 ft)",
        modifiers: ["", "Str+9"],
        description: "The target can't regain Hit Points until the start of the spirit's next turn.",
        useSpellMod: ["druid", "ranger"]
    }],
};
//Celestial Spirit Stat Blocks
CreatureList["celestial spirit (a)(5)"] = {
    name: "Celestial Spirit (Avenger)(lvl 5)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*5).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 16,
    hp: 40,
    hd: [7, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+5",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Bow (Avenger Only)",
        ability: 2,
        damage: [2, 6, "Radiant"],
        range: "Ranged (600 ft)",
        modifiers: ["", 5],
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (a)(6)"] = {
    name: "Celestial Spirit (Avenger)(lvl 6)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*6).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 17,
    hp: 50,
    hd: [8, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+6",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Bow (Avenger Only)",
        ability: 2,
        damage: [2, 6, "Radiant"],
        range: "Ranged (600 ft)",
        modifiers: ["", 6],
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (a)(7)"] = {
    name: "Celestial Spirit (Avenger)(lvl 7)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*7).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 18,
    hp: 60,
    hd: [10, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+7",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Bow (Avenger Only)",
        ability: 2,
        damage: [2, 6, "Radiant"],
        range: "Ranged (600 ft)",
        modifiers: ["", 7],
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (a)(8)"] = {
    name: "Celestial Spirit (Avenger)(lvl 8)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*8).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 19,
    hp: 70,
    hd: [12, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+8",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Bow (Avenger Only)",
        ability: 2,
        damage: [2, 6, "Radiant"],
        range: "Ranged (600 ft)",
        modifiers: ["", 8],
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (a)(9)"] = {
    name: "Celestial Spirit (Avenger)(lvl 9)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*9).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 20,
    hp: 80,
    hd: [13, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+9",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Bow (Avenger Only)",
        ability: 2,
        damage: [2, 6, "Radiant"],
        range: "Ranged (600 ft)",
        modifiers: ["", 9],
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (d)(5)"] = {
    name: "Celestial Spirit (Defender)(lvl 5)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*5).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 18,
    hp: 40,
    hd: [7, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+5",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Mace (Defender Only)",
        ability: 1,
        damage: [1, 10, "Radiant"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The spirit choose either itself or another creature it can see within 10 ft and grants 1d10 Temp HP.",
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (d)(6)"] = {
    name: "Celestial Spirit (Defender)(lvl 6)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*6).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 19,
    hp: 50,
    hd: [8, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+6",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Mace (Defender Only)",
        ability: 1,
        damage: [1, 10, "Radiant"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The spirit choose either itself or another creature it can see within 10 ft and grants 1d10 Temp HP.",
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (d)(7)"] = {
    name: "Celestial Spirit (Defender)(lvl 7)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*7).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 20,
    hp: 60,
    hd: [10, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    attacks: [{
        name: "Radiant Mace (Defender Only)",
        ability: 1,
        damage: [1, 10, "Radiant"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The spirit choose either itself or another creature it can see within 10 ft and grants 1d10 Temp HP.",
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (d)(8)"] = {
    name: "Celestial Spirit (Defender)(lvl 8)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*8).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 21,
    hp: 70,
    hd: [12, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+8",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Mace (Defender Only)",
        ability: 1,
        damage: [1, 10, "Radiant"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The spirit choose either itself or another creature it can see within 10 ft and grants 1d10 Temp HP.",
        useSpellMod: ["cleric", "paladin"]
    }],
};
CreatureList["celestial spirit (d)(9)"] = {
    name: "Celestial Spirit (Defender)(lvl 9)",
    regExpSearch: /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*9).*$/i,
    source: [
        ["P24", 323]
    ],
    size: 2,
    type: "Celestial",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon celestial",
    ac: 22,
    hp: 80,
    hd: [13, 10],
    speed: "30 ft, Fly 40 ft",
    scores: [16, 14, 16, 10, 14, 16],
    damage_resistances: "Radiant",
    condition_immunities: "Charmed; Frightened",
    senses: "Darkvision 60 ft",
    passivePerception: 12,
    languages: "Celestial; Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Healing Touch (1/Day)",
        description: "The spirit touches another creature. The target regains Hit Points equal to 2d8+9",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Radiant Mace (Defender Only)",
        ability: 1,
        damage: [1, 10, "Radiant"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "The spirit choose either itself or another creature it can see within 10 ft and grants 1d10 Temp HP.",
        useSpellMod: ["cleric", "paladin"]
    }],
};
//Construct Spirit Stat Blocks
CreatureList["construct spirit (4)"] = {
    name: "Construct Spirit (lvl 4)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*4).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 17,
    hp: 40,
    hd: [8, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        useSpellMod: ["wizard"]
    }],
};
CreatureList["construct spirit (5)"] = {
    name: "Construct Spirit (lvl 5)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*5).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 18,
    hp: 55,
    hd: [11, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        useSpellMod: ["wizard"]
    }],
};
CreatureList["construct spirit (6)"] = {
    name: "Construct Spirit (lvl 6)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*6).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 19,
    hp: 70,
    hd: [14, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        useSpellMod: ["wizard"]
    }],
};
CreatureList["construct spirit (7)"] = {
    name: "Construct Spirit (lvl 7)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*7).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 20,
    hp: 85,
    hd: [17, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        useSpellMod: ["wizard"]
    }],
};
CreatureList["construct spirit (8)"] = {
    name: "Construct Spirit (lvl 8)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*8).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 21,
    hp: 100,
    hd: [20, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        useSpellMod: ["wizard"]
    }],
};
CreatureList["construct spirit (9)"] = {
    name: "Construct Spirit (lvl 9)",
    regExpSearch: /^(?=.*construct)(?=.*spirit)(?=.*9).*$/i,
    source: [
        ["P24", 324]
    ],
    size: 3,
    type: "Construct",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon construct",
    ac: 22,
    hp: 115,
    hd: [23, 8],
    speed: "30 ft",
    scores: [18, 10, 18, 14, 11, 5],
    damage_resistances: "Poison",
    condition_immunities: "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    actions: [{
        name: "Berserk Lashing (Clay Only)",
        description: "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
    }],
    features: [{
        name: "Heated Body (Metal Only)",
        description: "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
        joinString: "\n   ",
    }, {
        name: "Stony Lethargy (Stone Only)",
        description: "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals my spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 8, "Bludgeoning"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        useSpellMod: ["wizard"]
    }],
};
//Draconic Spirit Stat Block
CreatureList["draconic spirit (5)"] = {
    name: "Draconic Spirit (lvl 5)",
    regExpSearch: /^(?=.*draconic)(?=.*spirit)(?=.*5).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 2,
    type: "Dragon",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon dragon",
    ac: 19,
    hp: 50,
    hd: [8, 10],
    speed: "30 ft, Fly 60 ft, Swim 30 ft",
    scores: [19, 14, 17, 10, 14, 14],
    damage_resistances: "Acid, Cold, Fire, Lightning, Poison",
    condition_immunities: "Charmed, Frightened, Poisoned",
    senses: "Blindsight 30 ft, Darkvision 60 ft",
    passivePerception: 12,
    languages: "Draconic, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Shared Resistances",
        description: "When I summon the spirit, choose one of its Resistances. I have Resistane to the chosen damage type until the spell ends.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (10 ft)",
        modifiers: ["", 5],
        useSpellMod: ["wizard"]
    }, {
        name: "Breath Weapon",
        ability: 1,
        dc: true,
        damage: [2, 6, "Ac/Cd/Fi/Li/Po"],
        abilitytodamage: false,
        range: "30 ft Cone",
        useSpellMod: ["wizard"]
    }],
};
CreatureList["draconic spirit (6)"] = {
    name: "Draconic Spirit (lvl 6)",
    regExpSearch: /^(?=.*draconic)(?=.*spirit)(?=.*6).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 2,
    type: "Dragon",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon dragon",
    ac: 20,
    hp: 60,
    hd: [10, 10],
    speed: "30 ft, Fly 60 ft, Swim 30 ft",
    scores: [19, 14, 17, 10, 14, 14],
    damage_resistances: "Acid, Cold, Fire, Lightning, Poison",
    condition_immunities: "Charmed, Frightened, Poisoned",
    senses: "Blindsight 30 ft, Darkvision 60 ft",
    passivePerception: 12,
    languages: "Draconic, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Shared Resistances",
        description: "When I summon the spirit, choose one of its Resistances. I have Resistane to the chosen damage type until the spell ends.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (10 ft)",
        modifiers: ["", 6],
        useSpellMod: ["wizard"]
    }, {
        name: "Breath Weapon",
        ability: 1,
        dc: true,
        damage: [2, 6, "Ac/Cd/Fi/Li/Po"],
        abilitytodamage: false,
        range: "30 ft Cone",
        useSpellMod: ["wizard"]
    }],
};
CreatureList["draconic spirit (7)"] = {
    name: "Draconic Spirit (lvl 7)",
    regExpSearch: /^(?=.*draconic)(?=.*spirit)(?=.*7).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 2,
    type: "Dragon",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon dragon",
    ac: 21,
    hp: 70,
    hd: [12, 10],
    speed: "30 ft, Fly 60 ft, Swim 30 ft",
    scores: [19, 14, 17, 10, 14, 14],
    damage_resistances: "Acid, Cold, Fire, Lightning, Poison",
    condition_immunities: "Charmed, Frightened, Poisoned",
    senses: "Blindsight 30 ft, Darkvision 60 ft",
    passivePerception: 12,
    languages: "Draconic, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Shared Resistances",
        description: "When I summon the spirit, choose one of its Resistances. I have Resistane to the chosen damage type until the spell ends.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (10 ft)",
        modifiers: ["", 7],
        useSpellMod: ["wizard"]
    }, {
        name: "Breath Weapon",
        ability: 1,
        dc: true,
        damage: [2, 6, "Ac/Cd/Fi/Li/Po"],
        abilitytodamage: false,
        range: "30 ft Cone",
        useSpellMod: ["wizard"]
    }],
};
CreatureList["draconic spirit (8)"] = {
    name: "Draconic Spirit (lvl 8)",
    regExpSearch: /^(?=.*draconic)(?=.*spirit)(?=.*8).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 2,
    type: "Dragon",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon dragon",
    ac: 22,
    hp: 80,
    hd: [13, 10],
    speed: "30 ft, Fly 60 ft, Swim 30 ft",
    scores: [19, 14, 17, 10, 14, 14],
    damage_resistances: "Acid, Cold, Fire, Lightning, Poison",
    condition_immunities: "Charmed, Frightened, Poisoned",
    senses: "Blindsight 30 ft, Darkvision 60 ft",
    passivePerception: 12,
    languages: "Draconic, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Shared Resistances",
        description: "When I summon the spirit, choose one of its Resistances. I have Resistane to the chosen damage type until the spell ends.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (10 ft)",
        modifiers: ["", 8],
        useSpellMod: ["wizard"]
    }, {
        name: "Breath Weapon",
        ability: 1,
        dc: true,
        damage: [2, 6, "Ac/Cd/Fi/Li/Po"],
        abilitytodamage: false,
        range: "30 ft Cone",
        useSpellMod: ["wizard"]
    }],
};
CreatureList["draconic spirit (9)"] = {
    name: "Draconic Spirit (lvl 9)",
    regExpSearch: /^(?=.*draconic)(?=.*spirit)(?=.*9).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 2,
    type: "Dragon",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon dragon",
    ac: 23,
    hp: 90,
    hd: [15, 10],
    speed: "30 ft, Fly 60 ft, Swim 30 ft",
    scores: [19, 14, 17, 10, 14, 14],
    damage_resistances: "Acid, Cold, Fire, Lightning, Poison",
    condition_immunities: "Charmed, Frightened, Poisoned",
    senses: "Blindsight 30 ft, Darkvision 60 ft",
    passivePerception: 12,
    languages: "Draconic, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Shared Resistances",
        description: "When I summon the spirit, choose one of its Resistances. I have Resistane to the chosen damage type until the spell ends.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Rend",
        ability: 1,
        damage: [1, 6, "Piercing"],
        range: "Melee (10 ft)",
        modifiers: ["", 9],
        useSpellMod: ["wizard"]
    }, {
        name: "Breath Weapon",
        ability: 1,
        dc: true,
        damage: [2, 6, "Ac/Cd/Fi/Li/Po"],
        abilitytodamage: false,
        range: "30 ft Cone",
        useSpellMod: ["wizard"]
    }],
};
//Elemental Spirit Stat Blocks
CreatureList["elemental spirit (4)"] = {
    name: "Elemental Spirit (lvl 4)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*4).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 15,
    hp: 50,
    hd: [8, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 4],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
CreatureList["elemental spirit (5)"] = {
    name: "Elemental Spirit (lvl 5)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*5).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 16,
    hp: 60,
    hd: [10, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 5],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
CreatureList["elemental spirit (6)"] = {
    name: "Elemental Spirit (lvl 6)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*6).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 17,
    hp: 70,
    hd: [12, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 6],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
CreatureList["elemental spirit (7)"] = {
    name: "Elemental Spirit (lvl 7)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*7).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 18,
    hp: 80,
    hd: [14, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 7],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
CreatureList["elemental spirit (8)"] = {
    name: "Elemental Spirit (lvl 8)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*8).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 19,
    hp: 90,
    hd: [15, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 8],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
CreatureList["elemental spirit (9)"] = {
    name: "Elemental Spirit (lvl 9)",
    regExpSearch: /^(?=.*elemental)(?=.*spirit)(?=.*9).*$/i,
    source: [
        ["P24", 325]
    ],
    size: 3,
    type: "Elemental",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon elemental",
    ac: 20,
    hp: 100,
    hd: [17, 10],
    speed: "40 ft, Burrow(E) 40 ft, Fly 40 ft(Hover(A)), Swim(W) 40 ft",
    scores: [18, 15, 17, 4, 10, 16],
    damage_resistances: "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
    damage_immunities: "Fire(F), Poison",
    condition_immunities: "Exhaustion, Paralyzed, Petrified, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Primordial, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Amorphous Form (A,F,W)",
        description: "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Slam",
        ability: 1,
        damage: [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
        range: "Melee (10 ft)",
        modifiers: ["", 9],
        useSpellMod: ["druid", "ranger", "wizard"]
    }],
};
//Fey Spirit Stat Blocks
CreatureList["fey spirit (3)"] = {
    name: "Fey Spirit (lvl 3)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*3).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 15,
    hp: 30,
    hd: [7, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 3],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (4)"] = {
    name: "Fey Spirit (lvl 4)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*4).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 16,
    hp: 40,
    hd: [10, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (5)"] = {
    name: "Fey Spirit (lvl 5)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*5).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 17,
    hp: 50,
    hd: [12, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (6)"] = {
    name: "Fey Spirit (lvl 6)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*6).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 18,
    hp: 60,
    hd: [15, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (7)"] = {
    name: "Fey Spirit (lvl 7)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*7).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 19,
    hp: 70,
    hd: [17, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (8)"] = {
    name: "Fey Spirit (lvl 8)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*8).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 20,
    hp: 80,
    hd: [20, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
CreatureList["fey spirit (9)"] = {
    name: "Fey Spirit (lvl 9)",
    regExpSearch: /^(?=.*fey)(?=.*spirit)(?=.*9).*$/i,
    source: [
        ["P24", 326]
    ],
    size: 4,
    type: "Fey",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fey",
    ac: 21,
    hp: 90,
    hd: [22, 6],
    speed: "30 ft, Fly 30 ft",
    scores: [13, 16, 14, 14, 11, 16],
    condition_immunities: "Charmed",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Sylvan, Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    actions: [{
        name: "Fey Step",
        description: desc([
            "As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
            "Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
            "Mirthful. Wisdom Saving Throw: DC equals my spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by I and the spirit for 1 minute or until the target takes any damage.",
            "Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
        ]),
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fey Blade",
        ability: 2,
        damage: [2, 6, "Force"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        useSpellMod: ["druid", "ranger", "warlock", "wizard"]
    }],
};
//Fiendish Spirit Stat Blocks
CreatureList["fiendish spirit (demon)(6)"] = {
    name: "Fiendish Spirit (Demon)(lvl 6)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*6).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 18,
    hp: 50,
    hd: [8, 10],
    speed: "40 ft, Climb 40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Death Throes",
        description: "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals my spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+6 Fire damage. Success: Half damage.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 12, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (demon)(7)"] = {
    name: "Fiendish Spirit (Demon)(lvl 7)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*7).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 65,
    hd: [11, 10],
    speed: "40 ft, Climb 40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Death Throes",
        description: "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals my spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+7 Fire damage. Success: Half damage.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 12, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (demon)(8)"] = {
    name: "Fiendish Spirit (Demon)(lvl 8)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*8).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 80,
    hd: [13, 10],
    speed: "40 ft, Climb 40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Death Throes",
        description: "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals my spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+8 Fire damage. Success: Half damage.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 12, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (demon)(9)"] = {
    name: "Fiendish Spirit (Demon)(lvl 9)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*9).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 21,
    hp: 95,
    hd: [16, 10],
    speed: "40 ft, Climb 40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Death Throes",
        description: "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals my spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+9 Fire damage. Success: Half damage.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Bite",
        ability: 2,
        damage: [1, 12, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (devil)(6)"] = {
    name: "Fiendish Spirit (Devil)(lvl 6)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*6).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 18,
    hp: 40,
    hd: [7, 10],
    speed: "40 ft, Fly 60 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Devil's Sight",
        description: "Magical Darkness doesn't impede the spirit's Darkvision.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fiery Strike",
        ability: 2,
        damage: [2, 6, "Fire"],
        range: "Melee/Ranged (5 ft/150 ft)",
        modifiers: ["", 6],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (devil)(7)"] = {
    name: "Fiendish Spirit (Devil)(lvl 7)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*7).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 55,
    hd: [9, 10],
    speed: "40 ft, Fly 60 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Devil's Sight",
        description: "Magical Darkness doesn't impede the spirit's Darkvision.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fiery Strike",
        ability: 2,
        damage: [2, 6, "Fire"],
        range: "Melee/Ranged (5 ft/150 ft)",
        modifiers: ["", 7],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (devil)(8)"] = {
    name: "Fiendish Spirit (Devil)(lvl 8)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*8).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 70,
    hd: [12, 10],
    speed: "40 ft, Fly 60 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Devil's Sight",
        description: "Magical Darkness doesn't impede the spirit's Darkvision.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fiery Strike",
        ability: 2,
        damage: [2, 6, "Fire"],
        range: "Melee/Ranged (5 ft/150 ft)",
        modifiers: ["", 8],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (devil)(9)"] = {
    name: "Fiendish Spirit (Devil)(lvl 9)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*9).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 21,
    hp: 85,
    hd: [14, 10],
    speed: "40 ft, Fly 60 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Devil's Sight",
        description: "Magical Darkness doesn't impede the spirit's Darkvision.",
        joinString: "\n   ",
    }, {
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Fiery Strike",
        ability: 2,
        damage: [2, 6, "Fire"],
        range: "Melee/Ranged (5 ft/150 ft)",
        modifiers: ["", 9],
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (yugoloth)(6)"] = {
    name: "Fiendish Spirit (Yugoloth)(lvl 6)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*6).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 18,
    hp: 60,
    hd: [10, 10],
    speed: "40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claws",
        ability: 2,
        damage: [1, 8, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (yugoloth)(7)"] = {
    name: "Fiendish Spirit (Yugoloth)(lvl 7)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*7).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 75,
    hd: [12, 10],
    speed: "40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claws",
        ability: 2,
        damage: [1, 8, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (yugoloth)(8)"] = {
    name: "Fiendish Spirit (Yugoloth)(lvl 8)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*8).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 19,
    hp: 90,
    hd: [15, 10],
    speed: "40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claws",
        ability: 2,
        damage: [1, 8, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
        useSpellMod: ["warlock", "wizard"]
    }],
};
CreatureList["fiendish spirit (yugoloth)(9)"] = {
    name: "Fiendish Spirit (Yugoloth)(lvl 9)",
    regExpSearch: /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*9).*$/i,
    source: [
        ["P24", 327]
    ],
    size: 2,
    type: "Fiend",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon fiend",
    ac: 21,
    hp: 105,
    hd: [17, 10],
    speed: "40 ft",
    scores: [13, 16, 15, 10, 10, 16],
    damage_resistances: "Fire",
    damage_immunities: "Poison",
    condition_immunities: "Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Abyssal, Infernal, Telepathy 60 ft",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Magic Resistance",
        description: "The spirit has Advantage on saving throws against spells and other magical effects.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Claws",
        ability: 2,
        damage: [1, 8, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
        useSpellMod: ["warlock", "wizard"]
    }],
};
//Undead Spirit Stat Blocks
CreatureList["undead spirit (skeletal)(3)"] = {
    name: "Undead Spirit (Skeletal)(lvl 3)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*3).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 14,
    hp: 20,
    hd: [4, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 3],
    }],
};
CreatureList["undead spirit (skeletal)(4)"] = {
    name: "Undead Spirit (Skeletal)(lvl 4)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*4).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 15,
    hp: 30,
    hd: [6, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 4],
    }],
};
CreatureList["undead spirit (skeletal)(5)"] = {
    name: "Undead Spirit (Skeletal)(lvl 5)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*5).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 16,
    hp: 40,
    hd: [8, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 5],
    }],
};
CreatureList["undead spirit (skeletal)(6)"] = {
    name: "Undead Spirit (Skeletal)(lvl 6)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*6).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 17,
    hp: 50,
    hd: [10, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 6],
    }],
};
CreatureList["undead spirit (skeletal)(7)"] = {
    name: "Undead Spirit (Skeletal)(lvl 7)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*7).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 18,
    hp: 60,
    hd: [12, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 7],
    }],
};
CreatureList["undead spirit (skeletal)(8)"] = {
    name: "Undead Spirit (Skeletal)(lvl 8)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*8).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 19,
    hp: 70,
    hd: [14, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 8],
    }],
};
CreatureList["undead spirit (skeletal)(9)"] = {
    name: "Undead Spirit (Skeletal)(lvl 9)",
    regExpSearch: /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*9).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 20,
    hp: 80,
    hd: [16, 8],
    speed: "30 ft, Fly 40 ft",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    attacks: [{
        name: "Grave Bolt",
        ability: 2,
        damage: [2, 4, "Necrotic"],
        range: "Ranged (150 ft)",
        modifiers: ["", 9],
    }],
};
CreatureList["undead spirit (putrid/ghostly)(3)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 3)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*3).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 14,
    hp: 30,
    hd: [6, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 1,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 3],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 3],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(4)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 4)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*4).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 15,
    hp: 40,
    hd: [8, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 4],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(5)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 5)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*5).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 16,
    hp: 50,
    hd: [10, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 2,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 5],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(6)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 6)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*6).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 17,
    hp: 60,
    hd: [12, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 6],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(7)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 7)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*7).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 18,
    hp: 70,
    hd: [14, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 3,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 7],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(8)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 8)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*8).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 19,
    hp: 80,
    hd: [16, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 8],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};
CreatureList["undead spirit (putrid/ghostly)(9)"] = {
    name: "Undead Spirit (Putrid/Ghostly)(lvl 9)",
    regExpSearch: /^(?=.*undead)(?=.*putridghostly)(?=.*9).*$/i,
    source: [
        ["P24", 328]
    ],
    size: 3,
    type: "Undead",
    alignment: "Neutral",
    companion: "spell_creatures",
    companionApply: "spell_creatures",
    spell: "summon undead",
    ac: 20,
    hp: 90,
    hd: [18, 8],
    speed: "30 ft, Fly 40 ft(Hover, Ghostly)",
    scores: [12, 16, 15, 4, 10, 9],
    damage_immunities: "Necrotic, Poison",
    condition_immunities: "Exhaustion, Frightened, Paralyzed, Poisoned",
    senses: "Darkvision 60 ft",
    passivePerception: 10,
    languages: "Understands the languages I know",
    challengeRating: 0,
    proficiencyBonus: 2,
    proficiencyBonusLinked: true,
    attacksAction: 4,
    features: [{
        name: "Festering Aura (Putrid Only)",
        description: "Constitution Saving Throw: DC equals my spell save DC, any creature (other than me) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
        joinString: "\n   ",
    }, {
        name: "Incorporeal Passage (Ghostly Only)",
        description: "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turn inside an object, it is shunted to the nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
        joinString: "\n   ",
    }],
    attacks: [{
        name: "Deathly Touch (Ghostly Only)",
        ability: 2,
        damage: [1, 8, "Necrotic"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "On a hit, the target has the Frightened condition until the end of its next turn.",
    }, {
        name: "Rotting Claw (Putrid Only)",
        ability: 2,
        damage: [1, 6, "Slashing"],
        range: "Melee (5 ft)",
        modifiers: ["", 9],
        description: "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
    }],
};




